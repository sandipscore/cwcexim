using Newtonsoft.Json;
using Newtonsoft.Json.Linq;
using System;
using System.Collections;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using CwcExim.Areas.Report.Models;
using CwcExim.Controllers;
using CwcExim.Models;
using CwcExim.Repositories;
using CwcExim.Filters;
using CwcExim.UtilityClasses;
using System.Reflection;
using System.Text;
using CwcExim.Areas.Import.Models;
using System.Data;
using CwcExim.Areas.Export.Models;
using CwcExim.Areas.CashManagement.Models;
using EinvoiceLibrary;
using System.Threading.Tasks;
using System.Globalization;

namespace CwcExim.Areas.Report.Controllers
{

    public class DSR_ReportCWCController : BaseController
    {
        private static readonly log4net.ILog log = log4net.LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);

        private string HeadOffice { get; set; }
        private string HOAddress { get; set; }
        public string ZonalOffice { get; set; }
        public string ZOAddress { get; set; }
        public string GSTIN { get; set; }

        public decimal EffectVersion { get; set; }

        public string EffectVersionLogoFile { get; set; }
        //List<string> lstSBPrint = new List<string>();
        public DSR_ReportCWCController()
        {
            /*
             * CALL PROCEDURE AND SET VALUE OF PROPERTIES
             */
            DSRCompanyDetailsForReport objCompanyDetails = new DSRCompanyDetailsForReport();
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.getCompanyDetails();
            objCompanyDetails = (DSRCompanyDetailsForReport)ObjRR.DBResponse.Data;
            HeadOffice = ""; //objCompanyDetails.CompanyName;
            HOAddress = "";//objCompanyDetails.RoAddress;
            ZonalOffice = objCompanyDetails.CompanyName;
            ZOAddress = objCompanyDetails.CompanyAddress;
            GSTIN = objCompanyDetails.GSTIN;
            EffectVersion = Convert.ToDecimal(objCompanyDetails.EffectVersion);
            EffectVersionLogoFile = objCompanyDetails.VersionLogoFile.ToString();


        }

        #region ChequeSummaryReport

        /*Invoice Report Details Section-21.08.2018*/
        [HttpGet]
        public ActionResult ChequeSummaryReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetChequeSummaryReport(DSR_ChequeSummary ObjChequeSummary)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_ChequeSummary> LstChequeSummary = new List<DSR_ChequeSummary>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.ChequeSummary(ObjChequeSummary);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstChequeSummary = (List<DSR_ChequeSummary>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {

                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateChequeSummaryReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "ChequeSummary.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/ChequeSummary/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/ChequeSummary/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        //-----------------for update ChequeSummaryReport

        [HttpGet]
        public ActionResult PpgChequeDdPoSdSummaryReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetChequeDdPoSdSummaryReport(DSR_CashChequeDDSummary ObjChequeSummary)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_CashChequeDDSummary> LstChequeSummary = new List<DSR_CashChequeDDSummary>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.ChequeCashDDPOSummary(ObjChequeSummary);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstChequeSummary = (List<DSR_CashChequeDDSummary>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateChequeDdPoSdSummaryReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "ChequeSummary.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/ChequeSummary/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/ChequeSummary/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        //END 





        #endregion

        #region Invoice Containerwise


        [HttpGet]
        public ActionResult ContainerwiseInvoiceReport()
        {

            DSR_ReportRepository objExport = new DSR_ReportRepository();
            objExport.GetContainer();
            if (objExport.DBResponse.Status > 0)
                ViewBag.ContainerNo = JsonConvert.SerializeObject(objExport.DBResponse.Data);
            else
                ViewBag.ContainerNo = null;
            return PartialView();
        }

        [HttpPost]
        //[ValidateAntiForgeryToken]
        public JsonResult GetContainerReport(DSRContainerInvoiceReport ObjContaiunerReport)
        {
            if (ObjContaiunerReport.ContainerNo == null)
            {
                ObjContaiunerReport.ContainerNo = "";
            }
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            // List<DSRInvoiceGate> DSRInvoiceGateList = ObjRR.GetBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);//, objLogin.Uid
            ObjRR.ContainerInvoiceDetailsForPrint(ObjContaiunerReport);//, objLogin.Uid
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                //string FilePath = GeneratingBulkPDF(DSRInvoiceGateList, ObjBulkInvoiceReport.InvoiceModuleName);
                string FilePath = "";


                FilePath = GeneratingContainerInvoice(ds);

                return Json(new { Status = 1, Data = FilePath });
            }
            else
                return Json(new { Status = -1, Data = "No Record Found." });

        }



        [NonAction]
        public string GeneratingContainerInvoice(DataSet ds)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<string> lstOA = new List<string>();
            String CWC = "CWC";
            String GST = "";
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + ZonalOffice + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>" + ZOAddress + "</span>");
                html.Append("<br />");
                html.Append("</td></tr>");
                html.Append("<tr><td style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + GST + "</label></span></td></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Container wise Invoice</h2> </td></tr>");
                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                html.Append("<span>" + item.PartyName + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                html.Append("Party Address :</label> <span>" + item.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("</tr></tbody> ");
                html.Append("</table></td></tr><tr><td><hr /></td></tr><tr><th><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Size</th>");

                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.Size + "</td>");

                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Clause</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>" + data.Clause + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + data.Taxable.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 150px;'>" + data.Total.ToString("0") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 11px; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr><td style='font-size: 12px; text-align: left; line-height: 30px;'>Receipt No.: ");
                html.Append("<label style='font-weight: bold;'></label></td><td style='font-size: 12px; text-align: left; line-height: 30px;'>Party Code:");
                html.Append("<label style='font-weight: bold;'>" + "</label></td></tr><tr><td style='font-size: 11px; text-align: left; line-height: 30px;'>");
                html.Append("*Cheques are subject to realisation</td><td style='font-size: 11px; text-align: left; line-height: 30px;'>SAM(A/C)</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");
                /***************/
                lstOA.Add(html.ToString());
            });
            var FileName = "ContainerReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstOA);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }


        #endregion

        #region GatePassReport
        [HttpGet]
        public ActionResult GatePassReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Kdl_ReportRepository ObjReport = new Kdl_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetGatePassReport(GatePassReport ObjGatePassReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<GatePassReport> LstContainerOutReport = new List<GatePassReport>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.GatePassReport(ObjGatePassReport, objLogin.Uid);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstContainerOutReport = (List<GatePassReport>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateGatePassReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "GatePassReport.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/GatePassReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/GatePassReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }
        #endregion

        #region Bulk Invoice

        [HttpGet]
        public ActionResult BulkInvoiceReport()
        {

            ExportRepository objExport = new ExportRepository();
            objExport.GetPaymentParty();
            if (objExport.DBResponse.Status > 0)
                ViewBag.PaymentParty = JsonConvert.SerializeObject(objExport.DBResponse.Data);
            else
                ViewBag.PaymentParty = null;
            return PartialView();
        }

        [HttpPost]
        //[ValidateAntiForgeryToken]
        public JsonResult GetBulkInvoiceReport(DSRBulkInvoiceReport ObjBulkInvoiceReport)
        {
            if (ObjBulkInvoiceReport.InvoiceNumber == null)
            {
                ObjBulkInvoiceReport.InvoiceNumber = "";
            }
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            //When Module is selected All Condition against a party

            if (ObjBulkInvoiceReport.InvoiceModule == "All")
            {
                string ModuleName = "";
                //delete all the files in the folder before creating it
                if (System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    string deletelocation = Server.MapPath("~/Docs/All/") + Session.SessionID + "/";
                    DeleteDirectory(deletelocation);
                }

                //get all the distinct invoice module and invoices list with respect to party and date range 
                ObjRR.ModuleListWithInvoice(ObjBulkInvoiceReport);
                if (ObjRR.DBResponse.Status == 1)
                {
                    DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                    List<dynamic> lstModule = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
                    IList lstDistModule = lstModule.Select(x => x.Module).Distinct().ToList();
                    string FilePath = "";


                    foreach (string Mod in lstDistModule)
                    {
                        //lstModule.Where(x => x.Module == Mod).ToList().ForEach(itemInv =>
                        //{
                        //    String ModuleName= itemInv.Module;
                        switch (Mod)
                        {
                            //Here ds is list of invoice of a module between two dates 
                            case "IMPYard":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "ASSESSMENT SHEET FCL";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforYard((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "IMPDeli":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "ASSESSMENT SHEET LCL";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforGodown((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "EXPLod":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "LOADED CONTAINER PAYMENT SHEET";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforContainer((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "EXPMovement":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "CONTAINER MOVEMENT";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforContainerMov((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "EXP":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "EXPORT PAYMENT SHEET";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforContainerMov((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "CCIN":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "CCIN ENTRY";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforCCINEntry((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "BTT":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "BTT";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBTT((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "AUC":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Auction";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforAuction((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "EC":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "EMPTY CONTAINER PAYMENT SHEET";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforEmptyContainer((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "ECTrns":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "EMPTY CONTAINER TRANSFER";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforEmptyContainer((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "IMPSC":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "SEAL CUTTING";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforSealCutting((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "PEST":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "PEST";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforPest((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "EXPCRGSHFT":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "CARGO SHIFTING";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforCargoSF((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "Fumigation":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "FUMIGATION";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforFumigationInvoice((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "EXPCS":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "EXPORT CONTAINER STUFFING";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforContainerStuffingInvoice((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "BTTCon":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "EXPORT BTT CONTAINER ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBTTContainerInvoice((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "RCTSeal":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "RCT SEALING ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforRCTSealing((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "EXPGRE":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Export GRE Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforExpGRE((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "BND":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Bond Delivery Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBND((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "bnd":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Bond Delivery Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBND((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "BNDadv":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Bond Advance Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBondWhiteField((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "BNDAdv":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Bond Advance Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBondWhiteField((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "BNDAdvance":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Bond Advance Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBondAdvanceWhiteField((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "BNDUnloading":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Bond Unloading Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBonUnloadingInvoice((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "RESERV":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "RESERVATION ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingReservationBulkPDFforGE((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "Rent":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Rent ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforRentInvoice((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "IMPRCTSeal":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Import RCT Seal ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforImportRCTSealing((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            default:
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                //case statement for printing name of invoices                                
                                if (Mod == "GE") { ModuleName = "GATE ENTRY"; }
                                else if (Mod == "IMPFCLLCL") { ModuleName = "FCL To LCL CONVERSION"; }
                                else if (Mod == "MiscInv") { ModuleName = "MISCELLANEOUS"; }
                                /*  else if (Mod == "EXPCS") { ModuleName = "EXPORT CONTAINER STUFFING"; }*/
                                //else if (Mod == "RENT") { ModuleName = "RENT"; }
                                //else if (Mod == "RESERV") { ModuleName = "RESERVATION"; }
                                else if (Mod == "IRR") { ModuleName = "IRR"; }
                                else if (Mod == "INVDEBT") { ModuleName = "CONTAINER DEBIT INVOICE"; }
                                else if (Mod == "EXPRRCD") { ModuleName = "EXPORT RR CREDIT DEBIT"; }
                                else if (Mod == "JO") { ModuleName = "JOB ORDER"; }
                                else ModuleName = Mod;
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforGE((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                        }
                        //});

                    }
                    return Json(new { Status = 1, Data = FilePath });
                }
                else
                    return Json(new { Status = -1, Data = "No Record Found." });
            }

            else
            {
                // List<DSRInvoiceGate> DSRInvoiceGateList = ObjRR.GetBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);//, objLogin.Uid
                ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);//, objLogin.Uid

                if (ObjRR.DBResponse.Status == 1)
                {
                    DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                    //string FilePath = GeneratingBulkPDF(DSRInvoiceGateList, ObjBulkInvoiceReport.InvoiceModuleName);
                    string FilePath = "";
                    switch (ObjBulkInvoiceReport.InvoiceModule)
                    {
                        case "IMPYard":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforYard(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "IMPDeli":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforGodown(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EXPLod":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforContainer(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EXPMovement":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforContainerMov(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EXP":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforContainerMov(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "CCIN":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforCCINEntry(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BTT":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforBTT(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "PEST":
                            FilePath = GeneratingBulkPDFforPest(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;

                        case "AUC":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforAuction(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EC":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforEmptyContainer(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "ECTrns":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforEmptyContainer(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "IMPSC":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforSealCutting(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EXPCRGSHFT":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforCargoSF(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "Fumigation":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforFumigationInvoice(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EXPCS":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforContainerStuffingInvoice(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BND":
                            FilePath = GeneratingBulkPDFforBND(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "bnd":
                            FilePath = GeneratingBulkPDFforBND(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BNDadv":
                            FilePath = GeneratingBulkPDFforBondWhiteField(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BNDAdv":
                            FilePath = GeneratingBulkPDFforBondWhiteField(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BNDAdvance":
                            FilePath = GeneratingBulkPDFforBondAdvanceWhiteField(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BNDUnloading":
                            FilePath = GeneratingBulkPDFforBonUnloadingInvoice(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BTTCon":

                            FilePath = GeneratingBulkPDFforBTTContainerInvoice(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;

                        case "RESERV":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingReservationBulkPDFforGE(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "Rent":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforRentInvoice(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "RCTSeal":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforRCTSealing(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "IMPRCTSeal":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforImportRCTSealing(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EXPGRE":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforExpGRE(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        default:
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforGE(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                    }

                    return Json(new { Status = 1, Data = FilePath });
                }
                else
                    return Json(new { Status = -1, Data = "No Record Found." });
            }
        }

        [NonAction]
        public string GeneratingBulkPDFforBondAdvanceDSR(DataSet ds, string InvoiceModuleName)
        {
            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='font-size: 12px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 12px;'>Email - " + objCompany[0].EmailAddress + "</label>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'>Bond Advance Payment sheet</label>");
                html.Append("</td>");
                html.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='3' style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td colspan='3'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='12'><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + "</h2> </td></tr>");
                html.Append("<tr><td colspan='12'><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Payer Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td></tr><tr><td colspan='12'><hr /></td></tr>");
                html.Append("<tr><th colspan='6' width='50%'><b style='text-align: left; font-size: 12px;margin-top: 10px;'>SAC No :" + item.StuffingReqNo + "</b></th>");

                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<td colspan='6' width='50%' style='font-size:12px;'><b>SAC validity :</b> From <u>" + elem.SacApprovedDate + "</u> to <u>" + elem.SacValidityDate + "</u></td></tr>");
                });

                //html.Append("<tr><th colspan='12'><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container/Cargo Details :</b> </th></tr>");
                //html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='10'>");
                //html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>SR No.</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>CFS Code</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Container No.</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Size</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Arrival</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Carting</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Destuffing</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Delivery</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>No of Days</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>No of Week</th>");
                //html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Cargo Type</th>");
                //html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/

                // lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                //{
                //    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + i + "</td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + elem.ArrivalDate + "</td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + item.DeliveryDate + "</td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + ((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.ArrivalDate)).TotalDays + 1).ToString() + "</td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + Math.Ceiling(((((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(item.ArrivalDate)).TotalDays + 1)) / 7)).ToString() + "</td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + Convert.ToDateTime(elem.DeliveryDate)+ "</td>");
                //    html.Append("<td style='border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                //    html.Append("</tr>");
                //    i = i + 1;
                //});
                /***************/
                //html.Append("</tbody></table></td></tr>");

                html.Append("<tr><td colspan='12'>");

                //html.Append("<table style=' border: 1px solid #000; width:100%;' cellspacing='0' cellpadding='5'>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='5'>Shipping Line : " + item.ShippingLineName + " </td></tr>");
                //html.Append("<tr><td style='font-size: 12px;'>Shipping Line No.:  </td>");
                //html.Append("<td style='font-size: 12px;'>OBL No :  </td>");
                //html.Append("<td style='font-size: 12px;'>Item No. : " + lstContainer.Where(x => x.InvoiceId == item.InvoiceId).Count().ToString() + "</td>");
                //html.Append("<td style='font-size: 12px;'>BOE No : " + item.BOENo.ToString().TrimEnd(',') + " </td>");
                //html.Append("<td style='font-size: 12px;'>BOE Date : " + item.BOEDate.ToString().TrimEnd(',') + " </td>");
                //html.Append("</tr>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='3'>Importer : " + item.ExporterImporterName + " </td>");
                //html.Append("<td style='font-size: 12px;' colspan='2'>VALUE : " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='5'>CHA Name : " + item.CHAName + " </td></tr>");
                //html.Append("<tr><td style='font-size: 12px;'>No Of Pkg : " + item.TotalNoOfPackages.ToString() + " </td>");
                //html.Append("<td style='font-size: 12px;'>Total Gr.Wt (In Kg) : " + item.TotalGrossWt.ToString("0.000") + " </td>");
                //html.Append("<td style='font-size: 12px;'>Total Area (In Sqr Mtr) : " + item.TotalSpaceOccupied.ToString("0.000") + "</td>");
                //html.Append("<td></td>");
                //html.Append("<td></td>");
                //html.Append("</tr>");
                //html.Append("</table>");
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                    html.Append("<td colspan='6' width='50%'>");
                    html.Append("<table style='width:100%; font-size:9pt;' cellspacing='0' cellpadding='5'><tbody>");
                    html.Append("<tr><td colspan='6' width='30%'>BOL No.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOLNo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>BOL Date</td><td>:</td><td colspan='6' width='70%'>" + elem.BOLDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>BOE No.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOENo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>BOE Date.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOEDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>AWB No.</td><td>:</td><td colspan='6' width='70%'>" + elem.AWBNo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>AWB Date</td><td>:</td><td colspan='6' width='70%'>" + elem.AWBDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>IGM No.</td><td>:</td><td colspan='6' width='70%'>" + elem.IGMNo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>IGM Date</td><td>:</td><td colspan='6' width='70%'>" + elem.IGMDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>Godown No.</td><td>:</td><td colspan='6' width='70%'>" + elem.GodownName + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>Importer</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                    html.Append("</tbody></table>");
                    html.Append("</td>");

                    html.Append("<td colspan='6' width='50%'>");
                    html.Append("<table style='border-left: 1px solid #000; width:100%; font-size:9pt;' cellspacing='0' cellpadding='5'><tbody>");
                    html.Append("<tr><td colspan='6' width='40%'>CHA Name</td><td>:</td><td colspan='6' width='60%'>" + item.CHAName + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>CIF Value</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>DUTY</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Total</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>No Of Pkg</td><td>:</td><td colspan='6' width='60%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalSpaceOccupied.ToString("0.000") + "</td></tr>");
                    html.Append("</tbody></table>");
                    html.Append("</td>");

                    html.Append("</tr></tbody></table>");
                    html.Append("</td></tr>");

                    html.Append("<tr><th colspan='12'><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container/Cargo Charges :</h3> </th></tr>");
                    html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                    html.Append("<thead><tr>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SR No.</th>");
                    //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                    //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                    html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                    html.Append("<tbody>");
                    i = 1;
                    /*Charges Bind*/
                });
                i = 1;
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 150px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total :</th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + totamt.ToString("0") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");

                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-bottom:0; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 170px;'><span>&nbsp;&nbsp;</span>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th></tr>");


                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; padding: 5px;' colspan='13'><span>&nbsp;&nbsp;&nbsp;</span>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 11px; text-align: left; padding: 5px;' colspan='7'><span>&nbsp;&nbsp;&nbsp;</span>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 12px; text-align: left; width: 50%; vertical-align: bottom;'>");
                html.Append("</td>");
                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0;'>");
                html.Append("<span><br/></span>");
                html.Append("<p style='display: block; font-size: 11px; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> " + objCompany[0].BankName + "</p>");
                html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> " + objCompany[0].AccountNo + "</p>");
                html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span>" + objCompany[0].Branch + " & " + objCompany[0].IFSC + "</p>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='border: 1px solid #333; border-bottom: 0; border-right: 0; padding: 0 15px;'>");
                html.Append("<p style='text-align: right; font-size: 11px; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 11px; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody><tr><td style='font-size: 12px; text-align: left; line-height: 30px;'colspan='2'>Receipt No.: ");
                html.Append("<label style='font-weight: bold;'></label></td><td style='font-size: 12px; text-align: left; line-height: 30px;' colspan='2'>Party Code:");
                html.Append("<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 11px; text-align: left;'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 11px; text-align: left;'><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 11px; text-align: left;'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 11px; text-align: left;'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                lstSB.Add(html.ToString());
            });
            FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        [NonAction]
        public string GeneratingBulkPDFforPest(DataSet ds, string InvoiceModuleName, string All)
        {
            var FileName = "";
            var location = "";

            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstothers = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[11]);

            String Place = "";
            String FumigationType = "";
            String NoCanes = "";
            String Distance = "";
            String InvSplNo = "";
            String VesselNo = "";
            String NoOfPkg = "";
            String Chemical = "";
            String PortOfLoading = "";
            String PortOfDisc = "";
            String Country = "";
            String Exporter = "";
            String CargoDesc = "";
            String Consignee = "";
            String Remarks = "";
            String ContType = "";
            int NoOfPallets = 0;
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                lstothers.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    Place = elem.Place;
                    FumigationType = elem.FumigationType;
                    NoCanes = elem.NoCanes;
                    Distance = elem.Distance;
                    InvSplNo = elem.InvSplNo;
                    VesselNo = elem.VesselNo;
                    NoOfPkg = elem.NoOfPkg;
                    Chemical = elem.Chemical;

                    PortOfLoading = elem.PortOfLoading;
                    PortOfDisc = elem.PortOfDisc;
                    Country = elem.Country;
                    Exporter = elem.Exporter;
                    CargoDesc = elem.CargoDesc;
                    Consignee = elem.Consignee;
                    Remarks = elem.Remarks;
                    ContType = elem.ContainerType;
                    NoOfPallets = elem.NoOfPallets;
                }
                );
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                html.Append("<td align='left' valign='top'><img valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px;text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Assessment No :" + item.StuffingReqNo + "</b></th></tr>");
                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container/Cargo Details :</b></th></tr>");

                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Date of Arrival</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Date of Delivery</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + i + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='6' width='50%' style='border-bottom:1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Place of Fumigation</th><th>:</th><td colspan='6' width='70%'>" + Place + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>No. Container/Cane</th><th>:</th><td colspan='6' width='70%'>" + NoCanes + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Inv/Spl No</th><th>:</th><td colspan='6' width='70%'>" + InvSplNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>No. Pkg</th><th>:</th><td colspan='6' width='70%'>" + NoOfPkg + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Port of Loading</th><th>:</th><td colspan='6' width='70%'>" + PortOfLoading + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Port of Discharge</th><th>:</th><td colspan='6' width='70%'>" + PortOfDisc + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Name of Exporter / Importer</th><th>:</th><td colspan='6' width='70%'>" + Exporter + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Consignee</th><th>:</th><td colspan='6' width='70%'>" + Consignee + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Remarks</th><th>:</th><td colspan='6' width='70%'>" + Remarks + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td valign='top' colspan='6' width='50%' style='border-bottom:1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Fumigation Type</th><th>:</th><td colspan='6' width='70%'>" + FumigationType + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Container Type</th><th>:</th><td colspan='6' width='70%'>" + ContType + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Distance/Mt.</th><th>:</th><td colspan='6' width='70%'>" + Distance + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Name of Vessel/Ship</th><th>:</th><td colspan='6' width='70%'>" + VesselNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Chemical</th><th>:</th><td colspan='6' width='70%'>" + Chemical + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Country</th><th>:</th><td colspan='6' width='70%'>" + Country + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Cargo Description</th><th>:</th><td colspan='6' width='50%'>" + CargoDesc + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>No Of Pallets</th><th>:</th><td colspan='6' width='50%'>" + NoOfPallets + "</td></tr>");
                html.Append("<tr><th colspan='12' width='100%'></th></tr>");
                html.Append("<tr><th colspan='12' width='100%'></th></tr>");
                html.Append("<tr><th colspan='12' width='100%'></th></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container/Cargo Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");

                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 120px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 30px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 30px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 30px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 30px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 30px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 30px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 120px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border:1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 150px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.00") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 120px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border:1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 150px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 120px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border:1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total(Rounded) :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 150px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 120px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%; margin-bottom:10px;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : <span style='font-size:7pt;'>" + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</span></th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody><tr><td style='font-size: 6pt; width:50%;' colspan='6'>Payer Name: <label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left; width:50%; text-align: right;' colspan='6'>Payer Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");

                html.Append("<tr><th style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'> <br/> Signature CHA / Importer</th>");
                html.Append("<th style='font-size: 6pt; text-align: center;' colspan='4' width='33.33333333333333%'> <br/> Assistant <br/>(Signature)</th>");
                html.Append("<th style='font-size: 6pt; text-align: right;' colspan='4' width='33.33333333333333%'> <br/> For Central Warehousing Corporation<br/><br/><br/>(Authorized Signatories)</th></tr>");

                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                if (item.SupplyType == "B2B")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
               // html.Replace("ISO_A", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                lstSB.Add(html.ToString());
            });
            //var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            //var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            //if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            //{
            //    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            //}

            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }

            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforBondDSR(DataSet ds, string InvoiceModuleName, string All)
        {
            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='font-size: 12px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 12px;'>Email - " + objCompany[0].EmailAddress + "</label>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'>Bond SAC Payment sheet</label>");
                html.Append("</td>");
                html.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='3' style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td colspan='3'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='12'><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + "</h2> </td></tr>");
                html.Append("<tr><td colspan='12'><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Payer Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td></tr><tr><td colspan='12'><hr /></td></tr>");
                html.Append("<tr><th colspan='6' width='50%'><b style='text-align: left; font-size: 12px;margin-top: 10px;'>SAC No :" + item.StuffingReqNo + "</b></th>");

                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<td colspan='6' width='50%' style='font-size:12px;'><b>SAC validity :</b> From <u>" + elem.SacApprovedDate + "</u> to <u>" + elem.SacValidityDate + "</u></td></tr>");
                });

                //html.Append("<tr><th colspan='12'><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container/Cargo Details :</b> </th></tr>");
                //html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='10'>");
                //html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>SR No.</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>CFS Code</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Container No.</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Size</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Arrival</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Carting</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Destuffing</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Delivery</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>No of Days</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>No of Week</th>");
                //html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Cargo Type</th>");
                //html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/

                // lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                //{
                //    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + i + "</td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + elem.ArrivalDate + "</td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + item.DeliveryDate + "</td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + ((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.ArrivalDate)).TotalDays + 1).ToString() + "</td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + Math.Ceiling(((((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(item.ArrivalDate)).TotalDays + 1)) / 7)).ToString() + "</td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + Convert.ToDateTime(elem.DeliveryDate)+ "</td>");
                //    html.Append("<td style='border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                //    html.Append("</tr>");
                //    i = i + 1;
                //});
                /***************/
                //html.Append("</tbody></table></td></tr>");

                html.Append("<tr><td colspan='12'>");

                //html.Append("<table style=' border: 1px solid #000; width:100%;' cellspacing='0' cellpadding='5'>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='5'>Shipping Line : " + item.ShippingLineName + " </td></tr>");
                //html.Append("<tr><td style='font-size: 12px;'>Shipping Line No.:  </td>");
                //html.Append("<td style='font-size: 12px;'>OBL No :  </td>");
                //html.Append("<td style='font-size: 12px;'>Item No. : " + lstContainer.Where(x => x.InvoiceId == item.InvoiceId).Count().ToString() + "</td>");
                //html.Append("<td style='font-size: 12px;'>BOE No : " + item.BOENo.ToString().TrimEnd(',') + " </td>");
                //html.Append("<td style='font-size: 12px;'>BOE Date : " + item.BOEDate.ToString().TrimEnd(',') + " </td>");
                //html.Append("</tr>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='3'>Importer : " + item.ExporterImporterName + " </td>");
                //html.Append("<td style='font-size: 12px;' colspan='2'>VALUE : " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='5'>CHA Name : " + item.CHAName + " </td></tr>");
                //html.Append("<tr><td style='font-size: 12px;'>No Of Pkg : " + item.TotalNoOfPackages.ToString() + " </td>");
                //html.Append("<td style='font-size: 12px;'>Total Gr.Wt (In Kg) : " + item.TotalGrossWt.ToString("0.000") + " </td>");
                //html.Append("<td style='font-size: 12px;'>Total Area (In Sqr Mtr) : " + item.TotalSpaceOccupied.ToString("0.000") + "</td>");
                //html.Append("<td></td>");
                //html.Append("<td></td>");
                //html.Append("</tr>");
                //html.Append("</table>");
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                    html.Append("<td colspan='6' width='50%'>");
                    html.Append("<table style='width:100%; font-size:9pt;' cellspacing='0' cellpadding='5'><tbody>");
                    html.Append("<tr><td colspan='6' width='30%'>BOL No.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOLNo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>BOL Date</td><td>:</td><td colspan='6' width='70%'>" + elem.BOLDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>BOE No.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOENo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>BOE Date.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOEDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>AWB No.</td><td>:</td><td colspan='6' width='70%'>" + elem.AWBNo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>AWB Date</td><td>:</td><td colspan='6' width='70%'>" + elem.AWBDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>IGM No.</td><td>:</td><td colspan='6' width='70%'>" + elem.IGMNo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>IGM Date</td><td>:</td><td colspan='6' width='70%'>" + elem.IGMDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>Godown No.</td><td>:</td><td colspan='6' width='70%'>" + elem.GodownName + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>Importer</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                    html.Append("</tbody></table>");
                    html.Append("</td>");

                    html.Append("<td colspan='6' width='50%'>");
                    html.Append("<table style='border-left: 1px solid #000; width:100%; font-size:9pt;' cellspacing='0' cellpadding='5'><tbody>");
                    html.Append("<tr><td colspan='6' width='40%'>CHA Name</td><td>:</td><td colspan='6' width='60%'>" + item.CHAName + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>CIF Value</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>DUTY</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Total</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>No Of Pkg</td><td>:</td><td colspan='6' width='60%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalSpaceOccupied.ToString("0.000") + "</td></tr>");
                    html.Append("</tbody></table>");
                    html.Append("</td>");

                    html.Append("</tr></tbody></table>");
                    html.Append("</td></tr>");

                    html.Append("<tr><th colspan='12'><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container/Cargo Charges :</h3> </th></tr>");
                    html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                    html.Append("<thead><tr>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SR No.</th>");
                    //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                    //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                    html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                    html.Append("<tbody>");
                    i = 1;
                    /*Charges Bind*/
                });
                i = 1;
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 150px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total :</th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + totamt.ToString("0") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");

                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-bottom:0; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 170px;'><span>&nbsp;&nbsp;</span>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th></tr>");


                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; padding: 5px;' colspan='13'><span>&nbsp;&nbsp;&nbsp;</span>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 11px; text-align: left; padding: 5px;' colspan='7'><span>&nbsp;&nbsp;&nbsp;</span>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 12px; text-align: left; width: 50%; vertical-align: bottom;'>");
                html.Append("</td>");
                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0;'>");
                html.Append("<span><br/></span>");
                html.Append("<p style='display: block; font-size: 11px; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> " + objCompany[0].BankName + "</p>");
                html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> " + objCompany[0].AccountNo + "</p>");
                html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span>" + objCompany[0].Branch + " & " + objCompany[0].IFSC + "</p>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='border: 1px solid #333; border-bottom: 0; border-right: 0; padding: 0 15px;'>");
                html.Append("<p style='text-align: right; font-size: 11px; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 11px; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody><tr><td style='font-size: 12px; text-align: left; line-height: 30px;'colspan='2'>Receipt No.: ");
                html.Append("<label style='font-weight: bold;'></label></td><td style='font-size: 12px; text-align: left; line-height: 30px;' colspan='2'>Party Code:");
                html.Append("<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 11px; text-align: left;'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 11px; text-align: left;'><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 11px; text-align: left;'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 11px; text-align: left;'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                lstSB.Add(html.ToString());
            });
            //FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            //location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            //if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            //{
            //    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            //}
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforBND(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var BQRFileName = "";
            var BQRlocation = "";

            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstStorageDate = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();
            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            lstInvoice.ToList().ForEach(item =>
            {
                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    // objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }

                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>BOND DELIVERY PAYMENTSHEET</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='12'><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + " </h2> </td></tr>");

                html.Append("<tr><td colspan='12'>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th colspan='6' width='50%'><b style='text-align: left; font-size: 6pt; margin-top: 0;'>Bond No :" + item.StuffingReqNo + "</b></th>");
                html.Append("<td colspan='6' width='50%' style='font-size:6pt; text-align: right'><label width='15%'><b>SAC validity :</b></label> From <u>" + lstContainer[0].SacApprovedDate + "</u> to <u>" + lstContainer[0].SacValidityDate + "</u></td></tr>");
                html.Append("<tr><th colspan='2' width='20%' style='text-align: left; font-size: 6pt;margin-top: 15px;' valign='top'>Storage Period :</th>");
                html.Append("<td colspan='10' width='80%'><table style='width:100%; font-size:6pt;' cellspacing='0' cellpadding='0'><tbody>");

                var SacId = 0;
                var DeliId = 0;
                if (lstStorageDate.Where(x => x.InvoiceId == item.InvoiceId).Count() > 0)
                {
                    SacId = lstStorageDate.Where(x => x.InvoiceId == item.InvoiceId).ToList().Select(y => y.SacId).ToArray()[0];
                    DeliId = lstStorageDate.Where(x => x.InvoiceId == item.InvoiceId).ToList().Select(y => y.SacDelivryId).ToArray()[0];
                }

                lstStorageDate.Where(x => x.SacId == SacId && x.InvoiceId <= item.InvoiceId && x.SacDelivryId <= DeliId).ToList().ForEach(storage =>
                {
                    int j = 1;
                    html.Append("<tr><td colspan='12' cellpadding='5' valign='top'>From <u>" + storage.StorageFromDt + "</u> to <u>" + storage.StorageToDt + "</u></td></tr>");
                    j = j + 1;
                });
                html.Append("</tbody></table></td></tr>");


                html.Append("<tr><td colspan='12'>");
                int i = 1;
                Decimal totamt = 0;
                html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Bond No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].BondNo.ToString().TrimEnd(',') + " </td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Bond Date</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].BondDate.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOL No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].BOLNo.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOL Date</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].BOLDate.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOE No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].BOENo.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOE Date.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].BOEDate.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>AWB No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].AWBNo.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>AWB Date</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].AWBDate.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>IGM No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].IGMNo.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>IGM Date</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].IGMDate.ToString().TrimEnd(',') + "</td></tr>");
                //  html.Append("<tr><td colspan='6' width='30%'>Godown No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].GodownName.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Space Type</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].SpaceType.ToString() + "</td></tr>");

                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='border-left: 1px solid #000; width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='40%'>Ex-BOE No.</td><td>:</td><td colspan='6' width='60%'>" + lstContainer[0].ExBOENo.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>Ex-BOE Date.</td><td>:</td><td colspan='6' width='60%'>" + lstContainer[0].ExBOEDate.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>Importer</td><td>:</td><td colspan='6' width='60%'>" + lstInvoice[0].ExporterImporterName.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>CHA Name</td><td>:</td><td colspan='6' width='60%'>" + lstInvoice[0].CHAName.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>CIF Value</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIF)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>DUTY</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.Duty)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>Total</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIF) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>No Of Pkg</td><td>:</td><td colspan='6' width='60%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalSpaceOccupied.ToString("0.000") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>Cargo Type</td><td>:</td><td colspan='6' width='60%'>" + lstContainer[0].NatureOfMaterial.ToString() + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th colspan='12'><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container/Cargo Charges :</h3> </th></tr>");
                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.00") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody><tr><td style='font-size: 6pt; text-align: left; line-height: 30px;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='2'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;'><br/><br/><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;'><br/><br/><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;'><br/><br/><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                lstSB.Add(html.ToString());

            });
            //FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            //location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            //if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            //{
            //    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            //}

            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforBondWhiteField(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var BQRFileName = "";
            var BQRlocation = "";

            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            lstInvoice.ToList().ForEach(item =>
            {
                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);

                    //objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);

                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }


                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>BOND SAC PAYMENT SHEET</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='12'><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + "</h2> </td></tr>");

                html.Append("<tr><td colspan='12'>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th colspan='6' width='50%'><b style='text-align: left; font-size: 6pt; margin-top: 0;'>SAC No :" + item.StuffingReqNo + "</b></th>");

                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<td colspan='6' width='50%' style='font-size:6pt;'><b>SAC validity :</b> From <u>" + elem.SacApprovedDate + "</u> to <u>" + elem.SacValidityDate + "</u></td></tr>");
                });

                html.Append("<tr><td colspan='12'>");


                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                    html.Append("<td colspan='6' width='50%'>");
                    html.Append("<table style='width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                    html.Append("<tr><td colspan='6' width='30%'>BOL No.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOLNo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>BOL Date</td><td>:</td><td colspan='6' width='70%'>" + elem.BOLDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>BOE No.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOENo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>BOE Date.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOEDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>AWB No.</td><td>:</td><td colspan='6' width='70%'>" + elem.AWBNo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>AWB Date</td><td>:</td><td colspan='6' width='70%'>" + elem.AWBDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>IGM No.</td><td>:</td><td colspan='6' width='70%'>" + elem.IGMNo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>IGM Date</td><td>:</td><td colspan='6' width='70%'>" + elem.IGMDate.ToString().TrimEnd(',') + "</td></tr>");
                    //html.Append("<tr><td colspan='6' width='30%'>Godown No.</td><td>:</td><td colspan='6' width='70%'>" + elem.GodownName + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>Importer</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                    html.Append("</tbody></table>");
                    html.Append("</td>");

                    html.Append("<td colspan='6' width='50%'>");
                    html.Append("<table style='border-left: 1px solid #000; width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                    html.Append("<tr><td colspan='6' width='40%'>CHA Name</td><td>:</td><td colspan='6' width='60%'>" + item.CHAName + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>CIF Value</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>DUTY</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Total</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>No Of Pkg</td><td>:</td><td colspan='6' width='60%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalSpaceOccupied.ToString("0.000") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Space Type</td><td>:</td><td colspan='6' width='60%'>" + elem.SpaceType.ToString() + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Cargo Type</td><td>:</td><td colspan='6' width='60%'>" + elem.NatureOfMaterial.ToString() + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Area Type</td><td>:</td><td colspan='6' width='60%'>" + elem.AreaType.ToString() + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Storage Type</td><td>:</td><td colspan='6' width='60%'>" + elem.StorageType.ToString() + "</td></tr>");
                    html.Append("</tbody></table>");
                    html.Append("</td>");

                    html.Append("</tr></tbody></table>");
                    html.Append("</td></tr>");

                    html.Append("<tr><th colspan='12'><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container/Cargo Charges :</h3> </th></tr>");
                    html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                    html.Append("<thead><tr>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                    //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                    //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                    html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                    html.Append("<tbody>");
                    i = 1;
                    /*Charges Bind*/
                });
                i = 1;
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000; border-top: 0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.00") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");

                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 170px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");


                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; border-top: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody> <tr><td style='font-size: 6pt; text-align: left;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='2'>Party Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;'><br/><br/><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;'><br/><br/><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;'><br/><br/><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;'><br/><br/><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                lstSB.Add(html.ToString());
            });
            //FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            //location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            //if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            //{
            //    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            //}

            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforBondAdvanceWhiteField(DataSet ds, string InvoiceModuleName, string All)
        {
            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='font-size: 7pt;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt;'>Email - " + objCompany[0].EmailAddress + "</label>");
                html.Append("<br /><label style='font-size: 7pt; font-weight:bold;'>Bond Advance Payment sheet</label>");
                html.Append("</td>");
                html.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td>");
                html.Append("</tr>");

                html.Append("<tr><td colspan='3' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='3'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='12'><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + "</h2> </td></tr>");
                html.Append("<tr><td colspan='12'><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 7pt;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 7pt;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 7pt;'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 7pt; border-bottom:1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 7pt; border-bottom:1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Payer Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td></tr>");
                html.Append("<tr><th colspan='6' width='50%'><b style='text-align:left; font-size: 7pt;'>SAC No :" + item.StuffingReqNo + "</b></th>");

                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<td colspan='6' width='50%' style='font-size:7pt;'><b>SAC validity :</b> From <u>" + elem.SacApprovedDate + "</u> to <u>" + elem.SacValidityDate + "</u></td></tr>");
                });

                //html.Append("<tr><th colspan='12'><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container/Cargo Details :</b> </th></tr>");
                //html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='10'>");
                //html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>SR No.</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>CFS Code</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Container No.</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Size</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Arrival</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Carting</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Destuffing</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Delivery</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>No of Days</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>No of Week</th>");
                //html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Cargo Type</th>");
                //html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/

                // lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                //{
                //    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + i + "</td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + elem.ArrivalDate + "</td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + item.DeliveryDate + "</td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + ((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.ArrivalDate)).TotalDays + 1).ToString() + "</td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + Math.Ceiling(((((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(item.ArrivalDate)).TotalDays + 1)) / 7)).ToString() + "</td>");
                //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + Convert.ToDateTime(elem.DeliveryDate)+ "</td>");
                //    html.Append("<td style='border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                //    html.Append("</tr>");
                //    i = i + 1;
                //});
                /***************/
                //html.Append("</tbody></table></td></tr>");

                html.Append("<tr><td colspan='12'>");

                //html.Append("<table style=' border: 1px solid #000; width:100%;' cellspacing='0' cellpadding='5'>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='5'>Shipping Line : " + item.ShippingLineName + " </td></tr>");
                //html.Append("<tr><td style='font-size: 12px;'>Shipping Line No.:  </td>");
                //html.Append("<td style='font-size: 12px;'>OBL No :  </td>");
                //html.Append("<td style='font-size: 12px;'>Item No. : " + lstContainer.Where(x => x.InvoiceId == item.InvoiceId).Count().ToString() + "</td>");
                //html.Append("<td style='font-size: 12px;'>BOE No : " + item.BOENo.ToString().TrimEnd(',') + " </td>");
                //html.Append("<td style='font-size: 12px;'>BOE Date : " + item.BOEDate.ToString().TrimEnd(',') + " </td>");
                //html.Append("</tr>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='3'>Importer : " + item.ExporterImporterName + " </td>");
                //html.Append("<td style='font-size: 12px;' colspan='2'>VALUE : " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='5'>CHA Name : " + item.CHAName + " </td></tr>");
                //html.Append("<tr><td style='font-size: 12px;'>No Of Pkg : " + item.TotalNoOfPackages.ToString() + " </td>");
                //html.Append("<td style='font-size: 12px;'>Total Gr.Wt (In Kg) : " + item.TotalGrossWt.ToString("0.000") + " </td>");
                //html.Append("<td style='font-size: 12px;'>Total Area (In Sqr Mtr) : " + item.TotalSpaceOccupied.ToString("0.000") + "</td>");
                //html.Append("<td></td>");
                //html.Append("<td></td>");
                //html.Append("</tr>");
                //html.Append("</table>");
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                    html.Append("<td colspan='6' width='50%'>");
                    html.Append("<table style='border-right: 1px solid #000; width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                    html.Append("<tr><td colspan='6' width='30%'>BOL No.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOLNo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>BOL Date</td><td>:</td><td colspan='6' width='70%'>" + elem.BOLDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>BOE No.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOENo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>BOE Date.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOEDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>AWB No.</td><td>:</td><td colspan='6' width='70%'>" + elem.AWBNo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>AWB Date</td><td>:</td><td colspan='6' width='70%'>" + elem.AWBDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>IGM No.</td><td>:</td><td colspan='6' width='70%'>" + elem.IGMNo.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>IGM Date</td><td>:</td><td colspan='6' width='70%'>" + elem.IGMDate.ToString().TrimEnd(',') + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>Godown No.</td><td>:</td><td colspan='6' width='70%'>" + elem.GodownName + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='30%'>Importer</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                    html.Append("</tbody></table>");
                    html.Append("</td>");

                    html.Append("<td colspan='6' width='50%'>");
                    html.Append("<table style='width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                    html.Append("<tr><td colspan='6' width='40%'>CHA Name</td><td>:</td><td colspan='6' width='60%'>" + item.CHAName + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>CIF Value</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>DUTY</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Total</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>No Of Pkg</td><td>:</td><td colspan='6' width='60%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                    html.Append("<tr><td colspan='6' width='40%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalSpaceOccupied.ToString("0.000") + "</td></tr>");
                    html.Append("</tbody></table>");
                    html.Append("</td>");

                    html.Append("</tr></tbody></table>");
                    html.Append("</td></tr>");

                    html.Append("<tr><th colspan='12'><h3 style='text-align:left; font-size:7pt;'>Container/Cargo Charges :</h3> </th></tr>");
                    html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                    html.Append("<thead><tr>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                    //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                    //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                    html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>Taxable Amt.</th>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                    html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total</th></tr><tr>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                    html.Append("<tbody>");
                    i = 1;
                    /*Charges Bind*/
                });
                i = 1;
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: center; width: 130px;'>" + totamt.ToString("0") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 7pt; text-align: center; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");

                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 7pt; text-align: center; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 170px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 7pt; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");


                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; border-top: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                //html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                //html.Append("<tbody>");
                //html.Append("<tr>");
                //html.Append("<td style='font-size: 12px; text-align: left; width: 50%; vertical-align: bottom;'>");
                //html.Append("</td>");
                //html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0;'>");
                //html.Append("<span><br/></span>");
                //html.Append("<p style='display: block; font-size: 11px; margin:0;'>Company's Bank Details</p>");
                //html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> " + objCompany[0].BankName + "</p>");
                //html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> " + objCompany[0].AccountNo + "</p>");
                //html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span>" + objCompany[0].Branch + " & " + objCompany[0].IFSC + "</p>");
                //html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                //html.Append("<tbody>");
                //html.Append("<tr>");
                //html.Append("<td style='border: 1px solid #333; border-bottom: 0; border-right: 0; padding: 0 15px;'>");
                //html.Append("<p style='text-align: right; font-size: 11px; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                //html.Append("<span><br/><br/></span>");
                //html.Append("<p style='text-align: right; font-size: 11px; margin:0;'>Authorised Signatory</p>");
                //html.Append("</td>");
                //html.Append("</tr>");
                //html.Append("</tbody>");
                //html.Append("</table>");
                //html.Append("</td>");
                //html.Append("</tr>");
                //html.Append("</tbody>");
                //html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody> <tr><td><span><br/></span></td></tr> <tr><td style='font-size: 6pt; text-align: left; line-height: 30px;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='2'>Party Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");

                html.Append("<tr><td style='font-size: 6pt; text-align: left;'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;'><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                lstSB.Add(html.ToString());
            });
            //FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            //location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            //if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            //{
            //    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            //}

            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforBonUnloadingInvoice(DataSet ds, string InvoiceModuleName, string All)
        {
            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstHeader = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[7]);
            List<string> lstSB = new List<string>();
            String RemarksValue = "";
            string Container = "";
            lstHeader.ForEach(item =>
            {
                if (item.ContainerType == "Empty" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Empty Container Gate In";
                else if (item.ContainerType == "Loaded" && item.TransportMode == 2 && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Road";
                else if (item.ContainerType == "Loaded" && item.TransportMode == 1 && item.TransportFrom == "L" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD Loni)";
                else if (item.ContainerType == "Loaded" && item.TransportMode == 1 && item.TransportFrom == "T" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD TKD)";
                else if (item.ContainerType == "LoadedVehicle" && item.TransportMode == 1 && item.TransportFrom == "T" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD TKD)";
                else if (item.ContainerType == "LoadedVehicle" && item.TransportMode == 1 && item.TransportFrom == "L" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD Loni)";
                else if (item.CBT == " 1" && InvoiceModuleName == "GATE ENTRY")
                    Container = "CBT";

            });
            lstInvoice.ToList().ForEach(item =>
            {
                WFLD_ReportRepository rep = new WFLD_ReportRepository();
                WFLDSDBalancePrint objSDBalance = new WFLDSDBalancePrint();
                RemarksValue = item.Remarks;

                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (WFLDSDBalancePrint)rep.DBResponse.Data;
                }
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td colspan='8' width='90%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 7pt;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 7pt; font-weight:bold;'>" + InvoiceModuleName + "</label><br/><label style='font-size: 7pt; font-weight:bold;'>" + Container + "</label>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='12' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom:1px solid #000; padding-bottom: 5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom:1px solid #000; padding-bottom: 5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                if (InvoiceModuleName == "IRR")
                {
                    lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                    {
                        html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:90%; font-size:6pt' cellspacing='0' cellpadding='5'>");
                        html.Append("<thead><tr>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding: 5px;'>Train No</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding: 5px;'>Wagon No</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding: 5px;'>VIA</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding: 5px;'>Gross Wt</th>");
                        html.Append("<th style='border-bottom: 1px solid #000; text-align: center;'>Tare Wt</th>");
                        html.Append("</tr></thead>");
                        html.Append("<tbody><tr>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.TrainNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.WagonNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.VIA + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.GrossWt + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; text-align: center;'>" + elem.TareWt + "</td>");
                        html.Append("</tr></tbody>");
                        html.Append("</table></td></tr>");
                    });
                }


                html.Append("<tr><th style='text-align: left; font-size: 7pt;margin-top: 10px;'><b>Container / CBT Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Valid Upto Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Unloading Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Cargo Type</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Space Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/

                int i = 1;
                if (InvoiceModuleName != "Bond Delivery Invoice")
                {
                    lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                    {
                        if (InvoiceModuleName == "GATE ENTRY")
                        {
                            elem.ToDate = elem.ArrivalDate;
                        }
                        if (InvoiceModuleName == "FCL To LCL CONVERSION")
                        {
                            elem.ToDate = item.DeliveryDate;
                        }


                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.CFSCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ContainerNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.Size + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ArrivalDate + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ValidUpto + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.UnloadedDate + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.SpaceType + "</td>");
                        html.Append("</tr>");
                        i = i + 1;
                    });
                }
                /***************/
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt;margin: 0;'>Container / CBT Charges :</h3></th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 7pt; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");


                html.Append("<tr><th  colspan='12' style='border-top: 1px solid #000; font-size: 6pt; text-align: left; width: 200px;'>Round Up :</th>");
                html.Append("<th style='border-top: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;' colspan='1'>" + item.RoundUp.ToString("0.00") + "</th>");
                html.Append("</tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; border-top: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");
                // html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='4' width='20%'>SD Balance:<label style='font-weight: bold;'>" + objSDBalance.SDBalance.ToString() + "</label></td></tr>");

                //html.Append("<tr><td style='font-size: 12px; text-align: left; line-height: 30px;'colspan='2'></td>");
                //html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;' colspan='2'>SD Balance:<label style='font-weight: bold;'>" + objSDBalance.SDBalance.ToString() + "</label></td></tr>");



                if (InvoiceModuleName == "MISCELLANEOUS" || InvoiceModuleName == "CONTAINER DEBIT INVOICE")
                {
                    html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='12'>Remarks:");
                    html.Append("<label style='font-weight: bold;'>" + RemarksValue + " </label></td></tr>");
                }


                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='6' width='50%'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='6' width='50%'>SAM(A/C)</td></tr>");

                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr></tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforBTTContainerInvoice(DataSet ds, string InvoiceModuleName, string All)
        {
            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstbreakup = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[6]);
            List<string> lstSB = new List<string>();
            String RemarksValue = "";
            lstInvoice.ToList().ForEach(item =>
            {
                WFLD_ReportRepository rep = new WFLD_ReportRepository();
                WFLDSDBalancePrint objSDBalance = new WFLDSDBalancePrint();
                RemarksValue = item.Remarks;
                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (WFLDSDBalancePrint)rep.DBResponse.Data;
                }
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='font-size: 7pt;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt;'>Email - " + objCompany[0].EmailAddress + "</label>");
                html.Append("<br /><label style='font-size: 7pt; font-weight:bold;'>" + InvoiceModuleName + "</label>");
                html.Append("</td>");
                html.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td>");
                html.Append("</tr>");

                //html.Append("<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                //html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                //html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>CFS Whitefield</span>");
                //html.Append("<br />" + InvoiceModuleName);
                //html.Append("</td></tr>");

                html.Append("<tr><td colspan='12' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center; margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                //html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                //html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                //html.Append("<span>" + item.PartyName + "</span></td>");
                //html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                //html.Append("Party Address :</label> <span>" + item.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                //html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                //html.Append("Party GST :</label> <span>" + item.PartyGSTNo + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                //html.Append("<label style='font-weight: bold;'>Invoice Generated By :</label> <span>" + item.PaymentMode + "</span></td></tr>");
                //html.Append("</tbody>");
                //html.Append("</table></td></tr>");
                //html.Append("<tr><td><hr/></td></tr>");

                if (InvoiceModuleName == "IRR")
                {
                    lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                    {
                        html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='5'>");
                        html.Append("<thead><tr>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Train No</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Wagon No</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>VIA</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Gross Wt</th>");
                        html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Tare Wt</th>");
                        html.Append("</tr></thead>");
                        html.Append("<tbody><tr>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.TrainNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.WagonNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.VIA + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.GrossWt + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.TareWt + "</td>");
                        html.Append("</tr></tbody>");
                        html.Append("</table></td></tr>");
                    });
                }

                html.Append("<tr><th style='text-align: left; font-size: 7pt;margin-top: 10px;'><b>Container / CBT Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Arrival Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Delivery Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Days</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.SealCuttingDt + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.Days + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/

                //lstbreakup.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                //    {

                //    });
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt;margin: 0;'>Container / CBT Charges :</h3></th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border: 1px solid #000; border-top: 0; width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 7pt; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; border-top: 1px solid #000; font-size: 7pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 7pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");
                // html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='4' width='20%'>SD Balance:<label style='font-weight: bold;'>" + objSDBalance.SDBalance.ToString() + "</label></td></tr>");

                //html.Append("<tr><td style='font-size: 12px; text-align: left; line-height: 30px;'colspan='2'></td>");
                //html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;' colspan='2'>SD Balance:<label style='font-weight: bold;'>" + objSDBalance.SDBalance.ToString() + "</label></td></tr>");



                if (InvoiceModuleName == "MISCELLANEOUS" || InvoiceModuleName == "CONTAINER DEBIT INVOICE")
                {
                    html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='12'>Remarks:");
                    html.Append("<label style='font-weight: bold;'>" + RemarksValue + " </label></td></tr>");
                }


                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='6' width='50%'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='6' width='50%'>SAM(A/C)</td></tr>");

                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");

                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr></tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforContainerStuffingInvoice(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var BQRFileName = "";
            var BQRlocation = "";

            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstbreakup = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[6]);
            List<string> lstSB = new List<string>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            String RemarksValue = "";
            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                RemarksValue = item.Remarks;
                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                }

                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);

                    // objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);

                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }


                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                if (InvoiceModuleName == "IRR")
                {
                    lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                    {
                        html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='5'>");
                        html.Append("<thead><tr>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Train No</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Wagon No</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>VIA</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Gross Wt</th>");
                        html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Tare Wt</th>");
                        html.Append("</tr></thead>");
                        html.Append("<tbody><tr>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.TrainNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.WagonNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.VIA + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.GrossWt + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.TareWt + "</td>");
                        html.Append("</tr></tbody>");
                        html.Append("</table></td></tr>");
                    });
                }

                html.Append("<tr><th style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'><b>Container / CBT Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>To Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ToDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/

                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:100%; font-size: 6pt;' cellspacing='0' cellpadding='5'> ");
                html.Append("<thead><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding:5px;'>Shipping Bill No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding:5px;'>Charge Code</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align: right; '>Amount</th>");
                html.Append("</tr></thead>");
                html.Append("<tbody>");

                lstbreakup.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; '>" + elem.shippingbillno + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; '>" + elem.chargetype + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: right; '>" + elem.amount + "</td>");
                    html.Append("</tr>");
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Charges :</h3></th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");

                if (InvoiceModuleName == "MISCELLANEOUS" || InvoiceModuleName == "CONTAINER DEBIT INVOICE")
                {
                    html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='12'>Remarks:");
                    html.Append("<label style='font-weight: bold;'>" + RemarksValue + " </label></td></tr>");
                }


                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>SAM(A/C)</td></tr>");

                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");

                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforGE(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var BQRFileName = "";
            var BQRlocation = "";

            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstHeader = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[7]);
            List<string> lstSB = new List<string>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            String RemarksValue = "";
            string Container = "";
            lstHeader.ForEach(item =>
            {
                if (item.ContainerType == "Empty" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Empty Container Gate In";
                else if (item.ContainerType == "Loaded" && item.TransportMode == 2 && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Road";
                else if (item.ContainerType == "Loaded" && item.TransportMode == 1 && item.TransportFrom == "L" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD Loni)";
                else if (item.ContainerType == "Loaded" && item.TransportMode == 1 && item.TransportFrom == "T" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD TKD)";
                else if (item.ContainerType == "LoadedVehicle" && item.TransportMode == 1 && item.TransportFrom == "T" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD TKD)";
                else if (item.ContainerType == "LoadedVehicle" && item.TransportMode == 1 && item.TransportFrom == "L" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD Loni)";
                else if (item.CBT == " 1" && InvoiceModuleName == "GATE ENTRY")
                    Container = "CBT";

            });
            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                RemarksValue = item.Remarks;

                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                }

                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    // objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }

                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; text-align: center; margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                if (InvoiceModuleName.ToLower() == ("IRR").ToLower())
                {
                    lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                    {
                        html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt; text-align: center;' cellspacing='0' cellpadding='5'>");
                        html.Append("<thead><tr>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Train No</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Wagon No</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>VIA</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Gross Wt</th>");
                        html.Append("<th style='border-bottom: 1px solid #000;'>Tare Wt</th>");
                        html.Append("</tr></thead>");
                        html.Append("<tbody><tr>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.TrainNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.WagonNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.VIA + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.GrossWt + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000;'>" + elem.TareWt + "</td>");
                        html.Append("</tr></tbody>");
                        html.Append("</table></td></tr>");
                    });
                }
                int i = 1;

                if (InvoiceModuleName.ToLower() != ("MISCELLANEOUS INVOICE").ToLower() && InvoiceModuleName.ToLower() != ("MISCELLANEOUS").ToLower() && InvoiceModuleName.ToLower() != ("Rent").ToLower())
                {
                    html.Append("<tr><th style='text-align:left; font-size:7pt; margin-top: 0; margin-bottom: 0;'><b>Container / CBT Details :</b> </th></tr>");

                    html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt; text-align: center;' cellspacing='0' cellpadding='5'>");
                    html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>SR No.</th>");
                    if (InvoiceModuleName.ToLower() == ("JOB ORDER").ToLower())
                    {
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container No.</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Gross WT.(in Kg)</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Port Name</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Cargo Type</th>");
                        html.Append("<th style='border-bottom: 1px solid #000;'>ODC Type</th>");
                    }
                    else if (InvoiceModuleName.ToLower() == ("CONTAINER DEBIT INVOICE").ToLower())
                    {
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>ICD Code</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container / CBT No.</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Cargo Type</th>");
                        html.Append("<th style='border-bottom: 1px solid #000;'>ODC Type</th>");
                    }

                    else
                    {
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>ICD Code</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container / CBT No.</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>From Date</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>To Date</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Days</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Cargo Type</th>");
                        html.Append("<th style='border-bottom: 1px solid #000;'>ODC Type</th>");
                    }
                    html.Append("</tr></thead><tbody>");


                    /*************/
                    /*Container Bind*/

                    //int i = 1;

                    if (InvoiceModuleName.ToLower() != ("Bond Delivery Invoice").ToLower())
                    {
                        lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                        {
                            if (InvoiceModuleName.ToLower() == ("GATE ENTRY").ToLower())
                            {
                                elem.ToDate = elem.ArrivalDate;
                            }
                            if (InvoiceModuleName.ToLower() == ("FCL To LCL CONVERSION").ToLower())
                            {
                                elem.ToDate = item.DeliveryDate;
                            }
                            if (InvoiceModuleName.ToLower() == ("JOB ORDER").ToLower())
                            {
                                html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i.ToString() + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Size + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Gross_Wt + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.PortName + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                                html.Append("<td style='border-bottom: 1px solid #000;'>" + elem.ODCType + "</td>");
                                html.Append("</tr>");
                            }
                            else
                            {
                                html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i.ToString() + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.CFSCode + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Size + "</td>");

                                if (InvoiceModuleName.ToLower() == ("CONTAINER DEBIT INVOICE").ToLower())
                                {
                                    DateTime startDate = Convert.ToDateTime(elem.FromDate);
                                    DateTime endDate = Convert.ToDateTime(elem.ToDate);
                                    TimeSpan duration = endDate > startDate ? endDate - startDate : startDate - endDate;
                                    double daysBetweenDates = (duration.TotalDays) + 1;
                                }
                                else if (InvoiceModuleName.ToLower() == ("EXPORT PAYMENT SHEET").ToLower())
                                {
                                    DateTime sdate = Convert.ToDateTime(elem.ArrivalDate);
                                    DateTime edate = Convert.ToDateTime(elem.StuffingDate);
                                    TimeSpan ts = edate - sdate;
                                    int days = ts.Days;

                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ArrivalDate + "</td>");
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.StuffingDate + "</td>");
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + days + "</td>");
                                }
                                else
                                {
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ArrivalDate + "</td>");
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ToDate + "</td>");
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + "" + "</td>");
                                }
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                                html.Append("<td style='border-bottom: 1px solid #000; text-align: center;'>" + elem.ODCType + "</td>");
                                html.Append("</tr>");
                            }

                            i = i + 1;
                        });
                    }
                    /***************/
                    html.Append("</tbody></table></td></tr>");
                }
                if (InvoiceModuleName.ToLower() != ("Rent").ToLower())
                {
                    html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Charges :</h3></th></tr><tr><td>");
                }
                else
                {
                    html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Rent Charges :</h3></th></tr><tr><td>");
                }

                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (InvoiceModuleName.ToLower() == ("JOB ORDER").ToLower())
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.Clause + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + ((Convert.ToDecimal(data.Taxable) + Convert.ToDecimal(item.TotalCGST) + Convert.ToDecimal(item.TotalSGST) + Convert.ToDecimal(item.TotalIGST))).ToString("0.##") + "</td></tr>");
                    }
                    else
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    }

                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border:1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");


                if (InvoiceModuleName.ToLower() == ("MISCELLANEOUS").ToLower() || InvoiceModuleName.ToLower() == ("CONTAINER DEBIT INVOICE").ToLower() || InvoiceModuleName.ToLower() == ("MISCELLANEOUS INVOICE").ToLower())
                {
                    html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='12'>Remarks:");
                    html.Append("<label style='font-weight: bold;'>" + RemarksValue + " </label></td></tr>");
                }


                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='6' width='50%'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='6' width='50%'>SAM(A/C)</td></tr>");

                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforFumigationInvoice(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var BQRFileName = "";
            var BQRlocation = "";


            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstCargo = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[5]);
            List<string> lstSB = new List<string>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                }

                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    // objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }

                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'></th><th></th><td colspan='6' width='50%'></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'><b>Cargo Details :</b> </th></tr>");
                html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px; width: 2%;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px; width: 15%;'>Chemical Name</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 10%;'>Area</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                lstCargo.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 2%;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 15%;'>" + elem.Chemical + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 10%;'>" + elem.Area + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><th style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'><b>Container / CBT Details :</b> </th></tr>");
                html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>To Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + item.StuffingReqDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ToDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Charges :</h3></th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");

                if (InvoiceModuleName == "MISCELLANEOUS" || InvoiceModuleName.ToUpper() == "FUMIGATION")
                {
                    html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='12'>Remarks: ");
                    html.Append("<label style='font-weight: bold;'>" + item.Remarks + " </label></td></tr>");
                }


                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>SAM(A/C)</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforCargoSF(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var BQRFileName = "";
            var BQRlocation = "";

            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);


            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ExportRepository rep = new DSR_ExportRepository();
                DSRBTTCargoDet objCargoDet = new DSRBTTCargoDet();
                List<DSRBTTCargoDet> SbNoList = new List<DSRBTTCargoDet>();
                rep.GetCargoDetShiftById(item.InvoiceNo);
                if (rep.DBResponse.Data != null)
                {
                    /// objCargoDet = (DSRBTTCargoDet)rep.DBResponse.Data;
                    SbNoList = (List<DSRBTTCargoDet>)rep.DBResponse.Data;
                }

                var exporter = SbNoList.Select(x => x.exporter).Distinct();
                String ExportName = exporter.FirstOrDefault();
                // String Exporter = exporter[0].toString();

                DSR_ReportRepository repp = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                repp.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (repp.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)repp.DBResponse.Data;
                }
                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    // objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }


                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%; font-size:7pt; border:1px solid #333; margin-top: 0; margin-bottom: 0;' cellspacing='0' cellpadding='5'><tbody><tr>");
                html.Append("<td colspan='4' width='33.33333333333333%'><b>Exporter :</b> " + ExportName + " </td>");
                html.Append("<td colspan='4' width='33.33333333333333%'><b>CHA :</b> </td>");
                html.Append("<td colspan='4' width='33.33333333333333%'><b>Shipping Line :</b></td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%; font-size:6pt;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; padding: 5px;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; padding: 5px;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; padding: 5px;'>To Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align:center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'></td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'></td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'></td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'></td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'></td>");
                    html.Append("<td style='border-bottom: 1px solid #000; text-align:center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });

                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Cargo Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:8pt;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; padding: 5px; width:5%;'>Entry No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; padding: 5px; width:10%;'>SB No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; padding: 5px; width:10%;'>SB Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; padding: 5px; width:10%;'>Commodity</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; padding: 5px; width:10%;'>No of pkg</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; padding: 5px; width:10%;'>GR WT</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align:center; width:10%;'>FOB</th>");
                html.Append("</tr></thead><tbody>");
                i = 1;

                SbNoList.ForEach(elemCargo =>
                 {
                     html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:5%;'>" + i.ToString() + "</td>");
                     html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'> " + elemCargo.ShippingBillNo.ToString() + " </td>");
                     html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>" + elemCargo.ShippingBillDate.ToString() + "</td>");
                     html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>" + elemCargo.CommodityName.ToString() + "</td>");
                     html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>" + elemCargo.NoOfUnits.ToString() + "</td>");
                     html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>" + elemCargo.GrossWeight.ToString() + "</td>");
                     html.Append("<td style='border-bottom: 1px solid #000; text-align:center; width:10%;'> " + elemCargo.Fob.ToString() + "</td>");
                     html.Append("</tr>");
                     i = i + 1;
                 });
                html.Append("</tbody></table></td></tr>");


                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");

                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>SAM(A/C)</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforSealCutting(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var BQRFileName = "";
            var BQRlocation = "";

            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ImportRepository rep = new DSR_ImportRepository();
                DSRSealCuttingDateForReport objseal = new DSRSealCuttingDateForReport();
                rep.GetSealCuttingDateId(item.StuffingReqNo);
                if (rep.DBResponse.Data != null)
                {
                    objseal = (DSRSealCuttingDateForReport)rep.DBResponse.Data;
                }
                DSR_ReportRepository repp = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                repp.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (repp.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)repp.DBResponse.Data;
                }
                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    //  objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }

                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'></th><th></th><td colspan='6' width='50%'></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'><b>Container / CBT Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>To Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + objseal.GateInDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + objseal.TranscationDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Charges :</h3></th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>SAM(A/C)</td></tr>");

                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        [NonAction]
        public string GeneratingBulkPDFforYard(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";

            var BQRFileName = "";
            var BQRlocation = "";


            var FileName = "";
            var location = "";
            string dtype = "Date of Arrival";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstReasses = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[9]);
            List<dynamic> lstReassesment = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[10]);
            List<dynamic> lstOBLDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[11]);
            List<string> lstSB = new List<string>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);


            string Container = "";
            string cfscode = "";
            lstReasses.ForEach(item =>
            {
                if (item.cfscode != "")
                    Container = "(Re-Assessment)";

            });

            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                }
                lstContainer.ForEach(dat =>
                {
                    if (dat.InoviceId == item.InvoiceId)

                        cfscode = dat.CFSCode;
                    else

                        cfscode = "";
                });
                Container = "";

                lstReassesment.ForEach(data =>
                {
                    if (data.cfscode == cfscode)
                    {
                        Container = "(Re-Assessment)";
                        dtype = "Previous Delivery Date";
                    }
                });

                // Add for BQR Code Chiranjit das
                IrnResponse objERes = new IrnResponse();
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);

                    // objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);

                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }

                //------ End Chiranjit Das ------------

                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Assessment No :" + item.StuffingReqNo + "</b></th></tr>");
                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Details :</b></th></tr>");

                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:3%;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>RMS</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>ODC Type</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + dtype + " </th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>Weight</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>Date of Delivery</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>No of Days</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>Free Period Days</th>");
                html.Append("<th style='border-bottom: 1px solid #000;border-right: 1px solid #000; text-align: center; width:6%;'>Cargo Type</th>");
                html.Append("<th style='border-bottom: 1px solid #000;border-right: 1px solid #000; text-align: center; width:8%;'>Movement Type</th>");
                html.Append("<th style='border-bottom: 1px solid #000;border-right: 1px solid #000; text-align: center; width:10%;'>Cont.Received From</th>");

                html.Append("<th style='border-bottom: 1px solid #000; text-align: center; width:8%;'>Empty Back To</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                //string OblNo = "";
                //string RMS = "";
                int i = 1;
                int flagvalue = 0;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    //get no of days and weeks for IMPYard Payment Sheet
                    DSRDaysWeeks objDaysWeeks = new DSRDaysWeeks();

                    if (Container == "(Re-Assessment)")
                    {
                        elem.ArrivalDate = item.StuffingReqDate;
                        flagvalue = 1;
                    }

                    rep.GetDaysWeeksForIMPYard(item.InvoiceId, elem.CFSCode, flagvalue);
                    if (rep.DBResponse.Data != null)
                    {
                        objDaysWeeks = (DSRDaysWeeks)rep.DBResponse.Data;

                    }

                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:3%;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:6%;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:6%;'>" + elem.RMS + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:6%;'>" + elem.ODCType + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.GrossWt.ToString("0.000") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>" + objDaysWeeks.Days + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>" + objDaysWeeks.FreeDays + "</td>");

                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000;  text-align: center; width:8%;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.MovementType + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.ContainerReceivedFrom + "</td>");

                    html.Append("<td style='border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.EmptyPort + "</td>");
                    html.Append("</tr>");

                    // OblNo = OblNo + elem.OBL_No + ".";
                    // RMS = elem.RMS;

                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>OBL Details :</b></th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt;' cellspacing='0' cellpadding='8'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:3%;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>OBL/HBL No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:6%;'>Item No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:15%;'>Value</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:6%;'>BOE No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>BOE Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>No Of Pkg</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align: center; width:8%;'>Total Gr.Wt (In Kg)</th>");
                html.Append("</tr></thead><tbody>");

                int j = 1;
                lstOBLDetails.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:3%;'>" + j.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + elem.OBLNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + lstContainer.Where(x => x.InoviceId == item.InvoiceId).Count().ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.CIFValue.ToString("0.00") + " + DUTY : " + elem.Duty.ToString("0.00") + " = " + (elem.CIFValue + elem.Duty).ToString("0.00") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:6%;'>" + elem.BOENo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.BOEDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>" + elem.TotalNoOfPackages.ToString() + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.TotalGrossWt.ToString("0.000") + "</td>");
                    html.Append("</tr>");
                    j = j + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'><b>Shipping Line</b></td><td>:</td><td colspan='6' width='70%'>" + item.ShippingLineName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'><b>Shipping Line No.</b></td><td>:</td><td colspan='6' width='70%'>" + item.ShippingLineCode + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'><b>Distance</b></td><td>:</td><td colspan='6' width='70%'>" + item.Distance + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'><b>IGM NO.</b></td><td>:</td><td colspan='6' width='70%'>" + item.IGM_No + "</td></tr>");

                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'><b>Importer</b></td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'><b>CHA Name</b></td><td>:</td><td colspan='6' width='70%'>" + item.CHAName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'><b>Cargo Description</b></td><td>:</td><td colspan='6' width='70%'>" + item.CargoDesc + "</td></tr>");

                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 70px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 70px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 150px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                    totamt = totamt + data.Taxable;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 70px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 7pt; text-align: right; width: 100px;'>" + ((Convert.ToDecimal(totamt) + Convert.ToDecimal(item.TotalCGST) + Convert.ToDecimal(item.TotalSGST) + Convert.ToDecimal(item.TotalIGST))).ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 7pt; text-align: right; width: 100px;'>" + (Convert.ToDecimal(item.InvoiceAmt) - (Convert.ToDecimal(totamt) + Convert.ToDecimal(item.TotalCGST) + Convert.ToDecimal(item.TotalSGST) + Convert.ToDecimal(item.TotalIGST))).ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style=' width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; border-bottom:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 200px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 7pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style=' width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='75%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='3' width='25%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='75%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");

                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'><br/>For Central Warehousing Corporation<br/><br/><br/>(Authorized Signatories)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });

            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }

            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforGodown(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";

            var BQRFileName = "";
            var BQRlocation = "";

            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstCargoDetail = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<dynamic> lstReassesment = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[8]);
            List<dynamic> lstReassesbulk = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[10]);
            List<string> lstSB = new List<string>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            int cargotype = 0;
            string Container = "";
            string dt = "";
            //string dttype = "Date of Seal Cutting";

            lstCargoDetail.ToList().ForEach(item =>
            {
                cargotype = (int)item.CargoType;
            });

            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                }

                lstReassesment.ForEach(itemm =>
                {
                    if ((itemm.cfscode != "") && itemm.invoiceid == item.InvoiceId)
                    {
                        Container = "(Re-Assessment)";

                        DSR_ReportRepository repp = new DSR_ReportRepository();
                        dt = repp.GetPreviousInvDate(itemm.cfscode);
                        //dttype = "Previous Delivery Date";
                    }
                });

                lstReassesbulk.ForEach(data =>
                {
                    if (data.invoiceid == item.InvoiceId)
                    {
                        Container = "(Re-Assessment)";
                        DSR_ReportRepository repp = new DSR_ReportRepository();
                        dt = repp.GetPreviousInvDate(data.cfscode);
                        //dttype = "Previous Delivery Date";

                    }
                });

                if (item.Bond == 1)
                {
                    InvoiceModuleName = "Cargo Shifting In PBW";
                }
                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    //  objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label> <br/> <label style='font-size: 14px; font-weight:bold;'>" + Container + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style=' border:1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'><b>Assessment No :" + item.StuffingReqNo + "</b></th></tr>");
                html.Append("<tr><th style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'><b>Container / CBT Details :</b></th></tr>");

                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:50px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:100px;'>ICD Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:100px;'>Container / CBT No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:80px;'>Size</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:80px;'>Date of Arrival</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:80px;'>Date of Destuffing</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:80px;'>Date of Delivery</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:200px;'>No of Days</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:200px;'>No of Weeks</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:80px;'>ODC Type</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; text-align: center; width:80px;'>Cargo Type</th>");
                html.Append("</tr>");

                html.Append("<tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>Arrival to Destuff</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>Destuff to Delivery</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>Arrival to Destuff</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>Destuff to Delivery</th>");
                html.Append("</tr>");

                html.Append("</thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    if (dt != "")
                    {
                        elem.SealCuttingDt = dt;
                    }
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + item.DestuffingDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + ((Convert.ToDateTime(item.DestuffingDate) - Convert.ToDateTime(elem.ArrivalDate)).TotalDays + 1).ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + ((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(item.DestuffingDate)).TotalDays + 1).ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + Math.Ceiling(((((Convert.ToDateTime(item.DestuffingDate) - Convert.ToDateTime(elem.ArrivalDate)).TotalDays + 1)) / 7)).ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + Math.Ceiling(((((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(item.DestuffingDate)).TotalDays + 1)) / 7)).ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.ODCType + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; text-align: center;'>" + (cargotype == 0 ? "" : (cargotype == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><td>");
                html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line</td><td>:</td><td colspan='6' width='70%'>" + item.ShippingLineName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>OBL/HBL No.</td><td>:</td><td colspan='6' width='70%'>" + lstCargoDetail.Where(x => x.InvoiceId == item.InvoiceId).Select(x => x.OBLNo).FirstOrDefault() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Godown Name</td><td>:</td><td colspan='6' width='70%'>" + lstCargoDetail.Where(x => x.InvoiceId == item.InvoiceId).Select(x => x.GodownName).FirstOrDefault() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Item No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer.Where(x => x.InoviceId == item.InvoiceId).Count().ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOE No.</td><td>:</td><td colspan='6' width='70%'>" + lstCargoDetail.Where(x => x.InvoiceId == item.InvoiceId).Select(x => x.BOENo).FirstOrDefault() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOE Date</td><td>:</td><td colspan='6' width='70%'>" + lstCargoDetail.Where(x => x.InvoiceId == item.InvoiceId).Select(x => x.BOEDate).FirstOrDefault() + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Importer</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Value</td><td>:</td><td colspan='6' width='70%'>" + (lstContainer.Where(m => m.InoviceId == item.InvoiceId).Max(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InoviceId == item.InvoiceId).Max(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InoviceId == item.InvoiceId).Max(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InoviceId == item.InvoiceId).Max(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>CHA Name</td><td>:</td><td colspan='6' width='70%'>" + item.CHAName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>No Of Pkg</td><td>:</td><td colspan='6' width='70%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Gr.Wt (KG)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalGrossWt.ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Area (SQM)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalSpaceOccupied.ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>CBM</td><td>:</td><td colspan='6' width='70%'>" + item.SpaceOccupiedCBM.ToString("0.00") + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size:7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border:1px solid #000; border-top:0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + ((Convert.ToDecimal(totamt) + Convert.ToDecimal(item.TotalCGST) + Convert.ToDecimal(item.TotalSGST) + Convert.ToDecimal(item.TotalIGST))).ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 200px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size:6pt; text-align: right; width: 100px;'>" + (Convert.ToDecimal(item.InvoiceAmt) - (Convert.ToDecimal(totamt) + Convert.ToDecimal(item.TotalCGST) + Convert.ToDecimal(item.TotalSGST) + Convert.ToDecimal(item.TotalIGST))).ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 200px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : <span style='font-size:7pt;'>" + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</span></th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='75%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='3' width='25%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='75%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'><br/>For Central Warehousing Corporation<br/><br/><br/>(Authorized Signatories)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
                Container = "";
                dt = "";
                //dttype = "Date of Seal Cutting";
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforContainer(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var BQRFileName = "";
            var BQRlocation = "";

            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            List<dynamic> lstSBDetails = new List<dynamic>();


            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            if (ds.Tables.Count > 11)
            {
                lstSBDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[11]);
            }

            string pickfrom = "";
            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);

                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                    pickfrom = objSDBalance.EmptyFrom;
                }

                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    //  objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }


                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }
                StringBuilder html = new StringBuilder();
                /*Header Part*/

                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='12'><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center; margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td colspan='12'>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th colspan='4' style='text-align: left; font-size: 6pt; margin-top: 0; margin-bottom: 0; width:33.33333333333333%'><b>Assessment No :</b>" + item.StuffingReqNo + "</th>");
                html.Append("<th colspan='4' style='text-align: left; font-size: 6pt; margin-top: 0; margin-bottom: 0; width:33.33333333333333%'><b>Port Of Loading :</b>  " + objSDBalance.PortName + "</th>");
                html.Append("<th colspan='4' style='text-align: left; font-size: 6pt; margin-top: 0; margin-bottom: 0; width:33.33333333333333%'><b>Movement Type :</b>  " + objSDBalance.MovementType + "</th></tr>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt;' cellspacing='0' cellpadding='8'>");
                html.Append("<thead><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>Empty From</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>Move To</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>Load From</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>Load To</th>");
                html.Append("</tr></thead><tbody>");

                html.Append("<tr>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + objSDBalance.EmptyFrom + "</td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + objSDBalance.EmptyTo + "</td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + objSDBalance.LoadFrom + "</td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + objSDBalance.LoadTo + "</td>");
                html.Append("</tr>");
                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><th colspan='12' style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'><b>Container / CBT Details :</b></th></tr>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt; text-align: center;' cellspacing='0' cellpadding='8'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:30px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:80px;'>Entry No</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:80px;'>Container / CBT No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:35px;'>Size</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:80px;'>Empty Container IN Date</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:80px;'>F/S Out Date</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:80px;'>Stuffing Date</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:80px;'>Loaded Gate in Date</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:80px;'>Shipping Line</th>");
                html.Append("</tr>");
                html.Append("</thead>");

                html.Append("<tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;


                Decimal totamt = 0;
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {

                    if (pickfrom.Equals("ICD Dashrath"))
                    {

                    }
                    else
                    {
                        elem.DestuffingEntryDate = "";
                    }
                    if (objSDBalance.EmptyFrom.Equals("ICD Dashrath") && objSDBalance.EmptyTo.Equals("RCT Concor") && objSDBalance.LoadFrom.Equals("RCT Concor") && objSDBalance.LoadTo.Equals("RCT Concor"))
                    {
                        elem.FSArrivaldate = "";
                    }

                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.DestuffingEntryDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.GateExitDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.StuffingDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.FSArrivaldate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ShippingLineName + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt;' cellspacing='0' cellpadding='8'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>SB No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>SB Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>Exporter</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>CHA</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>Pkg</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>GR Weight</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>Fob Value</th>");
                html.Append("</tr></thead><tbody>");

                /*SB Details Bind*/
                var Totalpkg = 0M;
                var TotalGWT = 0M;
                var TotalFOB = 0M;
                var TotalStorage = 0M;


                int k = 1;
                lstSBDetails.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>" + k.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + elem.ShippingBillNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.ShipbillDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + elem.Exporter + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + elem.CHAName + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.NoOfPkg + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.GrossWt + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>" + elem.FobValue + "</td>");
                    html.Append("</tr>");
                    Totalpkg += elem.NoOfPkg;
                    TotalGWT += elem.GrossWt;
                    TotalFOB += elem.FobValue;
                    //   TotalStorage += elem.Total;
                    k = k + 1;
                });

                html.Append("<tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>TOTAL</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'></th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'></th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'></th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'></th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + Totalpkg + "</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + TotalGWT + "</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + TotalFOB + "</th>");
                html.Append("</tr>");
                /***************/
                html.Append("</tbody></table></td></tr>");


                html.Append("<tr><th colspan='12'><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Charges :</h3> </th></tr>");
                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Total;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + totamt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");

                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");

                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left;' colspan='3' width='25%'><br/><br/>Signature CHA / Importer</th>");
                html.Append("<th style='font-size: 6pt; text-align: left;' colspan='3' width='25%'><br/><br/>Assistant <br/>(Signature)</th>");
                html.Append("<th style='font-size: 6pt; text-align: left;' colspan='3' width='25%'><br/><br/>SAM/AM Accounts<br/>(Signature)</th>");
                html.Append("<th style='font-size: 6pt; text-align: left;' colspan='3' width='25%'><br/><br/>SAM/SIO <br/>(Signature)</th>");
                html.Append("</tr>");

                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td></tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }


        [NonAction]
        public string GeneratingBulkPDFforContainerMov(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";

            var BQRFileName = "";
            var BQRlocation = "";

            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstHeader = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[7]);
            List<string> lstSB = new List<string>();
            List<dynamic> lstSBDetails = new List<dynamic>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            if (ds.Tables.Count > 11)
            {
                lstSBDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[11]);
            }

            String RemarksValue = "";
            string Container = "";
            lstHeader.ForEach(item =>
            {
                if (item.ContainerType == "Empty" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Empty Container Gate In";
                else if (item.ContainerType == "Loaded" && item.TransportMode == 2 && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Road";
                else if (item.ContainerType == "Loaded" && item.TransportMode == 1 && item.TransportFrom == "L" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD Loni)";
                else if (item.ContainerType == "Loaded" && item.TransportMode == 1 && item.TransportFrom == "T" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD TKD)";
                else if (item.ContainerType == "LoadedVehicle" && item.TransportMode == 1 && item.TransportFrom == "T" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD TKD)";
                else if (item.ContainerType == "LoadedVehicle" && item.TransportMode == 1 && item.TransportFrom == "L" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD Loni)";
                else if (item.CBT == " 1" && InvoiceModuleName == "GATE ENTRY")
                    Container = "CBT";

            });
            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                RemarksValue = item.Remarks;

                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                }

                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);

                    //objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);

                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }

                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; text-align: center; margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                if (InvoiceModuleName.ToLower() == ("IRR").ToLower())
                {
                    lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                    {
                        html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt; text-align: center;' cellspacing='0' cellpadding='5'>");
                        html.Append("<thead><tr>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Train No</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Wagon No</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>VIA</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Gross Wt</th>");
                        html.Append("<th style='border-bottom: 1px solid #000;'>Tare Wt</th>");
                        html.Append("</tr></thead>");
                        html.Append("<tbody><tr>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.TrainNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.WagonNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.VIA + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.GrossWt + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000;'>" + elem.TareWt + "</td>");
                        html.Append("</tr></tbody>");
                        html.Append("</table></td></tr>");
                    });
                }
                int i = 1;

                if (InvoiceModuleName.ToLower() != ("MISCELLANEOUS INVOICE").ToLower() && InvoiceModuleName.ToLower() != ("MISCELLANEOUS").ToLower() && InvoiceModuleName.ToLower() != ("Rent").ToLower())
                {
                    html.Append("<tr><th style='text-align:left; font-size:7pt; margin-top: 0; margin-bottom: 0;'><b>Container / CBT Details :</b> </th></tr>");

                    html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt; text-align: center;' cellspacing='0' cellpadding='5'>");
                    html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>SR No.</th>");
                    if (InvoiceModuleName.ToLower() == ("JOB ORDER").ToLower())
                    {
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container No.</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Gross WT.(in Kg)</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Port Name</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Cargo Type</th>");
                        html.Append("<th style='border-bottom: 1px solid #000;'>ODC Type</th>");
                    }
                    else if (InvoiceModuleName.ToLower() == ("CONTAINER DEBIT INVOICE").ToLower())
                    {

                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>ICD Code</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container / CBT No.</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                        //   html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>From Date</th>");
                        //    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>To Date</th>");
                        //    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Days</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Cargo Type</th>");
                        html.Append("<th style='border-bottom: 1px solid #000;'>ODC Type</th>");

                    }
                    else if (InvoiceModuleName.ToLower() == ("EXPORT PAYMENT SHEET").ToLower())
                    {
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>ICD Code</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container / CBT No.</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>In Date</th>");
                        html.Append("<th style='border-bottom: 1px solid #000;'>Shipping Line</th>");
                    }
                    else
                    {
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>ICD Code</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container / CBT No.</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>From Date</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>To Date</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Days</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Cargo Type</th>");
                        html.Append("<th style='border-bottom: 1px solid #000;'>ODC Type</th>");

                    }
                    html.Append("</tr></thead><tbody>");


                    /*************/
                    /*Container Bind*/

                    //int i = 1;

                    if (InvoiceModuleName.ToLower() != ("Bond Delivery Invoice").ToLower())
                    {
                        lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                        {
                            if (InvoiceModuleName.ToLower() == ("GATE ENTRY").ToLower())
                            {
                                elem.ToDate = elem.ArrivalDate;
                            }
                            if (InvoiceModuleName.ToLower() == ("FCL To LCL CONVERSION").ToLower())
                            {
                                elem.ToDate = item.DeliveryDate;
                            }
                            if (InvoiceModuleName.ToLower() == ("JOB ORDER").ToLower())
                            {
                                html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i.ToString() + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Size + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Gross_Wt + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.PortName + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                                html.Append("<td style='border-bottom: 1px solid #000;'>" + elem.ODCType + "</td>");
                                html.Append("</tr>");
                            }
                            else
                            {
                                html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i.ToString() + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.CFSCode + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Size + "</td>");

                                if (InvoiceModuleName.ToLower() == ("CONTAINER DEBIT INVOICE").ToLower())
                                {
                                    DateTime startDate = Convert.ToDateTime(elem.FromDate);
                                    DateTime endDate = Convert.ToDateTime(elem.ToDate);
                                    TimeSpan duration = endDate > startDate ? endDate - startDate : startDate - endDate;
                                    double daysBetweenDates = (duration.TotalDays) + 1;
                                }
                                else if (InvoiceModuleName.ToLower() == ("EXPORT PAYMENT SHEET").ToLower())
                                {
                                    DateTime sdate = Convert.ToDateTime(elem.ArrivalDate);
                                    DateTime edate = Convert.ToDateTime(elem.StuffingDate);
                                    TimeSpan ts = edate - sdate;
                                    int days = ts.Days;

                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ArrivalDate + "</td>");
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ShippingLineName + "</td>");
                                }
                                else
                                {
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ArrivalDate + "</td>");
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ToDate + "</td>");
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + "" + "</td>");
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + elem.ODCType + "</td>");
                                }

                                html.Append("</tr>");
                            }

                            i = i + 1;
                        });
                    }
                    /***************/
                    html.Append("</tbody></table></td></tr>");
                }
                if (InvoiceModuleName.ToLower() == ("EXPORT PAYMENT SHEET").ToLower() || InvoiceModuleName.ToLower() == ("Container Movement").ToLower())
                {

                    html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt; text-align: center;' cellspacing='0' cellpadding='5'>");
                    html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:35px;'>SR No.</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:73px;'>SB No</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:65px;'>SB Date</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:65px;'>Carting Date</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:65px;'>Stuffing Date</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:120px;'>Exporter</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:80px;'>CHA</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:80px;'>Pkg</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:80px; text-align:right;'>GR Weight</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:100px; text-align:right;'>FOB</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:80px; text-align:right;'>Area</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:80px;'>Carting Type</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:60px;'>Cargo Nature</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:55px;'>Free Period</th>");
                    html.Append("<th style='border-bottom: 1px solid #000; width:75px;'>St.Charge From</th>");
                    html.Append("</tr></thead><tbody>");
                    /*************/
                    /*SB Details Bind*/
                    var Totalpkg = 0M;
                    var TotalGWT = 0M;
                    var TotalCBM = 0M;
                    var TotalStorage = 0M;
                    var TotalArea = 0M;
                    var TotalFOB = 0M;


                    int k = 1;
                    lstSBDetails.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + k.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.SB + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.SBDate + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.CartingDate + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.StuffingDate + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Exporter + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.CHAName + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.NoPkg + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:right;'>" + elem.GrossWeight + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:right;'>" + elem.FobValue + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:right;'>" + elem.Area + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.CartingType + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.CargoType + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.FreePeriod + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000;'>" + elem.StorageFrom + "</td>");
                        html.Append("</tr>");
                        Totalpkg += elem.NoPkg;
                        TotalGWT += elem.GrossWeight;
                        TotalCBM += elem.Reserved;
                        TotalStorage += elem.Total;
                        TotalArea += elem.Area;
                        TotalFOB += elem.FobValue;
                        k = k + 1;
                    });

                    html.Append("<tr><th colspan='7' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:100px; text-align: left;'>TOTAL</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + Totalpkg + "</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:right;'>" + TotalGWT + "</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:right;'>" + TotalFOB + "</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:right;'>" + TotalArea + "</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'></th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'></th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'></th>");
                    html.Append("<th style='border-bottom: 1px solid #000;'>" + "" + "</th>");
                    html.Append("</tr>");
                    /***************/
                    html.Append("</tbody></table></td></tr>");

                }

                if (InvoiceModuleName.ToLower() != ("Rent").ToLower())
                {
                    html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt;margin: 0;'>Container / CBT Charges :</h3></th></tr><tr><td>");
                }
                else
                {
                    html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt;margin: 0;'>Rent Charges :</h3></th></tr><tr><td>");
                }


                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (InvoiceModuleName.ToLower() == ("JOB ORDER").ToLower())
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.Clause + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + ((Convert.ToDecimal(data.Taxable) + Convert.ToDecimal(item.TotalCGST) + Convert.ToDecimal(item.TotalSGST) + Convert.ToDecimal(item.TotalIGST))).ToString("0.##") + "</td></tr>");
                    }
                    else
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    }

                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border:1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");

                if (InvoiceModuleName.ToLower() == ("MISCELLANEOUS").ToLower() || InvoiceModuleName.ToLower() == ("CONTAINER DEBIT INVOICE").ToLower() || InvoiceModuleName.ToLower() == ("MISCELLANEOUS INVOICE").ToLower())
                {
                    html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='12'>Remarks:");
                    html.Append("<label style='font-weight: bold;'>" + RemarksValue + " </label></td></tr>");
                }

                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='6' width='50%'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='6' width='50%'>SAM(A/C)</td></tr>");

                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/
                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        [NonAction]
        public string GeneratingBulkPDFforCCINEntry(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var FileName = "";
            var location = "";

            var BQRFileName = "";
            var BQRlocation = "";

            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ExportRepository rep = new DSR_ExportRepository();
                DSR_CCINEntry objCCINEntry = new DSR_CCINEntry();
                rep.GetCCINEntryById(Convert.ToInt32(item.StuffingReqId));
                if (rep.DBResponse.Data != null)
                {
                    objCCINEntry = (DSR_CCINEntry)rep.DBResponse.Data;
                }

                DSR_ReportRepository repp = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                repp.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (repp.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)repp.DBResponse.Data;
                }
                // 'SB Types 1. Baggage 2. Duty Free Goods 3. Cargo in Drawback',
                string SBTypeLabel = "";
                string cargodesc = "";


                cargodesc = objCCINEntry.CommodityName;
                if (objCCINEntry.SBType == 1)
                {
                    SBTypeLabel = "Baggage";
                }
                else if (objCCINEntry.SBType == 2)
                {
                    SBTypeLabel = "Duty Free Goods";
                }
                else if (objCCINEntry.SBType == 3)
                {
                    SBTypeLabel = "Cargo in Drawback";
                }
                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "/UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "/UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    //objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }

                StringBuilder html = new StringBuilder();
                int i = 1;
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>CCIN NO</td><td>:</td><td colspan='6' width='70%'>" + item.StuffingReqNo + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>CCIN DT</td><td>:</td><td colspan='6' width='70%'>" + Convert.ToDateTime(item.StuffingReqDate).ToString("dd/MM/yyyy") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>SB NO</td><td>:</td><td colspan='6' width='70%'>" + objCCINEntry.SBNo + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>SB DATE</td><td>:</td><td colspan='6' width='70%'>" + objCCINEntry.SBDate + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>SB Type</td><td>:</td><td colspan='6' width='70%'>" + SBTypeLabel + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line</td><td>:</td><td colspan='6' width='70%'>" + item.ShippingLineName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>FOB</td><td>:</td><td colspan='6' width='70%'>" + objCCINEntry.FOB + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Cargo Description</td><td>:</td><td colspan='6' width='70%'>" + cargodesc + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Cargo Type</td><td>:</td><td colspan='6' width='70%'>" + (objCCINEntry.CargoType == 0 ? "" : (objCCINEntry.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Exporter</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>CHA Name</td><td>:</td><td colspan='6' width='70%'>" + item.CHAName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>No Of Pkg</td><td>:</td><td colspan='6' width='70%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>SB Processed At</td><td>:</td><td colspan='6' width='70%'>" + objCCINEntry.PortOfLoadingName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shed / Godown No.</td><td>:</td><td colspan='6' width='70%'>" + objCCINEntry.GodownName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Carting Type</td><td>:</td><td colspan='6' width='70%'>" + objCCINEntry.CartingType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Cargo Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'></td></tr>");

                html.Append("<tr><td colspan='12' style='font-size: 6pt; text-align: left;'><b>Remarks</b> : " + objCCINEntry.Remarks + "</td></tr>");
                html.Append("<tr><td colspan='3' width='25%' style='font-size: 11px; text-align: left;'><br/><br/>&nbsp;</td>");
                html.Append("<td colspan='3' width='25%' style='font-size: 11px; text-align: left;'><br/><br/>&nbsp;</td>");
                html.Append("<td colspan='3' width='25%' style='font-size: 11px; text-align: right;'><br/><br/>(Sign. of Exporter / CHA)</td>");
                html.Append("<td colspan='3' width='25%' style='font-size: 11px; text-align: right;'><br/><br/>(Sign. of Shed Incharge)</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");

                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");


                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforBTT(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var FileName = "";
            var location = "";
            var BQRFileName = "";
            var BQRlocation = "";

            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);
            lstInvoice.ToList().ForEach(item =>
            {
                //DSR_ReportRepository rep = new DSR_ReportRepository();
                //DSR_BTTCargoDetPrint objCargoDet = new DSR_BTTCargoDetPrint();
                //rep.GetCargoDetBTTPrintById(Convert.ToInt32(item.StuffingReqId));
                //if (rep.DBResponse.Data != null)
                //{
                //objCargoDet = (DSR_BTTCargoDetPrint)rep.DBResponse.Data;
                //}

                //DSR_ReportRepository repp = new DSR_ReportRepository();
                //DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                //repp.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                //if (repp.DBResponse.Data != null)
                //{
                //  objSDBalance = (DSRSDBalancePrint)repp.DBResponse.Data;
                //}
                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "/UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "/UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    // objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center; margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%; font-size:6pt; border:1px solid #333;' cellspacing='0' cellpadding='5'><tbody><tr>");
                html.Append("<td colspan='6' width='65%'><b>Exporter :</b> " + item.ExporterImporterName + " </td>");
                html.Append("<td colspan='6' width='50%' style='text-align:left;'><b>CHA :</b> " + item.CHAName + " </td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                int i = 1;

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Cargo Details :</b> </th></tr>");

                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt; text-align:center;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000;width:5%;'>Entry No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>SB No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>SB Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>Carting Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>Delivery Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>No of Days</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>No of Weeks</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>Commodity</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>Cargo Type</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>ODC Type</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>No of pkg</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%; text-align:right;'>GR WT (Kg)</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%; text-align:right;'>FOB</th>");
                html.Append("<th style='border-bottom: 1px solid #000; width:10%; text-align:right;'>Area</th>");
                html.Append("</tr></thead><tbody>");
                i = 1;

                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'> " + elem.ShippingBillNo.ToString() + " </td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ShippingBillDate.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.CartingDate.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.DeliveryDate.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.NoOfDays.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.NoOfWeeks.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.CommodityName.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.CargoType.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ODCType.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.NoOfUnits.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:right;'>" + elem.GrossWeight.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:right;'> " + elem.Fob.ToString() + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; text-align:right;'> " + elem.Area.ToString() + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                html.Append("</tbody></table></td></tr>");


                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Cargo Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border: 1px solid #000; border-top: 0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td>");
                html.Append("<td style='font-size: 6pt; text-align: right;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");

                html.Append("<tr><td><span><br/><br/></span></td></tr>");

                html.Append("<tr><th style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'> <br/> Signature CHA / Importer</th>");
                html.Append("<th style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'> <br/> Assistant <br/>(Signature)</th>");
                html.Append("<th style='font-size: 6pt; text-align: right;' colspan='4' width='33.33333333333333%'> <br/> For Central Warehousing Corporation<br/><br/><br/>(Authorized Signatories)</th></tr>");

                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforAuction(DataSet ds, string InvoiceModuleName, string All)
        {
            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                }
                StringBuilder html = new StringBuilder();
                int i = 1;
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td colspan='8' width='90%' style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Dashrath</span>");
                html.Append("<br />" + InvoiceModuleName);
                html.Append("</td></tr>");
                html.Append("<tr><td colspan='12' style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");
                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                html.Append("<span>" + item.PartyName + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                html.Append("Party Address :</label> <span>" + item.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                html.Append("Party GST :</label> <span>" + item.PartyGSTNo + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>Invoice Generated By :</label> <span>" + item.PaymentMode + "</span></td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Invoice Generated : By </label> <span>" + item.PaymentMode + "</span></td>");
                html.Append("</tbody> ");
                html.Append("</table></td></tr><tr><td><hr /></td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style=' border: 1px solid #000; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tr><td style='font-size: 12px;'>BID No : " + item.StuffingReqNo + " </td>");
                html.Append("<td style='font-size: 12px;'>BID Date : " + Convert.ToDateTime(item.StuffingReqDate).ToString("dd/MM/yyyy") + "</td></tr>");
                html.Append("</table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 150px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 11px; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 11px; text-align: left; line-height: 30px;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='2'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 11px; text-align: left; line-height: 30px;'colspan='2'></td></tr>");
                // html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='2'>SD Balance:<label style='font-weight: bold;'>" + objSDBalance.SDBalance.ToString() + "</label></td></tr>");

                html.Append("<tr><td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='6' width='50%'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='6' width='50%'>SAM(A/C)</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 9px; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");

                html.Append("</td></tr></tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforEmptyContainer(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var FileName = "";
            var location = "";
            var BQRFileName = "";
            var BQRlocation = "";


            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstCargoDetail = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();
            List<dynamic> lstReassesmentec = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[9]);
            List<dynamic> lstReassesmentecbulk = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[9]);
            string Container = "";
            string cfscode = "";

            int flagfordate = 0;

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                }
                cfscode = "";
                lstContainer.ForEach(dat =>
                {
                    if (dat.InoviceId == item.InvoiceId)

                        cfscode = dat.CFSCode;
                });
                Container = "";
                flagfordate = 0;

                string dt = "";
                string dttype = "Date of Destuffing";
                lstReassesmentec.ForEach(itemm =>
                {
                    if ((itemm.cfscode != "") && itemm.invoiceid == item.InvoiceId)
                    {
                        Container = "(Re-Assessment)";

                        DSR_ReportRepository repp = new DSR_ReportRepository();
                        dt = repp.GetPreviousInvDate(itemm.cfscode);
                        dttype = "Previous Delivery Date";
                    }
                });

                lstReassesmentecbulk.ForEach(data =>
                {
                    if (data.invoiceid == item.InvoiceId)
                    {
                        Container = "(Re-Assessment)";
                        DSR_ReportRepository repp = new DSR_ReportRepository();
                        dt = repp.GetPreviousInvDate(data.cfscode);
                        dttype = "Previous Delivery Date";
                        flagfordate = 1;

                    }
                });
                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "/UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "/UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    // objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }

                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label><label style='font-size: 7pt; font-weight:bold;' >" + Container + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th>");
                html.Append("<br /><b style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Date of Arrival</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Date of Carting</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + dttype + "</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Date of Delivery</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>No of Days Arrival to Destuff</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>No of Days Destuff to Delivery</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>No of Weeks Arrival to Destuff</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>No of Weeks Destuff to Delivery</th>");
                //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding: 5px;'>Date of Seal Cutting</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>Cargo Type</th>");
                html.Append("<th style='border-bottom: 1px solid #000;border-bottom: 1px solid #000; text-align: center;'>ODC Type</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align: center;'>Movement Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    if (dt != "")
                    {
                        elem.DestuffingEntryDate = dt;
                    }
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.ArrivalDate + "</td>");
                    // html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + item.CartingDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + Convert.ToDateTime(elem.DestuffingEntryDate).ToString("dd/MM/yyyy") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + item.DeliveryDate + "</td>");
                    //if (flagfordate == 0)
                    //{
                    //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + ((Convert.ToDateTime(elem.DestuffingEntryDate) - Convert.ToDateTime(elem.ArrivalDate)).TotalDays + 1).ToString() + "</td>");
                    //}
                    //if (flagfordate == 1)
                    //{
                    //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + ((Convert.ToDateTime(elem.DestuffingEntryDate) - Convert.ToDateTime(elem.ArrivalDate)).TotalDays).ToString() + "</td>");
                    //}
                    if (flagfordate == 0)
                    {
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + ((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.DestuffingEntryDate)).TotalDays + 1).ToString() + "</td>");
                    }
                    if (flagfordate == 1)
                    {
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + ((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.DestuffingEntryDate)).TotalDays).ToString() + "</td>");
                    }
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + Math.Ceiling(((((Convert.ToDateTime(elem.DestuffingEntryDate) - Convert.ToDateTime(elem.ArrivalDate)).TotalDays + 1)) / 7)).ToString() + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + Math.Ceiling(((((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.DestuffingEntryDate)).TotalDays + 1)) / 7)).ToString() + "</td>");
                    // html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.SealCuttingDt.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.ODCType + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; text-align: center;'>" + elem.MovementType + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container Charges :</h3> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border: 1px solid #000; border-top: 0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + ((Convert.ToDecimal(totamt) + Convert.ToDecimal(item.TotalCGST) + Convert.ToDecimal(item.TotalSGST) + Convert.ToDecimal(item.TotalIGST))).ToString("0.##") + "</th></tr><tr>");
                // html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + (Convert.ToDecimal(item.InvoiceAmt) - (Convert.ToDecimal(totamt) + Convert.ToDecimal(item.TotalCGST) + Convert.ToDecimal(item.TotalSGST) + Convert.ToDecimal(item.TotalIGST))).ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-top: 0; border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");

                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='3' width='25%'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='3' width='25%'><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='3' width='25%'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='3' width='25%'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");

                html.Append("</td></tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
                Container = "";
                dt = "";
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforRentInvoice(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var FileName = "";
            var location = "";

            var BQRFileName = "";
            var BQRlocation = "";

            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstHeader = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[7]);
            List<string> lstSB = new List<string>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            String RemarksValue = "";
            string Container = "";

            lstHeader.ForEach(item =>
            {
                if (item.ContainerType == "Empty" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Empty Container Gate In";
                else if (item.ContainerType == "Loaded" && item.TransportMode == 2 && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Road";
                else if (item.ContainerType == "Loaded" && item.TransportMode == 1 && item.TransportFrom == "L" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD Loni)";
                else if (item.ContainerType == "Loaded" && item.TransportMode == 1 && item.TransportFrom == "T" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD TKD)";
                else if (item.ContainerType == "LoadedVehicle" && item.TransportMode == 1 && item.TransportFrom == "T" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD TKD)";
                else if (item.ContainerType == "LoadedVehicle" && item.TransportMode == 1 && item.TransportFrom == "L" && InvoiceModuleName == "GATE ENTRY")
                    Container = "Loaded Container By Train(By ICD Loni)";
                else if (item.CBT == " 1" && InvoiceModuleName == "GATE ENTRY")
                    Container = "CBT";

            });
            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                RemarksValue = item.Remarks;

                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                }


                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "/UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "/UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    //objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }

                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label><br/><label style='font-size: 14px; font-weight:bold;'>" + Container + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");


                html.Append("<tr><td><hr/></td></tr>");

                if (InvoiceModuleName == "IRR")
                {
                    lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                    {
                        html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='5'>");
                        html.Append("<thead><tr>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Train No</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Wagon No</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>VIA</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Gross Wt</th>");
                        html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Tare Wt</th>");
                        html.Append("</tr></thead>");
                        html.Append("<tbody><tr>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.TrainNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.WagonNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.VIA + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.GrossWt + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.TareWt + "</td>");
                        html.Append("</tr></tbody>");
                        html.Append("</table></td></tr>");
                    });
                }
                int i = 1;
                if (InvoiceModuleName == "Rent")
                {
                    lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                    {
                        html.Append("<tr><th style='text-align: left; font-size: 6pt;'>Rent for : " + data.Mnth + ", " + data.Yr + "</th></tr>");
                    });
                }
                if (InvoiceModuleName != "MISCELLANEOUS INVOICE" && InvoiceModuleName != "MISCELLANEOUS" && InvoiceModuleName != "Rent")
                {
                    html.Append("<tr><th style='text-align: left; font-size: 6pt; margin-top: 0; margin-bottom: 0;'><b>Container / CBT Details :</b> </th></tr>");
                    html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='5'>");
                    html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>SR No.</th>");
                    if (InvoiceModuleName == "JOB ORDER")
                    {
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Container No.</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Size</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Gross WT.(in Kg)</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Port Name</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Cargo Type</th>");
                        html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>ODC Type</th>");
                    }
                    else
                    {
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>ICD Code</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Container / CBT No.</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Size</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>From Date</th>");
                        html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>To Date</th>");
                        html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Cargo Type</th>");
                    }
                    html.Append("</tr></thead><tbody>");

                    /*************/
                    /*Container Bind*/

                    //int i = 1;

                    if (InvoiceModuleName != "Bond Delivery Invoice")
                    {
                        lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                        {
                            if (InvoiceModuleName == "GATE ENTRY")
                            {
                                elem.ToDate = elem.ArrivalDate;
                            }
                            if (InvoiceModuleName == "FCL To LCL CONVERSION")
                            {
                                elem.ToDate = item.DeliveryDate;
                            }
                            if (InvoiceModuleName == "JOB ORDER")
                            {
                                html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + i.ToString() + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ContainerNo + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.Size + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.Gross_Wt + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.PortName + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                                html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ODCType + "</td>");
                                html.Append("</tr>");
                            }
                            else
                            {
                                html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + i.ToString() + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.CFSCode + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ContainerNo + "</td>");
                                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.Size + "</td>");

                                if (InvoiceModuleName == "CONTAINER DEBIT INVOICE")
                                {
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.FromDate + "</td>");
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ToDate + "</td>");
                                }
                                else
                                {
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ArrivalDate + "</td>");
                                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ToDate + "</td>");
                                }

                                html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                                html.Append("</tr>");
                            }

                            i = i + 1;
                        });
                    }
                    /***************/
                    html.Append("</tbody></table></td></tr>");
                }
                if (InvoiceModuleName != "Rent")
                {
                    html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Charges :</h3></th></tr><tr><td>");
                }
                else
                {
                    html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Rent Charges :</h3></th></tr><tr><td>");
                }


                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    //html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 150px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    decimal total = Convert.ToDecimal(data.Taxable.ToString()) + Convert.ToDecimal(data.CGSTAmt.ToString()) + Convert.ToDecimal(data.SGSTAmt.ToString()) + Convert.ToDecimal(data.IGSTAmt.ToString());
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>" + total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>RoundUp :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + item.RoundUp.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th></tr>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");

                if (InvoiceModuleName == "MISCELLANEOUS" || InvoiceModuleName == "CONTAINER DEBIT INVOICE")
                {
                    html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='12'>Remarks:");
                    html.Append("<label style='font-weight: bold;'>" + RemarksValue + " </label></td></tr>");
                }


                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>SAM(A/C)</td></tr>");

                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforRCTSealing(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var FileName = "";
            var location = "";
            var BQRFileName = "";
            var BQRlocation = "";

            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstShipbill = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[11]);
            List<string> lstSB = new List<string>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            lstInvoice.ToList().ForEach(item =>
            {
                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "/UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "/UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    // objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%; font-size:6pt; border:1px solid #333;' cellspacing='0' cellpadding='5'><tbody><tr>");
                html.Append("<td colspan='4' width='33.33333333333333%'><b>Exporter :</b> " + item.ExporterImporterName + " </td>");
                html.Append("<td colspan='4' width='33.33333333333333%' style='text-align:left;'><b>CHA :</b> " + item.CHAName + " </td>");
                html.Append("<td colspan='4' width='33.33333333333333%'><b>Shipping Line :</b>" + item.ShippingLineName + "</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 6pt; margin-top: 0; margin-bottom: 0;'>Container Details :</b> </th></tr>");

                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt; text-align:center;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                html.Append("<th style='border-bottom: 1px solid #000;'>Port Name</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000;'>" + elem.PortName + "</td>");

                    html.Append("</tr>");
                    i = i + 1;
                });

                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Shipbill Details :</b> </th></tr>");

                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt; text-align:center;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>SB No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>SB Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>No of pkg</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>GR WT</th>");
                html.Append("<th style='border-bottom: 1px solid #000; width:10%;'>FOB Value</th>");
                html.Append("</tr></thead><tbody>");

                i = 1;
                lstShipbill.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ShipbillNo.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ShipbillDate.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.NoOfPkg.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.GrossWt.ToString() + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000;'> " + elem.FobValue.ToString() + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });

                html.Append("</tbody></table></td></tr>");


                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                string Desc = "";
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.OperationDesc == "Administrative Charge")
                    {
                        Desc = "RCT Sealing Charge";
                    }
                    else
                    {
                        Desc = data.OperationDesc;
                    }
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + Desc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000; border-top: 0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td>");
                html.Append("<td style='font-size: 6pt; text-align: right;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");

                html.Append("<tr><th style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'> <br/> Signature CHA / Importer</th>");
                html.Append("<th style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'> <br/> Assistant <br/>(Signature)</th>");
                html.Append("<th style='font-size: 6pt; text-align: right;' colspan='4' width='33.33333333333333%'> <br/> For Central Warehousing Corporation<br/><br/><br/>(Authorized Signatories)</th></tr>");
                html.Append("</tbody></table>");

                html.Append("</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }


        [NonAction]
        public string GeneratingBulkPDFforImportRCTSealing(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var FileName = "";
            var location = "";
            var BQRFileName = "";
            var BQRlocation = "";

            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstShipbill = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[11]);
            List<string> lstSB = new List<string>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            lstInvoice.ToList().ForEach(item =>
            {

                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "/UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "/UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    // objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }

                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%; font-size:6pt; border:1px solid #333;' cellspacing='0' cellpadding='5'><tbody><tr>");
                html.Append("<td colspan='4' width='33.33333333333333%'><b>Importer :</b> " + item.ExporterImporterName + " </td>");
                html.Append("<td colspan='4' width='33.33333333333333%' style='text-align:left;'><b>CHA :</b> " + item.CHAName + " </td>");
                html.Append("<td colspan='4' width='33.33333333333333%'><b>Shipping Line :</b>" + item.ShippingLineName + "</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container Details :</b> </th></tr>");

                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt; text-align:center;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Vessel</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Voyage</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>ForeignLine</th>");
                html.Append("<th style='border-bottom: 1px solid #000;'>Port Name</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Vessel + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Voyage + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Foreignline + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000;'>" + elem.PortName + "</td>");

                    html.Append("</tr>");
                    i = i + 1;
                });

                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Shipbill Details :</b> </th></tr>");

                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt; text-align:center;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>OBL No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>OBL Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>No of pkg</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width:10%;'>GR WT</th>");
                html.Append("<th style='border-bottom: 1px solid #000; width:10%;'>FOB Value</th>");
                html.Append("</tr></thead><tbody>");

                i = 1;
                lstShipbill.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.OBLNo.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.OBLDate.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.NoOfPkg.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.GrossWt.ToString() + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000;'> " + elem.FobValue.ToString() + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });

                html.Append("</tbody></table></td></tr>");


                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                string Desc = "";
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.OperationDesc == "Administrative Charge")
                    {
                        Desc = "RCT Sealing Charge";
                    }
                    else
                    {
                        Desc = data.OperationDesc;
                    }
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + Desc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000; border-top: 0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td>");
                html.Append("<td style='font-size: 6pt; text-align: right;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");

                html.Append("<tr><th style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'> <br/> Signature CHA / Importer</th>");
                html.Append("<th style='font-size: 6pt; text-align: left;' colspan='4' width='33.33333333333333%'> <br/> Assistant <br/>(Signature)</th>");
                html.Append("<th style='font-size: 6pt; text-align: right;' colspan='4' width='33.33333333333333%'> <br/> For Central Warehousing Corporation<br/><br/><br/>(Authorized Signatories)</th></tr>");
                html.Append("</tbody></table>");

                html.Append("</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }


        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateBulkInvoiceReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "BulkInvoice.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/BulkInvoice/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f))
                {

                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/BulkInvoice/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }


        [HttpGet]
        [CustomValidateAntiForgeryToken]
        public ActionResult ListOfInvoiceDateWise(string FromDate, string ToDate, string invoiceType)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<invoiceLIst> LstinvoiceLIst = new List<invoiceLIst>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.GetInvoiceList(FromDate, ToDate, invoiceType);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                //LstinvoiceLIst = (List<invoiceLIst>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }

        }

        [HttpPost]
        //public ActionResult Download()
        //{
        //    String session = Session.SessionID;
        //    DSR_ReportCWCController obj = new DSR_ReportCWCController();
        //    //////int CurrentFileID = Convert.ToInt32(FileID); 
        //    string fileSavePath = "";
        //    fileSavePath = Server.MapPath("~/Docs/All/") + Session.SessionID;
        //    var filesCol = obj.GetFile(fileSavePath).ToList();
        //    using (var memoryStream = new MemoryStream())
        //    {
        //        using (var ziparchive = new ZipArchive(memoryStream, ZipArchiveMode.Create, true))
        //        {
        //            for (int i = 0; i < filesCol.Count; i++)
        //            {
        //                ziparchive.CreateEntryFromFile(filesCol[i].FilePath, filesCol[i].FileName);
        //            }
        //        }
        //        return File(memoryStream.ToArray(), "application/zip", "Attachments.zip");
        //    }
        //}

        public JsonResult Download()
        {
            String session = Session.SessionID;
            DSR_ReportCWCController obj = new DSR_ReportCWCController();
            //////int CurrentFileID = Convert.ToInt32(FileID); 
            string fileSavePath = "";
            fileSavePath = Server.MapPath("~/Docs/All/") + Session.SessionID;
            var filesCol = obj.GetFile(fileSavePath).ToList();
            string FileList = "";
            //string FileList = "/Docs/All/" + Session.SessionID + "/";
            for (int i = 0; i < filesCol.Count; i++)
            {
                FileList = FileList + "/Docs/All/" + Session.SessionID + "/" + (filesCol[i].FileName) + ",";
            }
            var ObjResult = new { Status = 1, Message = FileList };
            return Json(ObjResult);
        }

        [NonAction]
        public List<FileList> GetFile(string fileSavePath)
        {
            List<FileList> listFiles = new List<FileList>();
            DirectoryInfo dirInfo = new DirectoryInfo(fileSavePath);
            int i = 0;
            foreach (var item in dirInfo.GetFiles())
            {
                listFiles.Add(new FileList()
                {
                    FileId = i + 1,
                    FileName = item.Name,
                    FilePath = dirInfo.FullName + "/" + item.Name
                });
                i = i + 1;
            }
            return listFiles;
        }

        private void DeleteDirectory(string path)
        {
            if (Directory.Exists(path))
            {
                //Delete all files from the Directory
                foreach (string file in Directory.GetFiles(path))
                {
                    System.IO.File.Delete(file);
                }
                //Delete all child Directories
                //foreach (string directory in Directory.GetDirectories(path))
                //{
                //    DeleteDirectory(directory);
                //}
                ////Delete a Directory
                //Directory.Delete(path);
            }
        }
        [NonAction]
        public string GeneratingBulkPDFforExpGRE(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var FileName = "";
            var location = "";

            var BQRFileName = "";
            var BQRlocation = "";

            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstHeader = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[7]);
            List<string> lstSB = new List<string>();
            List<dynamic> lstSBDetails = new List<dynamic>();

            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);
            upiQRInfo.gstIn = Convert.ToString(objCompany[0].GstIn);
            upiQRInfo.merchant_id = Convert.ToInt32(objCompany[0].ccavenuemid);

            if (ds.Tables.Count > 11)
            {
                lstSBDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[11]);
            }

            String RemarksValue = "";
            string Container = "";

            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                RemarksValue = item.Remarks;

                //rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                //if (rep.DBResponse.Data != null)
                //{
                //    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                //}

                IrnResponse objERes = new IrnResponse();
                //if (item.SupplyType == "B2C")
                //{
                BQRFileName = item.InvoiceId + ".jpg";
                BQRlocation = Server.MapPath("~/Docs/") + "BQR/" + BQRFileName;
                log.Error("Path:" + BQRlocation);
                if (!System.IO.File.Exists(BQRlocation))
                {


                    upiQRInfo.order_id = Convert.ToInt32(item.InvoiceId);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.billing_name = Convert.ToString(item.PartyName);
                    upiQRInfo.billing_address = Convert.ToString(item.PartyAddress);
                    upiQRInfo.billing_zip = Convert.ToString(item.PinCode);
                    upiQRInfo.billing_tel = Convert.ToString(item.MobileNo);
                    upiQRInfo.billing_email = Convert.ToString(item.Email);

                    upiQRInfo.InvoiceDate = Convert.ToString(item.DocDt);
                    upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                    upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                    upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                    upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                    upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                    upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                    upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                    upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                    upiQRInfo.tr = Convert.ToString(item.InvoiceId);
                    string Site = System.Configuration.ConfigurationManager.AppSettings["WebsiteUrl"];

                    upiQRInfo.redirect_url = Site + "/UPIResponse/GetResponseBqr";
                    upiQRInfo.cancel_url = Site + "/UPIResponse/CancelResponseBqr";
                    upiQRInfo.merchant_param1 = Convert.ToInt32(System.Configuration.ConfigurationSettings.AppSettings["BranchId"].ToString());


                    Einvoice Eobj = new Einvoice();
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode_Wfld(upiQRInfo);
                    // objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);


                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + "BQR"))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + "BQR");
                    }

                    string strm = objresponse.QrCodeBase64;

                    //this is a simple white background image
                    var myfilename = string.Format(@"{0}", Guid.NewGuid());

                    //Generate unique filename
                    //  string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                    var bytess = Convert.FromBase64String(strm);
                    using (var imageFile = new FileStream(BQRlocation, FileMode.Create))
                    {
                        imageFile.Write(bytess, 0, bytess.Length);
                        imageFile.Flush();
                    }

                    DSR_ReportRepository wfldObj = new DSR_ReportRepository();
                    wfldObj.AddEditBQRCode(item.InvoiceId, BQRFileName, ((Login)(Session["LoginUser"])).Uid);


                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                }

                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName.ToUpper() + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + BQRlocation + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img width='150px' height='150px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; text-align: center; margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom:1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Shipping Line Name</th><th>:</th><td colspan='6' width='70%'>" + item.ShippingLineName.TrimEnd(',', ' ') + "</td></tr>");

                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom:1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");
                int i = 1;

                html.Append("<tr><th style='text-align:left; font-size:7pt; margin-top: 0; margin-bottom: 0;'><b>Container / CBT Details :</b> </th></tr>");

                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt; text-align: center;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Empty Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Stuffing Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000;'>Days</th>");
                html.Append("</tr></thead><tbody>");

                /*************/
                /*Container Bind*/

                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Size + "</td>");

                    DateTime sdate = Convert.ToDateTime(elem.DestuffingEntryDate);
                    DateTime edate = DateTime.ParseExact(elem.StuffingDate, "dd/MM/yyyy", System.Globalization.CultureInfo.InvariantCulture);
                    TimeSpan ts = edate - sdate;
                    int days = ts.Days;

                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + sdate.ToString("dd/MM/yyyy") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + edate.ToString("dd/MM/yyyy") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000;'>" + (days + 1) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });

                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Container / CBT Charges :</h3></th></tr><tr><td>");

                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {

                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border:1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");

                html.Append("<tr><td style='font-size: 6pt; text-align: left;' colspan='6' width='50%'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='6' width='50%'>SAM(A/C)</td></tr>");

                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(objERes.SignedInvoice)) + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        #region Invoice Print

        public string ConvertNumbertoWords(long number)
        {
            if (number == 0) return "ZERO";
            if (number < 0) return "minus " + ConvertNumbertoWords(Math.Abs(number));
            string words = "";
            if ((number / 1000000) > 0)
            {
                words += ConvertNumbertoWords(number / 100000) + " LAKHS ";
                number %= 1000000;
            }
            if ((number / 1000) > 0)
            {
                words += ConvertNumbertoWords(number / 1000) + " THOUSAND ";
                number %= 1000;
            }
            if ((number / 100) > 0)
            {
                words += ConvertNumbertoWords(number / 100) + " HUNDRED ";
                number %= 100;
            }
            //if ((number / 10) > 0)  
            //{  
            // words += ConvertNumbertoWords(number / 10) + " RUPEES ";  
            // number %= 10;  
            //}  
            if (number > 0)
            {
                //if (words != "") words += "AND ";
                var unitsMap = new[]
                {
            "ZERO", "ONE", "TWO", "THREE", "FOUR", "FIVE", "SIX", "SEVEN", "EIGHT", "NINE", "TEN", "ELEVEN", "TWELVE", "THIRTEEN", "FOURTEEN", "FIFTEEN", "SIXTEEN", "SEVENTEEN", "EIGHTEEN", "NINETEEN"
        };
                var tensMap = new[]
                {
            "ZERO", "TEN", "TWENTY", "THIRTY", "FORTY", "FIFTY", "SIXTY", "SEVENTY", "EIGHTY", "NINETY"
        };
                if (number < 20) words += unitsMap[number];
                else
                {
                    words += tensMap[number / 10];
                    if ((number % 10) > 0) words += " " + unitsMap[number % 10];
                }
            }
            return words;
        }
        [NonAction]
        private string GeneratingPDF(DSRInvoiceGate objGP, int InvoiceId, string InvoiceModeleName)
        {
            string html = "";

            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/BulkReport" + InvoiceId.ToString() + ".pdf";
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }
            html = "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>" +
                "<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objGP.CompanyName + "</h1>" +
                "<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />" +
                "<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Dashrath</span><br/>" +
                "<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>" + InvoiceModeleName + "</span></td></tr>" +
                "<tr><td style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>" +
                "CWC GST No. <label>" + objGP.CompanyGstNo + "</label></span></td></tr>" +
                "<tr><td><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>" +
                "<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Tax Invoice</h2> </td></tr>" +
                "<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>" +
                "<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + objGP.InvoiceNo + "</span></td>" +
                "<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + objGP.InvoiceDate + "</span></td></tr>" +
                "<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>" +
                "<span>" + objGP.PartyName + "</span></td>" +
                "<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + objGP.PartyState + "</span> </td></tr>" +
                "<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>" +
                "Party Address :</label> <span>" + objGP.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>" +
                "<label style='font-weight: bold;'>State Code :</label> <span>" + objGP.PartyStateCode + "</span></td></tr>" +
                "<tr><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Party GST :</label> <span>" + objGP.PartyGstNo + "</span></td>" +
                "</tr></tbody> " +
                "</table></td></tr><tr><td><hr /></td></tr><tr><th><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container Details :</b> </th></tr>" +
                "<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:80%;' cellspacing='0' cellpadding='10'>" +
                "<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>SR No.</th>" +
                "<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>ICD Code</th>" +
                "<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Container No.</th>" +
                "<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Size</th>" +
                "<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>From Date</th>" +
                "<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>To Date</th></tr></thead><tbody>";
            int i = 1;
            foreach (var container in objGP.LstContainersGate)
            {
                html = html + "<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + i.ToString() + "</td>" +
                "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + container.CfsCode + "</td>" +
                "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + container.ContainerNo + "</td>" +
                "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + container.Size + "</td>" +
                "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + container.FromDate + "</td>" +
                "<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + container.ToDate + "</td></tr>";
                i = i + 1;
            }

            html = html + "</tbody></table></td></tr>" +
            "<tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container Charges :</h3> </th></tr><tr><td>" +
            "<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>" +
            "<thead><tr>" +
            "<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>SR No.</th>" +
            "<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Charge Code</th>" +
            "<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Description</th>" +
            "<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>HSN Code</th>" +
            "<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Rate</th>" +
            "<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Taxable Amt.</th>" +
            "<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>CGST</th>" +
            "<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>SGST</th>" +
            "<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>IGST</th>" +
            "<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Total</th></tr><tr>" +
            "<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Rate</th>" +
            "<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Amt.</th>" +
            "<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Rate</th>" +
            "<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Amt.</th>" +
            "<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Rate</th>" +
            "<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Amt.</th></tr></thead>" +
            "<tbody>";
            i = 1;
            foreach (var charge in objGP.LstChargesGate)
            {
                html = html + "<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + i.ToString() + "</td>" +
                    "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.ChargeSD + "</td>" +
                    "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 8px; text-align: center;'>" + charge.ChargeDesc + "</td>" +
                    "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 8px; text-align: center;'>" + charge.HsnCode + "</td>" +
                    "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.Rate.ToString("0") + "</td>" +
                    "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.TaxableAmt.ToString("0") + "</td>" +
                    "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.CGSTRate.ToString("0") + "</td>" +
                    "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.CGSTAmt.ToString("0") + "</td>" +
                    "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.SGSTRate.ToString("0") + "</td>" +
                    "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.SGSTAmt.ToString("0") + "</td>" +
                    "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.IGSTRate.ToString("0") + "</td>" +
                    "<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.IGSTAmt.ToString("0") + "</td>" +
                    "<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.Total.ToString("0") + "</td></tr>";
                i = i + 1;
            }
            html = html + "</tbody>" +
                "</table></td></tr></tbody></table><table style=' border: 1px solid #000; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='10'> " +
                "<tbody><tr><th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Total :</th>" +
                "<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'></td>" +
                "<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: right; padding: 5px;'>" + objGP.TotalTax.ToString("0") + "</td>" +
                "<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: right; padding: 5px;'>" + objGP.TotalCGST.ToString("0") + "</td>" +
                "<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: right; padding: 5px;'>" + objGP.TotalSGST.ToString("0") + "</td>" +
                "<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: right; padding: 5px;'>" + objGP.TotalIGST.ToString("0") + "</td>" +
                "<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: right; padding: 5px;'>" + objGP.TotalAmt.ToString("0") + "</td>" +
                "</tr><tr><th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>" +
                "Total Invoice (In Word) :</th><td style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;' colspan='6'>" +
                "" + ConvertNumbertoWords(Convert.ToInt32(objGP.TotalAmt)) + "</td>" +
                "</tr><tr><th style='font-size: 12px; text-align: left; padding: 5px;'>Amount of Tax Subject of Reverse :</th>" +
                "<td style='font-size: 12px; text-align: left; padding: 5px;' colspan='6'>0</td>" +
                "</tr></tbody></table><table style='width:100%;' cellspacing='0' cellpadding='10'>" +
                "<tbody><tr><td style='font-size: 12px; text-align: left; line-height: 30px;'>Receipt No.: " +
                "<label style='font-weight: bold;'></label></td><td style='font-size: 12px; text-align: left; line-height: 30px;'>Party Code:" +
                "<label style='font-weight: bold;'>" + objGP.PartyCode + "</label></td></tr><tr><td style='font-size: 11px; text-align: left; line-height: 30px;'>" +
                "*Cheques are subject to realisation</td><td style='font-size: 11px; text-align: left; line-height: 30px;'>SAM(A/C)</td></tr></tbody></table>" +
                "</td></tr></tbody></table>";
            //html = "<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 0; '><tbody> <tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>Central Warehousing Corporation</h1><label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Dashrath</span></td></tr><tr><td style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>CWC GST No. <label>07AAACC1206D1ZI</label></span></td></tr><tr><td><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='0'><tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Tax Invoice</h2> </td></tr><tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='0'><tbody><tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>11071/96365</span></td><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>14-MAR-18</span></td></tr><tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label> <span>FREIGHTBRIDGE LOGISTICS PVT LTD</span></td><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>Delhi</span> </td></tr><tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Address :</label> <span>501, 5th Floor, 56 Eros Apartment</span></td><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State Code :</label> <span>DL</span></td></tr><tr><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Party GST :</label> <span>07AAACF8646G1ZJ</span></td></tr></tbody> </table></td></tr><tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 10px;'>Container Details :</h3> </th></tr><tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='0'><thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>SR No.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>CFS Code</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Container No.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Size</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>From Date</th><th style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>To Date</th></tr></thead><tbody><tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>--</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>--</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>--</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>--</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>-</td><td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>--</td></tr></tbody></table></td></tr><tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container Charges :</h3> </th></tr><tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='0'><thead><tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>SR No.</th><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Charge Code</th><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Description</th><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>HSN Code</th><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Rate</th><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Taxable Amt.</th><th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>CGST</th><th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>SGST</th><th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>IGST</th><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Total</th></tr><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Rate</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Amt.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Rate</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Amt.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Rate</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Amt.</th></tr></thead><tbody><tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>--</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>--</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>--</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>--</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>-</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>--</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>--</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>-</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>-</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>--</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>--</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>-</td><td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>--</td></tr></tbody></table></td></tr></tbody></table><table style=' border: 1px solid #000; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='0'> <tbody><tr><th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Total :</th><td style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>7200</td><td style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>648</td><td style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>648</td><td style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>8496</td></tr><tr><th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Total Invoice (In Word) :</th><td style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;' colspan='4'>Eight Thousand Four Hundred Ninety Six Rupees Only</td></tr><tr><th style='font-size: 12px; text-align: left; padding: 5px;'>Amount of Tax Subject of Reverse :</th><td style='font-size: 12px; text-align: left; padding: 5px;' colspan='4'>0</td></tr></table><table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr><td style='font-size: 11px; text-align: left; line-height: 30px;'>Receipt No.: <label style='font-weight: bold;'></label></td><td style='font-size: 11px; text-align: left; line-height: 30px;'>Party Code: <label style='font-weight: bold;'></label></td></tr><tr><td style='font-size: 11px; text-align: left; line-height: 30px;'>*Cheques are subject to realisation</td><td style='font-size: 11px; text-align: left; line-height: 30px;'>SAM(A/C)</td></tr></tbody></table></td></tr></tbody></table>";

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f))
            {
                rp.GeneratePDF(location, html);
            }
            return "/Docs/" + Session.SessionID + "/BulkReport" + InvoiceId.ToString() + ".pdf";
        }

        private string GeneratingBulkPDF(List<DSRInvoiceGate> objGPList, string InvoiceModeleName)
        {

            List<string> HtmlList = new List<string>();

            string currDateTime = DateTime.Now.ToString("ddMMyyyyhhmmtt");

            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/BulkReport_" + currDateTime + ".pdf";
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }

            foreach (DSRInvoiceGate objGP in objGPList.OrderBy(x => x.InvoiceNo).ToList())
            {
                StringBuilder html = new StringBuilder();
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                html.Append("<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objGP.CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Dashrath</span><br/>");
                html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>" + InvoiceModeleName + "</span></td></tr>");
                html.Append("<tr><td style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objGP.CompanyGstNo + "</label></span></td></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Tax Invoice</h2> </td></tr>");
                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + objGP.InvoiceNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + objGP.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                html.Append("<span>" + objGP.PartyName + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + objGP.PartyState + "</span> </td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                html.Append("Party Address :</label> <span>" + objGP.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + objGP.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Party GST :</label> <span>" + objGP.PartyGstNo + "</span></td>");
                html.Append("</tr></tbody> ");
                html.Append("</table></td></tr><tr><td><hr /></td></tr><tr><th><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:80%;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>To Date</th></tr></thead><tbody>");
                int i = 1;
                foreach (var container in objGP.LstContainersGate)
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + container.CfsCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + container.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + container.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + container.FromDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + container.ToDate + "</td></tr>");
                    i = i + 1;
                }

                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                foreach (var charge in objGP.LstChargesGate)
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.ChargeSD + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 8px; text-align: center;'>" + charge.ChargeDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 8px; text-align: center;'>" + charge.HsnCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.Rate.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.TaxableAmt.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.CGSTRate.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.CGSTAmt.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.SGSTRate.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.SGSTAmt.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.IGSTRate.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.IGSTAmt.ToString("0") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + charge.Total.ToString("0") + "</td></tr>");
                    i = i + 1;
                }
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table><table style=' border: 1px solid #000; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='10'> ");
                html.Append("<tbody><tr><th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Total :</th>");
                html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'></td>");
                html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: right; padding: 5px;'>" + objGP.TotalTax.ToString("0") + "</td>");
                html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: right; padding: 5px;'>" + objGP.TotalCGST.ToString("0") + "</td>");
                html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: right; padding: 5px;'>" + objGP.TotalSGST.ToString("0") + "</td>");
                html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: right; padding: 5px;'>" + objGP.TotalIGST.ToString("0") + "</td>");
                html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: right; padding: 5px;'>" + objGP.TotalAmt.ToString("0") + "</td>");
                html.Append("</tr><tr><th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>");
                html.Append("Total Invoice (In Word) :</th><td style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;' colspan='6'>");
                html.Append("" + ConvertNumbertoWords(Convert.ToInt32(objGP.TotalAmt)) + "</td>");
                html.Append("</tr><tr><th style='font-size: 12px; text-align: left; padding: 5px;'>Amount of Tax Subject of Reverse :</th>");
                html.Append("<td style='font-size: 12px; text-align: left; padding: 5px;' colspan='6'>0</td>");
                html.Append("</tr></tbody></table><table style='width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr><td style='font-size: 12px; text-align: left; line-height: 30px;'>Receipt No.: ");
                html.Append("<label style='font-weight: bold;'></label></td><td style='font-size: 12px; text-align: left; line-height: 30px;'>Party Code:");
                html.Append("<label style='font-weight: bold;'>" + objGP.PartyCode + "</label></td></tr><tr><td style='font-size: 11px; text-align: left; line-height: 30px;'>");
                html.Append("*Cheques are subject to realisation</td><td style='font-size: 11px; text-align: left; line-height: 30px;'>SAM(A/C)</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                HtmlList.Add(html.ToString());
            }


            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f))
            {
                rp.GeneratePDF(location, HtmlList);
            }
            return "/Docs/" + Session.SessionID + "/BulkReport_" + currDateTime + ".pdf";
        }
        #endregion

        #region SD A/c Statement

        [HttpGet]
        public ActionResult SDStatement()
        {
            var Months = new Dictionary<int, string>();
            for (Int16 i = 1; i <= 12; i++)
            {
                Months.Add(i, System.Globalization.DateTimeFormatInfo.InvariantInfo.MonthNames[i - 1]);
            }
            ViewBag.Months = new SelectList((IEnumerable)Months, "Key", "Value", DateTime.Today.Month);
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetSDStatement(SDStatement ObjSDStatement)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.GetPDAStatement(ObjSDStatement.Month, ObjSDStatement.Year);
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GeneratePDFForPDAStatement(FormCollection Fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "SDStatement.pdf";
                Pages[0] = Fc["Page"].ToString();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report/SDStatement/";
                Pages[0] = Pages[0].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                //using (var Rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f))
                //{
                //    Rh.GeneratePDF(LocalDirectory + FileName, Pages);
                //}
                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/SDStatement/" + FileName });
            }
            catch
            {
                return Json(new { Status = 0, Message = "Error" });
            }
        }

        #endregion

        #region On Account Statement

        [HttpGet]
        public ActionResult OnAccountStatement()
        {
            var Months = new Dictionary<int, string>();
            for (Int16 i = 1; i <= 12; i++)
            {
                Months.Add(i, System.Globalization.DateTimeFormatInfo.InvariantInfo.MonthNames[i - 1]);
            }
            ViewBag.Months = new SelectList((IEnumerable)Months, "Key", "Value", DateTime.Today.Month);
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetOnAccountStatement(DSROAStatement ObjOAStatement)
        {
            string Fdt = Convert.ToDateTime(ObjOAStatement.FromDate).ToString("yyyy-MM-dd");
            string Tdt = Convert.ToDateTime(ObjOAStatement.ToDate).ToString("yyyy-MM-dd");

            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.GetOnAccountStatement(Fdt, Tdt);
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GeneratePDFForOAStatement(FormCollection Fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "OnAccountStatement.pdf";
                Pages[0] = Fc["Page"].ToString();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report/OnAccountStatement/";
                Pages[0] = Pages[0].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }

                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/OnAccountStatement/" + FileName });
            }
            catch
            {
                return Json(new { Status = 0, Message = "Error" });
            }
        }
        #endregion

        #region Party Wise On Account Statement Details Report

        public ActionResult PartyWiseOnAccountStatement()
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetAllPartyForOADet("", 0);
            if (ObjRR.DBResponse.Data != null)
            {
                var Jobj = Newtonsoft.Json.JsonConvert.SerializeObject(ObjRR.DBResponse.Data);
                var Jobject = Newtonsoft.Json.Linq.JObject.Parse(Jobj);
                ViewBag.LstParty = Jobject["LstParty"];
                ViewBag.State = Jobject["State"];
            }
            return PartialView();
        }


        [HttpGet]
        public JsonResult OASearchParty(string PartyCode)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetAllPartyForOADet(PartyCode, 0);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpGet]
        public JsonResult OALoadParty(string PartyCode, int Page)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetAllPartyForOADet(PartyCode, Page);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetPartyWiseOnAccountReport(string FromDate, string ToDate, int PartyId)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();

            string Fdt = Convert.ToDateTime(FromDate).ToString("yyyy-MM-dd");
            string Tdt = Convert.ToDateTime(ToDate).ToString("yyyy-MM-dd");

            ObjRR.GetPartyWiseOnAccountStatement(PartyId, Fdt, Tdt);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }


        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GeneratePDFForOAStatementDetails(FormCollection Fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "OnAcStatementPartyWise.pdf";
                Pages[0] = Fc["Page"].ToString();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report/OnAcStatementPartyWise/";
                Pages[0] = Pages[0].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }

                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/OnAcStatementPartyWise/" + FileName });
            }
            catch
            {
                return Json(new { Status = 0, Message = "Error" });
            }
        }
        #endregion

        #region register of outward supply

        [HttpGet]
        public ActionResult RegisterOfOutwardSupply()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public FileResult RegisterOfOutwardSupply(FormCollection fc)
        {
            try
            {
                var date1 = Convert.ToDateTime(fc["PeriodFrom"].ToString());
                var date2 = Convert.ToDateTime(fc["PeriodTo"].ToString());
                var Type = fc["ddlType"].ToString();
                var excelName = "";
                var ObjRR = new DSR_ReportRepository();
                ObjRR.GetRegisterofOutwardSupply(date1, date2, Type);

                if (Type == "Inv") { Type = "Invoice"; }
                if (Type == "C") { Type = "Credit"; }
                if (Type == "D") { Type = "Debit"; }
                if (Type == "Unpaid") { Type = "Unpaid"; }
                if (Type == "CancelInv") { Type = "Cancel Invoice"; }

                excelName = "RegisterofOutwardSupply" + "_" + Type + ".xlsx";

                if (!string.IsNullOrEmpty(ObjRR.DBResponse.Data.ToString()))
                    return File(ObjRR.DBResponse.Data.ToString(), "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", excelName);
                else
                {
                    string name = DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
                    var excelFile = Server.MapPath("~/Docs/Excel/" + name + ".xlsx");
                    using (var exl = new DynamicExcel.ExcelGenerator(excelFile))
                    {
                        exl.AddCell("A1", "No data found");
                        exl.Save();
                        return File(excelFile, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", excelName);
                    }
                }
            }
            catch
            {
                string name = DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
                var excelFile = Server.MapPath("~/Docs/Excel/" + name + ".xlsx");
                using (var exl = new DynamicExcel.ExcelGenerator(excelFile))
                {
                    exl.AddCell("A1", "No data found");
                    exl.Save();
                    return File(excelFile, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "RegisterofOutwardSupply.xlsx");
                }
            }
            // return null;
        }

        #endregion

        #region All Party Credit Status
        [HttpGet]
        public ActionResult GetPartyWiseCreditStatus()
        {
            return PartialView();
        }
        [HttpPost, CustomValidateAntiForgeryToken]
        public JsonResult PartyUnpaidCreditStatus(string AsOnDate)
        {
            DSR_ReportRepository objIM = new DSR_ReportRepository();
            objIM.PartyUnpaidCreditStatus(AsOnDate);
            if (objIM.DBResponse.Data != null)
            {
                IList<PartyUnpaidDetails> lstDet = new List<PartyUnpaidDetails>();
                lstDet = (List<PartyUnpaidDetails>)objIM.DBResponse.Data;
                string Path = GeneratePDFforCreditStatus(lstDet);
                return Json(new { Status = 1, Message = Path });
            }
            return Json(new { Status = 0, Message = "No Data Found" });
        }
        [NonAction]
        public string GeneratePDFforCreditStatus(IList<PartyUnpaidDetails> lstDtl)
        {
            StringBuilder objSB = new StringBuilder();
            objSB.Append("<table style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 0; '>");
            objSB.Append("<tbody><tr><td style='text-align: center;' colspan='2'>");
            objSB.Append("<span style='font-size: 14px; font-weight: bold; line-height: 16px;'>Payer Wise Credit Status</span>");
            objSB.Append("</td></tr><tr><td style='text-align: right;' colspan='2'>");

            objSB.Append("<span style='font-size: 11px; line-height: 22px;padding-bottom: 10px;'>As On: <label>" + lstDtl[0].AsOnDate + "</label>");
            objSB.Append("</span></td><td style='text-align: right;'></td></tr><tr><td colspan='2'><table style='width:100%; margin-bottom: 10px;'><tbody>");
            objSB.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;'><thead>");
            objSB.Append("<tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Payer</th>");
            objSB.Append("<th style=' border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Unpaid Amount</th></tr>");
            objSB.Append("</thead><tfoot><tr>");
            objSB.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; font-weight: bold; text-align: center; padding: 5px;'>");
            objSB.Append("Total</td><td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + Convert.ToDecimal(lstDtl.Sum(x => x.UnpaidAmt)) + "</td>");
            objSB.Append("</tr></tfoot><tbody>");
            int Serial = 1;
            lstDtl.ToList().ForEach(item =>
            {
                objSB.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;' >" + Serial + "." + item.PartyName + "</td>");
                objSB.Append("<td style=' border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'> " + item.UnpaidAmt + "</td></tr>");
                Serial++;
            });
            objSB.Append("</tbody></table></td></tr></tbody></table></td></tr></tbody></table>");
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID;
            if (!Directory.Exists(LocalDirectory))
                Directory.CreateDirectory(LocalDirectory);
            if (System.IO.File.Exists(LocalDirectory + "/CreditStatus.pdf"))
                System.IO.File.Delete(LocalDirectory + "/CreditStatus.pdf");
            using (var RH = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
            {
                RH.HeadOffice = this.HeadOffice;
                RH.HOAddress = this.HOAddress;
                RH.ZonalOffice = this.ZonalOffice;
                RH.ZOAddress = this.ZOAddress;
                RH.GeneratePDF(LocalDirectory + "/CreditStatus.pdf", objSB.ToString());
            }
            return "/Docs/" + Session.SessionID + "/CreditStatus.pdf";
        }
        #endregion

        #region Party Wise Unpaid Invoice Details
        [HttpGet]
        public ActionResult GetUnpaidInvoice()
        {
            DSR_ReportRepository objRR = new DSR_ReportRepository();
            objRR.GetPayeeNameforUnpaidInvoice();
            if (objRR.DBResponse.Data != null)
                ViewBag.GetPaymentParty = JsonConvert.DeserializeObject(JsonConvert.SerializeObject(objRR.DBResponse.Data));
            else ViewBag.GetPaymentParty = null;
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult PartyWiseUnpaidAmout(PartyWiseUnpaid objUn)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository objIM = new DSR_ReportRepository();
                objIM.PartyWiseUnpaidAmout(objUn.PartyId, objUn.AsOnDate);
                if (objIM.DBResponse.Data != null)
                {
                    PartyWiseUnpaidDtl objDet = new PartyWiseUnpaidDtl();
                    objDet = (PartyWiseUnpaidDtl)objIM.DBResponse.Data;
                    string Path = GeneratePDFforUnpaidInvoiceDetails(objDet);
                    return Json(new { Status = 1, Message = Path });
                }
                return Json(new { Status = 0, Message = "No Data Found" });
            }
            else return Json(new { Status = 0, Message = "No Data Found" });
        }
        [NonAction]
        public string GeneratePDFforUnpaidInvoiceDetails(PartyWiseUnpaidDtl objDet)
        {
            StringBuilder objSB = new StringBuilder();
            objSB.Append("<table style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 0; '>");
            objSB.Append("<tbody><tr><td style='text-align: center;' colspan='3'>");
            objSB.Append("<span style='font-size: 14px; font-weight: bold; line-height: 16px;'>Payer Unpaid Bill Status</span>");
            objSB.Append("</td></tr><tr><td style='text-align: left;' colspan='2'>");
            objSB.Append("<span style='display: block; font-size: 11px; padding-bottom: 10px;'>Payer Name: <label>" + objDet.PartyName + "</label>");
            objSB.Append("</span></td><td style='text-align: right;'>");
            objSB.Append("<span style='display: block; font-size: 11px; line-height: 22px;padding-bottom: 10px;'>As On: <label>" + objDet.AsOnDate + "</label></span>");
            objSB.Append("</td></tr><tr><td colspan='3'><table style='width:100%; margin-bottom: 10px;' ><tbody><tr>");
            objSB.Append("<td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;'><thead><tr>");
            objSB.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Invoice No.</th>");
            objSB.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Date</th>");
            objSB.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Amount</th>");
            objSB.Append("</tr></thead>");
            objSB.Append("<tfoot><tr>");
            objSB.Append("<td colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; font-weight: bold; text-align: center; padding: 5px;'>Total</td>");
            objSB.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + Convert.ToDecimal(objDet.lstDtl.Sum(x => x.InvoiceAmt)) + "</td></tr></tfoot><tbody>");
            objDet.lstDtl.ToList().ForEach(item =>
            {
                objSB.Append("<tr>");
                objSB.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>" + item.InvoiceNo + "</td>");
                objSB.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>" + item.InvoiceDate + "</td>");
                objSB.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + item.InvoiceAmt + "</td></tr>");
            });
            objSB.Append("</tbody></table></td></tr></tbody></table></td></tr></tbody></table>");
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID;
            if (!Directory.Exists(LocalDirectory))
                Directory.CreateDirectory(LocalDirectory);
            if (System.IO.File.Exists(LocalDirectory + "/UnpaidInvoiceDet.pdf"))
                System.IO.File.Delete(LocalDirectory + "/UnpaidInvoiceDet.pdf");
            using (var RH = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
            {
                RH.HeadOffice = this.HeadOffice;
                RH.HOAddress = this.HOAddress;
                RH.ZonalOffice = this.ZonalOffice;
                RH.ZOAddress = this.ZOAddress;
                RH.GeneratePDF(LocalDirectory + "/UnpaidInvoiceDet.pdf", objSB.ToString());
            }
            return "/Docs/" + Session.SessionID + "/UnpaidInvoiceDet.pdf";
        }
        #endregion

        #region Bulk Receipt  Report
        [HttpGet]
        public ActionResult BulkReceiptReport()
        {
            return PartialView();
        }
        [HttpPost]
        //[ValidateAntiForgeryToken]
        public JsonResult GetBulkReceiptReport(BulkReceiptReport ObjBulkReceiptReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetBulkCashreceipt(ObjBulkReceiptReport.PeriodFrom, ObjBulkReceiptReport.PeriodTo, ObjBulkReceiptReport.ReceiptNumber);
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                string Path = GenerateBulkReceiptReport(ds);
                return Json(new { Status = 1, Message = Path });
            }
            return Json(new { Status = 0, Message = "No Data Found" });
        }

        [HttpPost]
        //[ValidateAntiForgeryToken]
        public JsonResult GetTDSDepositReport(BulkReceiptReport ObjBulkReceiptReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetBulkCashreceipt(ObjBulkReceiptReport.PeriodFrom, ObjBulkReceiptReport.PeriodTo, ObjBulkReceiptReport.ReceiptNumber);
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                string Path = GenerateTDSDepositReport(ds);
                return Json(new { Status = 1, Message = Path });
            }
            return Json(new { Status = 0, Message = "No Data Found" });
        }

        [HttpPost]
        //[ValidateAntiForgeryToken]
        public JsonResult GetBulkSDReceiptReport(BulkReceiptReport ObjBulkReceiptReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetBulkCashreceipt(ObjBulkReceiptReport.PeriodFrom, ObjBulkReceiptReport.PeriodTo, ObjBulkReceiptReport.ReceiptNumber);
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                string Path = GenerateBulkSDReceiptReport(ds);
                return Json(new { Status = 1, Message = Path });
            }
            return Json(new { Status = 0, Message = "No Data Found" });
        }
        [NonAction]
        public string GenerateBulkReceiptReport(DataSet ds)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstMode = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();

            int i = 0;
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();


                //Page Header
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");

                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='150%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'>" + (item.fromPDA == "PDR" ? "SD RECEIPT" : "CASH RECEIPT") + "</label>");
                html.Append("</td></tr>");



                //Header
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='9' width='80%' style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td colspan='3' width='20%' style='font-size: 13px; line-height: 26px; float:right;'><label style='font-weight: bold;'>Date : </label> <span>" + item.ReceiptDate + "</span></td>");
                html.Append("</tr>");
                //html.Append("<tr><td colspan='9' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>By : </label><span>" + item.PartyName + "</span></td><td colspan='3' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Folio No : </label><span>" + item.PartyCode + "</span></td></tr>");
                html.Append("<tr><td colspan='9' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>By : </label><span>" + item.PartyName + "</span></td><td colspan='3' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'> </label><span>" + "" + "</span></td></tr>");
                html.Append("<tr><td colspan='12' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Address : </label><span>" + item.PartyAddress + "</span></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr><tr><td><hr/></td></tr><tr><td>");


                if (item.InvoiceNo.ToString() != "")
                {
                    //Invoice Nos and Amounts
                    html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:50%;' align='center' cellspacing='0' cellpadding='10'>");
                    html.Append("<thead><tr>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Invoice No</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Amount</th>");
                    html.Append("</tr></thead><tbody>");
                    //Loop
                    if (item.InvoiceNo.ToString() != "")
                    {
                        var InvoiceIds = item.InvoiceId.Split(',');
                        var InvoiceNos = item.InvoiceNo.Split(',');
                        var InvoiceAmts = item.Amt.Split(',');
                        i = 0;
                        foreach (var Invoice in InvoiceNos)
                        {
                            html.Append("<tr>");
                            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceNos[i] + "</td>");
                            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceAmts[i] + "</td>");
                            html.Append("</tr>");

                            i = i + 1;
                        }
                    }

                    html.Append("</tbody></table>");
                }
                html.Append("</td></tr>");
                //Banks
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:70%;' align='center' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Mode</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 140px;'>Drawee Bank</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Instrument</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Amount</th>");
                html.Append("</tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 80px;'>No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Date</th>");
                html.Append("</tr></thead><tbody>");

                //loop
                decimal totalpaymentreceiptAmt = 0;
                i = 1;
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Amount + "</td>");

                    html.Append("</tr>");
                    totalpaymentreceiptAmt = totalpaymentreceiptAmt + data.Amount;

                    i = i + 1;

                });

                //TDS
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>TDS</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TdsAmount.ToString() + "</td></tr>");


                //Total
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>Total Payment Receipt Amount</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + totalpaymentreceiptAmt + "</td></tr></tbody></table>");

                html.Append("</td></tr></tbody></table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'>In Words : " + objCurr.changeCurrencyToWords(totalpaymentreceiptAmt.ToString("0")) + "</th></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 80px;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><td width='10%' valign='top' align='right' style='font-size:13px;'><b>Remarks : </b></td><td colspan='2' width='85%' style='font-size:12px; line-height:22px;'>" + item.Remarks + "</td></tr>");
                //html.Append("<td style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'><b>Remarks : </b> " + item.Remarks + "</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr>");
                html.Append("<th style='width:60%;'></th>");
                html.Append("<th style='border-top: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>For Central Warehousing Corporation</th>");
                html.Append("</tr></tbody></table></td></tr></tbody></table>");

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            var type = "bulkreport";
            var id = "BulkReceipt" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
            var fileName = id + ".pdf";
            string PdfDirectory = Server.MapPath("~/Docs") + "/" + type + "/";
            if (!Directory.Exists(PdfDirectory))
                Directory.CreateDirectory(PdfDirectory);
            using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                rh.HeadOffice = "";
                rh.HOAddress = "";
                rh.ZonalOffice = "";
                rh.ZOAddress = "";
                rh.GeneratePDF(PdfDirectory + fileName, lstSB);
            }
            return "/Docs/" + type + "/" + fileName;
        }

        #region
        public JsonResult GetBulkReceiptReportAddMoneySD(BulkReceiptReport ObjBulkReceiptReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetBulkCashreceipt(ObjBulkReceiptReport.PeriodFrom, ObjBulkReceiptReport.PeriodTo, ObjBulkReceiptReport.ReceiptNumber);
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                string Path = GenerateBulkReceiptReportAddMoneySD(ds);
                return Json(new { Status = 1, Message = Path });
            }
            return Json(new { Status = 0, Message = "No Data Found" });
        }
        [NonAction]
        public string GenerateBulkReceiptReportAddMoneySD(DataSet ds)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstMode = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();

            int i = 0;
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();

                //Page Header
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");

                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='150%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'>CASH RECEIPT</label>");
                html.Append("</td></tr>");


                //Header
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='9' width='80%' style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td colspan='3' width='20%' style='font-size: 13px; line-height: 26px; float:right;'><label style='font-weight: bold;'>Date : </label> <span>" + item.ReceiptDate + "</span></td>");
                html.Append("</tr>");
                //html.Append("<tr><td colspan='9' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>By : </label><span>" + item.PartyName + "</span></td><td colspan='3' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Folio No : </label><span>" + item.PartyCode + "</span></td></tr>");
                html.Append("<tr><td colspan='9' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>By : </label><span>" + item.PartyName + "</span></td><td colspan='3' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'> </label><span>" + "" + "</span></td></tr>");
                html.Append("<tr><td colspan='12' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Address : </label><span>" + item.PartyAddress + "</span></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr><tr><td><hr/></td></tr>");


                //Banks
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:70%;' align='center' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Mode</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 140px;'>Drawee Bank</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Instrument</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Amount</th>");
                html.Append("</tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 80px;'>No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Date</th>");
                html.Append("</tr></thead><tbody>");

                //loop
                decimal totalpaymentreceiptAmt = 0;
                i = 1;
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Amount + "</td>");
                    html.Append("</tr>");
                    totalpaymentreceiptAmt = totalpaymentreceiptAmt + data.Amount;

                    i = i + 1;

                });

                //TDS
                //html.Append("<tr>");
                //html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>TDS</td>");
                //html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TdsAmount.ToString() + "</td></tr>");


                //Total
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>Total Payment Receipt Amount</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + totalpaymentreceiptAmt + "</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'>In Words : " + objCurr.changeCurrencyToWords(totalpaymentreceiptAmt.ToString("0")) + "</th></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 80px;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><td width='10%' valign='top' align='right' style='font-size:13px;'><b>Remarks : </b></td><td colspan='2' width='85%' style='font-size:12px; line-height:22px;'>" + item.Remarks + "</td></tr>");
                //html.Append("<td style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'><b>Remarks : </b> " + item.Remarks + "</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr>");
                html.Append("<th style='width:60%;'></th>");
                html.Append("<th style='border-top: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>For Central Warehousing Corporation</th>");
                html.Append("</tr></tbody></table></td></tr></tbody></table>");

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            var type = "bulkreport";
            var id = "BulkReceipt" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
            var fileName = id + ".pdf";
            string PdfDirectory = Server.MapPath("~/Docs") + "/" + type + "/";
            if (!Directory.Exists(PdfDirectory))
                Directory.CreateDirectory(PdfDirectory);
            using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                rh.HeadOffice = "";
                rh.HOAddress = "";
                rh.ZonalOffice = "";
                rh.ZOAddress = "";
                rh.GeneratePDF(PdfDirectory + fileName, lstSB);
            }
            return "/Docs/" + type + "/" + fileName;
        }
        #endregion
        [NonAction]
        public string GenerateTDSDepositReport(DataSet ds)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstMode = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();

            int i = 0;
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();


                //Page Header
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");

                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='150%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'>TDS RECEIPT</label>");
                html.Append("</td></tr>");



                //Header
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='9' width='80%' style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td colspan='3' width='20%' style='font-size: 13px; line-height: 26px; float:right;'><label style='font-weight: bold;'>Date : </label> <span>" + item.ReceiptDate + "</span></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>By : </label><span>" + item.PartyName + "</span></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr><tr><td><hr/></td></tr>");


                //Banks
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:70%;' align='center' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Mode</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 140px;'>Drawee Bank</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 140px;'></th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Certificate No.</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Amount</th>");
                html.Append("</tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 80px;'>No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Date</th>");
                html.Append("</tr></thead><tbody>");

                //loop
                decimal totalpaymentreceiptAmt = 0;
                i = 1;
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Amount + "</td>");
                    html.Append("</tr>");
                    totalpaymentreceiptAmt = totalpaymentreceiptAmt + data.Amount;

                    i = i + 1;

                });

                //TDS
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>TDS</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TdsAmount.ToString() + "</td></tr>");


                //Total
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>Total Payment Receipt Amount</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + totalpaymentreceiptAmt + "</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'>In Words : " + objCurr.changeCurrencyToWords(totalpaymentreceiptAmt.ToString("0")) + "</th></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 80px;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><td width='10%' valign='top' align='right' style='font-size:13px;'><b>Remarks : </b></td><td colspan='2' width='85%' style='font-size:12px; line-height:22px;'>" + item.Remarks + "</td></tr>");
                //html.Append("<td style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'><b>Remarks : </b> " + item.Remarks + "</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr>");
                html.Append("<th style='width:60%;'></th>");
                html.Append("<th style='border-top: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>For Central Warehousing Corporation</th>");
                html.Append("</tr></tbody></table></td></tr></tbody></table>");

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            var type = "bulkreport";
            var id = "BulkReceipt" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
            var fileName = id + ".pdf";
            string PdfDirectory = Server.MapPath("~/Docs") + "/" + type + "/";
            if (!Directory.Exists(PdfDirectory))
                Directory.CreateDirectory(PdfDirectory);
            using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                rh.HeadOffice = "";
                rh.HOAddress = "";
                rh.ZonalOffice = "";
                rh.ZOAddress = "";
                rh.GeneratePDF(PdfDirectory + fileName, lstSB);
            }
            return "/Docs/" + type + "/" + fileName;
        }

        [NonAction]
        public string GenerateBulkSDReceiptReport(DataSet ds)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstMode = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();

            int i = 0;
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                /*
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Dashrath</span>");
                html.Append("</td></tr>");
                html.Append("<tr><td style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Tax Invoice</h2> </td></tr>");
                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Receipt No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Receipt Date : </label> <span>" + item.ReceiptDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                html.Append("<span>" + item.PartyName + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                html.Append("Party Address :</label> <span>" + item.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("</tr></tbody> ");
                html.Append("</table></td></tr><tr><td><hr /></td></tr><tr><th><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>CFS Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>To Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                */
                /*************/
                /*Container Bind*/
                /*
                int i = 1;
                var InvoceIds = item.InvoiceId.Split(',');
                foreach (var InvId in InvoceIds)
                {
                    lstContainer.Where(x => x.InoviceId == Convert.ToInt32(InvId)).ToList().ForEach(elem =>
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.CFSCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ContainerNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.Size + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.FromDate + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ToDate + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                        html.Append("</tr>");
                        i = i + 1;
                    });
                }
                */
                /***************/
                /*
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 60px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                */
                /*Charges Bind*/
                /*
                foreach (var InvId in InvoceIds)
                {
                    lstCharges.Where(y => y.InoviceId == Convert.ToInt32(InvId)).ToList().ForEach(data =>
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Rate.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.CGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.IGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Total.ToString("0") + "</td></tr>");
                        i = i + 1;
                    });
                }
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; width: 120px;'>Total :</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; center; width: 144px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 90px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 160px;'>" + item.TotalTaxable.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 10px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalCGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalSGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalIGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 10px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 120px;'>" + item.InvoiceAmt.ToString("0") + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;' colspan='12'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;'>SAM(A/C)</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("</td></tr></tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Mode</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Drawee Bank</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Instrument No</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Amount</th>");
                html.Append("</tr>");
                html.Append("</thead>");
                html.Append("<tbody>");
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.Amount + "</td>");
                    html.Append("</tr>");
                });
                html.Append("</tbody></table>");
                */
                /***************/



                //Page Header
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");

                html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td colspan='8' width='90%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'>SD RECEIPT</label>");
                html.Append("</td></tr>");

                //html.Append("<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                //html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br/>");
                //html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Dashrath</span>");
                //html.Append("<h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Cash Receipt</h2> </td></tr>");

                //Header
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='9' width='80%' style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td colspan='3' width='20%' style='font-size: 13px; line-height: 26px; float:right;'><label style='font-weight: bold;'>Date : </label> <span>" + item.ReceiptDate + "</span></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>By : </label><span>" + item.PartyName + "</span></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr><tr><td><hr/></td></tr><tr><td>");

                //Invoice Nos and Amounts
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:50%;' align='center' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Invoice No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Amount</th>");
                html.Append("</tr></thead><tbody>");

                //Loop
                if (item.InvoiceNo.ToString() != "")
                {
                    var InvoiceIds = item.InvoiceId.Split(',');
                    var InvoiceNos = item.InvoiceNo.Split(',');
                    var InvoiceAmts = item.Amt.Split(',');
                    i = 0;
                    foreach (var Invoice in InvoiceNos)
                    {
                        html.Append("<tr>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceNos[i] + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceAmts[i] + "</td>");
                        html.Append("</tr>");

                        i = i + 1;
                    }
                }


                html.Append("</tbody></table></td></tr>");

                //Banks
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:70%;' align='center' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Mode</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 140px;'>Drawee Bank</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Instrument</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Amount</th>");
                html.Append("</tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 80px;'>No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Date</th>");
                html.Append("</tr></thead><tbody>");

                //loop
                decimal totalpaymentreceiptAmt = 0;
                i = 1;
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Amount + "</td>");
                    html.Append("</tr>");
                    totalpaymentreceiptAmt = totalpaymentreceiptAmt + data.Amount;

                    i = i + 1;

                });

                //TDS
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>SD Balance</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TdsAmount.ToString() + "</td></tr>");


                //Total
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>Total Payment Receipt Amount</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + totalpaymentreceiptAmt + "</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'>In Words : " + objCurr.changeCurrencyToWords(totalpaymentreceiptAmt.ToString("0")) + "</th></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 80px;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><td width='10%' valign='top' align='right' style='font-size:13px;'><b>Remarks : </b></td><td colspan='2' width='85%' style='font-size:12px; line-height:22px;'>" + item.Remarks + "</td></tr>");
                //html.Append("<td style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'><b>Remarks : </b> " + item.Remarks + "</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr>");
                html.Append("<th style='width:60%;'></th>");
                html.Append("<th style='border-top: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>For Central Warehousing Corporation</th>");
                html.Append("</tr></tbody></table></td></tr></tbody></table>");

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            var type = "bulkreport";
            var id = "BulkReceipt" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
            var fileName = id + ".pdf";
            string PdfDirectory = Server.MapPath("~/Docs") + "/" + type + "/";
            if (!Directory.Exists(PdfDirectory))
                Directory.CreateDirectory(PdfDirectory);
            using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                rh.HeadOffice = "";
                rh.HOAddress = "";
                rh.ZonalOffice = "";
                rh.ZOAddress = "";
                rh.GeneratePDF(PdfDirectory + fileName, lstSB);
            }
            return "/Docs/" + type + "/" + fileName;
        }

        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult GetChequeBounceReceiptReport(String ReceiptNo)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetChequeBounceCashreceipt(ReceiptNo);
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                string Path = GenerateBulk(ds);
                return Json(new { Status = 1, Message = Path });
            }
            return Json(new { Status = 0, Message = "No Data Found" });
        }


        [NonAction]
        public string GenerateBulk(DataSet ds)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstMode = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();

            int i = 0;
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();


                //Page Header
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '>");
                html.Append("<tbody><tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br/>");
                html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Dashrath</span>");
                html.Append("<h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Cash Receipt</h2> </td></tr>");

                //Header
                html.Append("<tr><td><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Date : </label> <span>" + item.ReceiptDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>By : </label><span>" + item.PartyName + "</span></td></tr></tbody></table>");
                html.Append("</td></tr><tr><td><hr/></td></tr><tr><td>");

                //Invoice Nos and Amounts
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:50%;' align='center' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Invoice No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Amount</th>");
                html.Append("</tr></thead><tbody>");

                //Loop
                var InvoiceIds = item.InvoiceId.Split(',');
                var InvoiceNos = item.InvoiceNo.Split(',');
                var InvoiceAmts = item.InvoiceAmt.ToString().Split(',');
                i = 0;
                foreach (var Invoice in InvoiceNos)
                {
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceNos[i] + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceAmts[i] + "</td>");
                    html.Append("</tr>");

                    i = i + 1;
                }

                html.Append("</tbody></table></td></tr>");

                //Banks
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:70%;' align='center' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Mode</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 140px;'>Drawee Bank</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Instrument</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Amount</th>");
                html.Append("</tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Date</th>");
                html.Append("</tr></thead><tbody>");

                //loop

                i = 1;
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Amount + "</td>");
                    html.Append("</tr>");

                    i = i + 1;
                });

                //TDS
                var TdsAmount = 0.00;
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>TDS</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + TdsAmount + "</td></tr>");
                //html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TdsAmount.ToString() + "</td></tr>");


                //Total
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>Total</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.InvoiceAmt.ToString() + "</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");
                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 80px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'>In Words : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th></tr>");
                html.Append("</tbody></table>");
                html.Append("<table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr>");
                html.Append("<th style='width:60%;'></th>");
                html.Append("<th style='border-top: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>For Central Warehousing Corporation</th>");
                html.Append("</tr></tbody></table></td></tr></tbody></table>");


                lstSB.Add(html.ToString());
            });
            var type = "bulkreport";
            var id = "BulkReceipt" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
            var fileName = id + ".pdf";
            string PdfDirectory = Server.MapPath("~/Docs") + "/" + type + "/";
            if (!Directory.Exists(PdfDirectory))
                Directory.CreateDirectory(PdfDirectory);
            using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                rh.HeadOffice = "";
                rh.HOAddress = "";
                rh.ZonalOffice = "";
                rh.ZOAddress = "";
                rh.GeneratePDF(PdfDirectory + fileName, lstSB);
            }
            return "/Docs/" + type + "/" + fileName;
        }
        [HttpGet]
        [CustomValidateAntiForgeryToken]
        public ActionResult ListOfReceiptDateWise(string FromDate, string ToDate)
        {
            ReportRepository ObjRR = new ReportRepository();
            ObjRR.GetReceiptList(FromDate, ToDate);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        #endregion

        #region DailyCashBookReport



        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult DailyCashBookReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //DSR_ReportRepository ObjReport = new DSR_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetDailyCashBookReport(DSR_DailyCashBook ObjDailyCashBook)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_DailyCashBook> LstDailyCashBook = new List<DSR_DailyCashBook>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.DailyCashBook(ObjDailyCashBook);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstDailyCashBook = (List<DSR_DailyCashBook>)ObjRR.DBResponse.Data;
                LstDailyCashBook = LstDailyCashBook.OrderBy(o => o.ReceiptDate).ThenBy(o => o.CRNo).ToList();

                LstDailyCashBook.Add(new DSR_DailyCashBook()
                {
                    /*ReceiptDate = "<strong>Total</strong>",
                    CRNo = "",
                    Depositor = "",*/

                    InvoiceDate = "<strong>Total</strong>",
                    InvoiceNo = "",
                    InvoiceType = "",
                    PartyName = "",
                    PayeeName = "",
                    ModeOfPay = "",
                    ChqNo = "",
                    GenSpace = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.GenSpace)).ToString(),
                    StorageCharge = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.StorageCharge)).ToString(),
                    Insurance = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Insurance)).ToString(),
                    GroundRentEmpty = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.GroundRentEmpty)).ToString(),
                    GroundRentLoaded = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.GroundRentLoaded)).ToString(),
                    MfCharge = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.MfCharge)).ToString(),
                    EntryCharge = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.EntryCharge)).ToString(),
                    Fumigation = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Fumigation)).ToString(),
                    OtherCharge = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.OtherCharge)).ToString(),
                    Misc = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Misc)).ToString(),
                    Cgst = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Cgst)).ToString(),
                    Sgst = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Sgst)).ToString(),
                    Igst = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Igst)).ToString(),

                    MiscExcess = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.MiscExcess)).ToString(),
                    TotalCash = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalCash)).ToString(),
                    TotalCheque = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalCheque)).ToString(),
                    TotalOthers = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalOthers)).ToString(),
                    Tds = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Tds)).ToString(),
                    CrTds = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.CrTds)).ToString(),
                    TotalPDA = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalPDA)).ToString(),
                    TotalOA = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalOA)).ToString(),
                    Remarks = ""

                });
                ObjRR.DBResponse.Data = LstDailyCashBook;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateDailyCashBookReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "DailyCashBookReport.pdf";
                Pages[0] = fc["Page"].ToString();
                Pages[0] = fc["Page"].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/DailyCashBookReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.LegalLandscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                //using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f))
                //{

                //    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                //}
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/DailyCashBookReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }





        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult DailyCashBookReportCash()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //DSR_ReportRepository ObjReport = new DSR_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetDailyCashBookReportCash(DSR_DailyCashBookCash ObjDailyCashBook)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_DailyCashBookCash> LstDailyCashBook = new List<DSR_DailyCashBookCash>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.DailyCashBookCash(ObjDailyCashBook);//, objLogin.Uid

            if (ObjRR.DBResponse.Data != null)
            {
                LstDailyCashBook = (List<DSR_DailyCashBookCash>)ObjRR.DBResponse.Data;
                LstDailyCashBook = LstDailyCashBook.OrderBy(o => o.ReceiptNo).ToList();

                ObjRR.DBResponse.Data = LstDailyCashBook;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }



        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateDailyCashBookReportPDFCash(FormCollection fc)
        {
            try
            {

                var Pages = new string[1];
                var FileName = "DailyCashBookReport.pdf";
                Pages[0] = fc["Page"].ToString();
                Pages[0] = fc["Page"].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/DailyCashBookReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.LegalLandscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                //using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f))
                //{

                //    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                //}
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/DailyCashBookReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion

        #region MonthlyCashBookReport

        //same model used for daily and monthly cashbook in patparganj

        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult MonthlyCashBookReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //DSR_ReportRepository ObjReport = new DSR_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetMonthlyCashBookReport(DSR_DailyCashBookCash ObjMonthlyCashBook)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_DailyCashBookCash> LstMonthlyCashBook = new List<DSR_DailyCashBookCash>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.MonthlyCashBook(ObjMonthlyCashBook);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstMonthlyCashBook = (List<DSR_DailyCashBookCash>)ObjRR.DBResponse.Data;

                ObjRR.DBResponse.Data = LstMonthlyCashBook;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateMonthlyCashBookPDF(FormCollection fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "DailyCashBookReport.pdf";
                Pages[0] = fc["Page"].ToString();
                Pages[0] = fc["Page"].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/MonthlyCashBookReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);


                using (var ObjPdf = new ReportingHelper(PdfPageSize.LegalLandscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/MonthlyCashBookReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #region SdSummary Excel

        [HttpGet]
        public ActionResult SdSummaryExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public FileResult SdSummaryExcelDetail(FormCollection fc)
        {
            // DSR ObjPV = new Ppg_AssessmentSheetLCL();
            string FromDate = (fc["FromDate"].ToString());
            string ToDate = (fc["ToDate"].ToString());
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.PartyWiseSdReportSummary(FromDate, ToDate);
            string excelName = "";
            excelName = "SdSummary" + "_" + ".xls";

            if (!string.IsNullOrEmpty(ObjRR.DBResponse.Data.ToString()))
                return File(ObjRR.DBResponse.Data.ToString(), "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", excelName);
            else
            {
                string name = DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
                var excelFile = Server.MapPath("~/Docs/Excel/" + name + ".xls");
                using (var exl = new DynamicExcel.ExcelGenerator(excelFile))
                {
                    exl.AddCell("A1", "No data found");
                    exl.Save();
                    return File(excelFile, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", excelName);
                }
            }


        }
        #endregion


        #region PDSummary



        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult PDASummaryReport()
        {

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetPdSummaryReport(DSRPdSummary ObjPdSummary, int drpType)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSRPdSummary> LstPdSummary = new List<DSRPdSummary>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.PdSummaryReport(ObjPdSummary, drpType);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstPdSummary = (List<DSRPdSummary>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GeneratePdSummaryPDF(FormCollection fc)
        {
            try
            {

                var Pages = new string[1];
                var FileName = "SdSummary.pdf";
                Pages[0] = fc["Page"].ToString();

                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/SdSummary/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/SdSummary/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion

        #region DailyPdaActivityReport



        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult DailyPdaActivityReport()
        {

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetDailyPdaActivityReport(DSRDailyPdaActivityReport ObjDailyPdaActivityReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSRDailyPdaActivityReport> LstDailyPdaActivityReport = new List<DSRDailyPdaActivityReport>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.DailyPdaActivity(ObjDailyPdaActivityReport);//, objLogin.Uid

            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            //if (ObjRR.DBResponse.Data != null)
            //{
            //    LstDailyPdaActivityReport = (List<DSRDailyPdaActivityReport>)ObjRR.DBResponse.Data;
            //    return Json(ObjRR.DBResponse);
            //}
            //else
            //{
            //    return Json(ObjRR.DBResponse);
            //}

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateDailyPdaActivityReportPDF(FormCollection fc)
        {
            try
            {

                string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                var Pages = new string[1];
                var FileName = "DailySdActivityReport.pdf";
                Pages[0] = fc["Page"].ToString();

                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/DailySdActivityReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/DailySdActivityReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }





        #endregion


        #region Stock Position Report
        [HttpGet]
        public ActionResult StockPositionReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetStockPositionReport(StockPositionReportModel ObjStockPosition)
        {
            Kdl_ReportRepository ObjRR = new Kdl_ReportRepository();
            List<StockPositionReportModel> LstStockPosition = new List<StockPositionReportModel>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.StockPositionReport(ObjStockPosition);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstStockPosition = (List<StockPositionReportModel>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateStockPositionReportPDF(FormCollection fc)
        {
            try
            {

                var Pages = new string[1];
                var FileName = "StockPositionReport.pdf";
                Pages[0] = fc["Page"].ToString();
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/StockPositionReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/StockPositionReport/" + FileName };
                return Json(ObjResult);
            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }
        #endregion

        #endregion



        #region Monthly SD Book

        [HttpGet]
        public ActionResult MonthlySDBookReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //DSR_ReportRepository ObjReport = new DSR_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetMonthlySDBookReport(DSR_DailyCashBook ObjMonthlyCashBook)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_DailyCashBook> LstMonthlyCashBook = new List<DSR_DailyCashBook>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.MonthSDBookReport(ObjMonthlyCashBook);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstMonthlyCashBook = (List<DSR_DailyCashBook>)ObjRR.DBResponse.Data;
                LstMonthlyCashBook.Add(new DSR_DailyCashBook()
                {
                    ReceiptDate = "<strong>Total</strong>",

                    GenSpace = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.GenSpace)).ToString(),
                    StorageCharge = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.StorageCharge)).ToString(),
                    Insurance = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Insurance)).ToString(),
                    GroundRentEmpty = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.GroundRentEmpty)).ToString(),
                    GroundRentLoaded = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.GroundRentLoaded)).ToString(),
                    MfCharge = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.MfCharge)).ToString(),
                    EntryCharge = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.EntryCharge)).ToString(),
                    Fumigation = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Fumigation)).ToString(),
                    OtherCharge = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.OtherCharge)).ToString(),
                    Cgst = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Cgst)).ToString(),
                    Sgst = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Sgst)).ToString(),
                    Igst = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Igst)).ToString(),
                    Misc = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Misc)).ToString(),
                    MiscExcess = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.MiscExcess)).ToString(),
                    TotalCash = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalCash)).ToString(),
                    TotalCheque = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalCheque)).ToString(),
                    Tds = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Tds)).ToString(),
                    CrTds = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.CrTds)).ToString()
                });
                ObjRR.DBResponse.Data = LstMonthlyCashBook;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateMonthlySDBookPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "MonthlySDBookReport.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/MonthlySDBookReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/MonthlySDBookReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }


        #endregion

        #region Invoice Job order

        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult PrintJOSingle(int ImpJobOrderId)
        {
            DSR_ImportRepository objIR = new DSR_ImportRepository();
            objIR.GetImportJODetailsFrPrint(ImpJobOrderId);
            if (objIR.DBResponse.Data != null)
            {

                CwcExim.Areas.Import.Models.DSRPrintJOModel objMdl = new CwcExim.Areas.Import.Models.DSRPrintJOModel();
                objMdl = (CwcExim.Areas.Import.Models.DSRPrintJOModel)objIR.DBResponse.Data;
                string Path = "";
                //string Path = GeneratePDFForJO(objMdl, ImpJobOrderId);
                //lstSBPrint.Add(GeneratePDFForJO(objMdl, ImpJobOrderId));
                return Json(new { Status = 1, Message = Path });
            }
            else
                return Json(new { Status = -1, Message = "Error" });
        }

        [NonAction]
        public string GeneratePDFForJO(CwcExim.Areas.Import.Models.DSRPrintJOModel objMdl, int ImpJobOrderId)
        {
            string Path = Server.MapPath("~/Docs/") + Session.SessionID + "/JobOrder" + ImpJobOrderId + ".pdf";
            string ContainerNo = "", Size = "", Serial = "", TrainNo = "", TrainDate = "", ContainerLoadType = "", CargoType = ""; int Count = 0;
            int Count40 = 0;
            int Count20 = 0;
            string Sline = "";
            string ImporterName = "";
            string ChaName = "";
            string Html = "";
            string CompanyAddress = "";
            StringBuilder html = new StringBuilder();
            CompanyRepository ObjCR = new CompanyRepository();
            List<Company> LstCompany = new List<Company>();
            ObjCR.GetAllCompany();
            if (ObjCR.DBResponse.Data != null)
            {
                LstCompany = (List<Company>)ObjCR.DBResponse.Data;
                CompanyAddress = LstCompany[0].CompanyAddress;
            }
            objMdl.lstDet.ToList().ForEach(item =>
            {
                ContainerNo = (ContainerNo == "" ? (item.ContainerNo) : (ContainerNo + "<br/>" + item.ContainerNo));
                Size = (Size == "" ? (item.ContainerSize) : (Size + "<br/>" + item.ContainerSize));
                Sline = (Sline == "" ? (item.Sline) : (Sline + "<br/>" + item.Sline));
                ImporterName = (ImporterName == "" ? (item.ImporterName) : (ImporterName + "<br/>" + item.ImporterName));
                ChaName = (ChaName == "" ? (item.ChaName) : (ChaName + "<br/>" + item.ChaName));
                ContainerLoadType = (ContainerLoadType == "" ? (item.ContainerLoadType) : (ContainerLoadType + "<br/>" + item.ContainerLoadType));
                CargoType = (CargoType == "" ? (item.CargoType) : (CargoType + "<br/>" + item.CargoType));
                Serial = (Serial == "") ? (++Count).ToString() : (Serial + "<br/>" + (++Count).ToString());
            });

            Count20 = objMdl.lstDet.ToList().Where(item => item.ContainerSize == "20").Count();
            Count40 = objMdl.lstDet.ToList().Where(item => item.ContainerSize == "40").Count();

            if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            //if (System.IO.File.Exists(Path))
            //{
            //    System.IO.File.Delete(Path);
            //}
            if ((Convert.ToInt32(Session["BranchId"])) == 1)
            {
                //Html = "<table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;'><thead><tr><th style='width:15%;text-align:left;'><img src='IMGSRC' width='50%;'/></th><th style='text-align:center;'><span style='font-size:16pt;'><strong>CENTRAL WAREHOUSING CORPORATION</strong></span><br/><span>(A GOVT. OF INDIA UNDERTAKING)<br/>" + CompanyAddress + "</span></th></tr></thead><tbody><tr><td style='text-align:left;'>No.<span style='border-bottom:1px solid #000;'> " + objMdl.JobOrderNo + "</span></td><td style='text-align:right;'>Date<span style='border-bottom:1px solid #000;'> " + objMdl.JobOrderDate + "</span></td></tr><tr><td colspan='2' style='text-align:center;'><br/><span style='border-bottom:1px solid #000;font-size:12pt;font-weight:600;'>JOB ORDER</span></td></tr><tr><td colspan='2' style='text-align:left;'><br/>To,<br/>The Kandla International Container Terminal(KICT),<br/>Kandla</td></tr><tr><td colspan='2' style='text-align:center;'><br/>Shift the Import from <span style='border-bottom:1px solid #000;'> " + objMdl.FromLocation + " </span> to<span style='border-bottom:1px solid #000;'> CFS-KPT </span></td></tr><tr><td colspan='2'><table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;border:1px solid #000;border-collapse:collapse;'><thead><tr><th style='border:1px solid #000;padding:5px;text-align:center;'>SL. NO.</th><th style='border:1px solid #000;padding:5px;text-align:center;'>CONTAINER NO.</th><th style='border:1px solid #000;padding:5px;text-align:center;'>SIZE</th><th style='border:1px solid #000;padding:5px;text-align:center;'>S. LINE</th><th style='border:1px solid #000;padding:5px;text-align:center;'>LOADED / EMPTY</th></tr></thead><tbody><tr><td style='border:1px solid #000;padding:5px;'>" + Serial + "</td><td style='border:1px solid #000;padding:5px;'>" + ContainerNo + "</td><td style='border:1px solid #000;padding:5px;'>" + Size + "</td><td style='border:1px solid #000;padding:5px;'>" + objMdl.ShippingLineName + "</td><td style='border:1px solid #000;padding:5px;'>" + objMdl.ContainerType + "</td></tr></tbody> </table></td></tr><tr><td colspan='2'><table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;'><tbody><tr><td>Copy to:- <span>M/s Abrar Forwarders <br/>Gate Incharge,CWC KPT <br/>Custom PO,KICT Gate</span></td><td><br/><br/>Authorised Signature</td></tr></tbody></table></td></tr></tbody></table>";

                html.Append("<table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;'><thead><tr><th style='width:15%;text-align:left;'><img src='IMGSRC' width='50%;'/></th><th style='text-align:center;'><span style='font-size:16pt;'><strong>CENTRAL WAREHOUSING CORPORATION</strong></span><br/><span>(A GOVT. OF INDIA UNDERTAKING)<br/>" + CompanyAddress + "</span></th></tr></thead><tbody><tr><td style='text-align:left;'>No.<span style='border-bottom:1px solid #000;'> " + objMdl.JobOrderNo + "</span></td><td style='text-align:right;'>Date<span style='border-bottom:1px solid #000;'> " + objMdl.JobOrderDate + "</span></td></tr><tr><td colspan='2' style='text-align:center;'><br/><span style='border-bottom:1px solid #000;font-size:12pt;font-weight:600;'>JOB ORDER</span></td></tr><tr><td colspan='2' style='text-align:left;'><br/>To,<br/>The Kandla International Container Terminal(KICT),<br/>Kandla</td></tr><tr><td colspan='2' style='text-align:center;'><br/>Shift the Import from <span style='border-bottom:1px solid #000;'> " + objMdl.FromLocation + " </span> to<span style='border-bottom:1px solid #000;'> CFS-KPT </span></td></tr><tr><td colspan='2'><table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;border:1px solid #000;border-collapse:collapse;'><thead><tr><th style='border:1px solid #000;padding:5px;text-align:center;'>SL. NO.</th><th style='border:1px solid #000;padding:5px;text-align:center;'>CONTAINER NO.</th><th style='border:1px solid #000;padding:5px;text-align:center;'>SIZE</th><th style='border:1px solid #000;padding:5px;text-align:center;'>S. LINE</th><th style='border:1px solid #000;padding:5px;text-align:center;'>LOADED / EMPTY</th></tr></thead><tbody><tr><td style='border:1px solid #000;padding:5px;'>" + Serial + "</td><td style='border:1px solid #000;padding:5px;'>" + ContainerNo + "</td><td style='border:1px solid #000;padding:5px;'>" + Size + "</td><td style='border:1px solid #000;padding:5px;'>" + objMdl.ShippingLineName + "</td><td style='border:1px solid #000;padding:5px;'>" + objMdl.ContainerType + "</td></tr></tbody> </table></td></tr><tr><td colspan='2'><table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;'><tbody><tr><td>Copy to:- <span>M/s Abrar Forwarders <br/>Gate Incharge,CWC KPT <br/>Custom PO,KICT Gate</span></td><td><br/><br/>Authorised Signature</td></tr></tbody></table></td></tr></tbody></table>");
            }
            else
            {
                //Html = "<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><thead>  <tr><td colspan='12'><table style='width:100%; font-size:8pt; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody><tr><th style='width:15%;text-align:left;'><img src='IMGSRC' width='50%;'/></th><th style='text-align:center;'><span style='font-size:16pt;'><strong>CENTRAL WAREHOUSING CORPORATION</strong></span><br/><span>(A GOVT. OF INDIA UNDERTAKING)<br/>" + CompanyAddress + "</span><br/><span style='border-bottom:1px solid #000;font-size:12pt;font-weight:600;'>IMPORT JOB ORDER</span></th></tr></tbody></table></td></tr></thead>   <tbody> <tr><td colspan='12'><table style='width:100%; font-size:8pt; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody><tr><td style='text-align:left; width:50%;'>Job Order No.<span style='border-bottom:1px solid #000;'> " + objMdl.JobOrderNo + "</span></td><td style='text-align:right;width:50%;'>Job Order Date<span style='border-bottom:1px solid #000;'> " + objMdl.JobOrderDate + "</span></td></tr></tbody></table></td></tr>   <tr><td colspan='12'><table style='width:100%; font-size:8pt; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody><tr><th>TO,</th></tr> <tr><th>The Manager(CT/OPERATIONS)</th></tr> <tr><td><span><br/></span></td></tr> <tr><td>" + objMdl.FromLocation + "</td></tr> <tr><td><span>&nbsp;&nbsp;</span>SIR,</td></tr> <tr><td><span>&nbsp;&nbsp;</span>YOU ARE REQUESTED TO KINDLY ARRANGE TO DELIVER THE FOLLOWING IMPORT CONTAINERS / CBT TO ICD DASHRATH,VADODARA.</td></tr> </tbody></table></td></tr>      <tr><td colspan='12' style='text-align:center;'><br/></td></tr>  <tr><td colspan='12'><table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border:1px solid #000;border-collapse:collapse;'><thead><tr><th style='border:1px solid #000;padding:5px;text-align:center; width:25px;'>SL.NO</th><th style='border:1px solid #000;padding:5px;text-align:center; width:100px;'>CONTAINER / CBT NO.</th><th style='border:1px solid #000;padding:5px;text-align:center; width:60px;'>SIZE</th><th style='border:1px solid #000;padding:5px;text-align:center; width:100px;'>G/HAZ</th><th style='border:1px solid #000;padding:5px;text-align:center; width:100px;'>SLA CODE</th><th style='border:1px solid #000;padding:5px;text-align:center; width:80px;'>F/L</th></tr></thead><tbody><tr><td style='border:1px solid #000;padding:5px;text-align:center;'>" + Serial + "</td><td style='border:1px solid #000;padding:5px;text-align:center;'>" + ContainerNo + "</td><td style='border:1px solid #000;padding:5px;text-align:center;'>" + Size + "</td><td style='border:1px solid #000;padding:5px;text-align:center;'>" + CargoType + "</td><td style='border:1px solid #000;padding:5px;text-align:center;'>" + Sline + "</td><td style='border:1px solid #000;padding:5px;text-align:center;'>" + ContainerLoadType + "</td></tr></tbody> </table></td></tr> <tr><td><span><br/></span></td></tr> <tr><td colspan='1'></td><th colspan='10'>TOTAL CONTAINERS / CBT : 20x " + Count20 + " + 40x " + Count40 + "</th></tr> <tr><td colspan='4'><table cellspacing='0' cellpadding='5' style='width:100%; font-size:8pt; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody><tr><td colspan='2'></td><td width='15%' valign='top' align='right'>Note :</td><td colspan='2' width='85%'>THE FOLLOWING CONTAINERS / CBT ARE REQUIRED TO BE SCANNED BEFORE ITS DELIVERY FROM THE PORT AS DESIRED BY THE CUSTOM SCANNING DIVISION</td></tr></tbody></table></td></tr>   <tr><td colspan='12'><span><br/><br/></span></td></tr> <tr><td colspan='12' style='text-align:right;'>FOR MANAGER <br/> ICD DASHRATH</td></tr>  <tr><td colspan='12'><table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;'><tbody> <tr><td><span><br/></span></td></tr>   <tr><td colspan='12'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><tbody><tr><td>Copy to <br/> 1- M/S Suman Forwarding Agency Pvt.Ltd - for arranging movement of the Containers / CBT from " + objMdl.FromLocation + " within time. failing which dwell time charges as per procedure will be debited to your account as per claim receive from line.<br/> 2-The Preventive Office, Customs,ICD Dashrath.</td></tr></tbody></table></td></tr>    </tbody></table></td></tr></tbody></table>";

                html.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'>");
                html.Append("<thead>");
                html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td colspan='8' width='150%' style='text-align: center;'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1>");
                html.Append("<label style='display: block; font-size: 7pt;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='display: block; font-size: 7pt;text-transform: uppercase; padding-bottom: 10px;'>" + CompanyAddress + "</span>");
                html.Append("<br/><label style='font-size: 7pt; font-weight:bold;'>IMPORT JOB ORDER</label>");
                html.Append("</td></tr>");
                html.Append("</thead>");

                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td colspan='12'>");
                html.Append("<table style='width:100%; font-size:7pt; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='text-align:left; width:50%;'>Job Order No.<span style='border-bottom:1px solid #000;'> " + objMdl.JobOrderNo + "</span></td>");
                html.Append("<td style='text-align:right;width:50%;'>Job Order Date<span style='border-bottom:1px solid #000;'> " + objMdl.JobOrderDate + "</span></td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td colspan='12'>");
                html.Append("<table style='width:100%; font-size:7pt; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th>TO,</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th>The Manager(CT/OPERATIONS)</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td><span><br/></span></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td>" + objMdl.FromLocation + "</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td><span>&nbsp;&nbsp;</span>SIR,</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td><span>&nbsp;&nbsp;</span>YOU ARE REQUESTED TO KINDLY ARRANGE TO DELIVER THE FOLLOWING IMPORT CONTAINERS / CBT TO ICD DASHRATH,VADODARA.</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td colspan='12' style='text-align:center;'>");
                html.Append("<br/>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td colspan='12'>");
                html.Append("<table style='width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border:1px solid #000;border-collapse:collapse;'>");
                html.Append("<thead>");
                html.Append("<tr>");
                html.Append("<th cellpadding='5' style='border:1px solid #000;padding:5px;text-align:center; width:25px;'>SL.NO</th>");
                html.Append("<th cellpadding='5' style='border:1px solid #000;padding:5px;text-align:center; width:100px;'>CONTAINER / CBT NO.</th>");
                html.Append("<th cellpadding='5' style='border:1px solid #000;padding:5px;text-align:center; width:40px;'>SIZE</th>");
                html.Append("<th cellpadding='5' style='border:1px solid #000;padding:5px;text-align:center; width:60px;'>G/HAZ</th>");
                html.Append("<th cellpadding='5' style='border:1px solid #000;padding:5px;text-align:center; width:180px;'>Importer Name</th>");
                html.Append("<th cellpadding='5' style='border:1px solid #000;padding:5px;text-align:center; width:150px;'>CHA Name</th>");
                html.Append("<th cellpadding='5' style='border:1px solid #000;padding:5px;text-align:center; width:100px;'>Shipping Line Name</th>");
                html.Append("<th cellpadding='5' style='border:1px solid #000;padding:5px;text-align:center; width:60px;'>F/L</th>");
                html.Append("</tr>");
                html.Append("</thead>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td cellpadding='5' valign='top' style='border:1px solid #000;padding:5px;text-align:center;'>" + Serial + "</td>");
                html.Append("<td cellpadding='5' valign='top' style='border:1px solid #000;padding:5px;text-align:center;'>" + ContainerNo + "</td>");
                html.Append("<td cellpadding='5' valign='top' style='border:1px solid #000;padding:5px;text-align:center;'>" + Size + "</td>");
                html.Append("<td cellpadding='5' valign='top' style='border:1px solid #000;padding:5px;text-align:center;'>" + CargoType + "</td>");
                html.Append("<td cellpadding='5' valign='top' style='border:1px solid #000;padding:5px;text-align:center;'>" + ImporterName + "</td>");
                html.Append("<td cellpadding='5' valign='top' style='border:1px solid #000;padding:5px;text-align:center;'>" + ChaName + "</td>");
                html.Append("<td cellpadding='5' valign='top' style='border:1px solid #000;padding:5px;text-align:center;'>" + Sline + "</td>");
                html.Append("<td cellpadding='5' valign='top' style='border:1px solid #000;padding:5px;text-align:center;'>" + ContainerLoadType + "</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td><span><br/></span></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td colspan='1'></td>");
                html.Append("<th colspan='10' style='font-size:7pt;'>TOTAL CONTAINERS / CBT : 20x " + Count20 + " + 40x " + Count40 + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td colspan='4'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-size:7pt; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td colspan='2'></td>");
                html.Append("<td width='15%' valign='top' align='right'>Note :</td>");
                html.Append("<td colspan='2' width='85%'>THE FOLLOWING CONTAINERS / CBT ARE REQUIRED TO BE SCANNED BEFORE ITS DELIVERY FROM THE PORT AS DESIRED BY THE CUSTOM SCANNING DIVISION</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td colspan='12'><span><br/><br/></span></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td colspan='12' style='text-align:right; font-size:7pt;'>FOR MANAGER");
                html.Append("<br/> ICD DASHRATH</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td colspan='12'>");
                html.Append("<table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td><span><br/></span></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td colspan='12'>");
                html.Append("<table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;'>");
                html.Append("<tbody>");
                html.Append(" <tr>");
                html.Append("<td>Copy to");
                html.Append("<br/> 1- M/S Suman Forwarding Agency Pvt.Ltd - for arranging movement of the Containers / CBT from " + objMdl.FromLocation + " within time. failing which dwell time charges as per procedure will be debited to your account as per claim receive from line.");
                html.Append("<br/> 2-The Preventive Office, Customs,ICD Dashrath.</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
            }
            // string Html = "<table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;'><thead><tr><th style='width:15%;text-align:left;'><img src='IMGSRC' width='50%;'/></th><th style='text-align:center;'><span style='font-size:16pt;'><strong>CENTRAL WAREHOUSING CORPORATION</strong></span><br/><span>(A GOVT. OF INDIA UNDERTAKING)<br/>CONTAINER FREIGHT STATION<br/>18, COAL DOCK ROAD, KOLKATA - 700 043</span></th></tr></thead><tbody><tr><td style='text-align:left;'>No.<span style='border-bottom:1px solid #000;'> "+objMdl.JobOrderNo+"</span></td><td style='text-align:right;'>Date<span style='border-bottom:1px solid #000;'> "+objMdl.JobOrderDate+"</span></td></tr><tr><td colspan='2' style='text-align:center;'><br/><span style='border-bottom:1px solid #000;font-size:12pt;font-weight:600;'>JOB ORDER</span></td></tr><tr><td colspan='2' style='text-align:center;'><br/>Please arrange to bring / shift the Import / Export Load / Empty container</td></tr><tr><td colspan='2' style='text-align:left;'>from<span style='border-bottom:1px solid #000;'> "+objMdl.FromLocation+" </span> to<span style='border-bottom:1px solid #000;'> "+objMdl.ToLocation+" </span></td></tr><tr><td colspan='2'><table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;border:1px solid #000;border-collapse:collapse;'><thead><tr><th style='border:1px solid #000;padding:5px;text-align:center;'>SL. NO.</th><th style='border:1px solid #000;padding:5px;text-align:center;'>CONTAINER NO.</th><th style='border:1px solid #000;padding:5px;text-align:center;'>SIZE</th><th style='border:1px solid #000;padding:5px;text-align:center;'>S. LINE</th><th style='border:1px solid #000;padding:5px;text-align:center;'>LOADED / EMPTY</th></tr></thead><tbody><tr><td style='border:1px solid #000;padding:5px;'>"+ Serial + "</td><td style='border:1px solid #000;padding:5px;'>"+ContainerNo+"</td><td style='border:1px solid #000;padding:5px;'>"+Size+"</td><td style='border:1px solid #000;padding:5px;'>"+objMdl.ShippingLineName+"</td><td style='border:1px solid #000;padding:5px;'>"+objMdl.ContainerType+"</td></tr></tbody> </table></td></tr><tr><td colspan='2'><table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;'><tbody><tr><td>Copy to:- <span></span></td><td><br/><br/>SR.ASSTT.MANAGER</td></tr></tbody></table></td></tr></tbody></table>";
            html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            //  using (var rh = new ReportingHelper(PdfPageSize.A4, 20f, 30f, 30f, 30f, false, true))
            //{
            //rh.GeneratePDF(Path, html.ToString());
            // }
            //  return "/Docs/" + Session.SessionID + "/JobOrder" + ImpJobOrderId + ".pdf";
            return html.ToString();
        }


        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult PrintJOTwoInvoice(int ImpJobOrderId)
        {
            DSR_ReportRepository objRR = new DSR_ReportRepository();
            objRR.GetImportJOInvoiceDetailsForPrint(ImpJobOrderId);
            //  List<string> lstSB = new List<string>();
            List<string> lstSBPrint = new List<string>();





            if (objRR.DBResponse.Data != null)
            {
                DataSet dtInvoice = (DataSet)objRR.DBResponse.Data;
                if (dtInvoice.Tables[0].Rows.Count > 0)
                {

                    for (int i = 0; i < dtInvoice.Tables[0].Rows.Count; i++)
                    {
                        DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                        Login objLogin = (Login)Session["LoginUser"];

                        ObjRR.JobOrderContainerInvoiceDetailsForPrint(dtInvoice.Tables[0].Rows[i]["InvoiceId"].ToString(), ImpJobOrderId);//, objLogin.Uid
                        if (ObjRR.DBResponse.Status == 1)
                        {
                            DataSet ds = (DataSet)ObjRR.DBResponse.Data;

                            lstSBPrint.Add(GeneratingJobOrderContainerInvoice(ds));



                        }

                    }
                    var FileName = "JO_ContainerReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                    var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                    var FilePath = "/Docs/" + Session.SessionID + "/" + FileName;
                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                    }

                    DSR_ImportRepository objIR = new DSR_ImportRepository();
                    objIR.GetImportJODetailsFrPrint(ImpJobOrderId);
                    if (objIR.DBResponse.Data != null)
                    {

                        CwcExim.Areas.Import.Models.DSRPrintJOModel objMdl = new CwcExim.Areas.Import.Models.DSRPrintJOModel();
                        objMdl = (CwcExim.Areas.Import.Models.DSRPrintJOModel)objIR.DBResponse.Data;
                        // string Path = "";
                        //string Path = GeneratePDFForJO(objMdl, ImpJobOrderId);
                        lstSBPrint.Add(GeneratePDFForJO(objMdl, ImpJobOrderId));

                    }

                    using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
                    {
                        rp.HeadOffice = "";
                        rp.HOAddress = "";
                        rp.ZonalOffice = "";
                        rp.ZOAddress = "";
                        rp.Version = EffectVersion;
                        rp.Effectlogofile = EffectVersionLogoFile;
                        rp.GeneratePDF(location, lstSBPrint);
                    }
                    return Json(new { Status = 1, Message = FilePath });
                }
                else
                    return Json(new { Status = -1, Message = "No Record Found." });
            }
            else
                return Json(new { Status = -1, Message = "Error" });
        }




        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult PrintJOInvoice(int ImpJobOrderId)
        {
            DSR_ReportRepository objIR = new DSR_ReportRepository();
            objIR.GetImportJOInvoiceDetailsForPrint(ImpJobOrderId);
            List<string> lstSB = new List<string>();
            if (objIR.DBResponse.Data != null)
            {
                DataSet dtInvoice = (DataSet)objIR.DBResponse.Data;
                if (dtInvoice.Tables[0].Rows.Count > 0)
                {

                    for (int i = 0; i < dtInvoice.Tables[0].Rows.Count; i++)
                    {
                        DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                        Login objLogin = (Login)Session["LoginUser"];

                        ObjRR.JobOrderContainerInvoiceDetailsForPrint(dtInvoice.Tables[0].Rows[i]["InvoiceId"].ToString(), ImpJobOrderId);//, objLogin.Uid
                        if (ObjRR.DBResponse.Status == 1)
                        {
                            DataSet ds = (DataSet)ObjRR.DBResponse.Data;

                            lstSB.Add(GeneratingJobOrderContainerInvoice(ds));



                        }

                    }
                    var FileName = "JO_ContainerReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                    var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                    var FilePath = "/Docs/" + Session.SessionID + "/" + FileName;
                    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                    {
                        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                    }

                    using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
                    {
                        rp.HeadOffice = "";
                        rp.HOAddress = "";
                        rp.ZonalOffice = "";
                        rp.ZOAddress = "";
                        rp.Version = EffectVersion;
                        rp.Effectlogofile = EffectVersionLogoFile;
                        rp.GeneratePDF(location, lstSB);
                    }
                    return Json(new { Status = 1, Message = FilePath });
                }
                else
                    return Json(new { Status = -1, Message = "No Record Found." });
            }
            else
                return Json(new { Status = -1, Message = "Error" });
        }



        [NonAction]
        public string GeneratingJobOrderContainerInvoice(DataSet ds)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            // List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            StringBuilder html = new StringBuilder();
            String CWC = "CWC";
            //  String GST = "";
            lstInvoice.ToList().ForEach(item =>
            {

                /*Header Part*/
                //html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                //html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                //html.Append("<td colspan='8' width='150%' style='text-align: center;'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + ZonalOffice + "</h1> ");
                //html.Append("<label style='display: block; font-size: 7pt;'>(A Govt. of India Undertaking) </label><br /> ");
                //html.Append("<span style='display: block; font-size: 7pt;text-transform: uppercase; padding-bottom: 10px;'>" + ZOAddress + "</span> ");
                //html.Append("<br/><label style='font-size: 7pt; font-weight:bold;'>JOB ORDER</label>");
                //html.Append("</td></tr>");

                //html.Append("<tr><td colspan='12' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>CWC GST No. <label>" + GSTIN + "</label></span></td>");
                //html.Append("<td align='left' valign='top'><img valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td></tr>");


                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + ZonalOffice + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + ZOAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>JOB ORDER</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + GSTIN + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                html.Append("<td align='left' valign='top'><img valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='12'><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Tax Invoice</h2> </td></tr>");

                html.Append("<tr><td colspan='12'><table style='width:100%;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td style='font-size: 7pt;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td style='font-size: 7pt;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 7pt;'><label style='font-weight: bold;'>Party : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td style='font-size: 7pt;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td style='font-size: 7pt;'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td style='font-size: 7pt;'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 7pt;  padding-bottom:5px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td style='font-size: 7pt;  padding-bottom:5px;'><label style='font-weight: bold;'>Payer Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 7pt;  padding-bottom:5px;'><label style='font-weight: bold;'>Importer Name :</label> <span>" + item.ExporterImporterName + "</span></td>");
                html.Append("<td style='font-size: 7pt; padding-bottom:5px;'><label style='font-weight: bold;'>Invoice Generated by :</label> <span>" + item.PaymentMode + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; padding-bottom:5px;'><label style='font-weight: bold;'>CHA Name :</label> <span>" + item.CHAName + "</span></td>");
                html.Append("<td style='font-size: 7pt; padding-bottom:5px;'><label style='font-weight: bold;'>Supply Type :</label> <span>" + item.SupplyType + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; border-bottom: 1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Place Of Supply :</label> <span>" + item.PartyState + "(" + item.PartyStateCode + ")</span></td>");
                html.Append("<td style='font-size: 7pt; border-bottom: 1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Is Service</label> <span>YES</span></td></tr>");


                html.Append("</tbody>");
                html.Append("</table></td></tr>");

                html.Append("<tr><th colspan='12'><b style='text-align: left; font-size: 7pt;'>Container Details :</b></th></tr>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size: 6pt;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding: 5px;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding: 5px;'>Gross WT.(in Kg)</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding: 5px;'>Port Name</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; padding: 5px;'>Cargo Type</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align: center;'>ODC Type</th>");
                html.Append("</tr></thead>");
                html.Append("<tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.Gross_Wt + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.PortName + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; text-align: center;'>" + elem.ODCType + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><th colspan='12'><h3 style='text-align: left; font-size: 7pt;'>Container Charges :</h3> </th></tr>");
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Clause</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.Clause + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>" + ((Convert.ToDecimal(data.Taxable) + Convert.ToDecimal(data.CGSTAmt) + Convert.ToDecimal(data.SGSTAmt) + Convert.ToDecimal(data.IGSTAmt))).ToString("0.##") + "</td></tr>");
                    i = i + 1;
                    totamt = totamt + data.Taxable;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 200px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 150px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 7pt; text-align: center; width: 120px;'>" + (Convert.ToDecimal(item.InvoiceAmt) - (Convert.ToDecimal(totamt) + Convert.ToDecimal(item.TotalCGST) + Convert.ToDecimal(item.TotalSGST) + Convert.ToDecimal(item.TotalIGST))).ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 200px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 150px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 7pt; text-align: center; width: 120px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td style='font-size: 7pt; text-align: left;'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'>Party Code:<label style='font-weight: bold;'>" + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left;'>*Cheques are subject to realisation</td><td style='font-size: 7pt; text-align: left;'>" + item.PartyCode + "</td></tr>");

                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 9px; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr></tbody></table>");

                /***************/
                //  lstSB.Add(html.ToString());

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
            });
            //var FileName = "ContainerReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            //var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            //if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            //{
            //    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            //}
            ///*if (System.IO.File.Exists(location))
            //{
            //    System.IO.File.Delete(location);
            //}*/
            //using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            //{
            //    rp.HeadOffice = "";
            //    rp.HOAddress = "";
            //    rp.ZonalOffice = "";
            //    rp.ZOAddress = "";
            //    rp.GeneratePDF(location, html.tostr);
            //}
            return html.ToString();//"/Docs/" + Session.SessionID + "/" + FileName;
        }


        #endregion


        #region Export Container Movement Invoice By StuffingId

        [HttpPost]

        public JsonResult GeneratingPDFExportMovementByStuffingId(DSRBulkInvoiceReport ObjBulkInvoiceReport, string stuffingId)
        {
            var FileName = "";
            var location = "";
            string FilePath = "";
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            List<invoiceLIst> LstinvoiceLIst = new List<invoiceLIst>();

            ObjRR.GetInvoiceListByStuffingId(stuffingId);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                List<string> lstSB = new List<string>();
                LstinvoiceLIst = (List<invoiceLIst>)ObjRR.DBResponse.Data;
                LstinvoiceLIst.ToList().ForEach(item =>
                {
                    ObjBulkInvoiceReport.InvoiceModule = "EXPMovement";
                    ObjBulkInvoiceReport.InvoiceNumber = item.InvoiceNumber;
                    ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);//, objLogin.Uid

                    if (ObjRR.DBResponse.Status == 1)
                    {
                        DataSet ds = (DataSet)ObjRR.DBResponse.Data;

                        StringBuilder html = GeneratingExportMovementPDFforContainer(ds, ObjBulkInvoiceReport.InvoiceModuleName, "");
                        //string FilePath = GeneratingBulkPDF(DSRInvoiceGateList, ObjBulkInvoiceReport.InvoiceModuleName);
                        lstSB.Add(html.ToString());
                    }

                });



                //FileName = "EXPMovement" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                //location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                //if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                //{
                //    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                //}
                FileName = "EXPMovement" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
                using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
                {
                    rp.HeadOffice = "";
                    rp.HOAddress = "";
                    rp.ZonalOffice = "";
                    rp.ZOAddress = "";
                    rp.GeneratePDF(location, lstSB);
                }
                FilePath = "/Docs/" + Session.SessionID + "/" + FileName;
                return Json(new { Status = 1, Data = FilePath });

            }
            else
                return Json(new { Status = -1, Data = "No Record Found." });



        }

        [NonAction]
        public StringBuilder GeneratingExportMovementPDFforContainer(DataSet ds, string InvoiceModuleName, string All)
        {
            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            //  List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();
            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                }

                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td colspan='10' width='90%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'>" + InvoiceModuleName + "</label>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='12' style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%'>");
                html.Append("<table style='width:100%; font-size:9pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%'>");
                html.Append("<table style='width:100%; font-size:9pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");


                html.Append("<tr><td><hr/></td></tr>");
                html.Append("<tr><th style='text-align: left; font-size: 13px;margin-top: 10px;'><b>Assessment No :" + item.StuffingReqNo + "</b> ");
                html.Append("<br/><br/><b style='text-align: left; font-size: 13px;margin-top: 10px;'>Container / CBT Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:8pt;' cellspacing='0' cellpadding='8'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:6%;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>To Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>Days</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>Cargo Type</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align: center; width:8%;'>ODC Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    DateTime sdate = Convert.ToDateTime(elem.ArrivalDate);
                    DateTime edate = Convert.ToDateTime(elem.StuffingDate);
                    TimeSpan ts = edate - sdate;
                    int days = ts.Days;

                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:6%;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.StuffingDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>" + days + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.ODCType + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");


                html.Append("<tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container / CBT Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 150px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");
                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                // Round Up

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 110px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.RoundUp.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th></tr>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 110px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 11px; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                /*
                                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                                html.Append("<tbody>");

                                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total :</th>");
                                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'></th>");
                                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + totamt.ToString("0.##") + "</th>");
                                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                                html.Append("<tr>");
                                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                                html.Append("</tr>");
                                html.Append("<tr>");
                                html.Append("<th style='font-size: 11px; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                                html.Append("</tr>");
                                html.Append("</tbody>");
                                html.Append("</table>");*/


                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");
                // html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='4' width='20%'>SD Balance:<label style='font-weight: bold;'>" + objSDBalance.SDBalance.ToString() + "</label></td>");

                //html.Append("<tr><td style='font-size: 12px; text-align: left; line-height: 30px;'colspan='2'></td>");
                //html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;' colspan='2'>SD Balance:<label style='font-weight: bold;'>" + objSDBalance.SDBalance.ToString() + "</label></td></tr>");

                html.Append("<tr>");
                html.Append("<td style='font-size: 11px; text-align: left;' colspan='3' width='25%'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 11px; text-align: left;' colspan='3' width='25%'><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 11px; text-align: left;' colspan='3' width='25%'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 11px; text-align: left;' colspan='3' width='25%'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 9px; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");

                html.Append("</tbody>");
                html.Append("</table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            });
            /* if (All != "All")
             {
                 FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                 location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                 if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                 {
                     System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                 }
             }
             else
             {
                 FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                 location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                 if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                 {
                     System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                 }
             }*/
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            /* using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
             {
                 rp.HeadOffice = "";
                 rp.HOAddress = "";
                 rp.ZonalOffice = "";
                 rp.ZOAddress = "";
                 rp.GeneratePDF(location, lstSB);
             }
             return "/Docs/" + Session.SessionID + "/" + FileName;*/

            return html;
        }

        #endregion
        #region Export Loaded factory Stuffing Invoice By StuffingId

        [HttpPost]

        public JsonResult GeneratingPDFExportFactoryByStuffingId(DSRBulkInvoiceReport ObjBulkInvoiceReport, string stuffingId)
        {




            var FileName = "";
            var location = "";
            string FilePath = "";
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            List<invoiceLIst> LstinvoiceLIst = new List<invoiceLIst>();

            ObjRR.GetFactoryInvoiceListByStuffingId(stuffingId);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                List<string> lstSB = new List<string>();
                LstinvoiceLIst = (List<invoiceLIst>)ObjRR.DBResponse.Data;
                LstinvoiceLIst.ToList().ForEach(item =>
                {
                    ObjBulkInvoiceReport.InvoiceModule = "EXPLod";
                    ObjBulkInvoiceReport.InvoiceNumber = item.InvoiceNumber;
                    ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);//, objLogin.Uid

                    if (ObjRR.DBResponse.Status == 1)
                    {
                        DataSet ds = (DataSet)ObjRR.DBResponse.Data;

                        StringBuilder html = GeneratingExportFactoryPDFforContainer(ds, ObjBulkInvoiceReport.InvoiceModuleName, "");
                        //string FilePath = GeneratingBulkPDF(DSRInvoiceGateList, ObjBulkInvoiceReport.InvoiceModuleName);
                        lstSB.Add(html.ToString());
                    }

                });



                //FileName = "EXPMovement" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                //location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                //if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                //{
                //    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                //}
                FileName = "EXPMovement" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
                using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
                {
                    rp.HeadOffice = "";
                    rp.HOAddress = "";
                    rp.ZonalOffice = "";
                    rp.ZOAddress = "";
                    rp.GeneratePDF(location, lstSB);
                }
                FilePath = "/Docs/" + Session.SessionID + "/" + FileName;
                return Json(new { Status = 1, Data = FilePath });

            }
            else
                return Json(new { Status = -1, Data = "No Record Found." });



        }

        [NonAction]
        public StringBuilder GeneratingExportFactoryPDFforContainer(DataSet ds, string InvoiceModuleName, string All)
        {
            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            //  List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();
            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                }

                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td colspan='10' width='90%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'>" + InvoiceModuleName + "</label>");
                html.Append("</td></tr>");

                //html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                //html.Append("<td colspan='8' width='90%' style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                //html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                //html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Dashrath</span>");
                //html.Append("<br />" + InvoiceModuleName);
                //html.Append("</td></tr>");

                html.Append("<tr><td colspan='12' style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%'>");
                html.Append("<table style='width:100%; font-size:9pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%'>");
                html.Append("<table style='width:100%; font-size:9pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                //html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                //html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                //html.Append("<span>" + item.PartyName + "</span></td>");
                //html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                //html.Append("Party Address :</label> <span>" + item.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                //html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                //html.Append("</tr></tbody>");
                //html.Append("</table></td></tr>");

                html.Append("<tr><td><hr/></td></tr>");
                html.Append("<tr><th style='text-align: left; font-size: 13px;margin-top: 10px;'><b>Assessment No :" + item.StuffingReqNo + "</b> ");
                html.Append("<br/><br/><b style='text-align: left; font-size: 13px;margin-top: 10px;'>Container / CBT Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:8pt;' cellspacing='0' cellpadding='8'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:6%;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>Date of Arrival</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>Date of Carting</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>Date of Destuffing</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>Date of Delivery</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>No of Days</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>No of Week</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align: center; width:8%;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:6%;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + item.CartingDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + item.DestuffingDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>" + item.TotDays + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>" + item.TotWeeks + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; text-align: center; width:8%;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");

                // html.Append("<tr><td>");
                //html.Append("<table style=' border: 1px solid #000; width:100%;' cellspacing='0' cellpadding='5'>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='5'>Shipping Line : " + item.ShippingLineName + " </td></tr>");
                //html.Append("<tr><td style='font-size: 12px;'>Shipping Line No.:  </td>");
                //html.Append("<td style='font-size: 12px;'>OBL No :  </td>");
                //html.Append("<td style='font-size: 12px;'>Item No. : " + lstContainer.Where(x => x.InoviceId == item.InvoiceId).Count().ToString() + "</td>");
                //html.Append("<td style='font-size: 12px;'>BOE No : " + item.BOENo + " </td>");
                //html.Append("<td style='font-size: 12px;'>BOE Date : " + item.BOEDate + " </td>");
                //html.Append("</tr>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='3'>Importer : " + item.ExporterImporterName + " </td>");
                //html.Append("<td style='font-size: 12px;' colspan='2'>VALUE : " + (lstContainer.Where(m => m.InoviceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InoviceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InoviceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InoviceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='5'>CHA Name : " + item.CHAName + " </td></tr>");
                //html.Append("<tr><td style='font-size: 12px;'>No Of Pkg : " + item.TotalNoOfPackages.ToString() + " </td>");
                //html.Append("<td style='font-size: 12px;'>Total Gr.Wt (In Kg) : " + item.TotalGrossWt.ToString("0.000") + " </td>");
                //html.Append("<td style='font-size: 12px;'>Total Area (In Sqr Mtr) :  </td>");
                //html.Append("<td></td>");
                //html.Append("<td></td>");
                //html.Append("</tr>");
                //html.Append("</table>");

                //html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                //html.Append("<td colspan='6' width='50%'>");
                //html.Append("<table style='width:100%; font-size:9pt;' cellspacing='0' cellpadding='5'><tbody>");
                //html.Append("<tr><td colspan='6' width='30%'>Shipping Line</td><td>:</td><td colspan='6' width='70%'>" + item.ShippingLineName + "</td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>Shipping Line No.</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>OBL/HBL No.</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>Item No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer.Where(x => x.InoviceId == item.InvoiceId).Count().ToString() + "</td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>BOE No.</td><td>:</td><td colspan='6' width='70%'>" + item.BOENo + "</td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>BOE Date</td><td>:</td><td colspan='6' width='70%'>" + item.BOEDate + "</td></tr>");
                //html.Append("</tbody></table>");
                //html.Append("</td>");

                //html.Append("<td colspan='6' width='50%'>");
                //html.Append("<table style='width:100%; font-size:9pt;' cellspacing='0' cellpadding='5'><tbody>");
                //html.Append("<tr><td colspan='6' width='30%'>Importer</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                ////html.Append("<tr><td colspan='6' width='30%'>Value</td><td>:</td><td colspan='6' width='70%'>" + (lstContainer.Where(m => m.InoviceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InoviceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InoviceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InoviceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");            
                //html.Append("<tr><td colspan='6' width='30%'>FOB Value</td><td>:</td><td colspan='6' width='70%'>" + (lstContainer.Where(m => m.InoviceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + "</td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>CHA Name</td><td>:</td><td colspan='6' width='70%'>" + item.CHAName + "</td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>No Of Pkg</td><td>:</td><td colspan='6' width='70%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                //html.Append("</tbody></table>");
                //html.Append("</td>");

                //html.Append("</tr></tbody></table>");
                //html.Append("</td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container / CBT Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 150px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");
                /*

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + totamt.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 11px; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");*/
                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                // Round Up

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 110px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.RoundUp.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th></tr>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 110px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.##") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 11px; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");


                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");
                // html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='4' width='20%'>SD Balance:<label style='font-weight: bold;'>" + objSDBalance.SDBalance.ToString() + "</label></td>");

                //html.Append("<tr><td style='font-size: 12px; text-align: left; line-height: 30px;'colspan='2'></td>");
                //html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;' colspan='2'>SD Balance:<label style='font-weight: bold;'>" + objSDBalance.SDBalance.ToString() + "</label></td></tr>");

                html.Append("<tr>");
                html.Append("<td style='font-size: 11px; text-align: left;' colspan='3' width='25%'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 11px; text-align: left;' colspan='3' width='25%'><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 11px; text-align: left;' colspan='3' width='25%'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 11px; text-align: left;' colspan='3' width='25%'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 9px; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");

                html.Append("</tbody>");
                html.Append("</table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            });
            /* if (All != "All")
             {
                 FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                 location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                 if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                 {
                     System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                 }
             }
             else
             {
                 FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                 location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                 if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                 {
                     System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                 }
             }*/
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            /* using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
             {
                 rp.HeadOffice = "";
                 rp.HOAddress = "";
                 rp.ZonalOffice = "";
                 rp.ZOAddress = "";
                 rp.GeneratePDF(location, lstSB);
             }
             return "/Docs/" + Session.SessionID + "/" + FileName;*/

            return html;
        }

        #endregion
        #region ContainerArrivalReport



        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult ContainerArrivalReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Kdl_ReportRepository ObjReport = new Kdl_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetContainerArrivalReport(ContainerArrivalReport ObjContainerArrivalReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ContainerArrivalReport LstContainerArrivalReport = new ContainerArrivalReport();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.ContainerArrivalReport(ObjContainerArrivalReport);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstContainerArrivalReport = (ContainerArrivalReport)ObjRR.DBResponse.Data;

                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateContainerArrivalReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "ContainerArrivalReport.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Ppg_Report/ContainerArrivalReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Ppg_Report/ContainerArrivalReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }





        #endregion

        //#region Stock Position Report
        //[HttpGet]
        //public ActionResult StockPositionReport()
        //{
        //    return PartialView();
        //}

        #region Stock Position Report
        //[HttpGet]
        //public ActionResult StockPositionReport()
        //{
        //    return PartialView();
        //}

        //[HttpPost]
        //[ValidateAntiForgeryToken]
        //public ActionResult GetStockPositionReport(StockPositionReportModel ObjStockPosition)
        //{
        //    Kdl_ReportRepository ObjRR = new Kdl_ReportRepository();
        //    List<StockPositionReportModel> LstStockPosition = new List<StockPositionReportModel>();
        //    Login objLogin = (Login)Session["LoginUser"];
        //    ObjRR.StockPositionReport(ObjStockPosition);//, objLogin.Uid
        //    if (ObjRR.DBResponse.Data != null)
        //    {
        //        LstStockPosition = (List<StockPositionReportModel>)ObjRR.DBResponse.Data;
        //        return Json(ObjRR.DBResponse);
        //    }
        //    else
        //    {
        //        return Json(ObjRR.DBResponse);
        //    }

        //}

        //[HttpPost, ValidateInput(false)]
        //[CustomValidateAntiForgeryToken]
        //public JsonResult GenerateStockPositionReportPDF(FormCollection fc)
        //{
        //    try
        //    {

        //        var Pages = new string[1];
        //        var FileName = "StockPositionReport.pdf";
        //        Pages[0] = fc["Page"].ToString();
        //        string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/ChequeSummary/";
        //        if (!Directory.Exists(LocalDirectory))
        //            Directory.CreateDirectory(LocalDirectory);
        //        using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
        //        {
        //            ObjPdf.HeadOffice = this.HeadOffice;
        //            ObjPdf.HOAddress = this.HOAddress;
        //            ObjPdf.ZonalOffice = this.ZonalOffice;
        //            ObjPdf.ZOAddress = this.ZOAddress;
        //            ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

        //        }
        //        var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/ChequeSummary/" + FileName };
        //        return Json(ObjResult);
        //    }
        //    catch (Exception ex)
        //    {
        //        return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
        //    }

        //}
        #endregion
        //}
        //#endregion

        #region CashReceiptInvoiceLedgerReport Partywise
        public ActionResult CashReceiptInvoiceLedgerReport()
        {
            AccessRightsRepository ACCR = new AccessRightsRepository();
            ACCR.GetMenuWiseAccessRight(Convert.ToInt32(Session["MenuId"]), ((Login)Session["LoginUser"]).Role.RoleId, Convert.ToInt32(Session["ModuleId"]),
                Convert.ToInt32(Session["BranchId"]));
            ViewBag.RightsList = JsonConvert.SerializeObject(ACCR.DBResponse.Data);

            ImportRepository objImport = new ImportRepository();
            objImport.GetPaymentParty();
            if (objImport.DBResponse.Status > 0)
                ViewBag.PaymentParty = JsonConvert.SerializeObject(objImport.DBResponse.Data);
            else
                ViewBag.PaymentParty = null;


            return PartialView();
        }

        [HttpPost]
        public JsonResult GetCashReceiptInvoiceLedgerReport(int partyId, string fromdate, string todate)
        {
            try
            {
                DSR_ReportRepository Repo = new DSR_ReportRepository();
                Repo.GetCrInvLedgerReport(partyId, Convert.ToDateTime(fromdate).ToString("yyyy-MM-dd"), Convert.ToDateTime(todate).ToString("yyyy-MM-dd"), ZonalOffice, ZOAddress);
                object obj = Repo.DBResponse;
                return Json(obj, JsonRequestBehavior.AllowGet);
            }
            catch (Exception ex)
            {
                return Json(new { Status = 0, Data = "", Message = ex.Message.ToString() }, JsonRequestBehavior.AllowGet);
            }

        }
        #endregion

        #region WorkSlip
        public ActionResult WorkSlipReport()
        {
            return PartialView();
        }

        [HttpPost]
        public JsonResult GetWorkSlipReport(string PeriodFrom, string PeriodTo, string ImportExport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            string FilePath = "";
            string fdt = Convert.ToDateTime(PeriodFrom).ToString("yyyy-MM-dd");
            string tdt = Convert.ToDateTime(PeriodTo).ToString("yyyy-MM-dd");
            ObjRR.WorkSlipDetailsForPrint(fdt, tdt, ImportExport, objLogin.Uid);//, objLogin.Uid
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                FilePath = GeneratingPDFforWS(ds, Convert.ToDateTime(PeriodFrom).ToString("dd-MMM-yy"), Convert.ToDateTime(PeriodTo).ToString("dd-MMM-yy"));
                return Json(new { Status = 1, Data = FilePath });
            }
            else
                return Json(new { Status = -1, Data = "No Record Found." });
        }

        [NonAction]
        public string GeneratingPDFforWS(DataSet ds, string dt, string dtt)
        {

            List<dynamic> objWs = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();

            List<dynamic> objImport = objWs.Where(o => o.Operation == "Import").ToList();
            List<dynamic> objExport = objWs.Where(o => o.Operation == "Export").ToList();
            List<dynamic> objGeneral = objWs.Where(o => o.Operation == "General").ToList();

            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
            html.Append("<tr><td colspan='12'>");

            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td><td width='100%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>ICD Dashrath</label><br/><label style='font-size: 12px;'>Inland Container Depot.</label><br/><label style='font-size: 14px; font-weight:bold;'>Workslip</label></td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");

            html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>");
            html.Append("<tr><td align='left' colspan='4' width='33.33333333333333%'><b>WorkSlip No :</b> " + objImport[0].WorkSlipNo + "</td><td align='left' colspan='4' width='33.33333333333333%'><b>From Date of Operation :</b> " + dt + "</td><td align='left' colspan='4' width='33.33333333333333%'><b>To Date of Operation :</b> " + dtt + "</td></tr>");
            html.Append("</tbody></table></td></tr>");
            string cfscont20 = "";
            string cfscont40 = "";
            //IMPORT
            objImport.ForEach(item =>
            {
                if (item.WSClause == "2(A)" || item.WSClause == "2(B)")
                {
                    cfscont20 += item.CFSCodeCont20 + ",";
                    cfscont40 += item.CFSCodeCont40 + ",";
                }
            });
            objImport.ForEach(item =>
            {
                if (item.WSClause == "1(A)")
                {
                    html.Append("<tr><td colspan='12'>");
                    html.Append("<table cellspacing='0' cellpadding='5' style='text-align: left; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
                    html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Import Operation :</th></tr>");

                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
                    html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI-1</th></tr>");
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of loaded container from Mumbai to ICD-Dashrath.(Including Lift off at ICD)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "1(B)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(B) Transportation of loaded container from Mundra/pipavav/Kandla to ICD-Dashrath.(Including Lift off at ICD)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "1(C)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(C) Transportation of loaded container from Hazira to ICD-Dashrath.(Including Lift off at ICD)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "1(D)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(D) Transportation of loaded container from RCT to ICD (Including Lift off at ICD)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("</tbody></table></td></tr>");
                }
                if (item.WSClause == "2(A)")

                {

                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt; '><tbody>");
                    html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI(2-A)</th></tr>");
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(a) Custom Examination/Destuffing. (Upto 25% Cargo Handling)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "2(B)")

                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(b) Custom Examination/Destuffing. (Beyond 25% Cargo Handling)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "2(C)")

                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI(2-B):</b> RMS VERIFICATION</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("</tbody></table></td></tr>");
                }
                if (item.WSClause == "3(A)")

                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI(3):</b> Destuffing of Import Loaded Container.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "4(A1)")

                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 4:</b> Cargo Delivery</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; font-size:8pt; '><tbody>");
                    html.Append("<tr><td colspan='12'><b>(a)</b> Cargo Delivery alongwith Custom Examination of Cargo</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Manual</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
                    html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.NoOfPackage + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.ManualWT + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                }
                if (item.WSClause == "4(A2)")

                {
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Mechanical</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
                    html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.NoOfPackage + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.MechanicalWT + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("</tbody></table></td>");
                }
                if (item.WSClause == "4(B1)")

                {
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; font-size:8pt; '><tbody>");
                    html.Append("<tr><td colspan='12'><b>(b)</b> Cargo Delivery of already Examined Cargo</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Manual</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
                    html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.NoOfPackage + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.ManualWT + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                }
                if (item.WSClause == "4(B2)")

                {
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Mechanical</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
                    html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.NoOfPackage + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.MechanicalWT + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("</tbody></table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "20(A)")
                {
                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-A (i):</b> Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath (Including Lift Off of Empty Container) Distance Upto 10km</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "20(B)")
                {
                    html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
                    html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 10-30km</td></tr>");
                    //html.Append("<tr><td colspan='12'>Dynamic</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "20(C)")
                {
                    html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
                    html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 30-50km</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "20(D)")
                {
                    html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
                    html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 50-75km</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "20(E)")
                {
                    html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
                    html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 75-100km</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "20(F)")
                {
                    html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
                    html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 100km</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("</tbody></table></td></tr>");
                }
                if (item.WSClause == "20(A1)")
                {
                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-A (ii):</b> Transportation of Import Loaded Container to factory for destuffing and Empty back to RCT(CONCOR)</td></tr>");

                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr></tbody></table></td></tr>");
                    html.Append("</tbody></table></td></tr>");

                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-A (iii):</b> Transportation of Import Loaded Container to factory for destuffing and Empty back to Mumbai</td></tr>");

                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr></tbody></table></td></tr>");
                    html.Append("</tbody></table></td></tr>");
                }

                if (item.WSClause == "20(A2)")
                {
                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-A (iv):</b> Transportation of Import Loaded Container to factory for destuffing and Empty back to Hazira</td></tr>");

                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + "0" + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + "0" + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + "0" + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + "0" + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + "0" + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + "0" + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + "0" + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + "0" + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + "0" + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + "0" + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + "0" + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + "0" + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr></tbody></table></td></tr>");
                    html.Append("</tbody></table></td></tr>");
                }

                if (item.WSClause == "21(A)")
                {
                    html.Append("<tr><th colspan='12'>BONDED WAREHOUSING TRANSACTION</th></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='4' style='border-bottom: 1px solid #000;'>Shifted to PBW (XXI-15)</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000;'>Manual</th>");
                    html.Append("<th colspan='2'>Mechanical</th>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Wt.Qtl</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package</th>");
                    html.Append("<th style='border-top: 1px solid #000;'>Wt.Qtl</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");

                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.NoOfPackage + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.ManualWT + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.NoOfPackageMech + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.MechanicalWT + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                }
                if (item.WSClause == "XXI-4(A)")
                {
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='4' style='border-bottom: 1px solid #000;'>Ex-Bond XXI-4 (B)</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='2' style='border-right: 1px solid #000;'>Manual</th>");
                    html.Append("<th colspan='2'>Mechanical</th>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Wt.Qtl</th>");
                    html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package</th>");
                    html.Append("<th style='border-top: 1px solid #000;'>Wt.Qtl</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");

                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.NoOfPackage + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.ManualWT + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.NoOfPackageMech + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.MechanicalWT + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }


            });
            html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI(21-b):</b> Bothway Loaded Containers Transportation of Import Loaded container from ICD to factory and return back loaded container to ICD (including loaded Lift off at ICD.)</td></tr>");
            html.Append("<tr>");
            html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            html.Append("<thead>");
            html.Append("<tr>");
            html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            html.Append("<th>40FT</th>");
            html.Append("</tr>");
            html.Append("</thead>");
            html.Append("<tbody>");
            html.Append("<tr>");
            html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + "0" + "</td>");
            html.Append("<td style='border-top: 1px solid #000;'>" + "0" + "</td>");
            html.Append("</tr>");
            html.Append("</tbody>");
            html.Append("</table></td>");
            html.Append("</tr>");
            html.Append("<tr>");
            html.Append("<td colspan='2' width='20%'>Summary :</td>");
            html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            html.Append("<thead>");
            html.Append("<tr>");
            html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            html.Append("<th>40FT</th>");
            html.Append("</tr>");
            html.Append("</thead>");

            html.Append("<tbody>");
            html.Append("<tr>");
            html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
            html.Append("<td style='border-top: 1px solid #000;'>0</td>");
            html.Append("</tr>");
            html.Append("</tbody>");
            html.Append("</table></td>");

            html.Append("</tr>");


            var varcfscont20 = "";
            var varcfscont40 = "";
            var varCount20 = "";
            var varCount40 = "";

            objImport.ForEach(x =>
            {
                if (x.WSClause == "XXII-5 (1)")
                {
                    varcfscont20 = Convert.ToString(x.CFSCodeCont20);
                    varcfscont40 = Convert.ToString(x.CFSCodeCont40);
                    varCount20 = Convert.ToString(x.Count20);
                    varCount40 = Convert.ToString(x.Count40);

                }
            });




            //Add Chiranjit For New Work Order

            html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (1):</b> Transportation of Loaded Container from ICD Varnama to ICD-Dashrath with Lift off </td></tr>");
            html.Append("<tr>");
            html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            html.Append("<thead>");
            html.Append("<tr>");
            html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            html.Append("<th>40FT</th>");
            html.Append("</tr>");
            html.Append("</thead>");
            html.Append("<tbody>");
            html.Append("<tr>");
            html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + varcfscont20 + "</td>");
            html.Append("<td style='border-top: 1px solid #000;'>" + varcfscont40 + "</td>");
            html.Append("</tr>");
            html.Append("</tbody>");
            html.Append("</table></td>");
            html.Append("</tr>");
            html.Append("<tr>");
            html.Append("<td colspan='2' width='20%'>Summary :</td>");
            html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            html.Append("<thead>");
            html.Append("<tr>");
            html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            html.Append("<th>40FT</th>");
            html.Append("</tr>");
            html.Append("</thead>");

            html.Append("<tbody>");
            html.Append("<tr>");
            html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + varCount20 + "</td>");
            html.Append("<td style='border-top: 1px solid #000;'>" + varCount40 + "</td>");
            html.Append("</tr>");
            html.Append("</tbody>");
            html.Append("</table></td>");

            html.Append("</tr>");


            varcfscont20 = "";
            varcfscont40 = "";
            varCount20 = "";
            varCount40 = "";

            //objImport.ForEach(x =>
            //{
            //    if (x.WSClause == "XXII-5 (6)")
            //    {
            //        varcfscont20 = Convert.ToString(x.CFSCodeCont20);
            //        varcfscont40 = Convert.ToString(x.CFSCodeCont40);
            //        varCount20 = Convert.ToString(x.Count20);
            //        varCount40 = Convert.ToString(x.Count40);

            //    }
            //});

            //html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (6):</b> Factory destuffing empty to ICD-Varnama </td></tr>");
            //html.Append("<tr>");
            //html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //html.Append("<tr>");
            //html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //html.Append("</tr>");
            //html.Append("</thead>");
            //html.Append("<tbody>");
            //html.Append("<tr>");
            //html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + varcfscont20 + "</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>" + varcfscont40 + "</td>");
            //html.Append("</tr>");
            //html.Append("</tbody>");
            //html.Append("</table></td>");
            //html.Append("</tr>");
            //html.Append("<tr>");
            //html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //html.Append("<tr>");
            //html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //html.Append("</tr>");
            //html.Append("</thead>");

            //html.Append("<tbody>");
            //html.Append("<tr>");
            //html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + varCount20 + "</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>" + varCount40 + "</td>");
            //html.Append("</tr>");
            //html.Append("</tbody>");
            //html.Append("</table></td>");

            //html.Append("</tr>");


            objImport.ForEach(item =>
            {
                if (item.WSClause == "XXII-5 (5) (i)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (5) (i):</b> Transportation of Import Loaded Container from ICD Dashrath to factory for destuffing and back to ICD-Varnama, Distance Upto 10 km  </td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");

                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("</tr>");


                }

                if (item.WSClause == "XXII-5 (5) (ii)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (5) (ii):</b> Transportation of Import Loaded Container from ICD Dashrath to factory for destuffing and back to ICD-Varnama, Distance >10-30 km   </td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");

                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("</tr>");


                }

                if (item.WSClause == "XXII-5 (5) (iii)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (5) (iii):</b> Transportation of Import Loaded Container from ICD Dashrath to factory for destuffing and back to ICD-Varnama, Distance >30-50 km   </td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");

                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("</tr>");


                }

                if (item.WSClause == "XXII-5 (5) (iv)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (5) (iv):</b> Transportation of Import Loaded Container from ICD Dashrath to factory for destuffing and back to ICD-Varnama, Distance >50-75 km   </td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");

                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("</tr>");


                }

                if (item.WSClause == "XXII-5 (5) (v)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (5) (v):</b> Transportation of Import Loaded Container from ICD Dashrath to factory for destuffing and back to ICD-Varnama, Distance >75-100 km  </td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");

                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("</tr>");


                }
                if (item.WSClause == "XXII-5 (5) (vi)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (5) (vi):</b> Transportation of Import Loaded Container from ICD Dashrath to factory for destuffing and back to ICD-Varnama, Distance >100 km  </td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");

                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("</tr>");


                }

            });







            html.Append("<tr><td><br/><br/><br/><br/></td></tr>");
            html.Append("<tr>");
            html.Append("<th colspan='3' width='25%'>HTC Representative</th>");
            html.Append("<th colspan='3' width='25%'>Import Incharge</th>");
            html.Append("<th colspan='3' width='25%'>PBW Incharge</th>");
            html.Append("<th colspan='3' width='25%'>Manager-ICD</th>");
            html.Append("</tr>");

            html.Append("</tbody></table>");
            html.Append("</td></tr>");



            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='5' style='font-size:12px; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
            html.Append("<tr><td><br/><br/><br/></td></tr>");
            html.Append("<tr><th colspan='2'>Name & Sign of H & T Contractor</th>");
            html.Append("<th colspan='1'></th>");
            html.Append("<th colspan='2'>Name & Sign of Supdt.Imp./Exp/Wh/C.U.</th>");
            html.Append("<th colspan='1'></th>");
            html.Append("<th colspan='2'>Name & Sign of S.A.M(Imp.) S.A.M. [Imp.][Exp.] Wh.</th>");
            html.Append("<th colspan='1'></th>");
            html.Append("<th colspan='2'>Name & Sign of Manager ICD</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");
            html.Append("</tbody></table>");

            html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            lstSB.Add(html.ToString());

            var FileName = "WorkSlipReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;


            //         List<dynamic> objWs = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //         List<string> lstSB = new List<string>();
            //         StringBuilder html = new StringBuilder();

            //         List<dynamic> objImport = objWs.Where(o => o.Operation == "Import").ToList();
            //         List<dynamic> objExport = objWs.Where(o => o.Operation == "Export").ToList();
            //         List<dynamic> objGeneral = objWs.Where(o => o.Operation == "General").ToList();

            //         html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
            //         html.Append("<tr><td colspan='12'>");

            //         html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            //         html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td><td width='100%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>ICD Dashrath</label><br/><label style='font-size: 12px;'>Inland Container Depot.</label><br/><label style='font-size: 14px; font-weight:bold;'>Workslip</label></td></tr>");
            //         html.Append("</tbody></table>");
            //         html.Append("</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>");
            //         html.Append("<tr><td align='left' colspan='4' width='33.33333333333333%'><b>WorkSlip No :</b> " + objImport[0].WorkSlipNo + "</td><td align='left' colspan='4' width='33.33333333333333%'><b>From Date of Operation :</b> " + dt + "</td><td align='left' colspan='4' width='33.33333333333333%'><b>To Date of Operation :</b> " + dtt + "</td></tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         //IMPORT
            //         html.Append("<tr><td colspan='12'>");
            //         html.Append("<table cellspacing='0' cellpadding='5' style='text-align: left; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Import Operation :</th></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI-1</th></tr>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of loaded container from Mumbai to ICD-Dashrath.(Including Lift off at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //   html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //   html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(B) Transportation of loaded container from Mundra/pipavav/Kandla to ICD-Dashrath.(Including Lift off at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(C) Transportation of loaded container from Hazira to ICD-Dashrath.(Including Lift off at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(D) Transportation of loaded container from RCT to ICD (Including Lift off at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt; '><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI(2-A)</th></tr>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(a) Custom Examination/Destuffing. (Upto 25% Cargo Handling)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(b) Custom Examination/Destuffing. (Beyond 25% Cargo Handling)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI(2-B):</b> Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI(3):</b> Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");		
            //   html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 4:</b> Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; font-size:8pt; '><tbody>");
            //         html.Append("<tr><td colspan='12'><b>(a)</b> Cargo Delivery alongwith Custom Examination of Cargo</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Manual</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
            //html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Mechanical</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
            //html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td>");

            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; font-size:8pt; '><tbody>");
            //         html.Append("<tr><td colspan='12'><b>(b)</b> Cargo Delivery of already Examined Cargo</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Manual</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
            //html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Mechanical</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
            //html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");		
            //   html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-A (i):</b> Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 10-30km</td></tr>");
            //         html.Append("<tr><td colspan='12'>Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 30-50km</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 50-75km</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 75-100km</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 100km</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");

            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //   html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-A (ii):</b> Transportation of Import Loaded Container to factory for destuffing and Empty back to RCT(CONCOR)</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr></tbody></table></td></tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //   html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-A (iii):</b> Transportation of Import Loaded Container to factory for destuffing and Empty back to Mumbai</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr></tbody></table></td></tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-A (iv):</b> Transportation of Import Loaded Container to factory for destuffing and Empty back to Hazira</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr></tbody></table></td></tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><th colspan='12'>BONDED WAREHOUSING TRANSACTION</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='4' style='border-bottom: 1px solid #000;'>Shifted to PBW (XXI-15)</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='2' style='border-right: 1px solid #000;'>Manual</th>");
            //html.Append("<th colspan='2'>Mechanical</th>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package</th>");
            //html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Wt.Qtl</th>");
            //html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package</th>");
            //html.Append("<th style='border-top: 1px solid #000;'>Wt.Qtl</th>");
            //html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='4' style='border-bottom: 1px solid #000;'>Ex-Bond XXI-4 (B)</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='2' style='border-right: 1px solid #000;'>Manual</th>");
            //html.Append("<th colspan='2'>Mechanical</th>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package</th>");
            //html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Wt.Qtl</th>");
            //html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package</th>");
            //html.Append("<th style='border-top: 1px solid #000;'>Wt.Qtl</th>");
            //html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI(21-b):</b> Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("</tr>");


            //         html.Append("<tr><td><br/><br/><br/><br/></td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='3' width='25%'>HTC Representative</th>");
            //      html.Append("<th colspan='3' width='25%'>Import Incharge</th>");
            //      html.Append("<th colspan='3' width='25%'>PBW Incharge</th>");
            //      html.Append("<th colspan='3' width='25%'>Manager-ICD</th>");        
            //         html.Append("</tr>");

            //         html.Append("</tbody></table>");
            //         html.Append("</td></tr>");

            //         //EXPORT
            //         html.Append("<tr><td colspan='12'>");
            //         html.Append("<table cellspacing='0' cellpadding='5' style='text-align: left; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Export Operation :</th></tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI (5): (Carting)</b> Unloading  of cargo from Truck/Vechicle and Stacking in the same in Godown/Open Yard.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; font-size:8pt; '><tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Manual</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
            //         html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Mechanical</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
            //         html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI (6): (Examination)</b> Examination of Export Cargo, Placement of Empty Container, Stuffinf, Sealing & Internal Shifting of Loaded Container.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI (7): (Direct Stuffing)</b> Unloading the Cargo from Truck/Vechile, Examination of Export Cargo, Placement of Empty Container, Stuffing the same in container, Sealing & shifting of Loaded Container.</th></tr>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of loaded container from Mumbai to ICD-Dashrath.(Including Lift off at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI (8)</th></tr>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of loaded container from ICD-Dashrath to Mumbai.(Including Lift on at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(B) Transportation of loaded container from ICD-Dashrath to Mundra/pipavav/Kandla.(Including Lift on at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(C) Transportation of loaded container from ICD-Dashrath to Hazira.(Including Lift on at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(D) Transportation of loaded container from ICD to RCT (CONCOR) (Including Lift on at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI-20-B (i) :</b>Transportation of Empty Loaded Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance up to 10km</td></tr>");
            //         html.Append("<tr><td colspan='12'>Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Empty Loaded Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance >30-50</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Empty Loaded Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance > 50-75</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Empty Loaded Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance > 75-100</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Empty Loaded Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance > 100</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-B (ii):</b> Transportation of Empty Container from RCT(CORNOR) to factory for stuffing and Loaded Back to ICD-Dashrath (Including Loaded Lift off at ICD) Distance</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr></tbody></table></td></tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-B (iii):</b> Transportation of Empty Container from Mumbai to factory for stuffing and Loaded Back to ICD-Dashrath (Including Loaded Lift off at ICD) Distance</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr></tbody></table></td></tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-B (iv):</b> Transportation of Empty Container from Hazira to factory for stuffing and Loaded Back to ICD-Dashrath (Including Loaded Lift off at ICD) Distance</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr></tbody></table></td></tr>");
            //         html.Append("</tbody></table></td></tr>");            

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 21 (a):</b> Bothway Empty Container :- Transportation of Empty Container from ICD to factory and return back empty container at ICD (Including empty Lift off at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");


            //         html.Append("<tr><td><br/><br/><br/><br/></td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='4' width='33.33333333333333%'>HTC Representative</th>");
            //         html.Append("<th colspan='4' width='33.33333333333333%'>Export Incharge</th>");
            //         html.Append("<th colspan='4' width='33.33333333333333%'>Manager-ICD</th>");
            //         html.Append("</tr>");

            //         html.Append("</tbody></table>");
            //         html.Append("</td></tr>");

            //         //GENERAL
            //         html.Append("<tr><td colspan='12'>");
            //         html.Append("<table cellspacing='0' cellpadding='5' style='text-align: left; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>General Operation :</th></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI (9)</th></tr>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of CBT between ICD and Mumbai (Including Stuffing/Destuffing at ICD).</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(B) Transportation of Export CBT from ICD to Ahmedabad (Including Stuffing/Destuffing at ICD).</td></tr>");            
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI-10</th></tr>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of Empty Containers From CWC-ICD to Mumbai.</td></tr>");            
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(B) Transportation of Empty Containers From CWC-ICD to Kandla/Pipavav/Mundra.</td></tr>");           
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(C) Transportation of Empty Containers From CWC-ICD to RCT Vadodara.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(D) Transportation of Empty Containers From CWC-ICD to Hazira.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>"); 

            //         html.Append("<tr><td colspan='12'><b>Clause XXI -11 (i) :</b>Internal Shifting of Empty Container in ICD.</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance up to 10km</td></tr>");
            //         html.Append("<tr><td colspan='12'>Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI -11 (ii) :</b>Internal Shifting of Loaded Container in ICD.</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance up to 10km</td></tr>");
            //         html.Append("<tr><td colspan='12'>Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI-12 (i) :</b>LIFT ON/OFF OF EMPTY CONTAINERS ARRIVED AT ICD-DASHRATH.</td></tr>");
            //         html.Append("<tr><td colspan='12'>(1) Lift off Empty Container arrived at ICD.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>(2) Lift off Import Private FD Empty Container.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>(3) Lift on Empty Containers Moved Private for FS.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>(4) Lift on Empty Containers Moved Private.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI-12 (ii) :</b>Lift on/off of Loaded Container</td></tr>");
            //         html.Append("<tr><td colspan='12'>(1) Lift on Import LD Container Moved for FD.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>(2) Lift On/off LD FS Containers Private Movement.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI (13) :</b> Shifting of Empty Container between ICD and CW-Karachia (Including Lift on)</td></tr>");            
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI (14) :</b> Shifting of Empty Container from any location withhin ICD complex for washing/cleaning.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; font-size:8pt;'><tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='4' width='33.33333333333333%'><b>Clause XXI (15) :</b> Internal Shifting of Cargowithin ICD complex for weighment or other purpose. <div style='border: 1px solid #000; padding:5px;'>Dynamic</div></td>");

            //         html.Append("<td colspan='4' width='33.33333333333333%'><table cellspacing='0' cellpadding='5' style='text-align:center; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12'><b>Clause XXI (16) :</b> Palletization of cargo.</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border: 1px solid #000;'>Package</th>");
            //         html.Append("<th colspan='6' width='50%' style='border: 1px solid #000; border-left:0;'>Weight in .Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border: 1px solid #000; border-left:0;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='4' width='33.33333333333333%'><b>Clause XXI (17) Bagging:</b> Providing labourfor filling of loose cargo in to fresh bags. <div style='border: 1px solid #000; padding:5px;'>Dynamic</div></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI (18) :</b> Reworking of Container: (a) Upto 25% Cargo Handling.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI (18) :</b> Reworking of Container: (b) Beyond 25% Cargo Handling.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><th colspan='12'><b>Clause XXI (19) </b> Container weighment:- Lift on and movt. of LD Cont. from ICD complex to CW-Karachia/other LWB Within 5 Kms and back to ICD.</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Summary of Containers</th></tr>");
            //         html.Append("<tr><th style='border-right: 1px solid #000;'></th>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th></tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr><th style='border-right: 1px solid #000;'>Loaded</th>");
            //         html.Append("<th style='border-right: 1px solid #000;'>Dynamic</th>");
            //         html.Append("<th>Dynamic</th></tr>");
            //         html.Append("<tr><th style='border-right: 1px solid #000;'>Empty</th>");
            //         html.Append("<th style='border-right: 1px solid #000;'>Dynamic</th>");
            //         html.Append("<th>Dynamic</th></tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Summary</th></tr>");
            //         html.Append("<tr><th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th></tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr><th style='border-right: 1px solid #000;'>Dynamic</th>");
            //         html.Append("<th>Dynamic</th></tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='4' width='33.33333333333333%'><b>Clause XXI (22) :</b> Supply of Causal labour.</td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td><br/><br/><br/><br/></td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='4' width='33.33333333333333%'>HTC Representative</th>");
            //         html.Append("<th colspan='4' width='33.33333333333333%'>IMP/EXP Incharge</th>");
            //         html.Append("<th colspan='4' width='33.33333333333333%'>Manager-ICD</th>");
            //         html.Append("</tr>");

            //         html.Append("</tbody></table>");
            //         html.Append("</td></tr>");
            //         //End

            //         html.Append("</tbody></table>");

            //         html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            //         lstSB.Add(html.ToString());

            //         var FileName = "WorkSlipReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            //         var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            //         if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            //         {
            //             System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            //         }
            //         /*if (System.IO.File.Exists(location))
            //         {
            //             System.IO.File.Delete(location);
            //         }*/

            //         using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 40f, 20f, 20f, false, true))
            //         {
            //             rp.HeadOffice = "";
            //             rp.HOAddress = "";
            //             rp.ZonalOffice = "";
            //             rp.ZOAddress = "";
            //             rp.GeneratePDF(location, lstSB);
            //         }
            //         return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        public ActionResult WorkSlipReportExport()
        {
            return PartialView();
        }

        [HttpPost]
        public JsonResult GetWorkSlipReportExport(string PeriodFrom, string PeriodTo, string ImportExport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            string FilePath = "";
            string fdt = Convert.ToDateTime(PeriodFrom).ToString("yyyy-MM-dd");
            string tdt = Convert.ToDateTime(PeriodTo).ToString("yyyy-MM-dd");
            ObjRR.WorkSlipDetailsForPrintExport(fdt, tdt, ImportExport, objLogin.Uid);//, objLogin.Uid
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                FilePath = GeneratingPDFforWSExport(ds, Convert.ToDateTime(PeriodFrom).ToString("dd-MMM-yy"), Convert.ToDateTime(PeriodTo).ToString("dd-MMM-yy"));
                return Json(new { Status = 1, Data = FilePath });
            }
            else
                return Json(new { Status = -1, Data = "No Record Found." });
        }

        [NonAction]
        public string GeneratingPDFforWSExport(DataSet ds, string dt, string dtt)
        {

            List<dynamic> objWs = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();

            List<dynamic> objImport = objWs.Where(o => o.Operation == "Import").ToList();
            List<dynamic> objExport = objWs.Where(o => o.Operation == "Export").ToList();
            List<dynamic> objGeneral = objWs.Where(o => o.Operation == "General").ToList();

            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td><td width='100%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>ICD Dashrath</label><br/><label style='font-size: 12px;'>Inland Container Depot.</label><br/><label style='font-size: 14px; font-weight:bold;'>Workslip</label></td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");

            html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>");
            html.Append("<tr><td align='left' colspan='4' width='33.33333333333333%'><b>WorkSlip No :</b> " + objExport[0].WorkSlipNo + "</td><td align='left' colspan='4' width='33.33333333333333%'><b>From Date of Operation :</b> " + dt + "</td><td align='left' colspan='4' width='33.33333333333333%'><b>To Date of Operation :</b> " + dtt + "</td></tr>");
            html.Append("</tbody></table></td></tr>");

            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='5' style='text-align: left; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
            objExport.ForEach(item =>
            {
                if (item.WSClause == "XXI-5(A)")
                {
                    html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Export Operation :</th></tr>");

                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI (5): (Carting)</b> Unloading  of cargo from Truck/Vechicle and Stacking in the same in Godown/Open Yard.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; font-size:8pt; '><tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Manual</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
                    html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.NoOfPackage + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.ManualWT + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                }
                if (item.WSClause == "XXI-5(B)")
                {
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Mechanical</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
                    html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.NoOfPackage + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>" + item.MechanicalWT + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("</tbody></table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "XXI-6")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI (6): (Examination)</b> Examination of Export Cargo, Placement of Empty Container, Stuffinf, Sealing & Internal Shifting of Loaded Container.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "XXI-7")
                {
                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
                    html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI (7): (Direct Stuffing)</b> Unloading the Cargo from Truck/Vechile, Examination of Export Cargo, Placement of Empty Container, Stuffing the same in container, Sealing & shifting of Loaded Container.</th></tr>");
                    // html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of loaded container from Mumbai to ICD-Dashrath.(Including Lift off at ICD)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "8(A)")
                {
                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
                    html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI (8)</th></tr>");
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of loaded container from ICD-Dashrath to Mumbai.(Including Lift on at ICD)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }

                if (item.WSClause == "8(B)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(B) Transportation of loaded container from ICD-Dashrath to Mundra/pipavav/Kandla.(Including Lift on at ICD)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "8(C)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(C) Transportation of loaded container from ICD-Dashrath to Hazira.(Including Lift on at ICD)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "8(D)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(D) Transportation of loaded container from ICD to RCT (CONCOR) (Including Lift on at ICD)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("</tbody></table></td></tr>");
                }


                if (item.WSClause == "20-B (i)")
                {
                    html.Append("<tr><td colspan='12'><b>Clause XXI-20-B (i) :</b>Transportation of Empty  Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
                    html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance up to 10km</td></tr>");
                    html.Append("<tr><td colspan='12'></td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }

                if (item.WSClause == "20-B (ii)")
                {
                    html.Append("<tr><td colspan='12'>Transportation of Empty  Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
                    html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance >10-30</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }

                if (item.WSClause == "20-B (iii)")
                {
                    html.Append("<tr><td colspan='12'>Transportation of Empty  Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
                    html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance > 30-50</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "20-B (iv)")
                {
                    html.Append("<tr><td colspan='12'>Transportation of Empty  Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
                    html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance > 50-75</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }


                if (item.WSClause == "20-B (v)")
                {
                    html.Append("<tr><td colspan='12'>Transportation of Empty  Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
                    html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance > 75-100</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "20-B (vi)")
                {
                    html.Append("<tr><td colspan='12'>Transportation of Empty  Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
                    html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance > 100</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("</tbody></table></td></tr>");
                }

                if (item.WSClause == "XXI-21")
                {
                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-B (ii):</b> Transportation of Empty Container from RCT(CORNOR) to factory for stuffing and Loaded Back to ICD-Dashrath (Including Loaded Lift off at ICD) Distance</td></tr>");

                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr></tbody></table></td></tr>");
                    html.Append("</tbody></table></td></tr>");

                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-B (iii):</b> Transportation of Empty Container from Mumbai to factory for stuffing and Loaded Back to ICD-Dashrath (Including Loaded Lift off at ICD) Distance</td></tr>");

                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr></tbody></table></td></tr>");
                    html.Append("</tbody></table></td></tr>");

                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-B (iv):</b> Transportation of Empty Container from Hazira to factory for stuffing and Loaded Back to ICD-Dashrath (Including Loaded Lift off at ICD) Distance</td></tr>");

                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");

                    html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th colspan='6' width='50%'>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr></tbody></table></td></tr>");
                    html.Append("</tbody></table></td></tr>");

                }
                if (item.WSClause == "XXI-22")
                {

                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 21 (a):</b> Bothway Empty Container :- Transportation of Empty Container from ICD to factory and return back empty container at ICD (Including empty Lift off at ICD)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>0</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
            });

            var varcfscont20 = "";
            var varcfscont40 = "";
            var varCount20 = "";
            var varCount40 = "";

            objExport.ForEach(x =>
            {
                if (x.WSClause == "XXII-5 (2)")
                {
                    varcfscont20 = Convert.ToString(x.CFSCodeCont20);
                    varcfscont40 = Convert.ToString(x.CFSCodeCont40);
                    varCount20 = Convert.ToString(x.Count20);
                    varCount40 = Convert.ToString(x.Count40);

                }
            });



            html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (2):</b>Transportation of Loaded Container from ICD Dashrath to ICD-Vamama with lft on</td></tr>");
            html.Append("<tr>");
            html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            html.Append("<thead>");
            html.Append("<tr>");
            html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            html.Append("<th>40FT</th>");
            html.Append("</tr>");
            html.Append("</thead>");
            html.Append("<tbody>");
            html.Append("<tr>");
            html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + varcfscont20 + "</td>");
            html.Append("<td style='border-top: 1px solid #000;'>" + varcfscont40 + "</td>");
            html.Append("</tr>");
            html.Append("</tbody>");
            html.Append("</table></td>");
            html.Append("</tr>");
            html.Append("<tr>");
            html.Append("<td colspan='2' width='20%'>Summary :</td>");
            html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            html.Append("<thead>");
            html.Append("<tr>");
            html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            html.Append("<th>40FT</th>");
            html.Append("</tr>");
            html.Append("</thead>");
            html.Append("<tbody>");
            html.Append("<tr>");
            html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + varCount20 + "</td>");
            html.Append("<td style='border-top: 1px solid #000;'>" + varCount40 + "</td>");
            html.Append("</tr>");
            html.Append("</tbody>");
            html.Append("</table></td>");
            html.Append("</tr>");



            varcfscont20 = "";
            varcfscont40 = "";
            varCount20 = "";
            varCount40 = "";

            //objExport.ForEach(x =>
            //{
            //    if (x.WSClause == "XXII-5 (5)")
            //    {
            //        varcfscont20 = Convert.ToString(x.CFSCodeCont20);
            //        varcfscont40 = Convert.ToString(x.CFSCodeCont40);
            //        varCount20 = Convert.ToString(x.Count20);
            //        varCount40 = Convert.ToString(x.Count40);

            //    }
            //});



            //html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (5):</b>Empty pickup from ICD-Varnama</td></tr>");
            //html.Append("<tr>");
            //html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //html.Append("<tr>");
            //html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //html.Append("</tr>");
            //html.Append("</thead>");
            //html.Append("<tbody>");
            //html.Append("<tr>");
            //html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + varcfscont20 + "</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>" + varcfscont40 + "</td>");
            //html.Append("</tr>");
            //html.Append("</tbody>");
            //html.Append("</table></td>");
            //html.Append("</tr>");
            //html.Append("<tr>");
            //html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //html.Append("<tr>");
            //html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //html.Append("</tr>");
            //html.Append("</thead>");
            //html.Append("<tbody>");
            //html.Append("<tr>");
            //html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + varCount20 + "</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>" + varCount40 + "</td>");
            //html.Append("</tr>");
            //html.Append("</tbody>");
            //html.Append("</table></td>");
            //html.Append("</tr>");



            objExport.ForEach(x =>
            {
                if (x.WSClause == "XXII-5 (6) (i)")
                {

                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (6) (i):</b>Transportation of Empty Container from ICD-Varnama to factory for stuffing and Loaded Back to ICD-Dashrath (Including Lift off Loaded at ICD) Distance up to 10 km</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + x.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + x.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + x.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + x.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");

                }

                if (x.WSClause == "XXII-5 (6) (ii)")
                {

                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (6) (ii):</b>Transportation of Empty Container from ICD-Varnama to factory for stuffing and Loaded Back to ICD-Dashrath (Including Lift off Loaded at ICD) Distance >10-30 km</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + x.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + x.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + x.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + x.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");

                }

                if (x.WSClause == "XXII-5 (6) (iii)")
                {

                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (6) (iii):</b>Transportation of Empty Container from ICD-Varnama to factory for stuffing and Loaded Back to ICD-Dashrath (Including Lift off Loaded at ICD) Distance >30-50 km</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + x.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + x.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + x.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + x.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");

                }
                if (x.WSClause == "XXII-5 (6) (iv)")
                {

                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (6) (iv):</b>Transportation of Empty Container from ICD-Varnama to factory for stuffing and Loaded Back to ICD-Dashrath (Including Lift off Loaded at ICD) Distance >50-75 km</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + x.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + x.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + x.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + x.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");

                }
                if (x.WSClause == "XXII-5 (6) (v)")
                {

                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (6) (v):</b>Transportation of Empty Container from ICD-Varnama to factory for stuffing and Loaded Back to ICD-Dashrath (Including Lift off Loaded at ICD) Distance >75-100 km</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + x.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + x.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + x.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + x.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");

                }

                if (x.WSClause == "XXII-5 (6) (vi)")
                {

                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXII-5 (6) (vi):</b>Transportation of Empty Container from ICD-Varnama to factory for stuffing and Loaded Back to ICD-Dashrath (Including Lift off Loaded at ICD) Distance >100 km</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + x.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + x.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + x.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + x.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");

                }
            });


            html.Append("<tr><td><br/><br/><br/><br/></td></tr>");
            html.Append("<tr>");
            html.Append("<th colspan='4' width='33.33333333333333%'>HTC Representative</th>");
            html.Append("<th colspan='4' width='33.33333333333333%'>Export Incharge</th>");
            html.Append("<th colspan='4' width='33.33333333333333%'>Manager-ICD</th>");
            html.Append("</tr>");

            html.Append("</tbody></table>");
            html.Append("</td></tr>");

            html.Append("</tbody></table>");
            html.Append("<tr><td><br/><br/><br/><br/></td></tr>");
            html.Append("<tr>");
            html.Append("<th colspan='4' width='33.33333333333333%'>HTC Representative</th>");
            html.Append("<th colspan='4' width='33.33333333333333%'>Export Incharge</th>");
            html.Append("<th colspan='4' width='33.33333333333333%'>Manager-ICD</th>");
            html.Append("</tr>");

            html.Append("</tbody></table>");
            html.Append("</td></tr>");

            //  html.Append("</tbody></table>");



            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='5' style='font-size:12px; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
            html.Append("<tr><td><br/><br/><br/></td></tr>");
            html.Append("<tr><th colspan='2'>Name & Sign of H & T Contractor</th>");
            html.Append("<th colspan='1'></th>");
            html.Append("<th colspan='2'>Name & Sign of Supdt.Imp./Exp/Wh/C.U.</th>");
            html.Append("<th colspan='1'></th>");
            html.Append("<th colspan='2'>Name & Sign of S.A.M(Imp.) S.A.M. [Imp.][Exp.] Wh.</th>");
            html.Append("<th colspan='1'></th>");
            html.Append("<th colspan='2'>Name & Sign of Manager ICD</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");
            html.Append("</tbody></table>");

            html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            lstSB.Add(html.ToString());

            var FileName = "WorkSlipReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;


            //         List<dynamic> objWs = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //         List<string> lstSB = new List<string>();
            //         StringBuilder html = new StringBuilder();

            //         List<dynamic> objImport = objWs.Where(o => o.Operation == "Import").ToList();
            //         List<dynamic> objExport = objWs.Where(o => o.Operation == "Export").ToList();
            //         List<dynamic> objGeneral = objWs.Where(o => o.Operation == "General").ToList();

            //         html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
            //         html.Append("<tr><td colspan='12'>");

            //         html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            //         html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td><td width='100%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>ICD Dashrath</label><br/><label style='font-size: 12px;'>Inland Container Depot.</label><br/><label style='font-size: 14px; font-weight:bold;'>Workslip</label></td></tr>");
            //         html.Append("</tbody></table>");
            //         html.Append("</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>");
            //         html.Append("<tr><td align='left' colspan='4' width='33.33333333333333%'><b>WorkSlip No :</b> " + objImport[0].WorkSlipNo + "</td><td align='left' colspan='4' width='33.33333333333333%'><b>From Date of Operation :</b> " + dt + "</td><td align='left' colspan='4' width='33.33333333333333%'><b>To Date of Operation :</b> " + dtt + "</td></tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         //IMPORT
            //         html.Append("<tr><td colspan='12'>");
            //         html.Append("<table cellspacing='0' cellpadding='5' style='text-align: left; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Import Operation :</th></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI-1</th></tr>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of loaded container from Mumbai to ICD-Dashrath.(Including Lift off at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //   html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //   html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(B) Transportation of loaded container from Mundra/pipavav/Kandla to ICD-Dashrath.(Including Lift off at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(C) Transportation of loaded container from Hazira to ICD-Dashrath.(Including Lift off at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(D) Transportation of loaded container from RCT to ICD (Including Lift off at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt; '><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI(2-A)</th></tr>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(a) Custom Examination/Destuffing. (Upto 25% Cargo Handling)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(b) Custom Examination/Destuffing. (Beyond 25% Cargo Handling)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI(2-B):</b> Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI(3):</b> Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");		
            //   html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 4:</b> Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; font-size:8pt; '><tbody>");
            //         html.Append("<tr><td colspan='12'><b>(a)</b> Cargo Delivery alongwith Custom Examination of Cargo</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Manual</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
            //html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Mechanical</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
            //html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td>");

            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; font-size:8pt; '><tbody>");
            //         html.Append("<tr><td colspan='12'><b>(b)</b> Cargo Delivery of already Examined Cargo</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Manual</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
            //html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Mechanical</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
            //html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");		
            //   html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-A (i):</b> Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 10-30km</td></tr>");
            //         html.Append("<tr><td colspan='12'>Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 30-50km</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 50-75km</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 75-100km</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Import Loaded Container from ICD to factory for destuffing and back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Lift off of Empty Container) Distance > 100km</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");

            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //   html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-A (ii):</b> Transportation of Import Loaded Container to factory for destuffing and Empty back to RCT(CONCOR)</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr></tbody></table></td></tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //   html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-A (iii):</b> Transportation of Import Loaded Container to factory for destuffing and Empty back to Mumbai</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr></tbody></table></td></tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-A (iv):</b> Transportation of Import Loaded Container to factory for destuffing and Empty back to Hazira</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr></tbody></table></td></tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><th colspan='12'>BONDED WAREHOUSING TRANSACTION</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='4' style='border-bottom: 1px solid #000;'>Shifted to PBW (XXI-15)</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='2' style='border-right: 1px solid #000;'>Manual</th>");
            //html.Append("<th colspan='2'>Mechanical</th>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package</th>");
            //html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Wt.Qtl</th>");
            //html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package</th>");
            //html.Append("<th style='border-top: 1px solid #000;'>Wt.Qtl</th>");
            //html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr><th colspan='4' style='border-bottom: 1px solid #000;'>Ex-Bond XXI-4 (B)</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='2' style='border-right: 1px solid #000;'>Manual</th>");
            //html.Append("<th colspan='2'>Mechanical</th>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package</th>");
            //html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Wt.Qtl</th>");
            //html.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package</th>");
            //html.Append("<th style='border-top: 1px solid #000;'>Wt.Qtl</th>");
            //html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI(21-b):</b> Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("</tr>");


            //         html.Append("<tr><td><br/><br/><br/><br/></td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='3' width='25%'>HTC Representative</th>");
            //      html.Append("<th colspan='3' width='25%'>Import Incharge</th>");
            //      html.Append("<th colspan='3' width='25%'>PBW Incharge</th>");
            //      html.Append("<th colspan='3' width='25%'>Manager-ICD</th>");        
            //         html.Append("</tr>");

            //         html.Append("</tbody></table>");
            //         html.Append("</td></tr>");

            //         //EXPORT
            //         html.Append("<tr><td colspan='12'>");
            //         html.Append("<table cellspacing='0' cellpadding='5' style='text-align: left; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Export Operation :</th></tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI (5): (Carting)</b> Unloading  of cargo from Truck/Vechicle and Stacking in the same in Godown/Open Yard.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; font-size:8pt; '><tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Manual</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
            //         html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Mechanical</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>Package</th>");
            //         html.Append("<th colspan='6' width='50%'>Wt.Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI (6): (Examination)</b> Examination of Export Cargo, Placement of Empty Container, Stuffinf, Sealing & Internal Shifting of Loaded Container.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI (7): (Direct Stuffing)</b> Unloading the Cargo from Truck/Vechile, Examination of Export Cargo, Placement of Empty Container, Stuffing the same in container, Sealing & shifting of Loaded Container.</th></tr>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of loaded container from Mumbai to ICD-Dashrath.(Including Lift off at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI (8)</th></tr>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of loaded container from ICD-Dashrath to Mumbai.(Including Lift on at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(B) Transportation of loaded container from ICD-Dashrath to Mundra/pipavav/Kandla.(Including Lift on at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(C) Transportation of loaded container from ICD-Dashrath to Hazira.(Including Lift on at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(D) Transportation of loaded container from ICD to RCT (CONCOR) (Including Lift on at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI-20-B (i) :</b>Transportation of Empty Loaded Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance up to 10km</td></tr>");
            //         html.Append("<tr><td colspan='12'>Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Empty Loaded Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance >30-50</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Empty Loaded Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance > 50-75</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Empty Loaded Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance > 75-100</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>Transportation of Empty Loaded Container to factory for stuffing and Loaded Back to ICD-Dashrath</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance > 100</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-B (ii):</b> Transportation of Empty Container from RCT(CORNOR) to factory for stuffing and Loaded Back to ICD-Dashrath (Including Loaded Lift off at ICD) Distance</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr></tbody></table></td></tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-B (iii):</b> Transportation of Empty Container from Mumbai to factory for stuffing and Loaded Back to ICD-Dashrath (Including Loaded Lift off at ICD) Distance</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr></tbody></table></td></tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 20-B (iv):</b> Transportation of Empty Container from Hazira to factory for stuffing and Loaded Back to ICD-Dashrath (Including Loaded Lift off at ICD) Distance</td></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody><tr>");
            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Upto 10km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'> >10-30km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>30-50km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>50-75km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>75-100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>>100km</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th colspan='6' width='50%'>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr></tbody></table></td></tr>");
            //         html.Append("</tbody></table></td></tr>");            

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'><b>Clause XXI 21 (a):</b> Bothway Empty Container :- Transportation of Empty Container from ICD to factory and return back empty container at ICD (Including empty Lift off at ICD)</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");


            //         html.Append("<tr><td><br/><br/><br/><br/></td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='4' width='33.33333333333333%'>HTC Representative</th>");
            //         html.Append("<th colspan='4' width='33.33333333333333%'>Export Incharge</th>");
            //         html.Append("<th colspan='4' width='33.33333333333333%'>Manager-ICD</th>");
            //         html.Append("</tr>");

            //         html.Append("</tbody></table>");
            //         html.Append("</td></tr>");

            //         //GENERAL
            //         html.Append("<tr><td colspan='12'>");
            //         html.Append("<table cellspacing='0' cellpadding='5' style='text-align: left; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>General Operation :</th></tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:9pt;'><tbody>");
            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI (9)</th></tr>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of CBT between ICD and Mumbai (Including Stuffing/Destuffing at ICD).</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(B) Transportation of Export CBT from ICD to Ahmedabad (Including Stuffing/Destuffing at ICD).</td></tr>");            
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI-10</th></tr>");
            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of Empty Containers From CWC-ICD to Mumbai.</td></tr>");            
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(B) Transportation of Empty Containers From CWC-ICD to Kandla/Pipavav/Mundra.</td></tr>");           
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(C) Transportation of Empty Containers From CWC-ICD to RCT Vadodara.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(D) Transportation of Empty Containers From CWC-ICD to Hazira.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>"); 

            //         html.Append("<tr><td colspan='12'><b>Clause XXI -11 (i) :</b>Internal Shifting of Empty Container in ICD.</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance up to 10km</td></tr>");
            //         html.Append("<tr><td colspan='12'>Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI -11 (ii) :</b>Internal Shifting of Loaded Container in ICD.</td></tr>");
            //         html.Append("<tr><td colspan='12'>(Including Empty Lift on and Loaded Lift off at ICD) Distance up to 10km</td></tr>");
            //         html.Append("<tr><td colspan='12'>Dynamic</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI-12 (i) :</b>LIFT ON/OFF OF EMPTY CONTAINERS ARRIVED AT ICD-DASHRATH.</td></tr>");
            //         html.Append("<tr><td colspan='12'>(1) Lift off Empty Container arrived at ICD.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>(2) Lift off Import Private FD Empty Container.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>(3) Lift on Empty Containers Moved Private for FS.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>(4) Lift on Empty Containers Moved Private.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI-12 (ii) :</b>Lift on/off of Loaded Container</td></tr>");
            //         html.Append("<tr><td colspan='12'>(1) Lift on Import LD Container Moved for FD.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'>(2) Lift On/off LD FS Containers Private Movement.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI (13) :</b> Shifting of Empty Container between ICD and CW-Karachia (Including Lift on)</td></tr>");            
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI (14) :</b> Shifting of Empty Container from any location withhin ICD complex for washing/cleaning.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; font-size:8pt;'><tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='4' width='33.33333333333333%'><b>Clause XXI (15) :</b> Internal Shifting of Cargowithin ICD complex for weighment or other purpose. <div style='border: 1px solid #000; padding:5px;'>Dynamic</div></td>");

            //         html.Append("<td colspan='4' width='33.33333333333333%'><table cellspacing='0' cellpadding='5' style='text-align:center; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12'><b>Clause XXI (16) :</b> Palletization of cargo.</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='6' width='50%' style='border: 1px solid #000;'>Package</th>");
            //         html.Append("<th colspan='6' width='50%' style='border: 1px solid #000; border-left:0;'>Weight in .Qtl</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%' style='border: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td colspan='6' width='50%' style='border: 1px solid #000; border-left:0;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='4' width='33.33333333333333%'><b>Clause XXI (17) Bagging:</b> Providing labourfor filling of loose cargo in to fresh bags. <div style='border: 1px solid #000; padding:5px;'>Dynamic</div></td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody></table></td></tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI (18) :</b> Reworking of Container: (a) Upto 25% Cargo Handling.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td colspan='12'><b>Clause XXI (18) :</b> Reworking of Container: (b) Beyond 25% Cargo Handling.</td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='2' width='20%'>Summary :</td>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th>");
            //         html.Append("</tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr>");
            //         html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
            //         html.Append("</tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><th colspan='12'><b>Clause XXI (19) </b> Container weighment:- Lift on and movt. of LD Cont. from ICD complex to CW-Karachia/other LWB Within 5 Kms and back to ICD.</th></tr>");
            //         html.Append("<tr>");
            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Summary of Containers</th></tr>");
            //         html.Append("<tr><th style='border-right: 1px solid #000;'></th>");
            //         html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th></tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr><th style='border-right: 1px solid #000;'>Loaded</th>");
            //         html.Append("<th style='border-right: 1px solid #000;'>Dynamic</th>");
            //         html.Append("<th>Dynamic</th></tr>");
            //         html.Append("<tr><th style='border-right: 1px solid #000;'>Empty</th>");
            //         html.Append("<th style='border-right: 1px solid #000;'>Dynamic</th>");
            //         html.Append("<th>Dynamic</th></tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            //         html.Append("<thead>");
            //         html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Summary</th></tr>");
            //         html.Append("<tr><th style='border-right: 1px solid #000;'>20FT</th>");
            //         html.Append("<th>40FT</th></tr>");
            //         html.Append("</thead>");
            //         html.Append("<tbody>");
            //         html.Append("<tr><th style='border-right: 1px solid #000;'>Dynamic</th>");
            //         html.Append("<th>Dynamic</th></tr>");
            //         html.Append("</tbody>");
            //         html.Append("</table></td>");

            //         html.Append("<td colspan='4' width='33.33333333333333%'><b>Clause XXI (22) :</b> Supply of Causal labour.</td>");
            //         html.Append("</tr>");

            //         html.Append("<tr><td><br/><br/><br/><br/></td></tr>");
            //         html.Append("<tr>");
            //         html.Append("<th colspan='4' width='33.33333333333333%'>HTC Representative</th>");
            //         html.Append("<th colspan='4' width='33.33333333333333%'>IMP/EXP Incharge</th>");
            //         html.Append("<th colspan='4' width='33.33333333333333%'>Manager-ICD</th>");
            //         html.Append("</tr>");

            //         html.Append("</tbody></table>");
            //         html.Append("</td></tr>");
            //         //End

            //         html.Append("</tbody></table>");

            //         html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            //         lstSB.Add(html.ToString());

            //         var FileName = "WorkSlipReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            //         var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            //         if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            //         {
            //             System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            //         }
            //         /*if (System.IO.File.Exists(location))
            //         {
            //             System.IO.File.Delete(location);
            //         }*/

            //         using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 40f, 20f, 20f, false, true))
            //         {
            //             rp.HeadOffice = "";
            //             rp.HOAddress = "";
            //             rp.ZonalOffice = "";
            //             rp.ZOAddress = "";
            //             rp.GeneratePDF(location, lstSB);
            //         }
            //         return "/Docs/" + Session.SessionID + "/" + FileName;
        }


        public ActionResult WorkSlipReportMis()
        {
            return PartialView();
        }

        [HttpPost]
        public JsonResult GetWorkSlipReportMis(string PeriodFrom, string PeriodTo, string ImportExport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            string FilePath = "";
            string fdt = Convert.ToDateTime(PeriodFrom).ToString("yyyy-MM-dd");
            string tdt = Convert.ToDateTime(PeriodTo).ToString("yyyy-MM-dd");
            ObjRR.WorkSlipDetailsForPrintMisc(fdt, tdt, ImportExport, objLogin.Uid);//, objLogin.Uid
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                FilePath = GeneratingPDFforWSMis(ds, Convert.ToDateTime(PeriodFrom).ToString("dd-MMM-yy"), Convert.ToDateTime(PeriodTo).ToString("dd-MMM-yy"));
                return Json(new { Status = 1, Data = FilePath });
            }
            else
                return Json(new { Status = -1, Data = "No Record Found." });
        }

        [NonAction]
        public string GeneratingPDFforWSMis(DataSet ds, string dt, string dtt)
        {

            List<dynamic> objWs = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();
            var Empty20 = 0;
            var Empty40 = 0;
            var Loaded20 = 0;
            var Loaded40 = 0;


            List<dynamic> objImport = objWs.Where(o => o.Operation == "Import").ToList();
            List<dynamic> objExport = objWs.Where(o => o.Operation == "Export").ToList();
            List<dynamic> objGeneral = objWs.Where(o => o.Operation == "MISC").ToList();

            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

            html.Append("<tr><td width='10%'></td>");

            html.Append("<td colspan='9' width='90%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td><td width='100%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>ICD Dashrath</label><br/><label style='font-size: 12px;'>Inland Container Depot.</label><br/><label style='font-size: 14px; font-weight:bold;'>Workslip</label></td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");

            html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>");
            html.Append("<tr><td align='left' colspan='4' width='33.33333333333333%'><b>WorkSlip No :</b> " + objGeneral[0].WorkSlipNo + "</td><td align='left' colspan='4' width='33.33333333333333%'><b>From Date of Operation :</b> " + dt + "</td><td align='left' colspan='4' width='33.33333333333333%'><b>To Date of Operation :</b> " + dtt + "</td></tr>");
            html.Append("</tbody></table></td></tr>");
            //GENERAL
            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='5' style='text-align: left; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
            html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>General Operation :</th></tr>");
            objGeneral.ForEach(item =>
            {
                if (item.WSClause == "XXI 9(A)")
                {

                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom:10px; font-size:8pt;'><tbody>");
                    html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI (9)</th></tr>");
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of CBT between ICD and Mumbai (Including Stuffing/Destuffing at ICD).</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "XXI 9(B)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(B) Transportation of Export CBT from ICD to Ahmedabad (Including Stuffing/Destuffing at ICD).</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "XXI-10(A)")
                {
                    html.Append("<tr><th colspan='12' width='100%' style='font-size:9pt;'>Clause XXI-10</th></tr>");
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(A) Transportation of Empty Containers From CWC-ICD to Mumbai.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "XXI-10(B)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(B)Transportation of Empty Containers From CWC-ICD to Kandla/Pipavav/Mundra.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("</tbody></table></td></tr>");
                }
                if (item.WSClause == "XXI-10(C)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(C) Transportation of Empty Containers From CWC-ICD to RCT Vadodara.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    //html.Append("</tbody></table></td></tr>");
                }

                if (item.WSClause == "XXI-10(D)")
                {
                    html.Append("<tr><td colspan='12' width='100%' style='font-size:9pt;'>(D) Transportation of Empty Containers From CWC-ICD to Hazira.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    // html.Append("</tbody></table></td></tr>");
                }
                if (item.WSClause == "XXI-11(i)")
                {
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'><b>Clause XXI -11 (i) :</b>Internal Shifting of Empty Container in ICD.</td></tr>");
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'>(Including Empty Lift on and Loaded Lift off at ICD) Distance up to 10km</td></tr>");
                    //html.Append("<tr><td colspan='12' style='font-size:9pt;'>Dynamic</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "XXI-11(ii)")
                {
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'><b>Clause XXI -11 (ii) :</b>Internal Shifting of Loaded Container in ICD.</td></tr>");
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'>(Including Empty Lift on and Loaded Lift off at ICD) Distance up to 10km</td></tr>");
                    //html.Append("<tr><td colspan='12'>Dynamic</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }


                if (item.WSClause == "XXI-12(1)")
                {
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'><b>Clause XXI-12 (i) :</b>LIFT ON/OFF OF EMPTY CONTAINERS ARRIVED AT ICD-DASHRATH.</td></tr>");
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'>(1) Lift off Empty Container arrived at ICD.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    Empty20 = Empty20 + Convert.ToInt32(item.Count20);
                    Empty40 = Empty40 + Convert.ToInt32(item.Count40);

                }
                if (item.WSClause == "XXI-12(2)")
                {
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'>(2) Lift off Import Private FD Empty Container.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    Empty20 = Empty20 + Convert.ToInt32(item.Count20);
                    Empty40 = Empty40 + Convert.ToInt32(item.Count40);
                }

                if (item.WSClause == "XXI-12(3)")
                {
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'>(3) Lift on Empty Containers Moved Private for FS.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    Empty20 = Empty20 + Convert.ToInt32(item.Count20);
                    Empty40 = Empty40 + Convert.ToInt32(item.Count40);
                }

                if (item.WSClause == "XXI-12(4)")
                {
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'>(4) Lift on Empty Containers Moved Private.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    Empty20 = Empty20 + Convert.ToInt32(item.Count20);
                    Empty40 = Empty40 + Convert.ToInt32(item.Count40);
                }

                if (item.WSClause == "XXI-12(ii)")
                {
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'><b>Clause XXI-12 (ii) :</b>Lift on/off of Loaded Container</td></tr>");
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'>(1) Lift on Import LD Container Moved for FD.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    Loaded20 = Loaded20 + Convert.ToInt32(item.Count20);
                    Loaded40 = Loaded40 + Convert.ToInt32(item.Count40);
                }
                if (item.WSClause == "XXI-12(iii)")
                {
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'>(2) Lift On/off LD FS Containers Private Movement.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    Loaded20 = Loaded20 + Convert.ToInt32(item.Count20);
                    Loaded40 = Loaded40 + Convert.ToInt32(item.Count40);
                }
                if (item.WSClause == "XXI-13")
                {
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'><b>Clause XXI (13) :</b> Shifting of Empty Container between ICD and CW-Karachia (Including Lift on)</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "XXI-14")
                {
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'><b>Clause XXI (14) :</b> Shifting of Empty Container from any location withhin ICD complex for washing/cleaning.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "XXI-15")
                {
                    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; font-size:8pt;'><tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='4' width='33.33333333333333%' style='font-size:9pt;'><b>Clause XXI (15) :</b> Internal Shifting of Cargowithin ICD complex for weighment or other purpose. <div style='border: 1px solid #000; padding:5px;'>" + item.NoOfPackage + "</div></td>");
                }
                if (item.WSClause == "XXI(16)")
                {
                    html.Append("<td colspan='4' width='33.33333333333333%'><table cellspacing='0' cellpadding='5' style='text-align:center; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='font-size:9pt;'><b>Clause XXI (16) :</b> Palletization of cargo.</th></tr>");
                    html.Append("<tr>");
                    html.Append("<th colspan='6' width='50%' style='border: 1px solid #000;'>Package</th>");
                    html.Append("<th colspan='6' width='50%' style='border: 1px solid #000; border-left:0;'>Weight in .Qtl</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%' style='border: 1px solid #000;'>" + item.NoOfPackage + "</td>");
                    html.Append("<td colspan='6' width='50%' style='border: 1px solid #000; border-left:0;'>" + item.Wt + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                }
                if (item.WSClause == "XXI(17)")
                {
                    html.Append("<td colspan='4' width='33.33333333333333%' style='font-size:9pt;'><b>Clause XXI (17) Bagging:</b> Providing labourfor filling of loose cargo in to fresh bags. <div style='border: 1px solid #000; padding:5px;'>" + item.NoOfPackage + "</div></td>");
                    html.Append("</tr>");
                    html.Append("</tbody></table></td></tr>");
                }

                if (item.WSClause == "XXI-18(i)")
                {
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'><b>Clause XXI (18) :</b> Reworking of Container: (a) Upto 25% Cargo Handling.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "XXI-18(ii)")
                {
                    html.Append("<tr><td colspan='12' style='font-size:9pt;'><b>Clause XXI (18) :</b> Reworking of Container: (b) Beyond 25% Cargo Handling.</td></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.Count20 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
                if (item.WSClause == "XXI-19(ii)")
                {
                    html.Append("<tr><th colspan='12' style='font-size:9pt;'><b>Clause XXI (19) </b> Container weighment:- Lift on and movt. of LD Cont. from ICD complex to CW-Karachia/other LWB Within 5 Kms and back to ICD.</th></tr>");
                    html.Append("<tr>");
                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Summary of Containers</th></tr>");
                    html.Append("<tr><th style='border-right: 1px solid #000;'></th>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th></tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr><th style='border-right: 1px solid #000;'>Loaded</th>");
                    html.Append("<th style='border-right: 1px solid #000;'>" + Loaded20 + "</th>");
                    html.Append("<th>" + Loaded40 + "</th></tr>");
                    html.Append("<tr><th style='border-right: 1px solid #000;'>Empty</th>");
                    html.Append("<th style='border-right: 1px solid #000;'>" + Empty20 + "</th>");
                    html.Append("<th>" + Empty40 + "</th></tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                }
                if (item.WSClause == "XXI(22)")
                {

                    html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align:center; border:1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
                    html.Append("<thead>");
                    html.Append("<tr>");
                    html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th>");
                    html.Append("</tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CFSCodeCont20 + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + item.CFSCodeCont40 + "</td>");
                    html.Append("</tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                    html.Append("<tr><th colspan='12' style='border-bottom: 1px solid #000;'>Summary</th></tr>");
                    html.Append("<tr><th style='border-right: 1px solid #000;'>20FT</th>");
                    html.Append("<th>40FT</th></tr>");
                    html.Append("</thead>");
                    html.Append("<tbody>");
                    html.Append("<tr><th style='border-right: 1px solid #000;'>" + item.Count20 + "</th>");
                    html.Append("<th>" + item.Count40 + "</th></tr>");
                    html.Append("</tbody>");
                    html.Append("</table></td>");
                    html.Append("</tr>");
                }
            });

            html.Append("<tr><td colspan='12' style='font-size:9pt;'><b>Clause XXI (22) :</b> Supply of Causal labour.</td></tr>");


            //Add Chiranjit Das
            var varcfscont20 = "";
            var varcfscont40 = "";
            var varCount20 = "";
            var varCount40 = "";

            objGeneral.ForEach(x =>
            {
                if (x.WSClause == "XXII-5 (3)")
                {
                    varcfscont20 = Convert.ToString(x.CFSCodeCont20);
                    varcfscont40 = Convert.ToString(x.CFSCodeCont40);
                    varCount20 = Convert.ToString(x.Count20);
                    varCount40 = Convert.ToString(x.Count40);

                }
            });


            html.Append("<tr><td colspan='12' style='font-size:9pt;'><b>Clause XXII-5 (3) :</b> Transportation of Empty Container from ICDVarnama to ICD-Dashrath with Lift Off</td></tr>");
            html.Append("<tr>");
            html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            html.Append("<thead>");
            html.Append("<tr>");
            html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            html.Append("<th>40FT</th>");
            html.Append("</tr>");
            html.Append("</thead>");
            html.Append("<tbody>");
            html.Append("<tr>");
            html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + varcfscont20 + "</td>");
            html.Append("<td style='border-top: 1px solid #000;'>" + varcfscont40 + "</td>");
            html.Append("</tr>");
            html.Append("</tbody>");
            html.Append("</table></td>");
            html.Append("</tr>");
            html.Append("<tr>");
            html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
            html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            html.Append("<thead>");
            html.Append("<tr>");
            html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            html.Append("<th>40FT</th>");
            html.Append("</tr>");
            html.Append("</thead>");
            html.Append("<tbody>");
            html.Append("<tr>");
            html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + varCount20 + "</td>");
            html.Append("<td style='border-top: 1px solid #000;'>" + varCount40 + "</td>");
            html.Append("</tr>");
            html.Append("</tbody>");
            html.Append("</table></td>");
            html.Append("</tr>");

            objGeneral.ForEach(x =>
            {
                if (x.WSClause == "XXII-5 (4)")
                {
                    varcfscont20 = Convert.ToString(x.CFSCodeCont20);
                    varcfscont40 = Convert.ToString(x.CFSCodeCont40);
                    varCount20 = Convert.ToString(x.Count20);
                    varCount40 = Convert.ToString(x.Count40);

                }
            });

            html.Append("<tr><td colspan='12' style='font-size:9pt;'><b>Clause XXII-5 (4) :</b> Transportation of Empty Container from ICD Dashrath to ICD-Vamama with lift on</td></tr>");
            html.Append("<tr>");
            html.Append("<td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            html.Append("<thead>");
            html.Append("<tr>");
            html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            html.Append("<th>40FT</th>");
            html.Append("</tr>");
            html.Append("</thead>");
            html.Append("<tbody>");
            html.Append("<tr>");
            html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + varcfscont20 + "</td>");
            html.Append("<td style='border-top: 1px solid #000;'>" + varcfscont40 + "</td>");
            html.Append("</tr>");
            html.Append("</tbody>");
            html.Append("</table></td>");
            html.Append("</tr>");
            html.Append("<tr>");
            html.Append("<td colspan='2' width='20%' style='font-size:9pt;'>Summary :</td>");
            html.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; margin: 0; font-size:8pt;'>");
            html.Append("<thead>");
            html.Append("<tr>");
            html.Append("<th style='border-right: 1px solid #000;'>20FT</th>");
            html.Append("<th>40FT</th>");
            html.Append("</tr>");
            html.Append("</thead>");
            html.Append("<tbody>");
            html.Append("<tr>");
            html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + varCount20 + "</td>");
            html.Append("<td style='border-top: 1px solid #000;'>" + varCount40 + "</td>");
            html.Append("</tr>");
            html.Append("</tbody>");
            html.Append("</table></td>");
            html.Append("</tr>");


            //Chiranjit Das

            html.Append("<tr><td><br/><br/><br/><br/></td></tr>");

            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='5' style='text-align: left; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
            html.Append("<tr>");
            html.Append("<th colspan='4' width='33.33333333333333%'>HTC Representative</th>");
            html.Append("<th colspan='4' width='33.33333333333333%'>IMP/EXP Incharge</th>");
            html.Append("<th colspan='4' width='33.33333333333333%'>Manager-ICD</th>");
            html.Append("</tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");

            html.Append("</tbody></table>");
            html.Append("</td></tr>");
            //End

            html.Append("</tbody></table></td></tr>");

            html.Append("</tbody></table>");

            html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            lstSB.Add(html.ToString());

            var FileName = "WorkSlipReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        #endregion

        #region Job Order by Road Print
        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult JobOrderPrint(int JobOrderId)
        {
            DSR_ImportRepository objIR = new DSR_ImportRepository();
            objIR.JobOrderPrintDetails(JobOrderId);
            string Path = "";
            int Status = 0;
            if (objIR.DBResponse.Data != null)
            {
                Status = 1;
                Path = JobOrderBind((List<dynamic>)objIR.DBResponse.Data, JobOrderId);
            }
            return Json(new { Message = Path, Status = Status });
        }
        [NonAction]
        public string JobOrderBind(List<dynamic> objList, int JobOrderId)
        {
            StringBuilder sb = new StringBuilder();
            sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
            //sb.Append("<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>ICD Dashrath</label><br/><label style='font-size: 14px; font-weight:bold;'>JOB ORDER</label></td></tr>");

            sb.Append("<tr><td colspan='12'>");
            sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            sb.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
            sb.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>JOB ORDER</label></td></tr>");
            sb.Append("</tbody></table>");
            sb.Append("</td></tr>");

            sb.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
            sb.Append("<tr><th style='font-size:12px; width:15%;'>Job Order No.</th><td style='font-size:12px;'>" + objList[0].FormOneNo + "</td>");
            sb.Append("<th style='font-size:12px; text-align:right;'>Job Order Date</th><td style='font-size:12px;'>" + objList[0].FormOneDate + "</td></tr></tbody></table></td></tr>");
            sb.Append("<tr><td colspan='12' style='font-size:13px;'><b>Transport by :</b> " + objList[0].TransportBy + "</td></tr>");
            sb.Append("<tr><td colspan='12' style='font-size:13px;'><b>Container/CBT :</b>" + (objList[0].CONTCBT == "CONT" ? "CONTAINER" : "CBT") + "</td></tr>");
            sb.Append("<tr><td colspan='12'>");
            sb.Append("<table style='border:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            sb.Append("<thead>");
            sb.Append("<tr>");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Container/CBT No.</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Size</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Container Type</th>");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Shipping Line</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Foreign Liner</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Vessel Name</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Vessel No</th> ");
            sb.Append("</tr>");
            sb.Append("</thead>");
            sb.Append("<tbody>");
            objList.ForEach(i =>
            {
                sb.Append("<tr>");
                sb.Append("<td style='text-align:center;border-right:1px solid #000;padding:10px;'>" + i.ContainerNo + "</td>");
                sb.Append("<td style='text-align:center;border-right:1px solid #000;padding:10px;'>" + i.ContainerSize + "</td> ");
                sb.Append("<td style='text-align:center;border-right:1px solid #000;padding:10px;'>" + i.LCLFCL + "</td> ");
                sb.Append("<td style='text-align:center;border-right:1px solid #000;padding:10px;'>" + i.ShippingLine + "</td> ");
                sb.Append("<td style='text-align:center;border-right:1px solid #000;padding:10px;'>" + i.ForeignLiner + "</td> ");
                sb.Append("<td style='text-align:center;border-right:1px solid #000;padding:10px;'>" + i.VesselName + "</td> ");
                sb.Append("<td style='text-align:center;border-right:1px solid #000;padding:10px;'>" + i.VesselNo + "</td> ");
                sb.Append("</tr>");
            });
            sb.Append("</tbody>");
            sb.Append("</table>");
            sb.Append("</td></tr>");
            //  sb.Append("</tr>");
            sb.Append("<tr><td colspan='12' style='font-size:13px;'><b>Remarks :</b>" + objList[0].Remarks + " </td></tr>");

            sb.Append("</tbody></table>");


            sb = sb.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID;
            string FileName = "JobOrderByRoad" + JobOrderId + ".pdf";
            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }
            using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                ObjPdf.HeadOffice = this.HeadOffice;
                ObjPdf.HOAddress = this.HOAddress;
                ObjPdf.ZonalOffice = this.ZonalOffice;
                ObjPdf.ZOAddress = this.ZOAddress;
                ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, sb.ToString());

            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        //#region Account Report Export Cargo In General Carting
        //[HttpGet]
        //public ActionResult ExportCargoReport()
        //{
        //    return PartialView();
        //}

        //[HttpPost]
        //[ValidateAntiForgeryToken]
        //public JsonResult GetCargoReport(DSR_CarGenCar ObjPC)
        //{
        //    if (ModelState.IsValid)
        //    {
        //        DSR_ReportRepository ObjRR = new DSR_ReportRepository();
        //        ObjRR.GetCargoExport(ObjPC);
        //        string Path = "";
        //        List<DSR_ExpCarGen> lstData = new List<DSR_ExpCarGen>();
        //        lstData = (List<DSR_ExpCarGen>)ObjRR.DBResponse.Data;
        //        Path = GeneratePDFExpCarReport(lstData, ObjPC.AsOnDate);

        //        return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
        //    }
        //    else
        //    {
        //        var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
        //        return Json(new { Status = 0, Message = ErrorMessage });
        //    }
        //}
        //[NonAction]
        //public string GeneratePDFExpCarReport(List<DSR_ExpCarGen> lstData, string Date)
        //{
        //    try
        //    {
        //        var FileName = "ExportCargoReport.pdf";
        //        StringBuilder Pages = new StringBuilder();
        //        string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
        //        Pages.Append("<tr><td colspan='12'>");
        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
        //        Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
        //        Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><span style='font-size:12px;'><b>As On Date - </b> " + Date + "</span><br/><label style='font-size: 14px; font-weight:bold;'>Account Report for Export Cargo In General Carting</label></td></tr>");
        //        Pages.Append("</tbody></table>");
        //        Pages.Append("</td></tr>");
        //        Pages.Append("</thead></table>");

        //        int i = 1;
        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
        //        Pages.Append("<thead><tr>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>S No</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>Entry No</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>In Date</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Sb No</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Sb Date</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Shed</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Area</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>No Of Days</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>No Of Week</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;width:12%;text-align:right;'>Gen Amt</th>");
        //        Pages.Append("</tr></thead>");
        //        Pages.Append("<tbody>");
        //        lstData.ForEach(item =>
        //        {
        //            Pages.Append("<tr>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + i + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>" + item.EntryNo + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.InDate + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.SbNo + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.SbDate + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Shed + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Area + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>" + item.NoOfDays + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>" + item.NoOfWeek + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;width:12%;text-align:right;'>" + item.GeneralAmount + "</td>");
        //            Pages.Append("</tr>");
        //            i++;
        //        });

        //        Pages.Append("<tr>");
        //        Pages.Append("<th colspan='5' style='width:3%;'>Total :</th>");
        //        Pages.Append("<th style='border-right:1px solid #000;width:8%;'></th>");
        //        Pages.Append("<th style='border-right:1px solid #000;width:8%;'>" + lstData.AsEnumerable().Sum(item => item.Area) + "</th>");
        //        Pages.Append("<th style='border-right:1px solid #000;width:6%;'>" + lstData.AsEnumerable().Sum(item => item.NoOfDays) + "</th>");
        //        Pages.Append("<th style='border-right:1px solid #000;width:6%;'>" + lstData.AsEnumerable().Sum(item => item.NoOfWeek) + "</th>");
        //        Pages.Append("<th style='width:12%;text-align:right;'>" + lstData.AsEnumerable().Sum(item => item.GeneralAmount) + "</th>");
        //        Pages.Append("</tr>");

        //        Pages.Append("</tbody></table>");

        //        Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

        //        if (!Directory.Exists(LocalDirectory))
        //        {
        //            Directory.CreateDirectory(LocalDirectory);
        //        }
        //        if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
        //        {
        //            System.IO.File.Delete(LocalDirectory + "/" + FileName);
        //        }
        //        //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
        //        //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
        //        using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
        //        {
        //            ObjPdf.HeadOffice = this.HeadOffice;
        //            ObjPdf.HOAddress = this.HOAddress;
        //            ObjPdf.ZonalOffice = this.ZonalOffice;
        //            ObjPdf.ZOAddress = this.ZOAddress;
        //            ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
        //        }
        //        return "/Docs/" + Session.SessionID + "/Report/" + FileName;
        //    }
        //    catch
        //    {
        //        return "";
        //    }
        //}


        //#endregion

        #region PV Report
        [HttpGet]
        public ActionResult PVReport()
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            ObjGR.GetGodownRightsWise(((Login)Session["LoginUser"]).Uid);
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetPVReport(DSR_PV ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                if (ObjPV.Module == "Import")
                    ObjRR.GetPVReportImport(ObjPV);
                else if (ObjPV.Module == "Export")
                    ObjRR.GetPVReportExport(ObjPV);
                else
                    ObjRR.GetPVReportBond(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null && ObjPV.Module == "Import")
                {
                    List<DSR_ImpPVReport> lstData = new List<DSR_ImpPVReport>();
                    lstData = (List<DSR_ImpPVReport>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFImpPVReport(lstData, ObjPV.AsOnDate, ObjPV.GodownName);
                }
                else if (ObjRR.DBResponse.Data != null && ObjPV.Module == "Export")
                {
                    List<DSR_ExpPVReport> lstData = new List<DSR_ExpPVReport>();
                    lstData = (List<DSR_ExpPVReport>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFPExpPVReport(lstData, ObjPV.AsOnDate, ObjPV.GodownName);
                }
                else
                {
                    List<DSR_BondPVReport> lstData = new List<DSR_BondPVReport>();
                    lstData = (List<DSR_BondPVReport>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFBondPVReport(lstData, ObjPV.AsOnDate, ObjPV.GodownName);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFImpPVReport(List<DSR_ImpPVReport> lstData, string Date, string GodownName)
        {
            try
            {
                var FileName = "PVReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><span style='font-size:12px;'><b>As On Date - </b> " + Date + "</span><br/><span style='font-size:12px;'><b>Shed Cd - </b>" + GodownName + "</span><br/><label style='font-size: 14px; font-weight:bold;'>Physical Verification Report for Import Cargo</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'><thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>S No</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>OBL No</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Destuf. Entry No</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Dstf Date</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>ICD Code</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Container No</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Size</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>CHA Name</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Importer Name</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Item No</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Package Type</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>No Pkg</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Rcvd Pkg</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Gr W</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Area</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>CIF Value</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Duty</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Balance Pkg</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Slot No</th><th style='border-bottom:1px solid #000;'>Remarks</th></tr></thead><tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.BOLNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.DestuffingEntryNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.DestuffingEntryDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CHAName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ImporterName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CommodityAlias + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.PackageType + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.NoOfUnits + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.NoOfUnitsRec + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Weight.ToString("0.00") + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Area.ToString("0.00") + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CIFValue.ToString("0.00") + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GrossDuty.ToString("0.00") + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.BalancePackages.ToString("0.00") + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.LocationName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Remarks + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });

                Pages.Append("<tr>");
                Pages.Append("<th colspan='11' style='border-bottom:1px solid #000;text-align:left;'>Total :</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.NoOfUnits) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.NoOfUnitsRec) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Weight).ToString("0.00") + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Area).ToString("0.00") + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.CIFValue).ToString("0.00") + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.GrossDuty).ToString("0.00") + "</th>");
                Pages.Append("<th colspan='3' style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.BalancePackages).ToString("0.00") + "</th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        [NonAction]
        public string GeneratePDFPExpPVReport(List<DSR_ExpPVReport> lstData, string Date, string GodownName)
        {
            try
            {
                var FileName = "PVReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 28px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 14px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:14px;'>ICD Dashrath</span><br/><span style='font-size:14px;'><b>Stock Register of Shed No...</b> " + GodownName + "</span><br/><span style='font-size:14px;'><b>As on Date...</b> " + Date + "</span><br/><label style='font-size: 16px; font-weight:bold;'>Physical Verification Report for Export Cargo</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                Pages.Append("<thead><tr><td colspan='12'><table style='border-top:1px solid #000;border-left:1px solid #000;border-right:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                Pages.Append("<th style='text-align:left;padding:10px;width:6%;'>Sla Cd</th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:2%;'>Sr.</th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Sb No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Sb Date</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'>Entry No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Carting Date</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>CHA Name</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Exporter Name</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Cargo Description</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:7%;'>No Pkg</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'>Gr Wt</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:13%;'>Fob</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Slot No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>Area</th>");
                Pages.Append("</tr></tbody></table></td></tr></thead>");

                Pages.Append("<tbody>");
                //Loop
                lstData.Select(x => new { ShippingLineId = x.ShippingLineId, EximTraderName = x.EximTraderName, EximTraderAlias = x.EximTraderAlias }).Distinct().ToList().ForEach(x =>
                       {
                           Pages.Append("<tr><td colspan='12' style='padding:0;'>");
                           Pages.Append("<table style='margin:0 0 15px;border:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                           Pages.Append("<tr><td colspan='12'>");
                           Pages.Append("<table style='margin:0;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                           Pages.Append("<th style='text-align:left;padding:10px;width:5.5%;'>" + x.EximTraderAlias + "</th> ");
                           Pages.Append("<th style='text-align:left;padding:10px;width:90%;'>" + x.EximTraderName + "</th> ");
                           Pages.Append("</tr></tbody></table>");
                           Pages.Append("</td></tr>");
                           //Loop
                           int i = 1;
                           lstData.Where(y => y.ShippingLineId == x.ShippingLineId).ToList().ForEach(y =>
                                  {
                                      Pages.Append("<tr><td colspan='12'>");
                                      Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:6%;'></td> ");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:2%;'>" + i + "</td> ");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.ShippingBillNo + "</td>");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.ShippingBillDate + "</td> ");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:10%;'>" + y.EntryNo + "</td> ");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.RegisterDate + "</td>");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.CHAName + "</td>");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.ExporterName + "</td>");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.CargoDescription + "</td>");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:7%;'>" + y.Units + "</td> ");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:9%;'>" + y.Weight.ToString("0.00") + "</td>");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:13%;'>" + y.Fob + "</td>");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.LocationName + "</td>");
                                      Pages.Append("<td style='text-align:left;padding:10px;width:5%;'>" + y.Area.ToString("0.00") + "</td>");
                                      Pages.Append("</tr></tbody></table>");
                                      Pages.Append("</td></tr>");
                                      i++;
                                  });
                           //loop end

                           Pages.Append("<tr><td colspan='12'>");
                           Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:6%;'></th> ");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:2%;'></th> ");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'>Total :</th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th> ");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:10%;'>" + lstData.Where(z => z.ShippingLineId == x.ShippingLineId).Count() + "</th> ");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:7%;'>" + lstData.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Units) + "</th> ");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:9%;'>" + lstData.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Weight).ToString("0.00") + "</th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:13%;'>" + lstData.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Fob) + "</th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:5%;'>" + lstData.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Area).ToString("0.00") + "</th>");
                           Pages.Append("</tr></tbody></table>");
                           Pages.Append("</td></tr>");

                           Pages.Append("</tbody></table>");
                           Pages.Append("</td></tr>");
                       });
                //loop  end

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:6%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:2%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'>Total :</th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:10%;'>" + lstData.Count() + "</th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:7%;'>" + lstData.Sum(x => x.Units) + "</th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:9%;'>" + lstData.Sum(x => x.Weight).ToString("0.00") + "</th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:13%;'>" + lstData.Sum(x => x.Fob) + "</th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:5%;'>" + lstData.Sum(x => x.Area).ToString("0.00") + "</th>");
                Pages.Append("</tr></tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("</tbody>");
                Pages.Append("</table>");
                Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }

        public string GeneratePDFBondPVReport(List<DSR_BondPVReport> lstData, string Date, string GodownName)
        {
            try
            {
                var FileName = "PVReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                decimal Value = 0, Duty = 0, Total = 0;


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1>");
                Pages.Append("<label style='font-size: 12px;'>(A Govt. of India Undertaking) </label><br />");
                Pages.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + lstData[0].CompAddress + "</span><br/><label style='font-size: 12px;'>Email: -" + lstData[0].CompEmail + "</label><br/><label style='font-size: 12px;'>PV STATEMENT OF LIVE BONDS IN GODOWN NO : " + GodownName + " AS ON " + Date + "</label>");
                Pages.Append("<br /><label style='font-size: 14px; font-weight:bold;'>GODOWN NO : " + GodownName + "</label>");
                Pages.Append("</td>");
                Pages.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'><thead>");
                Pages.Append("<tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>SL. NO</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>BOND NO</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>BOND DATE</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>NAME OF THE IMPORTER</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>DESCRIPTION OF GOODS</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>NO OF PKGS</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>WT.IN. KGS</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>ACCESIBLE VALUE</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>DUTY</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>TOTAL</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>AREA IN SQ. MT</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>CHA</th><th style='border-bottom:1px solid #000;'>Remarks</th></tr>");
                Pages.Append("</thead>");
                Pages.Append("<tbody>");

                lstData.ForEach(item =>
                {

                    Value = item.Value;
                    Duty = item.Duty;
                    Total = Math.Round((Value + Duty), 2);


                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.BondNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.BondDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Importer + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ItemDesc + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Units + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Weight + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Value + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Duty + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + (item.Value + item.Duty) + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Area + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CHA + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'></td>");
                    Pages.Append("</tr>");
                    i++;
                });

                Pages.Append("<tr>");
                Pages.Append("<th colspan='5' style='border-bottom:1px solid #000;text-align:left;'>Total :</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Units) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Weight) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Value) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Duty) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + (lstData.Sum(x => x.Value) + lstData.Sum(x => x.Duty)) + "</th>");
                Pages.Append("<th colspan='3' style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Area) + "</th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Daily Transaction Report
        public ActionResult DailyTransactionReport()
        {

            GodownRepository ObjGR = new GodownRepository();
            ObjGR.GetAllGodown();
            List<CwcExim.Models.Godown> LstGodown = new List<CwcExim.Models.Godown>();
            if (ObjGR.DBResponse.Data != null)
            {
                LstGodown = (List<CwcExim.Models.Godown>)ObjGR.DBResponse.Data;
            }
            return PartialView(LstGodown);
        }

        [HttpPost]
        public JsonResult GetDailyTransactioReport(string DTRDate, string Module, string GodownName, int GodownId = 0)
        {
            if (GodownId > 0)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                Login objLogin = (Login)Session["LoginUser"];
                string FilePath = "";
                string dt = Convert.ToDateTime(DTRDate).ToString("yyyy-MM-dd");

                if (Module == "Import")
                {
                    ObjRR.DTRForPrint(dt, GodownId);//, objLogin.Uid
                    if (ObjRR.DBResponse.Status == 1)
                    {
                        DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                        FilePath = GeneratingPDFforDTR(ds, Convert.ToDateTime(dt).ToString("dd-MMM-yy"));
                        return Json(new { Status = 1, Data = FilePath });
                    }
                    else
                        return Json(new { Status = -1, Data = "No Record Found." });
                }
                else
                {
                    ObjRR.DTRForExport(dt, GodownId);//, objLogin.Uid
                    if (ObjRR.DBResponse.Status == 1)
                    {
                        FilePath = GeneratingPDFForDTRExp((DSRDTRExp)ObjRR.DBResponse.Data, Convert.ToDateTime(dt).ToString("dd-MMM-yy"), GodownName);
                        return Json(new { Status = 1, Data = FilePath });
                    }
                    else
                        return Json(new { Status = -1, Data = "No Record Found." });
                }
            }
            else
            {
                return Json(new { Status = -1, Data = "Select Godown" });
            }
        }

        [NonAction]
        public string GeneratingPDFforDTR(DataSet ds, string dt)
        {
            List<dynamic> lstCont = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstCargo = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();
            String Shed = "";
            lstCont.Select(x => new { Shed = x.Shed }).Distinct().ToList().ForEach(item =>
            {
                if (Shed == "")
                    Shed = item.Shed;
                else
                    Shed += "," + item.Shed;
            });

            var sumobl = lstCont.AsEnumerable()
                        .Sum(r => r.NoObl);

            var sumNoPkg = lstCont.AsEnumerable()
                        .Sum(r => r.NoPkg);

            var sumGrWt = lstCont.AsEnumerable()
                        .Sum(r => (decimal)r.GrWt);

            var sumNoBoe = lstCont.AsEnumerable()
                        .Sum(r => r.NoBoe);

            var sumArea = lstCont.AsEnumerable()
                        .Sum(r => (decimal)r.Area);


            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

            html.Append("<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>ICD Dashrath</label><br/><label style='font-size: 12px;'>For Workslip</label><br/><label style='font-size: 14px; font-weight:bold;'>Daily Transaction Report</label></td></tr>");

            html.Append("<tr><td><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12' style='font-size:13px;'><b>SHED :<span>&nbsp;</span></b>" + Shed + "</td></tr>");
            html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin:0;'><tbody>");
            html.Append("<tr><th style='font-size:13px; text-align:left;' width='30%'>Daily Transaction Report (Import Unit) as on date :</th><td style='font-size:12px;' width='57%'>" + dt + "</td>");
            html.Append("<th style='font-size:13px; text-align:right;'>Date : <span>&nbsp;</span></th><td style='font-size:12px;'>" + dt + "</td></tr></tbody></table></td></tr>");

            //html.Append("<tr><td colspan='12' style='font-size:13px;'><b>Daily Transaction Report (Import Unit) as on date :</b> " + dt + "</td></tr>");

            html.Append("<tr><td><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12' style='font-size:13px;'>DESTUFFING OF CONTAINERS :</td></tr>");

            html.Append("<tr><td colspan='12'><table style='border:1px solid #000;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            html.Append("<thead><tr>");
            html.Append("<th style='text-align:left;padding:10px;border-bottom:1px solid #000;width:3%;'>SL No</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:12%;'>Container No.</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:5%;'>Ct Sz</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:12%;'>ICD Code</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>In Date</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Sla Cd</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Origin</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>No Ob</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>No Pkg</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Gr Wt</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>No Boe</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:11%;'>Shed</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Area</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Seal Cut.Date</th>");
            html.Append("</tr></thead>");
            html.Append("<tbody>");

            lstCont.ForEach(item =>
            {
                html.Append("<tr>");
                html.Append("<td style='text-align:left;padding:10px;width:3%;'>" + item.SlNo + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:12%;'>" + item.ContainerNo + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:5%;'>" + item.Size + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:12%;'>" + item.CFSCode + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.InDate + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.SlaCd + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.Origin + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.NoObl + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.NoPkg + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.GrWt + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.NoBoe + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:11%;'>" + item.Shed + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.Area + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.SealCuttingDate + "</td>");
                html.Append("</tr>");
            });
            html.Append("<tr><th colspan='7' style='border-top:1px solid #000;text-align:left;padding:10px;'>Total :-</th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;width:10%;'>" + sumobl + "</th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;width:10%;'>" + sumNoPkg + "</th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;width:10%;'>" + sumGrWt + "</th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;width:10%;'>" + sumNoBoe + "</th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;'></th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;width:10%;'>" + sumArea + "</th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;'></th></tr>");
            html.Append("</tbody>");
            html.Append("</table></td></tr>");

            html.Append("<tr><td><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12' style='font-size:13px;'>CARGO DELIVERED FROM THE GODOWN :</td></tr>");

            html.Append("<tr><td colspan='12'><table style='border:1px solid #000;border-bottom:none;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            html.Append("<thead><tr>");
            html.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>No of Boe</th>");
            html.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>No of Pkg</th>");
            html.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Gr Weight</th>");
            html.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Area</th>");
            html.Append("</tr></thead>");
            html.Append("<tbody><tr>");

            int cargoNoBoe = 0;
            int cargoNoPkg = 0;
            decimal cargoGrWt = 0;
            decimal cargoArea = 0;
            lstCargo.ForEach(item =>
            {
                cargoNoBoe = item.NoBoe;
                cargoNoPkg = item.NoPkg;
                cargoGrWt = item.GrWt;
                cargoArea = item.Area;
                html.Append("<td style='text-align:left;padding:10px;border-right:1px solid #000;'>" + item.NoBoe + "</td>");
                html.Append("<td style='text-align:center;padding:10px;border-right:1px solid #000;'>" + item.NoPkg + "</td>");
                html.Append("<td style='text-align:center;padding:10px;border-right:1px solid #000;'>" + item.GrWt + "</td>");
                html.Append("<td style='text-align:center;padding:10px;'>" + item.Area + "</td>");

            });
            html.Append("</tr></tbody>");
            html.Append("</table></td></tr>");

            html.Append("<tr><td><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12' style='font-size:13px;'>SUMMARY</td></tr>");

            html.Append("<tr><td colspan='12'>");
            html.Append("<table style='border:1px solid #000;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");

            html.Append("<td colspan='3' width='25%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            html.Append("<thead><tr><th colspan='12' width='100%' style='font-size:14px;text-align:center;border-bottom:1px solid #000;padding:10px;'>OPENING BALANCE</th></tr>");
            html.Append("<tr><td colspan='12' style='padding:0;border-bottom:1px solid #000;'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Obl</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>No Pkg</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Weight</th>");
            html.Append("<th width='10%' style='text-align:center;padding:10px;'>Area</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></thead>");
            html.Append("<tbody><tr><td colspan='12'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
            html.Append("<td width='10%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'></td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></tbody>");
            html.Append("</table></td>");

            html.Append("<td colspan='3' width='25%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            html.Append("<thead><tr><th colspan='12' width='100%' style='font-size:14px;text-align:center;border-bottom:1px solid #000;padding:10px;'>RECEIPT</th></tr>");
            html.Append("<tr><td colspan='12' style='padding:0;border-bottom:1px solid #000;'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Obl</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>No Pkg</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Weight</th>");
            html.Append("<th width='10%' style='text-align:center;padding:10px;'>Area</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></thead>");
            html.Append("<tbody><tr><td colspan='12'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + sumobl + "</td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + sumNoPkg + "</td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + sumGrWt + "</td>");
            html.Append("<td width='10%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'>" + sumArea + "</td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></tbody>");
            html.Append("</table></td>");

            html.Append("<td colspan='3' width='25%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            html.Append("<thead><tr><th colspan='12' width='100%' style='font-size:14px;text-align:center;border-bottom:1px solid #000;padding:10px;'>ISSUE</th></tr>");
            html.Append("<tr><td colspan='12' style='padding:0;border-bottom:1px solid #000;'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Obl</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>No Pkg</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Weight</th>");
            html.Append("<th width='10%' style='text-align:center;padding:10px;'>Area</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></thead>");
            html.Append("<tbody><tr><td colspan='12'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + cargoNoBoe + "</td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + cargoNoPkg + "</td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + cargoGrWt + "</td>");
            html.Append("<td width='10%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'>" + cargoArea + "</td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></tbody>");
            html.Append("</table></td>");

            html.Append("<td colspan='3' width='25%' valign='top' style='padding:0;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            html.Append("<thead><tr><th colspan='12' width='100%' style='font-size:14px;text-align:center;border-bottom:1px solid #000;padding:10px;'>CLOSING BALANCE</th></tr>");
            html.Append("<tr><td colspan='12' style='padding:0;border-bottom:1px solid #000;'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Obl</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>No Pkg</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Weight</th>");
            html.Append("<th width='10%' style='text-align:center;padding:10px;'>Area</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></thead>");
            html.Append("<tbody><tr><td colspan='12'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
            html.Append("<td width='10%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'></td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></tbody>");
            html.Append("</table></td>");

            html.Append("</tr></tbody></table>");
            html.Append("</td></tr>");

            html.Append("<tr><td><br/><br/><br/><br/><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><th colspan='3' width='25%' style='text-align:center;padding:10px;'>WA/JS/TA</th> ");
            html.Append("<th colspan='1' width='8.333333333333333%'></th>");
            html.Append("<th colspan='3' width='25%' style='text-align:center;padding:10px;'>SIO/SUPTD</th>");
            html.Append("<th colspan='1' width='8.333333333333333%'></th>");
            html.Append("<th colspan='3' width='25%' style='text-align:center;padding:10px;'>SAM(IMPORT)</th></tr>");
            html.Append("</tbody></table></td></tr>");

            html.Append("</tbody></table>");
            lstSB.Add(html.ToString());

            var FileName = "DTR" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4Landscape, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingPDFForDTRExp(DSRDTRExp obj, string dt, string GodownName)
        {
            StringBuilder sb = new StringBuilder();

            sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
            sb.Append("<tr><td colspan='12'>");
            sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
            sb.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
            sb.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>STOCK REGISTER CUM DAILY TRANSACTION REPORT</label></td></tr>");
            sb.Append("</tbody></table>");
            sb.Append("</td></tr>");
            sb.Append("<tr><td colspan='12'><br/><br/></td></tr>");
            sb.Append("<tr><td colspan='12'>");
            sb.Append("<table cellspacing='0' cellpadding='0' style='font-size:12px; width:100%;'><tbody>");
            sb.Append("<tr><td colspan='4' width='33.33333333333333%'><b>Shed No :</b> " + GodownName + " </td>  <td colspan='4' width='33.33333333333333%' style='text-align:center;'><b>DATE :</b> " + dt + " </td>  <td colspan='4' width='33.33333333333333%' style='text-align:right;'><b>PRINTED ON :</b> " + DateTime.Now.ToString("dd/MM/yyyy HH:mm") + " </td></tr>");
            sb.Append("</tbody></table>");
            sb.Append("</td></tr>");
            sb.Append("<tr><td colspan='12'><br/></td></tr>");
            sb.Append("</thead></table>");

            sb.Append("<table cellspacing='0' cellpadding='0' style='font-size:8pt; border:1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif;'><tbody>");
            //LOOP Start//Carting Details
            /*
            obj.lstCartingDetails.Select(a => new { ShippingLineId = a.ShippingLineId, ShippingLineName = a.ShippingLineName, SLA = a.SLA }).Distinct().ToList().ForEach(item =>
            {
                sb.Append("<tr><td colspan='12'>");
                sb.Append("<table cellspacing='0' cellpadding='10' style='font-size:8pt; width:100%;'><tbody>");
                sb.Append("<tr><th width='8%'>Sla</th><th width='8%'>" + item.SLA + "</th><th colspan='10'>" + item.ShippingLineName + "</th></tr>");

                sb.Append("<tr><th width='8%' style='border-bottom: 1px solid #000;'>Entry No</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Sb No</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Sb Date</th>");
                sb.Append("<th width='11%' style='border-bottom: 1px solid #000;'>Exporter</th>");
                sb.Append("<th width='11%' style='border-bottom: 1px solid #000;'>Cargo</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>No PKG</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Gr Wt</th>");
                sb.Append("<th width='11%' style='border-bottom: 1px solid #000;'>Fob</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Slot</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>G/R</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Area</th>");
                sb.Append("<th width='10%' style='border-bottom: 1px solid #000;'>Remarks</th></tr>");

                //LOOP Start//
                obj.lstCartingDetails.Where(m => m.ShippingLineId == item.ShippingLineId).ToList().ForEach(elem =>
                {
                    sb.Append("<tr><td width='8%' style='border-bottom: 1px solid #000;'>" + elem.CFSCode + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ShippingBillNo + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ShippingBillDate + "</td>");
                    sb.Append("<td width='11%' style='border-bottom: 1px solid #000;'>" + elem.ExporterName + "</td>");
                    sb.Append("<td width='11%' style='border-bottom: 1px solid #000;'>" + elem.CargoDescription + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ActualQty + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ActualWeight + "</td>");
                    sb.Append("<td width='11%' style='border-bottom: 1px solid #000;'>" + elem.FobValue + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.Slot + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.GR + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.Area + "</td>");
                    sb.Append("<td width='10%' style='border-bottom: 1px solid #000;'>" + elem.Remarks + "</td></tr>");
                });
                //LOOP End//

                sb.Append("<tr><th width='8%' valign='bottom'>Sub Total :</th>");
                sb.Append("<td width='8%' valign='bottom'></td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='11%'></td>");
                sb.Append("<td width='11%'></td>");
                sb.Append("<td width='8%' valign='bottom'>" + obj.lstCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Sum(y => y.ActualQty) + "</td>");
                sb.Append("<td width='8%' valign='bottom'>" + obj.lstCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Sum(y => y.ActualWeight) + "</td>");
                sb.Append("<td width='11%' valign='bottom'>" + obj.lstCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Sum(y => y.FobValue) + "</td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='10%'></td></tr>");

                sb.Append("<tr><th width='8%' style='border-bottom: 1px solid #000;'>Sub Count :</th>");
                sb.Append("<td colspan='11' style='border-bottom: 1px solid #000;'>" + obj.lstCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Count() + "</td></tr>");

                sb.Append("</tbody></table>");
                sb.Append("</td></tr>");
            });*/
            //LOOP End//

            //LOOP Start//Short Cargo Details
            obj.lstShortCartingDetails.Select(a => new { ShippingLineId = a.ShippingLineId, ShippingLineName = a.ShippingLineName, SLA = a.SLA }).Distinct().ToList().ForEach(item =>
            {
                sb.Append("<tr><td colspan='12'>");
                sb.Append("<table cellspacing='0' cellpadding='10' style='font-size:8pt; width:100%;'><tbody>");
                sb.Append("<tr><th width='8%'>Sla</th><th width='8%'>" + item.SLA + "</th><th colspan='10'>" + item.ShippingLineName + "</th></tr>");

                sb.Append("<tr><th width='8%' style='border-bottom: 1px solid #000;'>Entry No</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Sb No</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Sb Date</th>");
                sb.Append("<th width='11%' style='border-bottom: 1px solid #000;'>Exporter</th>");
                sb.Append("<th width='11%' style='border-bottom: 1px solid #000;'>Cargo</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>No PKG</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Gr Wt</th>");
                sb.Append("<th width='11%' style='border-bottom: 1px solid #000;'>Fob</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Slot</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>G/R</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Area</th>");
                sb.Append("<th width='10%' style='border-bottom: 1px solid #000;'>Remarks</th></tr>");

                //LOOP Start//
                obj.lstShortCartingDetails.Where(m => m.ShippingLineId == item.ShippingLineId).ToList().ForEach(elem =>
                {
                    sb.Append("<tr><td width='8%' style='border-bottom: 1px solid #000;'>" + elem.CFSCode + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ShippingBillNo + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ShippingBillDate + "</td>");
                    sb.Append("<td width='11%' style='border-bottom: 1px solid #000;'>" + elem.ExporterName + "</td>");
                    sb.Append("<td width='11%' style='border-bottom: 1px solid #000;'>" + elem.CargoDescription + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ActualQty + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ActualWeight + "</td>");
                    sb.Append("<td width='11%' style='border-bottom: 1px solid #000;'>" + elem.FobValue + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.Slot + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.GR + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.Area + "</td>");
                    sb.Append("<td width='10%' style='border-bottom: 1px solid #000;'>" + elem.Remarks + "</td></tr>");
                });
                //LOOP End//

                sb.Append("<tr><th width='8%' valign='bottom'>Sub Total :</th>");
                sb.Append("<td width='8%' valign='bottom'></td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='11%'></td>");
                sb.Append("<td width='11%'></td>");
                sb.Append("<td width='8%' valign='bottom'>" + obj.lstShortCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Sum(y => y.ActualQty) + "</td>");
                sb.Append("<td width='8%' valign='bottom'>" + obj.lstShortCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Sum(y => y.ActualWeight) + "</td>");
                sb.Append("<td width='11%' valign='bottom'>" + obj.lstShortCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Sum(y => y.FobValue) + "</td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='10%'></td></tr>");

                sb.Append("<tr><th width='8%' style='border-bottom: 1px solid #000;'>Sub Count :</th>");
                sb.Append("<td colspan='11' style='border-bottom: 1px solid #000;'>" + obj.lstShortCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Count() + "</td></tr>");

                sb.Append("</tbody></table>");
                sb.Append("</td></tr>");
            });
            //LOOP End//

            sb.Append("<tr cellpadding='10'><th width='8%' valign='bottom' style='font-size:9pt;'>Grand :</th>");
            sb.Append("<th width='8%' valign='bottom' style='font-size:9pt;'>" + obj.lstCartingDetails.Count() + "</th>");
            sb.Append("<th width='8%'></th>");
            sb.Append("<th width='11%'></th>");
            sb.Append("<th width='11%'></th>");
            sb.Append("<th width='8%' valign='bottom' style='font-size:9pt;'>" + (/*obj.lstCartingDetails.Sum(m => m.ActualQty) +*/ obj.lstShortCartingDetails.Sum(x => x.ActualQty)) + "</th>");
            sb.Append("<th width='8%' valign='bottom' style='font-size:9pt;'>" + (/*obj.lstCartingDetails.Sum(m => m.ActualWeight) +*/ obj.lstShortCartingDetails.Sum(x => x.ActualWeight)) + "</th>");
            sb.Append("<th width='11%' valign='bottom' style='font-size:9pt;'>" + (/*obj.lstCartingDetails.Sum(m => m.FobValue) +*/ obj.lstShortCartingDetails.Sum(x => x.FobValue)) + "</th>");
            sb.Append("<th width='8%'></th>");
            sb.Append("<th width='8%'></th>");
            sb.Append("<th width='8%'></th>");
            sb.Append("<th width='10%'></th></tr>");
            sb.Append("</tbody></table>");

            //CARGO SHIFTING DETAIL//
            sb.Append("<table cellspacing='0' cellpadding='10' style='margin-top:20px; font-size:8pt; border:1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif;'><tbody>");
            sb.Append("<tr><th colspan='15' style='text-align:center; font-size:10pt;'>CARGO SHIFTING DETAIL</th></tr>");
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Entry No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Sb No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Sb Date</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Exporter</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Cargo</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>No PKG</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Gr Wt</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Fob</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Slot</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>G/R</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Area</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>F-Shed</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>T-Shed</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>F-Sla</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000;'>T-Sla</th></tr>");
            //LOOP Start//
            obj.lstCargoShifting.ToList().ForEach(item =>
            {
                sb.Append("<tr><td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CFSCode + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillNo + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillDate + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ExporterName + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CargoDescription + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ActualQty + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ActualWeight + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.FobValue + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000;border-right: 1px solid #000;'>" + item.LocationName + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.GR + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.SQM + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.FromGodown + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ToGodown + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.FromShippingLine + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000;'>" + item.ToShippingLine + "</td></tr>");
            });
            //LOOP End//
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Total :</th>");
            sb.Append("<th colspan='4' width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstCargoShifting.Count() + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstCargoShifting.Sum(y => y.ActualQty) + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstCargoShifting.Sum(y => y.ActualWeight) + "</th>");
            sb.Append("<th colspan='8' width='11%' style='border-top: 1px solid #000;'>" + obj.lstCargoShifting.Sum(y => y.FobValue) + "</th></tr>");
            sb.Append("</tbody></table>");


            //CARGO ACCEPTING DETAIL//
            sb.Append("<table cellspacing='0' cellpadding='10' style='margin-top:20px; font-size:8pt; border:1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif;'><tbody>");
            sb.Append("<tr><th colspan='15' style='text-align:center; font-size:10pt;'>CARGO ACCEPTING DETAIL</th></tr>");
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Entry No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Sb No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Sb Date</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Exporter</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Cargo</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>No PKG</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Gr Wt</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Fob</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Slot</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>G/R</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Area</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>F-Shed</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>T-Shed</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>F-Sla</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000;'>T-Sla</th></tr>");
            //LOOP Start//
            obj.lstCargoAccepting.ToList().ForEach(item =>
            {
                sb.Append("<tr><td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CFSCode + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillNo + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillDate + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ExporterName + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CargoDescription + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ActualQty + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ActualWeight + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.FobValue + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.LocationName + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.GR + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.SQM + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.FromGodown + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ToGodown + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.FromShippingLine + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000;'>" + item.ToShippingLine + "</td></tr>");
            });
            //LOOP End//
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Total :</th>");
            sb.Append("<th colspan='4' width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstCargoAccepting.Count() + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstCargoAccepting.Sum(y => y.ActualQty) + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstCargoAccepting.Sum(y => y.ActualWeight) + "</th>");
            sb.Append("<th colspan='8' width='11%' style='border-top: 1px solid #000;'>" + obj.lstCargoAccepting.Sum(y => y.FobValue) + "</th></tr>");
            sb.Append("</tbody></table>");


            //BACK TO TOWN DETAIL//
            sb.Append("<table cellspacing='0' cellpadding='10' style='margin-top:20px; font-size:8pt; border:1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif;'><tbody>");
            sb.Append("<tr><th colspan='11' style='text-align:center; font-size:10pt;'>BACK TO TOWN DETAIL</th></tr>");
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Entry No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Sb No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Sb Date</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Exporter</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Cargo</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>No PKG</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Gr Wt</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Fob</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Slot</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>G/R</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000;'>Area</th></tr>");
            //LOOP Start//
            obj.lstBTTDetails.ToList().ForEach(item =>
            {
                sb.Append("<tr><td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CFSCode + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillNo + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillDate + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ExporterName + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CargoDescription + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.BTTQuantity + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.BTTWeight + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.Fob + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.LocationName + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.GR + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000;'>Dynamic</td></tr>");
            });
            //LOOP End//
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Total :</th>");
            sb.Append("<th width='8%' colspan='4' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstBTTDetails.Count() + "</th>");
            sb.Append("<th  width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstBTTDetails.Sum(a => a.BTTQuantity) + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstBTTDetails.Sum(a => a.BTTWeight) + "</th>");
            sb.Append("<th width='8%' colspan='4' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstBTTDetails.Sum(a => a.Fob) + "</th></tr>");
            //sb.Append("<th colspan='4' width='11%' style='border-top: 1px solid #000;'>Dynamic</th>");
            sb.Append("</tbody></table>");


            //STUFFING DETAIL//
            sb.Append("<table cellspacing='0' cellpadding='10' style='margin-top:20px; font-size:8pt; border:1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif;'><tbody>");
            sb.Append("<tr><th colspan='11' style='text-align:center; font-size:10pt;'>STUFFING DETAIL</th></tr>");
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>S.R. No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>S.R. Date</th>");
            sb.Append("<th width='9%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>ICD Code</th>");
            sb.Append("<th width='9%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Container No</th>");
            sb.Append("<th width='5%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Size</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>SLA</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>In Date</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>No SB</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>No of Unit</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Gr Wt</th>");
            sb.Append("<th width='12%' style='border-top: 1px solid #000;'>FOB</th></tr>");
            //LOOP Start//
            obj.lstStuffingDetails.ToList().ForEach(item =>
            {
                sb.Append("<tr><td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.StuffingNo + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.StuffingDate + "</td>");
                sb.Append("<td width='9%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CFSCode + "</td>");
                sb.Append("<td width='9%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ContainerNo + "</td>");
                sb.Append("<td width='5%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.Size + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.SLA + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.EntryDateTime + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillNo + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.StuffQuantity + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.StuffWeight + "</td>");
                sb.Append("<td width='12%' style='border-top: 1px solid #000;'>" + item.Fob + "</td></tr>");
            });

            //LOOP End//
            sb.Append("<tr><th colspan='7' width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Total :</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstStuffingDetails.Sum(z => z.ShippingBillNo) + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstStuffingDetails.Sum(z => z.StuffQuantity) + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstStuffingDetails.Sum(z => z.StuffWeight) + "</th>");
            sb.Append("<th width='12%' style='border-top: 1px solid #000;'>" + obj.lstStuffingDetails.Sum(z => z.Fob) + "</th></tr>");
            sb.Append("</tbody></table>");


            sb.Append("<table cellspacing='0' cellpadding='10' style='margin-top:20px; font-size:8pt;width:100%;'><tbody><tr>");
            sb.Append("<td colspan='6' width='60%' valign='top'>");
            sb.Append("<table cellspacing='0' cellpadding='10' style='font-size:8pt; width:100%;'><tbody>");
            sb.Append("<tr><th colspan='5' style='text-align:center; font-size:10pt;'>SUMMARY</th></tr>");
            sb.Append("<tr><th width='10%' style='border: 1px solid #000; border-right: 0;'>DESC</th>");
            sb.Append("<th width='8%' style='border: 1px solid #000;'>SBS</th>");
            sb.Append("<th width='9%' style='border: 1px solid #000; border-left: 0;'>PKGS</th>");
            sb.Append("<th width='9%' style='border: 1px solid #000; border-left: 0;'>WT</th>");
            sb.Append("<th width='12%' style='border: 1px solid #000; border-left: 0;'>FOB</th></tr>");
            //LOOP Start//
            sb.Append("<tr><td width='10%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>CARGO CARTED</td>");
            sb.Append("<td width='8%' style='border: 1px solid #000; border-top: 0;'>" + obj.lstCartingDetails.Count() + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + (/*obj.lstCartingDetails.Sum(x => x.ActualQty) +*/ obj.lstShortCartingDetails.Sum(x => x.ActualQty)) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + (/*obj.lstCartingDetails.Sum(x => x.ActualWeight) +*/ obj.lstShortCartingDetails.Sum(x => x.ActualWeight)) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + (/*obj.lstCartingDetails.Sum(x => x.FobValue) +*/ obj.lstShortCartingDetails.Sum(x => x.FobValue)) + "</td></tr>");

            sb.Append("<tr><td width='10%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>CARGO SHIFTED</td>");
            sb.Append("<td width='8%' style='border: 1px solid #000; border-top: 0;'>" + obj.lstCargoShifting.Count() + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstCargoShifting.Sum(x => x.ActualQty) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstCargoShifting.Sum(x => x.ActualWeight) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstCargoShifting.Sum(x => x.FobValue) + "</td></tr>");

            sb.Append("<tr><td width='10%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>CARGO ACCEPTED</td>");
            sb.Append("<td width='8%' style='border: 1px solid #000; border-top: 0;'>" + obj.lstCargoAccepting.Count() + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstCargoAccepting.Sum(x => x.ActualQty) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstCargoAccepting.Sum(x => x.ActualWeight) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstCargoAccepting.Sum(x => x.FobValue) + "</td></tr>");

            sb.Append("<tr><td width='10%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>CARGO BTT</td>");
            sb.Append("<td width='8%' style='border: 1px solid #000; border-top: 0;'>" + obj.lstBTTDetails.Count() + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstBTTDetails.Sum(x => x.BTTQuantity) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstBTTDetails.Sum(x => x.BTTWeight) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstBTTDetails.Sum(x => x.BTTQuantity) + "</td></tr>");

            sb.Append("<tr><td width='10%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>CARGO STUFFED</td>");
            sb.Append("<td width='8%' style='border: 1px solid #000; border-top: 0;'>" + obj.lstStuffingDetails.Sum(x => x.ShippingBillNo) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstStuffingDetails.Sum(x => x.StuffQuantity) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstStuffingDetails.Sum(x => x.StuffWeight) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstStuffingDetails.Sum(x => x.Fob) + "</td></tr>");
            //LOOP End//
            sb.Append("</tbody></table>");
            sb.Append("</td>");

            sb.Append("<td colspan='6' width='40%'>");
            sb.Append("<table cellspacing='0' cellpadding='10' style='font-size:8pt; width:100%;'><tbody>");
            sb.Append("<tr><th colspan='4' style='text-align:center; font-size:10pt;'>OPENING BALANCE</th></tr>");
            sb.Append("<tr><th width='8%' style='border: 1px solid #000;border-right: 0;'>SBS</th>");
            sb.Append("<th width='9%' style='border: 1px solid #000;'>PKGS</th>");
            sb.Append("<th width='9%' style='border: 1px solid #000; border-left: 0;'>WT</th>");
            sb.Append("<th width='12%' style='border: 1px solid #000; border-left: 0;'>FOB</th></tr>");
            //LOOP Start//
            sb.Append("<tr><td width='8%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>" + obj.StockOpening.Count() + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-top: 0;'>" + obj.StockOpening.Sum(x => x.Units) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.StockOpening.Sum(x => x.Weight) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.StockOpening.Sum(x => x.Fob) + "</td></tr>");
            //LOOP End//

            sb.Append("<tr><th colspan='4' style='text-align:center; font-size:10pt;'>CLOSING BALANCE</th></tr>");
            sb.Append("<tr><th width='8%' style='border: 1px solid #000;border-right: 0;'>SBS</th>");
            sb.Append("<th width='9%' style='border: 1px solid #000;'>PKGS</th>");
            sb.Append("<th width='9%' style='border: 1px solid #000; border-left: 0;'>WT</th>");
            sb.Append("<th width='12%' style='border: 1px solid #000; border-left: 0;'>FOB</th></tr>");

            //LOOP Start//
            sb.Append("<tr><td width='8%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>" + obj.StockClosing.Count() + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-top: 0;'>" + obj.StockClosing.Sum(x => x.Units) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.StockClosing.Sum(x => x.Weight) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.StockClosing.Sum(x => x.Fob) + "</td></tr>");
            //LOOP End//
            sb.Append("</tbody></table>");
            sb.Append("</td>");
            sb.Append("</tr></tbody></table>");

            sb.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            var FileName = "DTR" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4Landscape, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, sb.ToString());
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }


        #endregion

        #region SealCuttingReport



        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult SealCuttingReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Kdl_ReportRepository ObjReport = new Kdl_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public ActionResult GetSealCuttingReport(String FromDate, String ToDate)
        {

            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            string FilePath = "";
            SealCuttingReport ObjSealCuttingReport = new SealCuttingReport();
            ObjSealCuttingReport.PeriodFrom = FromDate;
            ObjSealCuttingReport.PeriodTo = ToDate;
            ObjRR.SealCuttingReport(ObjSealCuttingReport);//, objLogin.Uid
            if (ObjRR.DBResponse.Status == 1)
            {
                string Fdt = Convert.ToDateTime(ObjSealCuttingReport.PeriodFrom).ToString("dd-MM-yyyy");
                string Tdt = Convert.ToDateTime(ObjSealCuttingReport.PeriodTo).ToString("dd-MM-yyyy");
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                FilePath = GenerateSealCuttingReportPDF(ds, Fdt, Tdt);
                return Json(new { Status = 1, Data = FilePath });
            }
            else
                return Json(new { Status = -1, Data = "No Record Found." });

        }
        public string GenerateSealCuttingReportPDF(DataSet ds, string Fdt, string Tdt)
        {
            List<dynamic> lstGodown = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstGodownWiseDtl = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();
            int SlNo = 0;

            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

            //html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td><td valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>ICD Dashrath</label><br/><label style='font-size: 14px; font-weight:bold;'>Seal Cutting Report</label><br/><br/><label style='font-size: 12px;'><b>REPORT FROM DATE</b> " + Fdt + " <b>TO</b> " + Tdt + "</label></td></tr>");
            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
            html.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>Seal Cutting Report</label><br/><br/><label style='font-size: 12px;'><b>REPORT FROM DATE</b> " + Fdt + " <b>TO</b> " + Tdt + "</label></td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");

            html.Append("<tr><td><br/></td></tr>");
            lstGodown.Distinct().ToList().ForEach(item =>
                {
                    SlNo = 1;
                    html.Append("<tr><td colspan='12' style='font-size:13px;'>Shed Cd " + item.GodownName + "</td></tr>");
                    html.Append("<tr><td colspan='12'><table style='border:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                    html.Append("<thead><tr>");
                    html.Append("<th style='text-align:left;padding:10px;border-bottom:1px solid #000;width:3%;'>Sr. No.</th>");
                    html.Append("<th style='text-align:left;padding:10px;border-bottom:1px solid #000;width:10%;'>ICD Code</th>");
                    html.Append("<th style='text-align:left;padding:10px;border-bottom:1px solid #000;width:10%;'>Container / CBT No.</th>");
                    html.Append("<th style='text-align:left;padding:10px;border-bottom:1px solid #000;width:10%;'>Cont Size</th>");
                    html.Append("<th style='text-align:left;padding:10px;border-bottom:1px solid #000;width:10%;'>Seal Cut.Date</th>");
                    html.Append("</tr></thead>");
                    html.Append("<tbody>");
                    lstGodownWiseDtl.Where(x => x.GodownID == item.GodownID).ToList().ForEach(item1 =>
                            {
                                html.Append("<tr>");
                                html.Append("<td style='text-align:left;padding:10px;width:3%;'>" + SlNo++ + "</td>");
                                html.Append("<td style='text-align:left;padding:10px;width:10%;'>" + item1.CFSCode + "</td>");
                                html.Append("<td style='text-align:left;padding:10px;width:10%;'>" + item1.ContainerNo + "</td>");
                                html.Append("<td style='text-align:left;padding:10px;width:10%;'>" + item1.Size + "</td>");
                                html.Append("<td style='text-align:left;padding:10px;width:10%;'>" + item1.SealCuttingDate + "</td>");
                                html.Append("</tr>");
                            });
                    html.Append("</tbody>");
                    html.Append("</table></td></tr>");
                });
            html.Append("</tbody></table>");

            html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
            lstSB.Add(html.ToString());

            var FileName = "SealCuttingReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }





        #endregion

        //#region Accounts Report for Import Cargo
        //[HttpGet]
        //public ActionResult ImportCargoAccountsReport()
        //{
        //    DSR_ReportRepository ObjGR = new DSR_ReportRepository();
        //    ObjGR.GetGodownRightsWise(((Login)Session["LoginUser"]).Uid);
        //    if (ObjGR.DBResponse.Data != null)
        //        ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
        //    else ViewBag.ListOfGodown = null;
        //    return PartialView();
        //}

        //[HttpPost]
        //[ValidateAntiForgeryToken]
        //public JsonResult GetImpCargo(DSR_PV ObjPV)
        //{
        //    if (ModelState.IsValid)
        //    {
        //        DSR_ReportRepository ObjRR = new DSR_ReportRepository();
        //        ObjRR.GetImpCargo(ObjPV);
        //        string Path = "";
        //        List<DSR_ImpPVReport> lstData = new List<DSR_ImpPVReport>();
        //        lstData = (List<DSR_ImpPVReport>)ObjRR.DBResponse.Data;
        //        Path = GeneratePDFImpCargo(lstData, ObjPV.AsOnDate, ObjPV.GodownName);

        //        return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
        //    }
        //    else
        //    {
        //        var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
        //        return Json(new { Status = 0, Message = ErrorMessage });
        //    }
        //}
        //[NonAction]
        //public string GeneratePDFImpCargo(List<DSR_ImpPVReport> lstData, string Date, string GodownName)
        //{
        //    try
        //    {
        //        var FileName = "ImpCargoReport.pdf";
        //        StringBuilder Pages = new StringBuilder();
        //        string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
        //        Pages.Append("<tr><td colspan='12'>");
        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
        //        Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
        //        Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 28px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 14px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:14px;'>ICD Dashrath</span><br/><span style='font-size:14px;'><b>As On Date - </b> " + Date + "</span><br/><span style='font-size:14px;'><b>Shed Cd - </b>" + GodownName + "</span><br/><label style='font-size: 16px; font-weight:bold;'>Account Report for Import Cargo</label></td></tr>");
        //        Pages.Append("</tbody></table>");
        //        Pages.Append("</td></tr>");
        //        Pages.Append("</thead></table>");

        //        int i = 1;
        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
        //        Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>S No</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:12%;'>OBL No</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Dstf Date</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>Entry No</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Item No</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Pkg</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Rcvd Pkg</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Gr Wt</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>Area</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>Slot No</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Total Wk</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;width:12%;text-align:right;'>Amount</th></tr></thead>");
        //        Pages.Append("<tbody>");
        //        lstData.ForEach(item =>
        //        {
        //            Pages.Append("<tr>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + i + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:12%;'>" + item.BOLNo + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>" + item.DestuffingEntryDate + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>" + item.CFSCode + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>" + item.CommodityAlias + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>" + item.NoOfUnits + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>" + item.NoOfUnitsRec + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Weight.ToString("0.00") + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>" + item.Area.ToString("0.00") + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>" + item.LocationName + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.TotWk + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;width:12%;text-align:right;'>" + item.Amount + "</td>");
        //            Pages.Append("</tr>");
        //            i++;
        //        });

        //        Pages.Append("<tr>");
        //        Pages.Append("<th colspan='2' style='width:3%;'>Total :</th>");
        //        Pages.Append("<th style='width:6%;'></th>");
        //        Pages.Append("<th style='width:7%;'></th>");
        //        Pages.Append("<th style='width:4%;'></th>");
        //        Pages.Append("<th style='border-right:1px solid #000;width:4%;'>" + lstData.AsEnumerable().Sum(item => item.NoOfUnits) + "</th>");
        //        Pages.Append("<th style='border-right:1px solid #000;width:4%;'>" + lstData.AsEnumerable().Sum(item => item.NoOfUnitsRec) + "</th>");
        //        Pages.Append("<th style='border-right:1px solid #000;width:8%;'>" + lstData.AsEnumerable().Sum(item => item.Weight) + "</th>");
        //        Pages.Append("<th style='border-right:1px solid #000;width:7%;'>" + lstData.AsEnumerable().Sum(item => item.Area) + "</th>");
        //        Pages.Append("<th style='border-right:1px solid #000;width:7%;'></th>");
        //        Pages.Append("<th style='border-right:1px solid #000;width:5%;'>" + lstData.AsEnumerable().Sum(item => item.TotWk) + "</th>");
        //        Pages.Append("<th style='width:12%;text-align:right;'>" + lstData.AsEnumerable().Sum(item => item.Amount) + "</th>");
        //        Pages.Append("</tr>");
        //        Pages.Append("</tbody></table>");

        //        Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

        //        if (!Directory.Exists(LocalDirectory))
        //        {
        //            Directory.CreateDirectory(LocalDirectory);
        //        }
        //        if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
        //        {
        //            System.IO.File.Delete(LocalDirectory + "/" + FileName);
        //        }
        //        //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
        //        //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
        //        using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
        //        {
        //            ObjPdf.HeadOffice = this.HeadOffice;
        //            ObjPdf.HOAddress = this.HOAddress;
        //            ObjPdf.ZonalOffice = this.ZonalOffice;
        //            ObjPdf.ZOAddress = this.ZOAddress;
        //            ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
        //        }
        //        return "/Docs/" + Session.SessionID + "/Report/" + FileName;
        //    }
        //    catch
        //    {
        //        return "";
        //    }
        //}
        //#endregion

        #region PV Report Of Import Loaded Container
        [HttpGet]
        public ActionResult PVReportImpLoadedCont()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetImpLoadedCont(DSR_PVReport ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.GetImpLoadedCont(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    List<DSR_PVReportImpLoadedCont> lstData = new List<DSR_PVReportImpLoadedCont>();
                    lstData = (List<DSR_PVReportImpLoadedCont>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFImpLoadedCont(lstData, ObjPV.AsOnDate);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFImpLoadedCont(List<DSR_PVReportImpLoadedCont> lstData, string Date)
        {
            try
            {
                var FileName = "ImpLoadedContReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><span style='font-size:12px;'><b>As On Date - </b> " + Date + "</span><br/><label style='font-size: 14px; font-weight:bold;'>Physical Verification Report for Loaded Container</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>Entry No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:11%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Sla</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>CHA Name</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Importer/ Exporter</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Origin</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>No of Days</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;text-align:right;'>GRL Amount</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:20%;'>Remarks</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:11%;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.EntryDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.EximTraderAlias + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.CHAName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.ImporterName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.TransportFrom + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>" + item.Days + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;text-align:right;'>" + item.Amount + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;width:20%;'>" + item.Remarks + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });

                Pages.Append("<tr>");
                Pages.Append("<th colspan='2' style='width:3%;'>Total :</th>");
                Pages.Append("<th style='width:11%;'></th>");
                Pages.Append("<th style='width:8%;'></th>");
                Pages.Append("<th style='width:3%;'></th>");
                Pages.Append("<th style='width:5%;'></th>");
                Pages.Append("<th colspan='3' style='width:15%;text-align:right;'>" + lstData.Sum(o => o.Amount).ToString() + "</th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region PV Report Of Empty Container
        [HttpGet]
        public ActionResult PVReportEmptyCont()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetEmptyCont(DSR_PVReport ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.GetEmptyCont(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    List<DSR_PVReportImpEmptyCont> lstData = new List<DSR_PVReportImpEmptyCont>();
                    lstData = (List<DSR_PVReportImpEmptyCont>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFEmptyCont(lstData, ObjPV.AsOnDate);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFEmptyCont(List<DSR_PVReportImpEmptyCont> lstData, string Date)
        {
            try
            {
                var FileName = "EmptyContReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><span style='font-size:12px;'><b>As On - </b> " + Date + "</span><br/><label style='font-size: 14px; font-weight:bold;'>Physical Verification Report of Empty Containers</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>Sno</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>Entry No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:11%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Sla Cd</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>In Date Ecy</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>Out Date Ecy</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Days</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:12%;text-align:right;'>GRE Amount</th></tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:11%;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.EntryDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.EximTraderAlias + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.InDateEcy + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>" + item.OutDateEcy + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.Days + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;width:12%;text-align:right;'>" + item.Amount + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });
                Pages.Append("<tr>");
                Pages.Append("<th colspan='2' style='width:3%;'>Total :</th>");
                Pages.Append("<th style='width:11%;'></th>");
                Pages.Append("<th style='width:8%;'></th>");
                Pages.Append("<th style='width:3%;'></th>");
                Pages.Append("<th style='width:5%;'></th>");
                Pages.Append("<th style='width:8%;'></th>");
                Pages.Append("<th colspan='3' style='width:12%;text-align:right;'>" + lstData.Sum(o => o.Amount).ToString() + "</th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Collection Report
        [HttpGet]
        public ActionResult CollectionReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Kdl_ReportRepository ObjReport = new Kdl_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}
            ViewBag.TotalCash = 0;
            ViewBag.TotalPDA = 0;
            ViewBag.TotalBank = 0;

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetCollectionReport(DSR_CollectionReport ObjDebtorReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_CollectionReport> LstInvoiceReportDetails = new List<DSR_CollectionReport>();
            DSR_FinalCollectionReportTotal objFinalCollectionReportTotal = new DSR_FinalCollectionReportTotal();
            DSR_CollectionReportTotal objCollectionReportTotal = new DSR_CollectionReportTotal();
            //  Login objLogin = (Login)Session["LoginUser"];
            ObjRR.CollectionReport(ObjDebtorReport);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                objFinalCollectionReportTotal = (DSR_FinalCollectionReportTotal)ObjRR.DBResponse.Data;
                LstInvoiceReportDetails = objFinalCollectionReportTotal.listCollectionReport.ToList();
                objCollectionReportTotal = objFinalCollectionReportTotal.objCollectionReportTotal;

                ViewBag.TotalCash = objCollectionReportTotal.TotalCash;
                ViewBag.TotalPDA = objCollectionReportTotal.TotalPDA;
                ViewBag.TotalBank = objCollectionReportTotal.TotalBank;

                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateCollectionReportPDF(FormCollection fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "CollectionReport.pdf";
                Pages[0] = fc["Page"].ToString();

                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/CollectionReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/CollectionReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion

        #region Bulk Credit Note
        [HttpPost]
        public JsonResult GetBulkCreditNote(string InvoiceNumber, int PartyId, DateTime FromDate, DateTime ToDate)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.BulkCreditNoteprint(InvoiceNumber, PartyId, FromDate, ToDate);
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                string FilePath = "";
                FilePath = GeneratingBulkPDFforCRNote(ds);
                return Json(new { Status = 1, Data = FilePath });
            }
            else
                return Json(new { Status = -1, Data = "No Record Found." });

        }
        [NonAction]
        public string GeneratingBulkPDFforCRNote(DataSet ds)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td colspan='8' width='90%' width='100%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'></label>");
                html.Append("</td></tr>");
                html.Append("<tr><td colspan='12' style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Credit Note</h2> </td></tr>");
                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Credit Note No.</label> <span>" + item.CRNoteNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Credit Date : </label> <span>" + item.CRNoteDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                html.Append("<span>" + item.PartyName + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                html.Append("Party Address :</label> <span>" + item.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("</tr></tbody> ");
                html.Append("</table></td></tr><tr><td><hr /></td></tr><tr><th><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container Details :</b> </th></tr>");
                int i = 1;
                /*html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>To Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                /*
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.FromDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ToDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });*/
                /***************/
                /*html.Append("</tbody></table></td></tr>");*/
                //html.Append("<tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container Charges :</h3> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.CRNoteId == item.CRNoteId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + data.Taxable.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 150px;'>" + data.Total.ToString("0") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TotalTaxable.ToString("0") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0") + "</th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 11px; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr><td style='font-size: 12px; text-align: left; line-height: 30px;'>Receipt No.: ");
                html.Append("<label style='font-weight: bold;'></label></td><td style='font-size: 12px; text-align: left; line-height: 30px;'>Party Code:");
                html.Append("<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr><tr><td style='font-size: 11px; text-align: left; line-height: 30px;'>");
                html.Append("*Cheques are subject to realisation</td><td style='font-size: 11px; text-align: left; line-height: 30px;'>SAM(A/C)</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        #region Bulk Credit Note
        [HttpGet]
        public ActionResult GetBulkCreditNote()
        {
            return PartialView();
        }
        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult GetBulkCreditNoteReport(FormCollection fc)
        {
            DSR_ReportRepository objRR = new DSR_ReportRepository();
            objRR.GetBulkCreditNoteReport(Convert.ToDateTime(fc["PeriodFrom"]).ToString("yyyy/MM/dd"), Convert.ToDateTime(fc["PeriodTo"]).ToString("yyyy/MM/dd"));
            List<string> lststring = new List<string>();
            if (objRR.DBResponse.Data != null)
            {
                lststring = (List<string>)objRR.DBResponse.Data;
                List<string> pdfPages = new List<string>();
                /*PDF Gneration*/
                string Path = Server.MapPath("~/Docs/") + Session.SessionID + "/";
                string FileName = "BulkCRNote" + "CR" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                    Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                lststring.ForEach(item =>
                {
                    if (!string.IsNullOrEmpty(item) && item != "")
                    {
                        item = System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(item));
                        pdfPages.Add(item.Replace("|_br_|", "<br/>"));
                    }
                });
                //using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f))
                //{
                //    rh.GeneratePDF(Path + FileName, pdfPages.ToArray());
                //}
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(Path + FileName, pdfPages.ToArray());

                }
                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/" + FileName });
            }
            else
                return Json(new { Status = -1, Message = "No Data" });
        }
        #endregion

        #region Bulk Debit Note
        [HttpGet]
        public ActionResult GetBulkDeditNote()
        {
            return PartialView();
        }
        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult GetBulkDebitNoteReport(FormCollection fc)
        {
            DSR_ReportRepository objRR = new DSR_ReportRepository();
            objRR.GetBulkDebitNoteReport(Convert.ToDateTime(fc["PeriodFrom"]).ToString("yyyy/MM/dd"), Convert.ToDateTime(fc["PeriodTo"]).ToString("yyyy/MM/dd"));
            List<string> lststring = new List<string>();
            if (objRR.DBResponse.Data != null)
            {
                lststring = (List<string>)objRR.DBResponse.Data;
                List<string> pdfPages = new List<string>();
                /*PDF Gneration*/
                string Path = Server.MapPath("~/Docs/") + Session.SessionID + "/";
                string FileName = "BulkDRNote" + "DR" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                    Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                lststring.ForEach(item =>
                {
                    if (!string.IsNullOrEmpty(item) && item != "")
                    {
                        item = System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(item));
                        pdfPages.Add(item.Replace("|_br_|", "<br/>"));
                    }
                });
                //using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f))
                //{
                //    rh.GeneratePDF(Path + FileName, pdfPages.ToArray());
                //}

                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(Path + FileName, pdfPages.ToArray());

                }
                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/" + FileName });
            }
            else
                return Json(new { Status = -1, Message = "No Data" });
        }
        #endregion 

        #region Debtor Report

        [HttpGet]
        public ActionResult DebtorReport()
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<EximTraderWithInvoice> LstEximTraderWithInvoice = new List<EximTraderWithInvoice>();
            ObjRR.GetEximTraderWithInvoice();
            if (ObjRR.DBResponse.Data != null)
            {
                LstEximTraderWithInvoice = (List<EximTraderWithInvoice>)ObjRR.DBResponse.Data;
            }
            ViewBag.EximTraderWithInvoice = LstEximTraderWithInvoice;

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetDebtorReport(DebtorReport ObjDebtorReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DebtorReport> LstInvoiceReportDetails = new List<DebtorReport>();
            //  Login objLogin = (Login)Session["LoginUser"];
            ObjRR.DebtorReport(ObjDebtorReport);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstInvoiceReportDetails = (List<DebtorReport>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateDebtorReportPDF(FormCollection fc)
        {
            try
            {

                string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "DebtorReport.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/DebtorReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/DebtorReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion

        #region service code wise Invoice Details

        [HttpGet]
        public ActionResult ServiceCodeWiseInvDtls()
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSRSACList> LstSAC = new List<DSRSACList>();
            ObjRR.GetSAC();
            if (ObjRR.DBResponse.Data != null)
            {
                LstSAC = (List<DSRSACList>)ObjRR.DBResponse.Data;
            }
            ViewBag.SACList = LstSAC;

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetServiceCodeWiseInvDtls(DSRServiceCodeWiseInvDtls ObjServiceCodeWiseInvDtls)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSRServiceCodeWiseInvDtls> LstInvoiceReportDetails = new List<DSRServiceCodeWiseInvDtls>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.ServiceCodeWiseInvDtls(ObjServiceCodeWiseInvDtls);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstInvoiceReportDetails = (List<DSRServiceCodeWiseInvDtls>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateServiceCodeWiseInvDtlsPDF(FormCollection fc)
        {
            try
            {

                string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "ServiceCodeWiseInvoiceDetails.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/ServiceCodeWiseInvoiceDetails/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/ServiceCodeWiseInvoiceDetails/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion

        #region DailyInvoiceReport


        [HttpGet]
        public ActionResult DailyInvoiceReport()
        {


            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetDailyInvoiceReport(DSR_DailyInvReport ObjDailyReport)
        {

            if (ModelState.IsValid)
            {

                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.DailyInvoiceReport(ObjDailyReport);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {

                    List<DSR_DailyReport> lstPV = new List<DSR_DailyReport>();
                    lstPV = (List<DSR_DailyReport>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFDailyInvoiceReport(lstPV, ObjDailyReport.FromDate, ObjDailyReport.ToDate);
                }


                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }

        }

        [NonAction]
        public string GeneratePDFDailyInvoiceReport(List<DSR_DailyReport> lstPV, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "DailyInvoiceReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><span style='font-size:12px;'><b>From Date - </b>" + FromDate + "</span><br/><span style='font-size:12px;'><b>To Date - </b>" + ToDate + "</span><br/><label style='font-size: 14px; font-weight:bold;'>Daily Invoice Report</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");



                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S. No.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Invoice No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Party</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Total Amount</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Receipt No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Receipt Amount</th></tr></thead>");
                Pages.Append("<tbody>");
                lstPV.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Party + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.TotalAmt + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ReceiptNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ReceiptAmt + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });

                // Pages.Append("<tr>");
                // Pages.Append("<th colspan='5' style='border-bottom:1px solid #000;text-align:left;'>Total :</th>");
                //Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.NoOfUnits) + "</th>");
                // Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.NoOfUnitsRec) + "</th>");
                // Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Weight).ToString("0.00") + "</th>");
                // Pages.Append("<th colspan='3' style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Area).ToString("0.00") + "</th>");
                //  Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }

        #endregion

        #region SD Summary Daily Report
        [HttpGet]
        public ActionResult SDSumryDlyReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetSDSumryDly(string PeriodFrom, string PeriodTo)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.SDSummary(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                List<DSRSDSummary> lstData = new List<DSRSDSummary>();
                lstData = (List<DSRSDSummary>)ObjRR.DBResponse.Data;
                Path = GeneratePDFSDSumryDly(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);

            }
            else
            {
                return Json(new { Status = 0, Data = "" }, JsonRequestBehavior.AllowGet);
            }

        }
        [NonAction]
        public string GeneratePDFSDSumryDly(List<DSRSDSummary> lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "SDSumryDlyReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><span style='font-size:12px;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 14px; font-weight:bold;'>SD SUMMARY DAILY REPORT</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:6pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Sl.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Invoice No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Invoice Type</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Party Name</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Payer Name</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Pay Mode</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>GEN SPACE</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>STO</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>INS</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>GRE</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>GRL</th>");

                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>H & T</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Other</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>MISC</th>");

                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>PCS</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>DOC</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>RCT SEAL</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>WET</th>");

                // Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>BILL</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CGST</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>SGST</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>IGST</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Round Up</th>");

                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:13%;'>TOTAL</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>TDS</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>CR.TDS</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;text-align:right;'>Remarks</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Date + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Module + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.PartyName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.PayeeName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.PaymentType + "</td>");
                    //Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GEN + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.STO + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.INS + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GRE + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GRL + "</td>");

                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.HT + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.OTHS + "</td>");

                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MISC + "</td>");

                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.PCS + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.DOC + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.RCTSEAL + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.WET + "</td>");
                    //Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.BILL + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.RoundUp + "</td>");

                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Total + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.TDS + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CRTDS + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;text-align:right;'>" + item.Remarks + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:5%;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:9%;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:9%;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:5%;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:9%;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:9%;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:15%; text-align:right;'>Total :</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.GEN) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.STO) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.INS) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.GRE) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.GRL) + "</th>");

                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.HT) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.OTHS) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.MISC) + "</th>");

                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.PCS) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + lstData.Sum(x => x.DOC) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.RCTSEAL) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.WET) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.BILL) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.CGST) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.SGST) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.IGST) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.Total) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>" + lstData.Sum(x => Convert.ToDecimal(x.TDS)) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.CRTDS) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'></th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }

                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region StatementOfEmptyContainer



        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult StatementOfEmptyContainer()
        {


            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetStatementOfEmptyContainer(DSRStatementOfEmptyContainer ObjStatementOfEmptyContainer)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSRStatementOfEmptyContainer> LstStatementOfEmptyContainer = new List<DSRStatementOfEmptyContainer>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.StatementOfEmptyContainer(ObjStatementOfEmptyContainer);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstStatementOfEmptyContainer = (List<DSRStatementOfEmptyContainer>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateStatementOfEmptyContainerPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "StatementOfEmptyContainer.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/DailyCashBookReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/DailyCashBookReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }





        #endregion

        #region RR Report
        [HttpGet]
        public ActionResult ExportRRReport()
        {
            //  DataSet ds1 = new DataSet();
            // GeneratingBulkPDFforRR(ds1);
            DSR_ReportRepository ObjIR = new DSR_ReportRepository();



            ObjIR.GetContainerForExportRR();
            if (ObjIR.DBResponse.Data != null)
            {
                ViewBag.LstContainerNo = new SelectList((List<DSRExportRRReport>)ObjIR.DBResponse.Data, "CFSCode", "ContainerNo");
            }
            else
            {
                ViewBag.LstRequestNo = null;
            }
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportRRReport(DSRExportRRReport ObjDailyPdaActivityReport)
        {
            //  DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            string FilePath = "";
            //  List<DailyPdaActivityReport> LstDailyPdaActivityReport = new List<DailyPdaActivityReport>();
            //   Login objLogin = (Login)Session["LoginUser"];
            //    ObjRR.PrintExportRR(ObjDailyPdaActivityReport.ContainerNo, ObjDailyPdaActivityReport.CFSCode);//, objLogin.Uid
            //  if (ObjRR.DBResponse.Data != null)
            // {
            // DataSet ds = (DataSet)ObjRR.DBResponse.Data;
            FilePath = GeneratingBulkPDFforRR(ObjDailyPdaActivityReport.ContainerNo, ObjDailyPdaActivityReport.CFSCode);


            return Json(new { Status = 1, Data = FilePath });
            // }
            // else
            //    return Json(new { Status = -1, Data = "No Record Found." });

        }


        [NonAction]
        public string GeneratingBulkPDFforRR(String Contno, String CFSCode)
        {

            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.PrintExportRR(Contno, CFSCode);//, objLogin.Uid
            PrintExportRRReport ObjRRData = new PrintExportRRReport();
            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();
            if (ObjRR.DBResponse.Data != null)
            {

                ObjRRData = (PrintExportRRReport)ObjRR.DBResponse.Data;
                String Pnm = "", Pynm = "";
                String Cont = "", Sz = "", Loaded = "";
                int Pack = 0;
                decimal GW = 0;
                ObjRRData.LstPartyDetails.ForEach(item =>
                {
                    Pnm = item.PartyName + " " + "(" + item.PartyAddress + ")";
                    Pynm = item.PayeeName + " " + "(" + item.PayeeAddress + ")";

                });

                ObjRRData.LstContDetails.ForEach(item =>
                {
                    Cont = item.ContainerNo;
                    Sz = item.Size;
                    Loaded = item.Loaded;
                    Pack = item.NoOfPackages;
                    GW = item.GrossWt;

                });

                decimal RR = 0;
                decimal THC = 0;
                decimal CGST = 0;
                decimal SGST = 0;
                decimal IGST = 0;
                decimal INVAMT = 0;
                ObjRRData.LstChargesDetails.ForEach(item =>
                {
                    RR = item.RR;
                    THC = item.THC;
                    CGST = item.CGST;
                    SGST = item.SGST;
                    IGST = item.IGST;
                    INVAMT = item.Inv;
                });
                String PAN = "", GST = "";
                ObjRRData.LstCompDetails.ForEach(item =>
                {
                    PAN = item.Pan;
                    GST = item.GstIn;

                });
                String InvNo = "", Rctno = "", RDate = "", Payee = "";
                Decimal InvValue = 0;
                ObjRRData.LstReceiptDetails.ForEach(item =>
                {
                    InvNo = item.InvoiceNo;
                    Rctno = item.ReceiptNo;
                    RDate = item.ReceiptDate;
                    Payee = item.PayeeName;
                    InvValue = item.InvoiceAmt;

                });

                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td colspan='10' width='100%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking)</label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>ICD Dashrath</span>");
                html.Append("<br/><label style='font-size: 14px; font-weight:bold;'>INLAND WAY BILL</label>");
                html.Append("</td></tr>");
                html.Append("<tr><td><br/><br/></td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='border:1px solid #000; border-bottom: none; width:100%; font-size:8pt;' cellspacing='0' cellpadding='10'><tbody>");
                html.Append("<tr><td colspan='4' width='33.33333333333333%'><b>TRAIN NO :</b> " + ObjRRData.TrainNo + " </td>");
                html.Append("<td colspan='4' width='33.33333333333333%'><b>NON NEGOTIABLE/NON TRANSFERABLE</b></td>");
                html.Append("<td colspan='4' width='33.33333333333333%' style='text-align:right;'><b>TRAIN DATE :</b> " + ObjRRData.TrainDate + "</td></tr>");

                html.Append("<tr><td colspan='6' width='50%'><b>OPERATOR :</b> CWC</td>");
                html.Append("<td colspan='6' width='50%' style='text-align:right;'><b>Invoice No :</b> " + ObjRRData.InvoiceNo + "</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='border:1px solid #000; width:100%; font-size:8pt;' cellspacing='0' cellpadding='0'><tbody>");
                html.Append("<tr>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:8pt;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='6' width='50%' style='border-right:1px solid #000;' cellpadding='10'>");
                html.Append("CONSIGNOR (NAME & ADDRESS)<br/> <b>" + Pnm + "</b>");
                html.Append("</td>");
                html.Append("<td colspan='6' width='50%' style='border-right:1px solid #000;' cellpadding='10'>");
                html.Append("CONSIGNEE (NAME & ADDRESS)<br/> <b>" + Pynm + "</b>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:8pt;' valign='top' cellspacing='0' cellpadding='10'><tbody>");

                html.Append("<tr><td><table style='width:100%; font-size:8pt;' valign='top' cellspacing='0' cellpadding='0'>");
                html.Append("<thead><tr><th>ICD/CFS/PORT</th>");
                html.Append("<th>CODE</th>");
                html.Append("<th>RLY. STN.</th>");
                html.Append("<th>CODE</th></tr></thead>");
                html.Append("<tbody><tr>");
                html.Append("<td>" + ObjRRData.CFS_Port + "</td>");
                html.Append("<td>" + ObjRRData.PortCode + "</td>");
                html.Append("<td></td>");
                html.Append("<td></td>");
                html.Append("</tr></tbody>");
                html.Append("</table></td></tr>");

                html.Append("<tr><td><table style='width:100%; font-size:8pt;' valign='top' cellspacing='0' cellpadding='0'>");
                html.Append("<thead><tr><th>RLY. STN.</th>");
                html.Append("<th>CODE</th>");
                html.Append("<th>ICD/CFS/PORT CODE</th></tr></thead>");
                html.Append("<tbody><tr>");
                html.Append("<td>MND</td>");
                html.Append("<td></td>");
                html.Append("<td></td>");
                html.Append("</tr></tbody>");
                html.Append("</table></td></tr>");

                html.Append("</tbody></table></td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='border:1px solid #000; width:100%; font-size:8pt;' cellspacing='0' cellpadding='0'><tbody>");
                html.Append("<tr>");
                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='6' width='50%' style='border-right:1px solid #000;' valign='top'><table style='width:100%; font-size:7pt;' cellspacing='0'>");
                html.Append("<thead><tr><th colspan='12' style='font-size:12px;text-align:center;border-bottom:1px solid #000;padding:6px;'>CONTAINER</th></tr>");
                html.Append("<tr><th colspan='4' width='30%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:6px;'>Number</th>");
                html.Append("<th colspan='3' width='25%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:6px;'>Type</th>");
                html.Append("<th colspan='2' width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:6px;'>Size</th>");
                html.Append("<th colspan='3' width='25%' style='text-align:center;border-bottom:1px solid #000;padding:6px;'>L/E</th></tr></thead>");
                html.Append("<tbody><tr><td colspan='4' width='30%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:6px;'>" + Cont + "</td>");
                html.Append("<td colspan='3' width='25%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:6px;'></td>");
                html.Append("<td colspan='2' width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:6px;'>" + Sz + "</td>");
                html.Append("<td colspan='3' width='25%' style='text-align:center;border-bottom:1px solid #000;padding:6px;'>" + Loaded + "</td></tr></tbody>");
                html.Append("</table></td>");
                html.Append("<td colspan='6' width='50%' valign='top'><table style='width:100%; font-size:7pt;' cellspacing='0'>");
                html.Append("<thead><tr><th colspan='12' style='font-size:12px;text-align:center;border-bottom:1px solid #000;padding:6px;'>CARGO</th></tr>");
                html.Append("<tr><th colspan='4' width='33.33%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:6px;'>Total Pkgs.</th>");
                html.Append("<th colspan='4' width='33.33%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:6px;'>Description Type</th>");
                html.Append("<th colspan='4' width='33.33%' style='text-align:center;border-bottom:1px solid #000;padding:6px;'>Net. Wgt.(Kg)</th></tr></thead>");
                html.Append("<tbody><tr><td colspan='4' width='33.33%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:6px;'>" + Pack + "</td>");
                html.Append("<td colspan='4' width='33.33%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:6px;'></td>");
                html.Append("<td colspan='4' width='33.33%' style='text-align:center;border-bottom:1px solid #000;padding:6px;'>" + GW + "</td></tr></tbody>");
                html.Append("</table></td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td>");
                html.Append("<td colspan='6' width='50%' style='border-left:1px solid #000;' valign='top'><table style='width:100%; font-size:7pt;' cellspacing='0'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 130px; padding:8px;'>GROSS WT <br/> (Kg)</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 200px; padding:8px;'>SEAL NUMBER</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; text-align: center; width: 100px; padding:8px;'>RAIL FLAT <br/> NUMBER</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 50px; padding:8px;'>Customs</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 50px; padding:8px;'>S.Line</th></tr></thead>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000;border-bottom: 1px solid #000; text-align: center; width: 130px; padding:8px;'>" + GW + "</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000;border-bottom: 1px solid #000; text-align: center; width: 100px; padding:8px;'>" + ObjRRData.CustomSeal + "</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000;border-bottom: 1px solid #000; text-align: center; width: 50px; padding:8px;'>" + ObjRRData.SLine + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align: center; width: 50px; padding:8px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table></td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='border-left: 1px solid #000; border-right: 1px solid #000; width:100%; font-size:8.5pt;' cellspacing='0' cellpadding='0'><tbody>");
                html.Append("<tr><td colspan='4' width='33.33333333333333%' cellpadding='20'>Said to contain & said to Weight</td>");
                html.Append("<td colspan='4' width='33.33333333333333%' cellpadding='20'style='text-align:center;'><b>Stuffed at ICD PPG</b></td>");
                html.Append("<td colspan='4' width='33.33333333333333%' cellpadding='20' style='text-align:right;'><b>Tare Wgt.(Kg) :</b>" + ObjRRData.TW + "</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='0'><tbody>");
                html.Append("<tr><td>");
                html.Append("<table style='border: 1px solid #000;border-top:none;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                html.Append("<td colspan='6' width='50%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%; font-size:6pt; font-family:Verdana,Arial,San-serif; border-collapse:collapse;'>");
                html.Append("<thead><tr><th colspan='12' style='border-bottom: 1px solid #000; font-size:13px; text-align:center; padding:10px;'>CHARGES</th></tr>");
                html.Append("<tr><th colspan='2' width='12%' style='border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'></th>");
                html.Append("<th colspan='2' width='20%' style='border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>RR Chrg</th>");
                html.Append("<th colspan='2' width='10%' style='border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>THC</th>");
                html.Append("<th colspan='1' width='12%' style='border-right:1px solid #000;border-bottom:1px solid #000;text-align:left;padding:10px;'>SGST</th>");
                html.Append("<th colspan='1' width='12%' style='border-right:1px solid #000;border-bottom:1px solid #000;text-align:left;padding:10px;'>CGST</th>");
                html.Append("<th colspan='1' width='12%' style='border-right:1px solid #000;border-bottom:1px solid #000;text-align:left;padding:10px;'>IGST</th>");
                html.Append("<th colspan='3' width='24%' style='border-bottom:1px solid #000;text-align:center;padding:10px;'>Total</th></tr></thead>");
                html.Append("<tbody>");
                html.Append("<tr><td colspan='2' width='12%' style='border-right:1px solid #000; border-bottom:1px solid #000; text-align:center; padding:10px;'></td>");
                html.Append("<td colspan='2' width='20%' style='border-right:1px solid #000; border-bottom:1px solid #000;text-align:center; padding:10px;'>" + RR + "</td>");
                html.Append("<td colspan='2' width='10%' style='border-right:1px solid #000; border-bottom:1px solid #000; text-align:center; padding:10px;'>" + THC + "</td>");
                html.Append("<td colspan='1' width='12%' style='border-right:1px solid #000; border-bottom:1px solid #000; text-align:left; padding:10px;'>" + SGST + "</td>");
                html.Append("<td colspan='1' width='12%' style='border-right:1px solid #000; border-bottom:1px solid #000; text-align:left; padding:10px;'>" + CGST + "</td>");
                html.Append("<td colspan='1' width='12%' style='border-right:1px solid #000; border-bottom:1px solid #000; text-align:left; padding:10px;'>" + IGST + "</td>");
                html.Append("<td colspan='3' width='24%' style='border-bottom:1px solid #000;text-align:center; padding:10px;'>" + INVAMT + "</td></tr>");

                html.Append("<tr><td colspan='2' width='12%' style='border-right:1px solid #000; text-align:center; padding:10px;'><b>Total</b></td>");
                html.Append("<td colspan='2' width='20%' style='border-right:1px solid #000; text-align:center; padding:10px;'>" + RR + "</td>");
                html.Append("<td colspan='2' width='10%' style='border-right:1px solid #000; text-align:center; padding:10px;'>" + THC + "</td>");
                html.Append("<td colspan='1' width='12%' style='border-right:1px solid #000; text-align:left; padding:10px;'>" + SGST + "</td>");
                html.Append("<td colspan='1' width='12%' style='border-right:1px solid #000; text-align:left; padding:10px;'>" + CGST + "</td>");
                html.Append("<td colspan='1' width='12%' style='border-right:1px solid #000; text-align:left; padding:10px;'>" + IGST + "</td>");
                html.Append("<td colspan='3' width='24%' style='text-align:center; padding:10px;'>" + INVAMT + "</td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td>");

                html.Append("<td colspan='6' width='50%' valign='top' style='padding:0;'><table style='width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                html.Append("<thead><tr><th colspan='12' style='font-size:13px;text-align:center;padding:10px;border-bottom:1px solid #000;'>REMARKS AT DESTINATION</th></tr>");
                html.Append("<tr><th colspan='3' width='25%' style='border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Under/Over</th> ");
                html.Append("<th colspan='3' width='25%' style='border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Tpt. Charges(Rs.)</th>");
                html.Append("<th colspan='2' width='16.66666667%' style='border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Amount/Date Book</th>");
                html.Append("<th colspan='2' width='16.66666667%' style='border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>DeliveryRent(Rs.)</th>");
                html.Append("<th colspan='2' width='16.66666667%' style='border-bottom:1px solid #000;text-align:center;padding:10px;'>Total</th></tr></thead>");
                html.Append("<tbody>");
                html.Append("<tr><td colspan='3' width='25%' style='border-right:1px solid #000; text-align:center; padding:10px;border-bottom:1px solid #000;'></td>");
                html.Append("<td colspan='3' width='25%' style='border-right:1px solid #000;text-align:center;padding:10px;border-bottom:1px solid #000;'></td> ");
                html.Append("<td colspan='2' width='16.66666667%%' style='border-right:1px solid #000; text-align:center;padding:10px;border-bottom:1px solid #000;'></td>");
                html.Append("<td colspan='2' width='16.66666667%%' style='border-right:1px solid #000; text-align:center;padding:10px;border-bottom:1px solid #000;'></td>");
                html.Append("<td colspan='2' width='16.66666667%%' style='text-align:center;padding:10px;border-bottom:1px solid #000;'></td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='border:1px solid #000; width:100%; font-size:8pt;' cellspacing='0' cellpadding='0'><tbody>");
                html.Append("<tr>");
                html.Append("<td colspan='6' width='50%' style='border-right:1px solid #000;' valign='bottom' cellpadding='10'><table style='width:100%; font-size:8pt;' cellspacing='0'>");
                html.Append("<tbody><tr><td style='padding:5px;'><b>CWC PAN No:</b> " + PAN + "</td></tr>");
                html.Append("<tr><td style='padding:5px;'><b>CWC GST No:</b> " + GST + "</td></tr>");
                html.Append("<tr><td style='padding:5px;'>Subject to terms & conditions printed overleaf</td></tr></tbody>");
                html.Append("</table></td>");

                html.Append("<td colspan='6' width='50%' valign='top'>");
                html.Append("<table style='width:100%; font-size:8pt;' cellspacing='0'><tr>");
                html.Append("<td colspan='7' width='70%' valign='top' cellpadding='10' style='border-right:1px solid #000;'>");
                html.Append("<table style='width:100%; font-size:8pt;' cellspacing='0'><tbody>");
                html.Append("<tr><td colspan='12' style='font-size:12px;'><b>PAID</b></td></tr>");
                html.Append("<tr><td colspan='12' style='font-size:12px;'><br/><br/></td></tr>");
                html.Append("<tr><td colspan='12' style='font-size:12px;'><b>Invoice No. :</b>" + InvNo + "</td></tr>");
                html.Append("<tr><td colspan='12' style='font-size:12px;'><b>Receipt No. :</b>" + Rctno + "</td></tr>");
                html.Append("<tr><td colspan='12' style='font-size:12px;'><b>Receipt Dt. :</b>" + RDate + "</td></tr>");
                html.Append("<tr><td colspan='12' style='font-size:12px;'><b>PDA A/c :</b>" + Payee + "</td></tr>");
                html.Append("<tr><td colspan='12' style='font-size:12px;'><b>Amount :</b>" + InvValue + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("<td colspan='5' width='30%' cellpadding='5' valign='bottom'>FOR MANAGER</td>");
                html.Append("</tr></table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");


                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            }
            var FileName = "ExportRRReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        #region-- WEEKLY REPORT --

        [HttpGet]
        public ActionResult WeeklyVCReport()
        {
            return PartialView();
        }

        [HttpGet]
        public JsonResult GetVCDetails(string date1, string date2)
        {
            try
            {
                var dt1 = DateTime.ParseExact(date1, "dd/MM/yyyy", System.Globalization.CultureInfo.InvariantCulture);
                var dt2 = DateTime.ParseExact(date2, "dd/MM/yyyy", System.Globalization.CultureInfo.InvariantCulture);
                if (dt2.DayOfWeek.ToString().ToLower() != System.Configuration.ConfigurationManager.AppSettings["VCReportDay"].ToString().ToLower())
                {
                    return Json(new { Status = 2, Message = "Report Only Show on " + System.Configuration.ConfigurationManager.AppSettings["VCReportDay"].ToString() }, JsonRequestBehavior.AllowGet);
                }
                else
                {
                    var doa = Enumerable.Range(0, 1 + dt2.Subtract(dt1).Days).Select(offset => dt1.AddDays(offset)).ToArray();
                    IList<string> formatted = new List<string>();
                    doa.ToList().ForEach(item =>
                    {
                        formatted.Add(item.ToString("yyyyMMdd"));
                    });
                    var XMLText = Utility.CreateXML(formatted);
                    var reportRepo = new DSR_ReportRepository();
                    reportRepo.VCCapacityDetails(XMLText);

                    return Json(new { Status = 1, Message = "Data Detected", Data = reportRepo.DBResponse.Data }, JsonRequestBehavior.AllowGet);
                }
            }
            catch (Exception e)
            {
                return Json(new { Status = -1, Message = "Internal Error Occurs !!" }, JsonRequestBehavior.AllowGet);
            }
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult WeeklyVCReport(FormCollection fc)
        {
            var date = Convert.ToDateTime(fc["VCTdate"].ToString());
            var cfscap = Convert.ToDecimal(fc["TWcfscap"].ToString());
            var bndcap = Convert.ToDecimal(fc["TWbndcap"].ToString());
            var total1 = Convert.ToDecimal(fc["TWtotalcap"].ToString());
            var cfsutl = Convert.ToDecimal(fc["TWcfsutl"].ToString());
            var bndutl = Convert.ToDecimal(fc["TWbndutl"].ToString());
            var total2 = Convert.ToDecimal(fc["TWtotalutl"].ToString());
            var reportRepo = new DSR_ReportRepository();
            reportRepo.AddVCDetails(date, cfscap, bndcap, cfsutl, bndutl);

            return Json(new { Status = 1, Message = "VC Report Saved Succesfully", Data = reportRepo.DBResponse.Data }, JsonRequestBehavior.DenyGet);
        }

        [HttpPost, ValidateInput(false)]
        public JsonResult GeneratePDF(FormCollection fc)
        {
            try
            {
                var pages = new string[2];
                var type = fc["type"].ToString();
                var id = fc["id"].ToString();
                pages[0] = fc["page"].ToString();
                if (id == "")
                {
                    //string ad = "AB1CE12354F";
                    //Random rnd = new Random();
                    //id = new string(Enumerable.Repeat(ad, ad.Length).Select(s => s[rnd.Next(ad.Length)]).ToArray());
                    id = ((Login)(Session["LoginUser"])).Uid.ToString() + "" + DateTime.Now.ToString().Replace('/', '_').Replace(' ', '_').Replace(':', '_');
                }
                id = id.Replace('/', '_');
                var fileName = id + ".pdf";
                //  var fileName = DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                string PdfDirectory = Server.MapPath("~/Docs") + "/" + type + "/";
                if (!Directory.Exists(PdfDirectory))
                    Directory.CreateDirectory(PdfDirectory);
                //using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f))
                //{
                //    rh.GeneratePDF(PdfDirectory + fileName, pages);
                //}

                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(PdfDirectory + fileName, pages);

                }
                return Json(new { Status = 1, Message = "/Docs/" + type + "/" + fileName }, JsonRequestBehavior.DenyGet);// Data = fileName 
            }
            catch (Exception ex)
            {
                return Json(new { Status = "1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }


        //New VC Report for DSR
        [HttpGet]
        public ActionResult VCReport()
        {
            return PartialView();
        }

        [HttpPost]
        public JsonResult VCReport(string VCFdate, string VCTdate)
        {
            try
            {
                var dt1 = DateTime.ParseExact(VCFdate, "dd/MM/yyyy", System.Globalization.CultureInfo.InvariantCulture);
                var dt2 = DateTime.ParseExact(VCTdate, "dd/MM/yyyy", System.Globalization.CultureInfo.InvariantCulture);
                /*if (dt2.DayOfWeek.ToString().ToLower() != System.Configuration.ConfigurationManager.AppSettings["VCReportDay"].ToString().ToLower())
                {
                    return Json(new { Status = 2, Message = "Report Only Show on " + System.Configuration.ConfigurationManager.AppSettings["VCReportDay"].ToString() }, JsonRequestBehavior.AllowGet);
                }*/
                if (Math.Abs((dt2 - dt1).TotalDays + 1) != 7)
                {
                    return Json(new { Status = 2, Message = "Date gap must be of 7 days." }, JsonRequestBehavior.AllowGet);
                }
                else
                {
                    var doa = Enumerable.Range(0, 1 + dt2.Subtract(dt1).Days).Select(offset => dt1.AddDays(offset)).ToArray();
                    IList<string> formatted = new List<string>();
                    doa.ToList().ForEach(item =>
                    {
                        formatted.Add(item.ToString("yyyyMMdd"));
                    });
                    var XMLText = Utility.CreateXML(formatted);
                    var reportRepo = new DSR_ReportRepository();
                    reportRepo.VCCapacityReport(XMLText);
                    if (reportRepo.DBResponse.Status == 1)
                    {
                        return Json(new { Status = 1, Message = "Data Detected", Data = GeneratingPDFforWS((List<DSRVCCapacityModel>)reportRepo.DBResponse.Data, VCFdate, VCTdate) }, JsonRequestBehavior.AllowGet);
                    }
                    else
                    {
                        return Json(new { Status = -1, Message = "No Data" }, JsonRequestBehavior.AllowGet);
                    }
                }
            }
            catch (Exception e)
            {
                return Json(new { Status = -1, Message = "Internal Error Occurs !!" }, JsonRequestBehavior.AllowGet);
            }
        }

        [NonAction]
        public string GeneratingPDFforWS(List<DSRVCCapacityModel> data, string fdt, string tdt)
        {

            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();

            var dt1 = DateTime.ParseExact(fdt, "dd/MM/yyyy", System.Globalization.CultureInfo.InvariantCulture);
            var dt2 = DateTime.ParseExact(tdt, "dd/MM/yyyy", System.Globalization.CultureInfo.InvariantCulture);
            string FY1 = "";
            string FY2 = "";

            if (dt2.Month < 4)
            {
                FY1 = (dt2.Year - 1).ToString();
                FY2 = (dt2.Year - 2).ToString() + "-" + (dt2.Year - 1).ToString().Substring(2, 2);
            }
            else
            {
                FY1 = (dt2.Year).ToString();
                FY2 = (dt2.Year - 1).ToString() + "-" + (dt2.Year).ToString().Substring(2, 2);
            }

            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
            html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
            html.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 28px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 14px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:14px;'>ICD Dashrath</span><br/><label style='font-size: 16px; font-weight:bold;'>VC REPORT</label></td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");
            html.Append("</thead></table>");
            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-size:8pt;'><tbody>");
            html.Append("<tr><th colspan='12' style='text-align: right;'>DATED : " + DateTime.Now.ToString("dd.MM.yyyy") + "</th></tr>");
            html.Append("<tr><th colspan='12' style='text-align: center; font-size: 15px;'>CONTAINER HANDLING AT ICD-PPG DURING FOR THE WEEK ENDING " + fdt + " TO " + tdt + "</th></tr>");
            html.Append("<tr><td><br/></td></tr>");
            html.Append("</tbody></table>");
            html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
            html.Append("<thead>");
            html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>NAME OF CFS/ ICD</th>");
            html.Append("<th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>INCOME (RS. IN LACS)</th>");
            html.Append("<th colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>HANDLED DURING THIS WEEK (TEUs)</th>");
            html.Append("<th colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>HANDLED DURING LAST WEEK (TEUs)</th>");
            html.Append("<th colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>HANDLED DURING CORRESPONDING PERIOD LAST YEAR (TEUs)</th>");
            html.Append("<th colspan='1' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 70px;'>PROG. SINCE APRIL' " + FY1 + "</th>");
            html.Append("<th colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 70px;'>HANDLING IN " + FY2 + "</th></tr>");
            html.Append("<tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>THIS WEEK</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>LAST WEEK</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>THIS WEEK LAST YEAR</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IMPORT</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>EXPORT</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>EMPTY</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>TOTAL</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IMPORT</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>EXPORT</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>EMPTY</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>TOTAL</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IMPORT</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>EXPORT</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>EMPTY</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>TOTAL</th>");
            html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>TOTAL (TEUs)</th>");
            html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>TOTAL (TEUs)</th>");
            html.Append("</tr></thead>");
            html.Append("<tbody>");
            html.Append("<tr>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>ICD-PATPARGANJ,DELHI</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[0].Income.ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[1].Income.ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[2].Income.ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[0].Import.ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[0].Export.ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[0].Empty.ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + (data[0].Import + data[0].Export + data[0].Empty).ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[1].Import.ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[1].Export.ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[1].Empty.ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + (data[1].Import + data[1].Export + data[1].Empty).ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[2].Import.ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[2].Export.ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[2].Empty.ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + (data[2].Import + data[2].Export + data[2].Empty).ToString() + "</td>");
            html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[0].CurYear.ToString() + "</td>");
            html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data[0].PreYear.ToString() + "</td></tr>");
            html.Append("</tbody>");
            html.Append("</table>");
            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-size:8pt;'><tbody>");
            html.Append("<tr><td><br/><br/><br/><br/><br/><br/><br/></td></tr>");
            html.Append("<tr><th colspan='6' width='50%' style='text-align: left;'>SUBMITTED TO:- <br/> THE REGIONAL MANAGER CWC, RO, DELHI</th>  <th colspan='6' width='50%' style='text-align: right;'>MANAGER</th></tr>");
            html.Append("</tbody></table>");

            html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            lstSB.Add(html.ToString());

            var FileName = "VcReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/

            using (var rp = new ReportingHelper(PdfPageSize.A4Landscape, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }


        #endregion

        #region Landing Certificate
        public ActionResult LandingCertificate()
        {
            return PartialView();
        }
        [HttpGet]
        public ActionResult GetAllTrainNo()
        {
            DSR_ReportRepository ObjIR = new DSR_ReportRepository();
            ObjIR.GetAllTrainNo();
            if (ObjIR.DBResponse.Status > 0)
                return Json(ObjIR.DBResponse, JsonRequestBehavior.AllowGet);
            else
                return Json(null, JsonRequestBehavior.AllowGet);
        }
        [HttpGet]
        public ActionResult GetTrainDateByTrainNo(String TrainNo)
        {
            DSR_ReportRepository ObjIR = new DSR_ReportRepository();
            ObjIR.GetTrainDateByTrainNo(TrainNo);
            if (ObjIR.DBResponse.Status > 0)
                return Json(ObjIR.DBResponse, JsonRequestBehavior.AllowGet);
            else
                return Json(null, JsonRequestBehavior.AllowGet);
        }
        [HttpPost]
        //[CustomValidateAntiForgeryToken]
        public ActionResult GetLandingCertificateReport(String TrainNo, String TrainDate)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetLandingCertificateReport(TrainNo, TrainDate);
            String Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                TrainDetl lstData = new TrainDetl();
                lstData = (TrainDetl)ObjRR.DBResponse.Data;
                Path = GeneratePDFLandingCertificate(lstData, TrainNo);
            }
            return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);

        }
        public string GeneratePDFLandingCertificate(TrainDetl lstData, String TrainNo)
        {
            try
            {
                var FileName = "LandingCertificate.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>LANDING CERTIFICATE</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'><br/><br/></td></tr>");
                Pages.Append("<tr><th colspan='12' style='font-size:12px;'>This is Certify that following import loaded containers arrived at ICD Patparganj via ICD Loni From " + lstData.PortName + " as detailed below:</th></tr>");
                Pages.Append("<tr><td colspan='6' width='50%' style='font-size:11px;'><b>TRAIN NO :</b>" + lstData.TrainNo + "</td> <td colspan='6' width='50%' style='font-size:11px; text-align: right;'><b>TRAIN DATE :</b>" + lstData.TrainDate + "</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>Sno</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>TP No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:11%;'>TP Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Container No.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S Line</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Arrival Date</th></tr></thead>");

                Pages.Append("<tbody>");
                lstData.objTrainSummaryUpload.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>" + item.TP_No + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:11%;'>" + item.TP_Date + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Container_No + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + item.CT_Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.S_Line + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ArrivalDate + "</td>");

                    Pages.Append("</tr>");
                    i++;
                });
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' valign='bottom' style='width:100%;'><tfoot>");
                Pages.Append("<tr><td colspan='12'><br/><br/><br/><br/></td></tr>");
                Pages.Append("<tr><th colspan='6' width='50%' style='font-size:12px;'>Superitendent (Customs) <br/> ICD Patparganj</th> <th colspan='6' width='50%' style='font-size:12px; text-align: right;'>Import Incharge <br/> ICD Patparganj</th></tr>");
                Pages.Append("</tfoot></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region SD Details Report

        public ActionResult SDDetailsReport()
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetAllPartyForSDDet("", 0);
            if (ObjRR.DBResponse.Data != null)
            {
                var Jobj = Newtonsoft.Json.JsonConvert.SerializeObject(ObjRR.DBResponse.Data);
                var Jobject = Newtonsoft.Json.Linq.JObject.Parse(Jobj);
                ViewBag.LstParty = Jobject["LstParty"];
                ViewBag.State = Jobject["State"];
            }
            return PartialView();
        }


        [HttpGet]
        public JsonResult SearchParty(string PartyCode)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetAllPartyForSDDet(PartyCode, 0);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpGet]
        public JsonResult LoadParty(string PartyCode, int Page)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetAllPartyForSDDet(PartyCode, Page);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetSDDetReport(string FromDate, string ToDate, int PartyId)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();

            string Fdt = Convert.ToDateTime(FromDate).ToString("yyyy-MM-dd");
            string Tdt = Convert.ToDateTime(ToDate).ToString("yyyy-MM-dd");

            ObjRR.GetSDDetStatement(PartyId, Fdt, Tdt);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                DSRSDDetailsStatement SDData = new DSRSDDetailsStatement();
                SDData = (DSRSDDetailsStatement)ObjRR.DBResponse.Data;

                Path = GeneratePDFSDDetReport(SDData, FromDate, ToDate);
            }
            return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
        }


        [NonAction]
        public string GeneratePDFSDDetReport(DSRSDDetailsStatement SDData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "SdReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                //***************************************************************************************

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>SD STATEMENT</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append(" </td></tr>");
                Pages.Append("</thead>");

                Pages.Append(" <tbody>");
                Pages.Append("<tr><td colspan='12' style='font-size:12px;'><b>Party :</b>" + SDData.PartyName + "</td></tr>");
                Pages.Append(" <tr><td colspan='12' style='font-size:12px;'><b>Folio No :</b> " + SDData.PartyCode + "</td></tr>");
                Pages.Append("<tr><td colspan='12' style='font-size:12px;'><b>CWC GST No :</b> " + SDData.CompanyGst + "</td></tr>");
                Pages.Append("<tr><td colspan='12' style='font-size:12px;'><b>Party GST No :</b> " + SDData.PartyGst + "</td></tr>");
                Pages.Append("<tr><td colspan='12' style='font-size:12px;'><b>Period :</b> " + FromDate + " - " + ToDate + "</td></tr>");
                Pages.Append("</tbody></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; font-size:8pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>Sl. No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;text-align:center;'>Invoice No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>Invoice Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:11%;text-align:center;'>Receipt No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>Receipt Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>Pay Receipt</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>Transaction Type</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:12%;'>Transaction Amount</th></tr></thead>");
                Pages.Append("<tbody>");
                SDData.lstInvc.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;text-align:center;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>" + item.InvoiceDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:11%;text-align:center;'>" + item.ReceiptNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>" + item.ReceiptDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:right;'>" + item.ReceiptAmt.ToString() + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>" + item.TranType + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;width:12%;text-align:right;'>" + item.TranAmt.ToString() + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });
                Pages.Append("<tr>");
                Pages.Append("<th colspan='7' style='border-right:1px solid #000;width:8%;text-align:right;'>Invoice Utilization Balance :</th>");
                Pages.Append("<th style='width:12%;text-align:right;'>" + SDData.UtilizationAmount + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse;font-size:9pt;'><tbody>");
                Pages.Append("<tr><td><span><br/><br/></span></td></tr>");
                Pages.Append("<tr><td colspan='12'><p><b>N.B :</b> This is a computer generated statement. Doesn't require any signature.</p></td></tr>");
                Pages.Append("</tbody></table>");

                //***************************************************************************************
                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Long Standing Report For Container
        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult LongStandingImpLoadedCont()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetLongStandingImpLoadedCont(DSR_LongStandingImpCon ObjContainerBalanceInCFS)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_LongStandingImpConDtl> LstContainerBalanceInCFS = new List<DSR_LongStandingImpConDtl>();
            ObjRR.GetLongStandingImpLoadedCont(ObjContainerBalanceInCFS);
            String Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                LstContainerBalanceInCFS = (List<DSR_LongStandingImpConDtl>)ObjRR.DBResponse.Data;
                Path = GeneratePDFLongStandingImpLoadedCont(LstContainerBalanceInCFS, ObjContainerBalanceInCFS);

            }
            return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);

        }

        [HttpPost]

        public String GeneratePDFLongStandingImpLoadedCont(List<DSR_LongStandingImpConDtl> lstData, DSR_LongStandingImpCon Obj)
        {
            try
            {
                var FileName = "LongStandingImpLoadCon.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 28px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 14px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:14px;'>ICD Dashrath</span><br/><label style='font-size: 16px; font-weight:bold;'>Inland Container Depot.</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'><br/></td></tr>");
                Pages.Append("<tr><th colspan='12' style='font-size:14px; text-align: center;'>Import loaded containers Lying in ICD Patparganj more than " + Obj.days + " as on " + Obj.ToDate + " </th></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:6pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Sno</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>BOL No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>IGM No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>IGM Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Importer</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Address</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>ICD Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Sla Cd</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>No Pkg</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Gr.Wt.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Comdty.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>G/H/F</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Notice1</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Date1</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Notice2</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Date2</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Nocr</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Remarks1</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Remarks2</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.BOLNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.IGMNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.IGMDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ImporterName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ImporterAddress + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.InDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.SlaCd + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.NoOfPkg + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.GrWt + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Commodity + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.CargoType + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Notice1 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Date1 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Notice2 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Date2 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Nocr + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Remarks1 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Remarks2 + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });
                Pages.Append("</tbody></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' valign='bottom' style='width:100%;'><tfoot>");
                Pages.Append("<tr><td colspan='12'><br/><br/><br/><br/></td></tr>");
                Pages.Append("</tfoot></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }

        }
        #endregion

        #region ECONOMY REPORT
        public ActionResult EconomyReport()
        {
            return PartialView();
        }

        public JsonResult GetEconomyReport(int Month, int Year)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetEconomyReport(Month, Year);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpPost]
        public JsonResult SaveEconomyReport(int Month, int Year, List<EconomyReport> lstRptData)
        {
            try
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();

                decimal result;
                List<EconomyReport> lst = new List<EconomyReport>();
                lstRptData.ForEach(item =>
                {
                    if (decimal.TryParse(item.Amount, out result))
                    {
                        lst.Add(item);
                    }
                });

                string xml = "";
                if (lst != null)
                {
                    xml = Utility.CreateXML(lst);
                }

                ObjRR.SaveEconomyReport(Month, Year, xml, ((Login)(Session["LoginUser"])).Uid);

                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);

            }
            catch (Exception ex)
            {
                return Json(new { Status = -1, Message = "Internal Error Occurs !!", Data = "" }, JsonRequestBehavior.AllowGet);
            }
        }

        [HttpPost]
        public JsonResult EconomyReportPrint(int Month, int Year)
        {
            try
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.GetEconomyReportForPrint(Month, Year);
                if (ObjRR.DBResponse.Status == 1)
                {
                    return Json(new { Status = 1, Message = "Data Detected", Data = GeneratingPDFforEcoRpt((EconomyRptPrint)ObjRR.DBResponse.Data) }, JsonRequestBehavior.AllowGet);
                }
                else
                {
                    return Json(new { Status = -1, Message = ObjRR.DBResponse.Message }, JsonRequestBehavior.AllowGet);
                }

            }
            catch (Exception e)
            {
                return Json(new { Status = -1, Message = "Internal Error Occurs !!" }, JsonRequestBehavior.AllowGet);
            }
        }
        [NonAction]
        public string GeneratingPDFforEcoRpt(EconomyRptPrint data)
        {

            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();
            StringBuilder html2 = new StringBuilder();
            StringBuilder html3 = new StringBuilder();
            StringBuilder html4 = new StringBuilder();
            StringBuilder html5 = new StringBuilder();
            //html.Append("<h1>Test</h1>");
            //Page 1*********************************************************************************************************************
            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif;'><thead>");
            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%;'><tbody>");
            html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
            html.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/>");
            html.Append("<label style='font-size: 14px; font-weight:bold;'>ECONOMY REPORT FOR THE PERIOD OF " + Convert.ToDateTime(data.FormDate).ToString("dd-MMM-yyyy") + " TO " + Convert.ToDateTime(data.ToDate).ToString("dd-MMM-yyyy") + "</label></td></tr>");
            html.Append("<tr><th><br/><br/></th></tr>");
            html.Append("<tr><th colspan='12' style='text-align: right; font-size:8pt;'>DATED : " + Convert.ToDateTime(data.CreatedOn).ToString("dd-MMM-yyyy") + "</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");
            html.Append("</thead></table>");

            html.Append("<table style='width:100%; margin-bottom:20px; font-size: 8pt;' cellspacing='0' cellpadding='5'>");
            html.Append("<thead>");
            html.Append("<tr><th cellpadding='5' colspan='12' style='border-top: 1px solid #000; border-bottom: 1px solid #000; font-size: 9pt; text-align: center;'>COVERED AREA AND ITS CAPACITY</th></tr>");
            html.Append("<tr><th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Gross in <br/> Sq.Mtrs</th>");
            html.Append("<th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Net(Usable) in Sq.Mtrs</th>");
            html.Append("<th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Grids/Slot(Nos)</th>");
            html.Append("<th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Std.Bags(Nos)</th>");
            html.Append("</tr>");
            html.Append("</thead>");

            html.Append("<tbody>");
            html.Append("<tr><td colspan='3' style='padding:15px 5px;'>" + data.SqmCovered + "</td>");
            html.Append("<td colspan='3' style='padding:15px 5px;'></td>");
            html.Append("<td colspan='3' style='padding:15px 5px;'></td>");
            html.Append("<td colspan='3' style='padding:15px 5px;'>" + data.BagCovered + "</td></tr>");
            html.Append("</tbody>");
            html.Append("</table>");

            html.Append("<table style='width:100%; margin-bottom:20px; font-size: 8pt;' cellspacing='0' cellpadding='5'>");
            html.Append("<thead>");
            html.Append("<tr><th colspan='12' style='border-top: 1px solid #000; border-bottom: 1px solid #000; font-size: 9pt; text-align: center;'>OPEN AREA AND ITS CAPACITY</th></tr>");
            html.Append("<tr><th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Gross in <br/> Sq.Mtrs</th>");
            html.Append("<th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Net(Usable) in Sq.Mtrs</th>");
            html.Append("<th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>TEU's(Nos.)</th>");
            html.Append("<th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Std.Bags(Nos)</th>");
            html.Append("</tr>");
            html.Append("</thead>");
            html.Append("<tbody>");
            html.Append("<tr><td colspan='3' style='padding:15px 5px;'>" + data.SqmOpen + "</td>");
            html.Append("<td colspan='3' style='padding:15px 5px;'></td>");
            html.Append("<td colspan='3' style='padding:15px 5px;'></td>");
            html.Append("<td colspan='3' style='padding:15px 5px;'>" + data.BagOpen + "</td></tr>");
            html.Append("</tbody>");
            html.Append("</table>");

            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-size:9pt;'><tbody>");
            html.Append("<tr><td><br/><br/><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12' style='text-align: left;'>Submmited to:- <br/> <b>The Regional Manager</b> <br/> CWC, RO, DELHI</td></tr>");
            html.Append("</tbody></table>");

            //html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
            lstSB.Add(html.ToString());
            //Page 2*********************************************************************************************************************

            html2.Append("<table style='border-top: 1px solid #000;width:100%; font-size:8pt;' cellspacing='0' cellpadding='5'>");
            html2.Append("<thead>");
            html2.Append("<tr><th style='border-bottom: 1px solid #000; text-align:left; width:50%;'>Head of Income</th>");
            html2.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:17%;'>Amount <br/> RS   P.</th>");
            html2.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:17%;'>Cumulative <br/> Since 1st April</th>");
            html2.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:17%;'>Progressive Cumulative <br/> RS   P.</th></tr>");

            html2.Append("<tr><th style='border-bottom: 1px solid #000; text-align:left; width:50%;'>1</th>");
            html2.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:17%;'>2</th>");
            html2.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:17%;'>3</th>");
            html2.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:17%;'>4</th></tr>");
            html2.Append("</thead>");
            html2.Append("<tbody>");

            data.RptDetails.Where(x => x.ItemType == "I" && x.PageNo == 2).ToList().ForEach(i =>
               {
                   html2.Append("<tr><td cellpadding='5'>" + i.ItemLabel + "</td>");
                   html2.Append("<td cellpadding='5'>" + i.Amount + "</td>");
                   html2.Append("<td cellpadding='5'>" + i.CumAmount + "</td>");
                   html2.Append("<td cellpadding='5'>" + i.ProCumAmount + "</td></tr>");
               });
            html2.Append("</tbody>");
            html2.Append("</table>");

            lstSB.Add(html2.ToString());

            //Page 3**********************************************************************************************************************          
            html3.Append("<table style='width:100%; font-size:9pt;' cellspacing='0' cellpadding='5'>");
            html3.Append("<thead>");
            html3.Append("<tr><th style='border-top:1px solid #000; border-bottom: 1px solid #000;text-align:left; width:50%;''>1</th>");
            html3.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:17%;'>2</th>");
            html3.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:17%;'>3</th>");
            html3.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:17%;'>4</th></tr>");
            html3.Append("</thead>");
            html3.Append("<tbody>");

            data.RptDetails.Where(x => x.ItemType == "I" && x.PageNo == 3).ToList().ForEach(i =>
              {
                  html3.Append("<tr><td cellpadding='4'>" + i.ItemLabel + "</td>");
                  html3.Append("<td cellpadding='4'>" + i.Amount + "</td>");
                  html3.Append("<td cellpadding='4'>" + i.CumAmount + "</td>");
                  html3.Append("<td cellpadding='4'>" + i.ProCumAmount + "</td></tr>");
              });
            html3.Append("</tbody>");
            html3.Append("</table>");
            lstSB.Add(html3.ToString());

            //Page 4**********************************************************************************************************************            
            html4.Append("<table style='width:100%; font-size: 8pt;' cellspacing='0' cellpadding='5'>");
            html4.Append("<thead>");
            html4.Append("<tr><th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:8%;'>Code No</th>");
            html4.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:47%;'>Head of Expenses</th>");
            html4.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Amount <br/> RS   P.</th>");
            html4.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Cumulative <br/> Since 1st April</th>");
            html4.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Progressive Cumulative <br/> RS   P.</th></tr>");

            html4.Append("<tr><th style='border-bottom: 1px solid #000; text-align:left; width:8%;'>5</th>");
            html4.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:47%;'>6</th>");
            html4.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:15%;'>7</th>");
            html4.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:15%;'>8</th>");
            html4.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:15%;'>9</th></tr>");
            html4.Append("</thead>");
            html4.Append("<tbody>");

            int maxSr = data.RptDetails.Where(x => x.ItemType == "E").Max(x => x.Sr);
            data.RptDetails.Where(x => x.ItemType == "E" && x.PageNo == 4).ToList().ForEach(i =>
                {

                    html4.Append("<tr>");
                    if (i.Sr == maxSr)
                    {
                        html4.Append("<td cellpadding='5' colspan='2'>" + i.ItemLabel + "</td>");
                        //html4.Append("<td style='font-size: 9pt; padding:10px;'>" + i.ItemLabel + "</td>");
                    }
                    else
                    {
                        html4.Append("<td cellpadding='5'>" + i.ItemCodeNo + "</td>");
                        html4.Append("<td cellpadding='5'>" + i.ItemLabel + "</td>");
                    }
                    html4.Append("<td cellpadding='5'>" + i.Amount + "</td>");
                    html4.Append("<td cellpadding='5'>" + i.CumAmount + "</td>");
                    html4.Append("<td cellpadding='5'>" + i.ProCumAmount + "</td></tr>");
                });

            html4.Append("</tbody>");
            /*html4.Append("<tfoot>");
            html4.Append("<tr><th colspan='2' style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Excess of Income over Expenditure</th>");
            html4.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Dynamic</th>");
            html4.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Dynamic</th>");
            html4.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Dynamic</th></tr>");
            html4.Append("</tfoot>");*/
            html4.Append("</table>");
            lstSB.Add(html4.ToString());

            //Page last**********************************************************************************************************************    

            html5.Append("<table style='width:100%; font-size:8pt;' cellspacing='0' cellpadding='5'>");
            html5.Append("<thead><tr><th colspan='12' style='text-align: left; font-size:9pt;'>Summary of Financial Performance for the period of " + Convert.ToDateTime(data.FormDate).ToString("dd-MMM-yyyy") + " to " + Convert.ToDateTime(data.ToDate).ToString("dd-MMM-yyyy") + "</th></tr>");
            html5.Append("<tr><th style='border-top: 1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Code No</th>");
            html5.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; text-align:left; width:40%;'>Head of Income</th>");
            html5.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Amount <br /> RS   P.</th>");
            html5.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Cumulative <br /> Since 1st April</th>");
            html5.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Progressive Cumulative <br /> RS   P.</th></tr>");
            html5.Append("</thead>");
            html5.Append("<tbody>");
            data.RptSummary.ForEach(i =>
            {
                html5.Append("<tr><td cellpadding='5'>" + i.CodeNo + "</td>");
                html5.Append("<td cellpadding='5'>" + i.ItemLabel + "</td>");
                html5.Append("<td cellpadding='5'>" + i.Amount + "</td>");
                html5.Append("<td cellpadding='5'>" + i.CumAmount + "</td>");
                html5.Append("<td cellpadding='5'>" + i.ProCumAmount + "</td></tr>");
            });
            html5.Append("</tbody>");
            /*html5.Append("<tfoot>");
            html5.Append("<tr><th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'></th>");
            html5.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Total(A+B)</th>");
            html5.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Dynamic</th>");
            html5.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Dynamic</th>");
            html5.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Dynamic</th></tr>");
            html5.Append("</tfoot>");*/
            html5.Append("</table>");

            html5.Append("<table style='border-top:1px solid #000; width:100%;' cellspacing='0' cellpadding='10'>");
            html5.Append("<tbody>");
            html5.Append("<tr><td width='3%' align='right' style='font-size:8pt;'>1.</td><td colspan='2' width='85%' style='font-size:9pt;'>Indicate total number of time barred Bond and income involved(with vearwise break-up)</td></tr>");
            html5.Append("<tr><td width='3%' align='right' style='font-size:8pt;'>2.</td><td colspan='2' width='85%' style='font-size:9pt;'>Number of contaiers seized abandanded and their income involved(with vearwise break-up)</td></tr>");
            html5.Append("</tbody>");
            html5.Append("</table>");

            lstSB.Add(html5.ToString());

            var FileName = "EcoReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        #region Long Standing Report For Imp Loaded Cargo
        [HttpGet]
        public ActionResult LongStandingImpLoadedCargo()
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            ObjGR.GetGodownRightsWise(((Login)Session["LoginUser"]).Uid);
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetLongStandingImpLoadedCargo(DSR_LongStandingImpCargo ObjContainerBalanceInCFS)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_LongStandingImpCargoDtl> LstContainerBalanceInCFS = new List<DSR_LongStandingImpCargoDtl>();
            ObjRR.GetLongStandingImpLoadedCargo(ObjContainerBalanceInCFS);
            String Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                LstContainerBalanceInCFS = (List<DSR_LongStandingImpCargoDtl>)ObjRR.DBResponse.Data;
                Path = GeneratePDFLongStandingImpLoadedCargo(LstContainerBalanceInCFS, ObjContainerBalanceInCFS);

            }
            return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);

        }

        [HttpPost]

        public String GeneratePDFLongStandingImpLoadedCargo(List<DSR_LongStandingImpCargoDtl> lstData, DSR_LongStandingImpCargo Obj)
        {
            try
            {
                var FileName = "LongStandingImpLoadCargo.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 28px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 14px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:14px;'>ICD Dashrath</span><br/><label style='font-size: 16px; font-weight:bold;'>Inland Container Depot.</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'><br/></td></tr>");
                Pages.Append("<tr><th colspan='12' style='font-size:14px; text-align: center;'>Import Cargo Lying in Shed more than " + Obj.days + " as on " + Obj.AsOnDate + " </th></tr>");
                Pages.Append("<tr><td colspan='12' style='font-size:12px;'><b>SHED :</b> " + Obj.GodownName + "</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:6pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>OBL No.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>IGM No.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>IGM Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Importer</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Address</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Dstf Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Sla Cd</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>No Pkg</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Gr.Wt.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Area</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Comdty.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>G/H/P*</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Notice1</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Notice2</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>NOC</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Remarks1</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Remarks2</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.BOLNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.IGMNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.IGMDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ImporterName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ImporterAddress + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.InDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.DstfDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.SlaCd + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.NoOfPkg + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.GrWt + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Area + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Commodity + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.CargoType + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Notice1 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Date1 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Notice2 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Date2 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Nocr + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Remarks1 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Remarks2 + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });
                Pages.Append("</tbody></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' valign='bottom' style='width:100%;'><tfoot>");
                Pages.Append("<tr><td colspan='12'><br/><br/><br/><br/></td></tr>");
                Pages.Append("</tfoot></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }

        }
        #endregion

        #region Export Job Order
        [HttpGet]
        public ActionResult ExportJobOrderReport(string type = "Road")
        {
            ViewData["InvType"] = type;
            //  DataSet ds1 = new DataSet();
            // GeneratingBulkPDFforRR(ds1);
            DSR_ReportRepository ObjIR = new DSR_ReportRepository();



            //     ObjIR.GetContainerForExportJobOrder(type);
            //    if (ObjIR.DBResponse.Data != null)
            //    {
            //        ViewBag.LstContainerNo = new SelectList((List<PPGExportRRReport>)ObjIR.DBResponse.Data, "CFSCode", "ContainerNo");
            //    }
            //    else
            //    {
            //       ViewBag.LstRequestNo = null;
            //    }
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportJobReport(DSRExportJobOrder ObjDailyPdaActivityReport)
        {
            //  DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            string FilePath = "";
            //  List<DailyPdaActivityReport> LstDailyPdaActivityReport = new List<DailyPdaActivityReport>();
            //   Login objLogin = (Login)Session["LoginUser"];
            //    ObjRR.PrintExportRR(ObjDailyPdaActivityReport.ContainerNo, ObjDailyPdaActivityReport.CFSCode);//, objLogin.Uid
            //  if (ObjRR.DBResponse.Data != null)
            // {
            // DataSet ds = (DataSet)ObjRR.DBResponse.Data;
            FilePath = GeneratingBulkPDFforJobOrder(ObjDailyPdaActivityReport.PeriodFrom, ObjDailyPdaActivityReport.PeriodTo, ObjDailyPdaActivityReport.TransactionType);


            return Json(new { Status = 1, Data = FilePath });
            // }
            // else
            //    return Json(new { Status = -1, Data = "No Record Found." });

        }


        [NonAction]
        public string GeneratingBulkPDFforJobOrder(String PFrom, String PTo, String TType)
        {

            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.PrintExportJobOrder(PFrom, PTo, TType);//, objLogin.Uid
            CwcExim.Areas.Export.Models.DSRPrintJOModel ObjRRData = new CwcExim.Areas.Export.Models.DSRPrintJOModel();
            List<CwcExim.Areas.Export.Models.DSRPrintJOModelDet> lstData = new List<CwcExim.Areas.Export.Models.DSRPrintJOModelDet>();
            lstData = (List<CwcExim.Areas.Export.Models.DSRPrintJOModelDet>)ObjRR.DBResponse.Data;

            ObjRR.PrintExportJoSum(PFrom, PTo, TType);//, objLogin.Uid
                                                      //   CwcExim.Areas.Export.Models.ppgexportjobordersum ObjRRSumData = new CwcExim.Areas.Export.Models.ppgexportjobordersum();
            List<CwcExim.Areas.Export.Models.DSRexportjobordersum> lstDataSum = new List<CwcExim.Areas.Export.Models.DSRexportjobordersum>();
            lstDataSum = (List<CwcExim.Areas.Export.Models.DSRexportjobordersum>)ObjRR.DBResponse.Data;


            //  PrintExportRRReport ObjRRData = new PrintExportRRReport();
            List<string> lstSB = new List<string>();
            DateTime Dt = DateTime.Now.Date;
            String DtValue = Dt.ToString("dd/MM/yyyy");
            StringBuilder html = new StringBuilder();

            if (TType.Equals("Train"))
            {
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>Job Order For MOVEMENT OF Export LDD CONTAINERS</label></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("<tr><td colspan='12'><br/></td></tr>");
                html.Append("<tr><td colspan='6' width='50%' style='font-size:11px;'><b>TO :</b> <br/> M/s </td> <td colspan='6' width='50%' style='font-size:11px; text-align: right;'><b>DATE :</b>" + DtValue + "</td></tr>");
                html.Append("<tr><td colspan='12'><br/><br/></td></tr>");
                html.Append("<tr><th colspan='12' style='font-size:12px;'>Please arrange movement of following export Loaded/Empty Containerrs from ICD PPG to ICD LONI</th></tr>");
                html.Append("</thead></table>");
            }


            if (TType.Equals("Road"))
            {
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>Job Order For MOVEMENT OF Export LDD CONTAINERS</label></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("<tr><td colspan='12'><br/></td></tr>");
                html.Append("<tr><td colspan='6' width='50%' style='font-size:11px;'><b>TO :</b> <br/> M/s </td> <td colspan='6' width='50%' style='font-size:11px; text-align: right;'><b>DATE :</b>" + DtValue + "</td></tr>");
                html.Append("<tr><td colspan='12'><br/><br/></td></tr>");
                // html.Append("<tr><th colspan='12' style='font-size:12px;'>Please arrange movement of following export Loaded/Empty Containerrs from ICD PPG to ICD LONI</th></tr>");
                html.Append("</thead></table>");
            }
            if (ObjRR.DBResponse.Data != null)
            {

                //   ObjRRData = (CwcExim.Areas.Export.Models.DSRPrintJOModel)ObjRR.DBResponse.Data;
                String Pnm = "", Pynm = "";
                String Cont = "", Sz = "", Loaded = "";
                int Pack = 0;
                decimal GW = 0;


                decimal RR = 0;
                decimal THC = 0;
                decimal CGST = 0;
                decimal SGST = 0;
                decimal IGST = 0;
                decimal INVAMT = 0;

                if (TType.Equals("Train"))
                {



                    html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:8pt;'>");
                    html.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>S.N</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>ICD Code</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Container No</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Size</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>S/line</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>On behalf of</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Cust Seal</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Sla Seal</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>POL</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>POD</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Tr wt</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:0;width:8%;'>Crg wt</th></tr></thead>");

                    html.Append("<tbody>");
                    int i = 1;
                    int jnpt20, jnpt40, jnpttotal, jnpttues;
                    jnpt20 = 0;
                    jnpt40 = 0;
                    jnpttotal = 0;
                    jnpttues = 0;
                    int GTIL20, GTIL40, GTILtotal, GTILtues;
                    GTIL20 = 0;
                    GTIL40 = 0;
                    GTILtotal = 0;
                    GTILtues = 0;
                    int NSICT20, NSICT40, NSICTtotal, NSICTtues;
                    NSICT20 = 0;
                    NSICT40 = 0;
                    NSICTtotal = 0;
                    NSICTtues = 0;
                    int SUB20, SUB40, SUBtotal, SUBtues;
                    SUB20 = 0;
                    SUB40 = 0;
                    SUBtotal = 0;
                    SUBtues = 0;
                    int MND20, MND40, MNDtotal, MNDtues;
                    MND20 = 0;
                    MND40 = 0;
                    MNDtotal = 0;
                    MNDtues = 0;
                    int PBR20, PBR40, PBRtotal, PBRtues;
                    PBR20 = 0;
                    PBR40 = 0;
                    PBRtotal = 0;
                    PBRtues = 0;

                    int TOT20, TOT40, TOTtotal, TOTtues;
                    TOT20 = 0;
                    TOT40 = 0;
                    TOTtotal = 0;
                    TOTtues = 0;
                    lstData.ForEach(item =>
                    {
                        html.Append("<tr><td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + i + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.CFSCode + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ContainerNo + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>" + item.ContainerSize + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ShippingLineName + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.OnBehalf + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.CustomSealNo + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Sline + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.POL + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.POD + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Ct_Tare + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:0;width:8%;'>" + item.Cargo_Wt + "</td></tr>");
                        if (item.POL.Equals("JNPT"))
                        {
                            if (item.ContainerSize.Equals("20"))
                            {
                                jnpt20 = jnpt20 + 1;
                            }
                            else
                            {
                                jnpt40 = jnpt40 + 1;
                            }
                        }

                        if (item.POL.Equals("GTIL"))
                        {
                            if (item.ContainerSize.Equals("20"))
                            {
                                GTIL20 = GTIL20 + 1;
                            }
                            else
                            {
                                GTIL40 = GTIL40 + 1;
                            }
                        }

                        if (item.POL.Equals("NSICT"))
                        {
                            if (item.ContainerSize.Equals("20"))
                            {
                                NSICT20 = NSICT20 + 1;
                            }
                            else
                            {
                                NSICT40 = NSICT40 + 1;
                            }
                        }

                        if (item.POL.Equals("MND"))
                        {
                            if (item.ContainerSize.Equals("20"))
                            {
                                MND20 = MND20 + 1;
                            }
                            else
                            {
                                MND40 = MND40 + 1;
                            }
                        }

                        if (item.POL.Equals("PBR"))
                        {
                            if (item.ContainerSize.Equals("20"))
                            {
                                PBR20 = PBR20 + 1;
                            }
                            else
                            {
                                PBR40 = PBR40 + 1;
                            }
                        }
                        i++;
                    });
                    jnpttotal = jnpt20 + jnpt40;
                    jnpttues = jnpt20 + (jnpt40 * 2);

                    GTILtotal = GTIL20 + GTIL40;
                    GTILtues = GTIL20 + (GTIL40 * 2);

                    NSICTtotal = NSICT20 + NSICT40;
                    NSICTtues = NSICT20 + (NSICT40 * 2);
                    SUB20 = jnpt20 + GTIL20 + NSICT20;
                    SUB40 = jnpt40 + GTIL40 + NSICT40;
                    SUBtotal = jnpttotal + GTILtotal + NSICTtotal;
                    SUBtues = jnpttues + GTILtues + NSICTtues;
                    MNDtotal = MND20 + MND40;
                    MNDtues = MND20 + (MND40 * 2);
                    PBRtotal = PBR20 + PBR40;
                    PBRtues = PBR20 + (PBR40 * 2);
                    TOT20 = SUB20 + MND20 + PBR20;
                    TOT40 = SUB40 + MND40 + PBR40;
                    TOTtotal = SUBtotal + MNDtotal + PBRtotal;
                    TOTtues = SUBtues + MNDtues + PBRtues;
                    html.Append("</tbody></table>");

                    html.Append("<table cellspacing='0' cellpadding='5' style='width:90%; border-collapse:collapse; text-align:center; margin-top:20px; font-size:8pt;'>");
                    html.Append("<thead><tr><th colspan='12' style='text-align:left;'>SUMMARY REPORT</th></tr>");
                    html.Append("<tr><th style='border:1px solid #000;border-right:0;width:10%;'></th>");
                    html.Append("<th style='border:1px solid #000;border-right:0;width:10%;'>20</th>");
                    html.Append("<th style='border:1px solid #000;border-right:0;width:10%;'>40</th>");
                    html.Append("<th style='border:1px solid #000;border-right:0;width:10%;'>TOTAL</th>");
                    html.Append("<th style='border:1px solid #000;border-right:1px solid #000;width:10%;'>TEUS</th></tr></thead>");
                    html.Append("<tbody>");

                    html.Append("<tr><th style='border:1px solid #000;border-right:0;border-top:0;width:10%;'>JNPT</th>");
                    html.Append("<td style='border:1px solid #000;border-right:0;border-top:0;width:10%;'>" + jnpt20 + " </td>");
                    html.Append("<td style='border:1px solid #000;border-right:0;border-top:0;width:10%;'>" + jnpt40 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-right:0;border-top:0;width:10%;'>" + jnpttotal + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:1px solid #000;width:10%;'>" + jnpttues + "</td></tr>");

                    html.Append("<tr><th style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>GTIL</th>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + GTIL20 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + GTIL40 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + GTILtotal + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:1px solid #000;width:10%;'>" + GTILtues + "</td></tr>");

                    html.Append("<tr><th style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>NSICT</th>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + NSICT20 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + NSICT40 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + NSICTtotal + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:1px solid #000;width:10%;'>" + NSICTtues + "</td></tr>");

                    html.Append("<tr><th style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>SUB TOTAL</th>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + SUB20 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + SUB40 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + SUBtotal + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:1px solid #000;width:10%;'>" + SUBtues + "</td></tr>");

                    html.Append("<tr><th style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>MND</th>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + MND20 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + MND40 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + MNDtotal + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:1px solid #000;width:10%;'>" + MNDtues + "</td></tr>");

                    html.Append("<tr><th style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>PBR</th>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + PBR20 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + PBR20 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + PBRtotal + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:1px solid #000;width:10%;'>" + PBRtues + "</td></tr>");

                    html.Append("<tr><th style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>TOTAL</th>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + TOT20 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + TOT40 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;'>" + TOTtotal + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:1px solid #000;width:10%;'>" + TOTtues + "</td></tr>");
                    html.Append("</tbody></table>");

                    html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; text-align:center; margin-top:20px; font-size:8pt;'><tbody>");
                    html.Append("<tr><td width='10%' valign='top' align='right'>REMARKS :</td><td colspan='2' width='85%' style='text-align: left;'>H & T Contracter is required to transport the Export Loaded Containers from ICD-PPG to ICD-LONI with in 12hrs i.e from 22:00 p.m to 10:00 a.m</td></tr>");
                    html.Append("<tr><td width='10%' valign='top' align='right'>COPY TO :</td><td colspan='2' width='85%' style='text-align: left;'>1. Suman Forwarding Agency Pvt Ltd. - ICD Ppg <br/> 2. SAM/AM - A/C ICD Ppg <br/>  3. Anil William Thomas Security Agency. - ICD Ppg <br/>  4. Manager ICD LONI (In Duplicate)</td></tr>");
                    html.Append("</tbody></table>");
                }
                else
                {


                    int i = 1;
                    html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:8pt;'>");
                    html.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>S.N</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>ICD Code</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Container No</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Size</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>S/line</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>On behalf of</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Cust Seal</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Sla Seal</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>POL</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>POD</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Tr wt</th>");
                    html.Append("<th style='border-bottom:1px solid #000;border-right:0;width:8%;'>Crg wt</th></tr></thead>");

                    html.Append("<tbody>");
                    lstData.ForEach(item =>
                    {
                        html.Append("<tr><td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + i + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.CFSCode + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ContainerNo + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>" + item.ContainerSize + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ShippingLineName + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.OnBehalf + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.CustomSealNo + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Sline + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.POL + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.POD + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Ct_Tare + "</td>");
                        html.Append("<td style='border-bottom:1px solid #000;border-right:0;width:8%;'>" + item.Cargo_Wt + "</td></tr>");
                        i++;
                    });
                    html.Append("</tbody></table>");

                    html.Append("<table cellspacing='0' cellpadding='5' style='width:90%; border-collapse:collapse; text-align:center; margin-top:20px; font-size:8pt;'>");
                    html.Append("<thead><tr><th colspan='12' style='text-align:left; font-size:10pt;'>SUMMARY REPORT</th></tr>");
                    html.Append("<tr><th style='border:1px solid #000;border-right:0;width:10%;'></th>");
                    html.Append("<th style='border:1px solid #000;border-right:0;width:10%;'>20</th>");
                    html.Append("<th style='border:1px solid #000;border-right:0;width:10%;'>40</th>");
                    html.Append("<th style='border:1px solid #000;border-right:0;width:10%;'>TOTAL</th>");
                    html.Append("<th style='border:1px solid #000;border-right:1px solid #000;width:10%;'>TEUS</th></tr></thead>");
                    html.Append("<tbody>");
                    int tot = 0;
                    int tottues = 0;
                    int grosstot = 0;
                    int grosstues = 0;
                    int tot20 = 0;
                    int tot40 = 0;
                    lstDataSum.ForEach(itemm =>
                    {
                        tot = itemm.SZ20 + itemm.SZ40;
                        grosstot = grosstot + tot;
                        tottues = itemm.SZ20 + (itemm.SZ40 * 2);
                        grosstues = grosstues + tottues;
                        tot20 = tot20 + itemm.SZ20;
                        tot40 = tot40 + itemm.SZ40;
                        html.Append("<tr><th style='border:1px solid #000;border-right:0;border-top:0;width:10%;'>" + itemm.POL + "</th>");
                        html.Append("<td style='border:1px solid #000;border-right:0;border-top:0;width:10%;'>" + itemm.SZ20 + "</td>");
                        html.Append("<td style='border:1px solid #000;border-right:0;border-top:0;width:10%;'>" + itemm.SZ40 + "</td>");
                        html.Append("<td style='border:1px solid #000;border-right:0;border-top:0;width:10%;'>" + tot + "</td>");
                        html.Append("<td style='border:1px solid #000;border-top:0;border-right:1px solid #000;width:10%;'>" + tottues + "</td></tr>");
                        tot = 0;
                        tottues = 0;
                    });
                    html.Append("<tr><th style='border:1px solid #000;border-top:0;border-right:0;width:10%;font-size:9pt;'>TOTAL</th>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;font-size:9pt;'>" + tot20 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;font-size:9pt;'>" + tot40 + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:0;width:10%;font-size:9pt;'>" + grosstot + "</td>");
                    html.Append("<td style='border:1px solid #000;border-top:0;border-right:1px solid #000;width:10%;font-size:9pt;'>" + grosstues + "</td></tr>");
                    html.Append("</tbody></table>");

                    html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; text-align:center; margin-top:20px; font-size:8pt;'><tbody>");
                    html.Append("<tr><td width='10%' valign='top' align='right'>COPY TO :</td><td colspan='2' width='85%' style='text-align: left;'>1. Suman Forwarding Agency Pvt Ltd. - ICD Ppg <br/> 2. SAM/AM - A/C ICD Ppg <br/>  3. Anil William Thomas Security Agency. - ICD Ppg</td></tr>");
                    html.Append("</tbody></table>");
                }



            }
            html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
            lstSB.Add(html.ToString());
            var FileName = "ExportJobReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        #region  Core Data Report

        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult CoreDataReport()
        {

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetCoreDataReport(DSRCoreData ObjCoreData)
        {
            String FilePath = "";
            FilePath = GenerateCoreDataReportPDF(ObjCoreData);


            return Json(new { Status = 1, Data = FilePath });
        }

        [NonAction]
        public String GenerateCoreDataReportPDF(DSRCoreData ObjCoredt)
        {


            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();
            string fdt = Convert.ToDateTime(ObjCoredt.PeriodFrom).ToString("yyyy-MM-dd");
            string tdt = Convert.ToDateTime(ObjCoredt.PeriodTo).ToString("yyyy-MM-dd");
            string fdpt = Convert.ToDateTime(ObjCoredt.PeriodFrom).ToString("dd/MM/yyyy");
            string tdpt = Convert.ToDateTime(ObjCoredt.PeriodTo).ToString("dd/MM/yyyy");
            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%;'><tbody>");
            html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
            html.Append("<td colspan='10' width='100%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1>");
            html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking)</label><br />");
            html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>ICD Dashrath</span>");
            html.Append("<br/><label style='font-size: 14px; font-weight:bold;'>CORE DATA FOR THE PERIOD OF " + fdpt + " TO " + tdpt + "</label>");
            html.Append("</td></tr>");
            html.Append("<tr><td><br/><br/></td></tr>");
            html.Append("</tbody></table>");

            DSR_ReportRepository ObjRR = new DSR_ReportRepository();

            ObjRR.PrintCoreData(fdt, tdt);//, objLogin.Uid

            DSRCoreData objPrint = (DSRCoreData)ObjRR.DBResponse.Data;

            /*Header Part*/
            if (ObjRR.DBResponse.Data != null)
            {
                html.Append("<table cellspacing='0' cellpadding='5' style='border:1px solid #000; border-bottom:0; font-size:9pt; width:100%;'>");
                html.Append("<thead><tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3' width='40%'>Description</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000; border-right:1px solid #000;text-align:center;' colspan='3' width='20%'>Income through cash realization(as per cash Book) <br/> ( Amt. in Rs.)</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000; border-right:1px solid #000;text-align:center;' colspan='3' width='20%'>Income through bill raised on depositors(as per cash Book) <br/> ( Amt. in Rs.)</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3' width='20%'>Total <br/> ( Amt. in Rs.)</td></tr></thead>");

                html.Append("<tbody>");
                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000; border-right:1px solid #000;' colspan='3'>Warehousing income(Excluding S.Tax & Cess)</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000; border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><th cellpadding='5' style='border-bottom:1px solid #000; border-right:1px solid #000;' colspan='3'>Foodgrain</th>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>FCI</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>Fertilizers</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>Other Commodities(including Air Cargo)</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>Public Bonded</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>Management Bonded</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>ICD/CFS(Including leasing)(Excluding PDA collection)</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'>" + objPrint.ICDCash + "</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'>" + objPrint.ICDBill + "</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'>" + objPrint.ICDTotal + "</td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>Railside Warehousing</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>DESS/OTA & others</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'>" + objPrint.DESSCash + "</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'>" + objPrint.DESSTotal + "</td></tr>");

                html.Append("<tr><th cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>Total Warehousing charges</th>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><th cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>M.F Receipts (H & T)</th>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>General</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>CFS/ICD</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'>" + objPrint.CFSCash + "</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'>" + objPrint.CFSTotal + "</td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>Haulage Charges</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>Income from Rail Haulage <br/> Import(PBR & MND)</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'>" + objPrint.IRRCash + "</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'>" + objPrint.IRRTotal + "</td></tr>");

                html.Append("<tr><th cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>Terminal Handling Charges</th>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>Other Income(Leased CFS/ICD-Loni/Gr.Noida)</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'></td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'></td></tr>");

                html.Append("<tr><th cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;' colspan='3'>TOTAL INCOME</th>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'>" + objPrint.GrossCash + "</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:center;' colspan='3'>" + objPrint.GrossBill + "</td>");
                html.Append("<td cellpadding='5' style='border-bottom:1px solid #000;text-align:center;' colspan='3'>" + objPrint.GrossTotal + "</td></tr>");
                html.Append("</tbody>");
                html.Append("</table>");
            }

            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%;font-size:9pt;'><tbody>");
            html.Append("<tr><td><br/><br/></td></tr>");
            html.Append("<tr><th colspan='12'>Note : Core data should be furnished by fax/phone/ in person by 02 nd of every succeeding month</th></tr>");
            html.Append("<tr><td><br/><br/><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12' style='text-align: left;'><b>SUBMITTED TO:-</b> <br/> <b>THE REGIONAL MANAGER</b> <br/> CWC, RO, DELHI</td></tr>");
            html.Append("</tbody></table>");

            html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
            lstSB.Add(html.ToString());

            var FileName = "CoreDataReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;


        }





        #endregion

        #region Bill Cum SD Ledger
        public ActionResult BillCumSDLedger()
        {
            AccessRightsRepository ACCR = new AccessRightsRepository();
            ACCR.GetMenuWiseAccessRight(Convert.ToInt32(Session["MenuId"]), ((Login)Session["LoginUser"]).Role.RoleId, Convert.ToInt32(Session["ModuleId"]),
                Convert.ToInt32(Session["BranchId"]));
            ViewBag.RightsList = JsonConvert.SerializeObject(ACCR.DBResponse.Data);

            ImportRepository objImport = new ImportRepository();
            objImport.GetPaymentParty();
            if (objImport.DBResponse.Status > 0)
                ViewBag.PaymentParty = JsonConvert.SerializeObject(objImport.DBResponse.Data);
            else
                ViewBag.PaymentParty = null;

            return PartialView();
        }


        [HttpPost]
        public JsonResult GetBillCumSDLedgerReport(int partyId, string fromdate, string todate)
        {
            try
            {
                DSR_ReportRepository Repo = new DSR_ReportRepository();
                Repo.GetBillCumSDLedgerReport(partyId, Convert.ToDateTime(fromdate).ToString("yyyy-MM-dd"), Convert.ToDateTime(todate).ToString("yyyy-MM-dd"), ZonalOffice, ZOAddress);
                object obj = Repo.DBResponse;
                return Json(obj, JsonRequestBehavior.AllowGet);
            }
            catch (Exception ex)
            {
                return Json(new { Status = 0, Data = "", Message = ex.Message.ToString() }, JsonRequestBehavior.AllowGet);
            }

        }
        #endregion

        #region ContainerOutReport



        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult ContainerOutReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //ReportRepository ObjReport = new ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetContainerOutReport(ContainerOutReport ObjContainerOutReport)
        {


            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ContainerOutReport LstContainerOutReport = new ContainerOutReport();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.ContainerOutport(ObjContainerOutReport);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                // LstContainerOutReport.lstContainerOutReport = (List<ContainerOutReportList>)ObjRR.DBResponse.Data;
                //LstContainerOutReport = (ContainerOutReport)ObjRR.DBResponse.Data;
                //if (LstContainerOutReport.lstContainerOutReport.Count > 1)
                //{
                //    LstContainerOutReport.lstContainerOutReport.ToList().ForEach(m =>
                //    {
                //        if (m.Size == "20" && m.Size != null && m.Size != "")
                //        {
                //            sizeTwenty += 1;
                //        }
                //        if (m.Size == "40" && m.Size != null && m.Size != "")
                //        {
                //            sizeFourty += 1;
                //        }

                //    });
                //}
                //ViewBag.sizeTwenty = sizeTwenty;
                //ViewBag.sizeFourty = sizeFourty;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateContainerOutReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "ContainerOutReport.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Ppg_Report/ContainerOutReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Ppg_Report/ContainerOutReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion

        #region ContainerPaymentInfo
        [HttpGet]
        public ActionResult ContainerPaymentInfo()
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.ListOfContainerWithCFSCode("", 0);
            if (ObjRR.DBResponse.Data != null)
            {
                var Jobj = Newtonsoft.Json.JsonConvert.SerializeObject(ObjRR.DBResponse.Data);
                var Jobject = Newtonsoft.Json.Linq.JObject.Parse(Jobj);
                ViewBag.lstContainer = Jobject["lstContainer"];
                ViewBag.State = Jobject["State"];
            }
            return PartialView();
        }
        [HttpGet]
        public JsonResult SearchByCFSCode(string CFSCode)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.ListOfContainerWithCFSCode(CFSCode, 0);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpGet]
        public JsonResult LoadContainerList(string CFSCode, int Page)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.ListOfContainerWithCFSCode(CFSCode, Page);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult ContainerPaymentDetail(DSR_ContainerPaymentInfo ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.ContainerPaymentDetail(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    //List<DSR_ContainerPaymentDtl> lstData = new List<DSR_ContainerPaymentDtl>();
                    //lstData = (List<DSR_ContainerPaymentDtl>)ObjRR.DBResponse.Data;
                    DSR_ContainerPaymentInfo CP = new DSR_ContainerPaymentInfo();
                    CP = (DSR_ContainerPaymentInfo)ObjRR.DBResponse.Data;
                    Path = GeneratePDFContainerPayment(CP);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFContainerPayment(DSR_ContainerPaymentInfo CP)
        {
            try
            {
                var FileName = "ContainerPaymentDetail.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>Container Payment Details</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='font-size:12px; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td colspan='2'><b>Entry No :</b> " + CP.CFSCode + "</td> <td colspan='2'><b>Container No :</b> " + CP.ContainerNo + "</td> <td colspan='2'><b>In Date :</b> " + CP.InDate + "</td> <td colspan='2'><b>Size :</b> " + CP.Size + "</td> <td colspan='2'><b>Sla :</b> " + CP.EximTraderAlias + "</td> <td colspan='2'><b>Out Date :</b>  " + CP.OutDate + "</td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");


                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>Invoice No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Invoice Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Invoice Type</th>");

                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Party Cd</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Chrg Cd</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Amount</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>From Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:8%;'>To Date</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                decimal tot = 0;
                CP.lstContainerPaymentDtl.ForEach(item =>
                {
                    tot = tot + item.Amount;
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>" + item.ReceiptNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ReceiptDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.InvoiceType + "</td>");

                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.PartyName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ChargeType + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + item.Amount + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.FromDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;width:8%;'>" + item.ToDate + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });

                Pages.Append("<tr>");
                Pages.Append("<th colspan='4' style='width:8%;'>Total :</th>");
                Pages.Append("<th style='width:10%;'></th>");
                Pages.Append("<th colspan='2' style='width:8%;'>" + tot + " </th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region TDSReport


        /*   [HttpGet]
           public ActionResult TDSReport()
           {

               DSR_ReportRepository ObjRR = new DSR_ReportRepository();
              // List<PartyLedgerList> LstParty = new List<PartyLedgerList>();
               ObjRR.GetEximTraderForPartyLedger();
               if (ObjRR.DBResponse.Data != null)
               {                               
                   ViewBag.PartyList = new SelectList((List<PartyLedgerList>)ObjRR.DBResponse.Data, "PartyId", "PartyName");
               }
               else
               {
                   ViewBag.PartyList = null;
               }
               return PartialView();
           }

           [HttpPost]
           [ValidateAntiForgeryToken]
           public ActionResult GetTDSReport(TDSReport ObjTDSReport)
           {
               DSR_ReportRepository ObjRR = new DSR_ReportRepository();
               TDSMain LstITDSMain = new TDSMain();
               //  Login objLogin = (Login)Session["LoginUser"];
               ObjRR.TdsReport(ObjTDSReport);//, objLogin.Uid
               if (ObjRR.DBResponse.Data != null)
               {
                   LstITDSMain = (TDSMain)ObjRR.DBResponse.Data;
                   return Json(ObjRR.DBResponse);
               }
               else
               {
                   return Json(ObjRR.DBResponse);
               }

           }

           [HttpPost, ValidateInput(false)]
           [CustomValidateAntiForgeryToken]
           public JsonResult GenerateTDSReportPDF(FormCollection fc)
           {
               try
               {

                   string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                   // string FtpIdPath = "";
                   //string LocalIdPath = "";
                   var Pages = new string[1];
                   var FileName = "TDSReport.pdf";
                   Pages[0] = fc["Page"].ToString();
                   // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                   //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                   //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                   //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                   // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                   string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Ppg_Report/TDSReport/";
                   if (!Directory.Exists(LocalDirectory))
                       Directory.CreateDirectory(LocalDirectory);
                   using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, true))
                   {
                       ObjPdf.HeadOffice = this.HeadOffice;
                       ObjPdf.HOAddress = this.HOAddress;
                       ObjPdf.ZonalOffice = this.ZonalOffice;
                       ObjPdf.ZOAddress = this.ZOAddress;
                       ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                   }
                   var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Ppg_Report/TDSReport/" + FileName };
                   return Json(ObjResult);

               }
               catch (Exception ex)
               {
                   return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
               }

           }*/
        [HttpGet]
        public ActionResult TDSReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Kdl_ReportRepository ObjReport = new Kdl_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<PartyLedgerList> LstParty = new List<PartyLedgerList>();
            ObjRR.GetEximTraderForPartyLedger();
            if (ObjRR.DBResponse.Data != null)
            {
                ViewBag.PartyList = new SelectList((List<PartyLedgerList>)ObjRR.DBResponse.Data, "PartyId", "PartyName");
            }
            else
            {
                ViewBag.PartyList = null;
            }
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetTDSReport(DSR_TDSReport ObjTDSReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            DSR_TDSMain LstITDSMain = new DSR_TDSMain();
            //  Login objLogin = (Login)Session["LoginUser"];
            ObjRR.TdsReport(ObjTDSReport);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstITDSMain = (DSR_TDSMain)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateTDSReportPDF(FormCollection fc)
        {
            try
            {

                string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "TDSReport.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/TDSReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/TDSReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }


        #endregion

        #region Import Container Income
        [HttpGet]
        public ActionResult ImportConIncome()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult ImportConIncomeDetail(DSR_ImportConIncome ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.ImportConIncomeDetail(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    List<DSR_ImportConIncomeDtl> lstData = (List<DSR_ImportConIncomeDtl>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFImportConIncome(lstData, ObjPV.FromDate, ObjPV.ToDate);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFImportConIncome(List<DSR_ImportConIncomeDtl> lstData, String FromDate, String ToDate)
        {
            try
            {
                var FileName = "ImportConIncomeDetail.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>IMPORT CONTAINER INCOME REPORT</label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>S.NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>DATE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PARTY NAME</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PARTY CODE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CONTAINER NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>ICD CODE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>ENTRY NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>SIZE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CONTAINER MOVEMENT TYPE(By Train/Road)</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>TRAIN NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>TRAIN DATE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>SLA CODE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PORT CODE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>DESTUFFING DATE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CUSTOM SEAL NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>SHED NO.</th>");
                Pages.Append("<th colspan='7' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 700px;'>INCOME CHARGES CODE</th>");
                Pages.Append("<th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>TAXES</th>");
                Pages.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Total</th></tr><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>THC</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>TPT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>ECC</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>DTF</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>LOL</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IRR</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HAZ</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>CGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IGST</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PartyName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PartyCode + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CFSCode + "  </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.EntryNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.MovementType + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TrainNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TrainDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.SLACode + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PortCode + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.DestuffingDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CustomSealNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ShedNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.THC + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.TPT + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.ECC + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.DTF + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.LOL + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.IRR + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.HAZ + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Total + "</td></tr>");
                    i++;
                });

                Pages.Append("<tr><th colspan='17' style='border-right: 1px solid #000; font-size: 10px; text-align: left; width: 100px;'>TOTAL</th>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.THC) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.TPT) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.ECC) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.DTF) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.LOL) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IRR) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.HAZ) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.SGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IGST) + "</td>");
                Pages.Append("<td style='font-size: 10px; text-align: center; width: 130px;'>" + lstData.Sum(item => item.Total) + "</td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A3Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Export Container Income
        [HttpGet]
        public ActionResult ExportConIncome()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult ExportConIncomeDetail(DSR_ExportConIncome ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.ExportConIncomeDetail(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    List<DSR_ExportConIncomeDtl> lstData = (List<DSR_ExportConIncomeDtl>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFExportConIncome(lstData, ObjPV.FromDate, ObjPV.ToDate);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFExportConIncome(List<DSR_ExportConIncomeDtl> lstData, String FromDate, String ToDate)
        {
            try
            {
                var FileName = "ExportConIncomeDetail.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>EXPORT CONTAINER INCOME REPORT</label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>S.NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>DATE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>INVOICE NO./BILL OF SUPPLY</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>PARTY NAME</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>PARTY CODE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>CONTAINER NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>CFS CODE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>SIZE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>CONTAINER MOVEMENT TYPE(By Train/Road)</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>CONTAINER TYPE (HAZ & NON-HAZ)</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>CARGO WEIGHT</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>TARE WEIGHT</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>TOTAL WEIGHT</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>SLA CODE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>PORT CODE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>PORT OF LOADING</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>STUFFING DATE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>MOVEMENT DATE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>SEAL DATE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>SHED NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>SHED AREA</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>WEEK</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>FOB VALUE</th>");
                Pages.Append("<th colspan='11' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 1100px;'>CHARGES CODE</th>");
                Pages.Append("<th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 300px;'>TAXES</th>");
                Pages.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 130px;'>Total</th></tr><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>HND</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>THC</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>EXPORT RR</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>FNC CHARGES</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>WEIGHMENT CHG.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>INSURANCE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>GRE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>GENERAL SPACE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>GRL</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>MOVEMENT CHG./STUFFING CHG.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>HAZ CHARGES</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>CGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>SGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 9px; text-align: center; width: 100px;'>IGST</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PartyName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PartyCode + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.MovementType + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ContainerType + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CargoWeight + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TareWeight + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TotalWeight + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.SLACode + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PortCode + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PortOfLoading + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.StuffingDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.MovementDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.SealDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ShedNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ShedArea + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Week + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.FOBValue + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.HND + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.THC + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.RR + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.FNC + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.WHT + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.INS + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.GRE + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.GEN + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.GRL + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.MO + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.HAZ + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Total + "</td></tr>");
                    i++;
                });

                Pages.Append("<tr><th colspan='23' style='border-right: 1px solid #000; font-size: 10px; text-align: left; width: 100px;'>TOTAL</th>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.HND) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.THC) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.RR) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.FNC) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.WHT) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.INS) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.GRE) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.GEN) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.GRL) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.MO) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.HAZ) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.SGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IGST) + "</td>");
                Pages.Append("<td style='font-size: 10px; text-align: center; width: 130px;'>" + lstData.Sum(item => item.Total) + "</td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A3Landscape, 40f, 40f, 10f, 10f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Assessment sheet LCL Report
        [HttpGet]
        public ActionResult AssessmentSheetLCL()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult AssessmentSheetLCLDetail(DSR_AssessmentSheetLCL ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.AssessmentSheetLCLDetail(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    List<DSR_AssessmentSheetLCLDtl> lstData = (List<DSR_AssessmentSheetLCLDtl>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFAssessmentSheetLCL(lstData, ObjPV.FromDate, ObjPV.ToDate);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFAssessmentSheetLCL(List<DSR_AssessmentSheetLCLDtl> lstData, String FromDate, String ToDate)
        {
            try
            {
                var FileName = "AssessmentSheetLCLDetail.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>Assessment Sheet LCL Report</label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>S.NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE DATE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>IMPORTER NAME</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PAYER NAME</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>BOE NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>BOE VALUE(INCLUDING DUTY)</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>NO.OF WEEK</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>AREA</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>GROSS WEIGHT</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CARGO TYPE</th>");
                Pages.Append("<th colspan='6' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 600px;'>INCOME CHARGES CODE</th>");
                Pages.Append("<th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>TAXES</th>");
                Pages.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Total</th></tr><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>ENTRY CHARGES</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HANDLING CHG.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>STORAGE CHG.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>INSURANCE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>OVERTIME CHG.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HAZ CHARGES</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>CGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IGST</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ImporterName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PayeeName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BOENo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BOEValueDuty + " </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Week + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Area + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.GrossWt + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CargoType + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.ENT + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.HND + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.STO + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.INS + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.OTI + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.HAZ + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Total + "</td></tr>");
                    i++;
                });

                Pages.Append("<tr><th colspan='11' style='border-right: 1px solid #000; font-size: 10px; text-align: left; width: 100px;'>TOTAL</th>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.ENT) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.HND) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.STO) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.INS) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.OTI) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.HAZ) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.SGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IGST) + "</td>");
                Pages.Append("<td style='font-size: 10px; text-align: center; width: 130px;'>" + lstData.Sum(item => item.Total) + "</td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion
        #region SealClosingReport



        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult SealClosingReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Kdl_ReportRepository ObjReport = new Kdl_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetSealClosingReport(DSR_SealClosingReport ObjSealClosingReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_SealClosingReport> LstSealClosingReport = new List<DSR_SealClosingReport>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.SealClosingReport(ObjSealClosingReport);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstSealClosingReport = (List<DSR_SealClosingReport>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateSealClosingReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "SealClosingReport.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/SealClosingReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/SealClosingReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }





        #endregion

        #region Empty Container Payment Report
        [HttpGet]
        public ActionResult EmptyContPayment()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult EmptyContPaymentDetail(DSR_EmptyConPayRpt ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.EmptyContainerPayment(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    List<DSR_EmptyConPayRptDtl> lstData = (List<DSR_EmptyConPayRptDtl>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFImportConIncome(lstData, ObjPV.FromDate, ObjPV.ToDate);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFImportConIncome(List<DSR_EmptyConPayRptDtl> lstData, String FromDate, String ToDate)
        {
            try
            {
                var FileName = "EmptyContainerReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>EMPTY CONTAINER PAYMENT REPORT</label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>S.NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE DATE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>IMPORTER NAME</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PAYER NAME</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CONTAINER NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CONTAINER SIZE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>NO OF DAYS</th>");
                Pages.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 400px;'>INCOME CHARGES CODE</th>");
                Pages.Append("<th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>TAXES</th>");
                Pages.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Total</th></tr><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>LNE (LIFT OF EMPTY)</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>GRE (GROUND RENT EMPTY Chg.)</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>CGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IGST</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ImporterName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PayeeName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TotalDays + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>" + item.LOE + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>" + item.GRE + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Total + "</td></tr>");
                    i++;
                });

                Pages.Append("<tr><th colspan='8' style='border-right: 1px solid #000; font-size: 10px; text-align: left; width: 100px;'>TOTAL</th>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>" + lstData.Sum(item => item.LOE) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>" + lstData.Sum(item => item.GRE) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.SGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IGST) + "</td>");
                Pages.Append("<td style='font-size: 10px; text-align: center; width: 130px;'>" + lstData.Sum(item => item.Total) + "</td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Reserve Space Income Report
        public ActionResult ReserveSpaceIncomeReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult ReserveSpaceIncomeReport(DSRReserveSpaceReport vm)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository obj = new DSR_ReportRepository();
                DateTime FromDate = Convert.ToDateTime(vm.FromDate);
                DateTime ToDate = Convert.ToDateTime(vm.ToDate);
                obj.ReserveSpaceIncomeReport(FromDate, ToDate);
                string Path = "";
                if (obj.DBResponse.Data != null)
                {
                    List<DSRReserveSpaceReport> lstData = (List<DSRReserveSpaceReport>)obj.DBResponse.Data;
                    Path = GeneratePDFReserverSpaceIncomeReport(lstData, vm.FromDate, vm.ToDate);
                    return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
                }
                return Json(new { Status = 0, Message = "" });
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }


        }
        [NonAction]
        public string GeneratePDFReserverSpaceIncomeReport(List<DSRReserveSpaceReport> lstData, String FromDate, String ToDate)
        {
            try
            {
                var FileName = "ReserveSpaceIncomeReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>RESERVE SPACE INCOME REPORT</label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>S.NO.</th>");
                //Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>BILLING DATE</th>");
                //Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>BILLING NO.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE DATE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE NO.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PARTY NAME</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PARTY CODE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>MONTH</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>AREA</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>RATE(Per SQM)</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>RESERVATION AMOUNT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>CGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>TOTAL AMOUNT RECEIVED</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>REMARKS</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    //  Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'></td>");
                    //   Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'></td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PartyName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PartyCode + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Month + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Area + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Rate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>" + item.ReservationAmount + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TotalAMount + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>" + item.Remarks + "</td></tr>");
                    i++;
                });
                Pages.Append("<tr><th colspan='8' style='border-right: 1px solid #000; font-size: 10px; text-align: left; width: 100px;'>TOTAL</th>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.ReservationAmount) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.SGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.TotalAMount) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></td>");
                Pages.Append("</tr>");


                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A3Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion


        #region Assessment sheet FCL Report
        [HttpGet]
        public ActionResult AssessmentSheetFCL()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult AssessmentSheetFCLDetail(DSR_AssessmentSheetFCL ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.AssessmentSheetFCLDetail(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    List<DSR_AssessmentSheetFCLDtl> lstData = (List<DSR_AssessmentSheetFCLDtl>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFAssessmentSheetFCL(lstData, ObjPV.FromDate, ObjPV.ToDate);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFAssessmentSheetFCL(List<DSR_AssessmentSheetFCLDtl> lstData, String FromDate, String ToDate)
        {
            try
            {
                var FileName = "AssessmentSheetFCLDetail.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>Assessment Sheet FCL Report</label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>S.NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE DATE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>IMPORTER NAME</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PAYER NAME</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CONTAINER NO</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CONTAINER SIZE</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>BOE NO.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>BOE VALUE(INCLUDING DUTY)</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>NO.OF DAYS</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>GROSS WEIGHT</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CARGO TYPE</th>");
                Pages.Append("<th colspan='6' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 600px;'>INCOME CHARGES CODE</th>");
                Pages.Append("<th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>TAXES</th>");
                Pages.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Total</th></tr><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>ENTRY CHARGES</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>GRL CHG.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>INSURANCE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>OVERTIME CHG.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>MF CHARGES</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HAZ CHARGES</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>CGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IGST</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ImporterName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PayeeName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BOENo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BOEValueDuty + " </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Days + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.GrossWt + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CargoType + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.ENT + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.GRL + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.INS + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.OTI + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.MF + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.HAZ + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Total + "</td></tr>");
                    i++;
                });

                Pages.Append("<tr><th colspan='12' style='border-right: 1px solid #000; font-size: 10px; text-align: left; width: 100px;'>TOTAL</th>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.ENT) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.GRL) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.INS) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.OTI) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.MF) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.HAZ) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.SGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IGST) + "</td>");
                Pages.Append("<td style='font-size: 10px; text-align: center; width: 130px;'>" + lstData.Sum(item => item.Total) + "</td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A3Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Outstanding Amount Report

        [HttpGet]
        public ActionResult OutstandingAmountReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult OutstandingAmountReport(DSR_OutstandingAmountReport ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.OutstandingAmountReport(Convert.ToDateTime(ObjPV.FromDate), Convert.ToDateTime(ObjPV.ToDate));
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    List<DSR_OutstandingAmountReport> lstData = (List<DSR_OutstandingAmountReport>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFOutstandingAmountReport(lstData, ObjPV.FromDate, ObjPV.ToDate);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFOutstandingAmountReport(List<DSR_OutstandingAmountReport> lstData, String FromDate, String ToDate)
        {
            try
            {
                var FileName = "OutstandingAmountReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>Outstanding Amount Report</label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>S.NO.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>BILLING DATE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>BILLING NO.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PARTY NAME</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PARTY CODE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>MONTH</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>AREA</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>RATE(Per SQM)</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>AMOUNT RECEIVABLE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>SGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>IGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>TOTAL AMOUNT RECEIVABLE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 600px;'>REMARKS</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BillingDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BillingNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PartyName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PartyCode + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Month + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Area + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.SQM + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.AmountReceivalbe + " </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>" + item.TotalAmount + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 600px;'>" + item.Remarks + "</td></tr>");
                    i++;
                });

                Pages.Append("<tr><th colspan='8' style='border-right: 1px solid #000; font-size: 10px; text-align: left; width: 100px;'>TOTAL</th>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.AmountReceivalbe) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.SGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.TotalAmount) + "</td><td></td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A3Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }

        #endregion

        #region Rent Income Report
        public ActionResult RentIncomeReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult RentIncomeReport(DSR_RentIncomeReportViewModel ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.RentIncomeReport(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    List<DSR_RentIncomeReportViewModel> lstData = (List<DSR_RentIncomeReportViewModel>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFRentIncomeReport(lstData, ObjPV.FromDate, ObjPV.ToDate);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFRentIncomeReport(List<DSR_RentIncomeReportViewModel> lstData, String FromDate, String ToDate)
        {
            try
            {
                var FileName = "RentIncomeReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>Rent Income Report</label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>S.NO.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>BILLING DATE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>BILLING NO.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE DATE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE NO.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PARTY NAME</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PARTY CODE</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>MONTH</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>TDS CERTIFICATE NO.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>RENT RECEIVED(Rs.)</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>TDS AMOUNT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>SGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>IGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>TOTAL AMOUNT RECEIVED</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>AMOUNT RECEIVABLE/OUTSTANDING</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 600px;'>REMARKS</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BillingDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BillingNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PartyName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PartyCode + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Month + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TDSCertification + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.RentReceived + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TDSAmount + " </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>" + item.TotalAmountReceived + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>" + item.AmountOutstanding + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 600px;'>" + item.Remarks + "</td></tr>");
                    i++;
                });

                Pages.Append("<tr><th colspan='9' style='border-right: 1px solid #000; font-size: 10px; text-align: left; width: 100px;'>TOTAL</th>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.RentReceived) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.TDSAmount) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.SGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.TotalAmountReceived) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.AmountOutstanding) + "</td><td></td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A3Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }

        #endregion

        #region Cargo Stock Register
        [HttpGet]
        public ActionResult CargoStockRegister()
        {
            return PartialView();
        }


        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetCargoStockRegister(DSR_CrgStkRgt ObjCargoStockRegister)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            DSR_CrgStkRgt _objCargoStockRegister = new DSR_CrgStkRgt();


            ObjRR.CargoStockRegister(ObjCargoStockRegister);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                //_objCargoStockRegister.exportCargoStocklst = (List<exportCargoStock>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateCargoStockRegisterPDF(FormCollection fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "CargoStockRegister.pdf";
                Pages[0] = fc["Page"].ToString();
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/CargoStockRegister/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/CargoStockRegister/" + FileName };
                return Json(ObjResult);
            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }
        #endregion
        /*    #region Job Order Sheet Report
            [HttpGet]
            public ActionResult JobOrderSheetReport()
            {
                return PartialView();
            }

            [HttpPost]
            [ValidateAntiForgeryToken]
            public ActionResult GetJobOrderSheetReport(DSRJobordsht ObjJobOrderSheet)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                List<DSRJobordsht> LstJobOrderSheet = new List<DSRJobordsht>();
                // Login objLogin = (Login)Session["LoginUser"];


                ObjRR.JobOrderSheet(ObjJobOrderSheet);//, objLogin.Uid
                if (ObjRR.DBResponse.Data != null)
                {
                    LstJobOrderSheet = (List<DSRJobordsht>)ObjRR.DBResponse.Data;
                    return Json(ObjRR.DBResponse);
                }
                else
                {
                    return Json(ObjRR.DBResponse);
                }

            }

            [HttpPost, ValidateInput(false)]
            [CustomValidateAntiForgeryToken]
            public JsonResult GenerateJobOrderSheetPDF(FormCollection fc)
            {
                try
                {
                    var Pages = new string[1];
                    var FileName = "JobOrderSheet.pdf";
                    Pages[0] = fc["Page"].ToString();
                    string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/JobOrderSheet/";
                    if (!Directory.Exists(LocalDirectory))
                        Directory.CreateDirectory(LocalDirectory);
                    using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                    {
                        ObjPdf.HeadOffice = this.HeadOffice;
                        ObjPdf.HOAddress = this.HOAddress;
                        ObjPdf.ZonalOffice = this.ZonalOffice;
                        ObjPdf.ZOAddress = this.ZOAddress;
                        ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                    }
                    var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/JobOrderSheet/" + FileName };
                    return Json(ObjResult);
                }
                catch (Exception ex)
                {
                    return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
                }

            }
            #endregion*/
        #region BulkCreaditNoteReport
        [HttpGet]
        public ActionResult BulkCreaditNoteReport()
        {

            //ExportRepository objExport = new ExportRepository();
            //objExport.GetPaymentParty();
            //if (objExport.DBResponse.Status > 0)
            //    ViewBag.PaymentParty = JsonConvert.SerializeObject(objExport.DBResponse.Data);
            //else
            //    ViewBag.PaymentParty = null;
            return PartialView();
        }
        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult PrintCRNote(FormCollection fc)
        {
            //objRR.GetBulkDebitNoteReport(Convert.ToDateTime(fc["PeriodFrom"]).ToString("yyyy/MM/dd"), Convert.ToDateTime(fc["PeriodTo"]).ToString("yyyy/MM/dd"));
            DSR_ReportRepository objRepo = new DSR_ReportRepository();
            PrintModelOfBulkCrCompany objCR = new PrintModelOfBulkCrCompany();
            objRepo.PrintDetailsForBulkCRNote(Convert.ToDateTime(fc["PeriodFrom"]).ToString("yyyy/MM/dd"), Convert.ToDateTime(fc["PeriodTo"]).ToString("yyyy/MM/dd"), "C");
            if (objRepo.DBResponse.Data != null)
            {
                objCR = (PrintModelOfBulkCrCompany)objRepo.DBResponse.Data;
                string Path = GenerateDRNotePDF(objCR);
                return Json(new { Status = 1, Message = Path });
            }
            else
            {
                return Json(new { Status = -1, Message = "error" });
            }
        }
        #endregion
        #region BulkDebitnoteReport
        [HttpGet]
        public ActionResult BulkDebitnoteReport()
        {

            //ExportRepository objExport = new ExportRepository();
            //objExport.GetPaymentParty();
            //if (objExport.DBResponse.Status > 0)
            //    ViewBag.PaymentParty = JsonConvert.SerializeObject(objExport.DBResponse.Data);
            //else
            //    ViewBag.PaymentParty = null;
            return PartialView();
        }
        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult PrintDRNote(FormCollection fc)
        {
            //objRR.GetBulkDebitNoteReport(Convert.ToDateTime(fc["PeriodFrom"]).ToString("yyyy/MM/dd"), Convert.ToDateTime(fc["PeriodTo"]).ToString("yyyy/MM/dd"));
            DSR_ReportRepository objRepo = new DSR_ReportRepository();
            PrintModelOfBulkCrCompany objCR = new PrintModelOfBulkCrCompany();
            objRepo.PrintDetailsForBulkCRNote(Convert.ToDateTime(fc["PeriodFrom"]).ToString("yyyy/MM/dd"), Convert.ToDateTime(fc["PeriodTo"]).ToString("yyyy/MM/dd"), "D");
            if (objRepo.DBResponse.Data != null)
            {
                objCR = (PrintModelOfBulkCrCompany)objRepo.DBResponse.Data;
                string Path = GenerateDRNotePDF(objCR);
                return Json(new { Status = 1, Message = Path });
            }
            else
            {
                return Json(new { Status = -1, Message = "error" });
            }
        }

        //    public string GenerateCRNotePDF(PrintModelOfBulkCrCompany objCR)
        //    {
        //        string Note = "";
        //        string SACCode = "", note = "", fileName = "";
        //        objCR.lstCharges.Select(x => new { SACCode = x.SACCode }).Distinct().ToList().ForEach(item =>
        //        {
        //            if (SACCode == "")
        //                SACCode = item.SACCode;
        //            else
        //                SACCode = SACCode + "," + item.SACCode;
        //        });

        //            note = (Note == "C") ? "CREDIT NOTE" : "DEBIT NOTE";
        //        fileName = (Note == "C") ? ("CreditNote" + CRNoteId + ".pdf") : ("DebitNote" + CRNoteId + ".pdf");
        //        string Path = Server.MapPath("~/Docs/") + Session.SessionID;//+ "/CreditNote" + CRNoteId + ".pdf";
        //        if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
        //        {
        //            Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
        //        }
        //        if (System.IO.File.Exists(Path + "/" + fileName))
        //        {
        //            System.IO.File.Delete(Path + "/" + fileName);

        //        }
        //        objCR.lstCrParty.ToList().ForEach(item =>
        //        {
        //            string html = "<table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><thead><tr><th colspan='2' style='text-align:center;padding:8px;'>Principle Place of Business: <span style='border-bottom:1px solid #000;'>______________________</span><br/>" + note + "</th></tr><tr><th style='border:1px solid #000;text-align:center;padding:8px;width:50%;'>Details of Service Provider</th><th style='border:1px solid #000;text-align:center;padding:8px;width:50%;'>Details of Service Receiver</th></tr></thead><tbody><tr><td style='border:1px solid #000;text-align:left;padding:8px;'>Name: " + objCR.CompanyName + "</td><td style='border:1px solid #000;text-align:left;padding:8px;'>Name: <span>" + item.PartyName + "</span></td></tr><tr><td style='border:1px solid #000;text-align:left;padding:8px;'>Warehouse Address: <span>" + objCR.CompanyAddress + "</span></td><td style='border:1px solid #000;text-align:left;padding:8px;'>Address: <span>" + item.PartyAddress + "</span></td></tr><tr><td style='border:1px solid #000;text-align:left;padding:8px;'>City: <span>" + objCR.CompCityName + "</span></td><td style='border:1px solid #000;text-align:left;padding:8px;'>City: <span>" + item.PartyCityName + "</span></td></tr><tr><td style='border:1px solid #000;text-align:left;padding:8px;'>State: <span>" + objCR.CompStateName + "</span></td><td style='border:1px solid #000;text-align:left;padding:8px;'>State: <span>" + item.PartyStateName + "</span></td></tr><tr><td style='border:1px solid #000;text-align:left;padding:8px;'>State Code: <span>" + objCR.CompStateCode + "</span></td><td style='border:1px solid #000;text-align:left;padding:8px;'>State Code: <span>" + item.PartyStateCode + "</span></td></tr><tr><td style='border:1px solid #000;text-align:left;padding:8px;'>GSTIN: <span>" + objCR.CompGstIn + "</span></td><td style='border:1px solid #000;text-align:left;padding:8px;'><span>GSTIN(if registered):" + item.PartyGSTIN + "</span></td></tr><tr><td style='border:1px solid #000;text-align:left;padding:8px;'>PAN:<span>" + objCR.CompPan + "</span></td><td style='border:1px solid #000;text-align:left;padding:8px;'><span></span></td></tr><tr><td style='text-align:left;padding:8px;'>Debit/Credit Note Serial No: <span style='border-bottom:1px solid #000;'>" + item.CRNoteNo + "</span><br/><br/>Date of Issue: <span style='border-bottom:1px solid #000;'>" + item.CRNoteDate + "</span></td><td style='text-align:left;padding:8px;'>Accounting Code of <span>" + SACCode + "</span><br/><br/>Description of Services: <span>Other Storage & Warehousing Services</span></td></tr><tr><td colspan='2' style='text-align:left;padding:8px;'>Original Bill of Supply/Tax Invoice No: <span style='border-bottom:1px solid #000;'>" + item.InvoiceNo + "</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Date: <span style='border-bottom:1px solid #000;'>" + Convert.ToDateTime(item.InvoiceDate).ToString("dd/MM/yyyy") + "</span></td></tr><tr><td colspan='2'>";
        //        string htmltable = "<table style='width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border:1px solid #000;font-size:7pt;'><thead><tr><th rowspan='2' style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>Sl No.</th><th style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;width:20%;'>Particulars</th><th rowspan='2' style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;width:7%;'>Taxable Value</th><th colspan='2' style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>CGST</th><th colspan='2' style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>SGST</th><th colspan='2' style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>IGST</th><th rowspan='2' style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>Total Amount</th></tr><tr><th style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>Reasons for increase / decrease in original invoice</th><th style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>Rate</th><th style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>Amt</th><th style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>Rate</th><th style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>Amt</th><th style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>Rate</th><th style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>Amt</th></tr></thead><tbody>";
        //        string tr = "";
        //        int Count = 1;
        //        decimal IGSTAmt = 0, CGSTAmt = 0, SGSTAmt = 0;
        //            objCR.lstCharges.Where(y => y.CRNoteId == item.CRNoteId).ToList().ForEach(data =>
        //           {
        //                tr += "<tr><td style='border:1px solid #000;text-align:center;padding:5px;font-size:7pt;'>" + Count + "</td><td style='border:1px solid #000;text-align:left;padding:5px;font-size:7pt;'>" + item.ChargeName + "</td><td style='border:1px solid #000;text-align:right;padding:5px;font-size:7pt;'>" + item.Taxable + "</td><td style='border:1px solid #000;text-align:right;padding:5px;font-size:7pt;'>" + item.CGSTPer + "</td><td style='border:1px solid #000;text-align:right;padding:5px;font-size:7pt;'>" + item.CGSTAmt + "</td><td style='border:1px solid #000;text-align:right;padding:5px;font-size:7pt;'>" + item.SGSTPer + "</td><td style='border:1px solid #000;text-align:right;padding:5px;font-size:7pt;'>" + item.SGSTAmt + "</td><td style='border:1px solid #000;text-align:right;padding:5px;font-size:7pt;'>" + item.IGSTPer + "</td><td style='border:1px solid #000;text-align:right;padding:5px;font-size:7pt;'>" + item.IGSTAmt + "</td><td style='border:1px solid #000;text-align:right;padding:5px;font-size:7pt;'>" + item.Total + "</td></tr>";
        //            IGSTAmt += item.IGSTAmt;
        //            CGSTAmt += item.CGSTAmt;
        //            SGSTAmt += item.SGSTAmt;
        //            Count++;
        //        });
        //        string AmountInWord = ConvertNumbertoWords((long)objCR.GrandTotal);
        //        string Remarks = objCR.Remarks;
        //        string tfoot = "<tr><td style='border:1px solid #000;text-align:center;padding:5px;'></td><td style='border:1px solid #000;text-align:left;padding:5px;'></td><td style='border:1px solid #000;text-align:center;padding:5px;font-weight:600;'>Total</td><td style='border:1px solid #000;text-align:right;padding:5px;'></td><td style='border:1px solid #000;text-align:right;padding:5px;'>" + CGSTAmt + "</td><td style='border:1px solid #000;text-align:right;padding:5px;'></td><td style='border:1px solid #000;text-align:right;padding:5px;'>" + SGSTAmt + "</td><td style='border:1px solid #000;text-align:right;padding:5px;'></td><td style='border:1px solid #000;text-align:right;padding:5px;'>" + IGSTAmt + "</td><td style='border:1px solid #000;text-align:right;padding:5px;'>" + objCR.TotalAmt + "</td></tr><tr><td colspan='10' style='border:1px solid #000;text-align:left;padding:5px;font-size:7pt;'><span style='border-bottom:1px solid #000;font-weight:600;'>Total Debit/Credit Note Value (in figure)</span> <span>" + objCR.GrandTotal + "</span></td></tr><tr><td colspan='10' style='border:1px solid #000;text-align:left;padding:5px;font-size:7pt;'><span style='border-bottom:1px solid #000;font-weight:600;'>Total Debit/Credit Note Value (in words)</span> <span>" + AmountInWord + "</span></td></tr><tr><td colspan='10' style='border:1px solid #000;text-align:left;padding:5px;font-size:7pt;'><span style='border-bottom:1px solid #000;font-weight:600;'>Remarks</span> <span>" + Remarks + "</span></td></tr></tbody></table></td></tr><tr><td colspan='2' style='text-align:left;padding:5px;'>Note:<br/><span style='padding:8px;'>1. The invoice issued earlier can be modified/cancelled by way of Debit Note/Credit Note.</span><br/><span style='padding:8px;'>2. Credit Note is to be issued where excess amount cliamed in original invoice.</span><br/><span style='padding:8px;'>3. Debit Note is to be issued where less amount claimed in original invoice.</span></td></tr><tr><td></td><td style='text-align:left;padding:8px;font-weight:600;'>Signature: ____________________________<br/><br/>Name of the Signatory: __________________ <br/><br/>Designation/Status: ____________________ </td></tr><tr><td style='text-align:left;padding:5px;'>To,<br/><span style='border-bottom:1px solid #000;'>____________________________ <br/>____________________________<br/>____________________________<br/></span><br/><br/>Copy To:<br/>1. Duplicate Copy for RM, CWC,RO -<br/>2. Triplicate Copy for Warehouse</td></tr></tbody></table>";
        //        html = html + htmltable + tr + tfoot;
        //        using (var RH = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f))
        //        {
        //            RH.GeneratePDF(Path + "/" + fileName, html);
        //        }
        //        return "/Docs/" + Session.SessionID + "/" + fileName;
        //    }


        //}

        [NonAction]
        public string GenerateDRNotePDF(PrintModelOfBulkCrCompany objCR)
        {


            List<string> lstSB = new List<string>();

            string SACCode = "";
            objCR.lstCharges.Select(x => new { SACCode = x.SACCode }).Distinct().ToList().ForEach(item =>
            {
                if (SACCode == "")
                    SACCode = item.SACCode;
                else
                    SACCode = SACCode + "," + item.SACCode;
            });

            objCR.lstCrParty.ToList().ForEach(item =>
            {

                //    /*Header Part*/
                StringBuilder html = new StringBuilder();

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td colspan='8' width='90%' width='100%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCR.CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCR.CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'></label>");
                html.Append("</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table cellpadding='0' cellspacing='0' style='table-layout: fixed; width:100%; border:1px solid #000; font-size:8pt; font-family:Verdana,Arial,San-serif;'><tbody>");
                html.Append("<tr>");
                html.Append("<td colspan='6' cellspacing='0' style='width:50%; border-right: 1px solid #000;'>");
                html.Append("<table cellspacing='0' style='width:100%;font-size:8pt;'><tbody>");
                html.Append("<tr><th cellpadding='10' style='border-bottom: 1px solid #000;'>Details of Service Provider</th></tr>");
                html.Append("<tr><td cellpadding='10' style='border-bottom: 1px solid #000;'><b>Name:</b>" + objCR.CompanyName + "</td></tr>");
                html.Append("<tr><td cellpadding='10' style='border-bottom: 1px solid #000;'><b>Warehouse Address:</b>" + objCR.CompanyAddress + "</td></tr>");
                html.Append("<tr><td cellpadding='10' style='border-bottom: 1px solid #000;'><b>City:</b>" + objCR.CompCityName + "</td></tr>");
                html.Append("<tr><td cellpadding='10' style='border-bottom: 1px solid #000;'><b>State:</b>" + objCR.CompStateName + "</td></tr>");
                html.Append("<tr><td cellpadding='10' style='border-bottom: 1px solid #000;'><b>State Code:</b>" + objCR.CompStateCode + "</td></tr>");
                html.Append("<tr><td cellpadding='10' style='border-bottom: 1px solid #000;'><b>GSTIN:</b> " + objCR.CompGstIn + "</td></tr>");
                html.Append("<tr><td cellpadding='10'><b>PAN:</b>" + objCR.CompPan + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' cellspacing='0' Valign='top' style='width:50%;'>");
                html.Append("<table cellspacing='0' style='width:100%;font-size:8pt;'><tbody>");
                html.Append("<tr><th cellpadding='10' style='border-bottom: 1px solid #000;'>Details of Service Receiver</th></tr>");
                html.Append("<tr><td cellpadding='10' style='border-bottom: 1px solid #000;'><b>Name:</b> " + item.PartyName + "</td></tr>");
                html.Append("<tr><td cellpadding='10' style='border-bottom: 1px solid #000;'><b>Address:</b> " + item.PartyAddress + "</td></tr>");
                html.Append("<tr><td cellpadding='10' style='border-bottom: 1px solid #000;'><b>City:</b>" + item.PartyCityName + "</td></tr>");
                html.Append("<tr><td cellpadding='10' style='border-bottom: 1px solid #000;'><b>State:</b>" + item.PartyStateName + "</td></tr>");
                html.Append("<tr><td cellpadding='10' style='border-bottom: 1px solid #000;'><b>State Code:</b> " + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><td cellpadding='10' style='border-bottom: 1px solid #000;'><b>GSTIN(if registered):</b> " + item.PartyGSTIN + "</td></tr>");
                html.Append("<tr><td cellpadding='10'></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");

                html.Append("<table cellpadding='6' cellspacing='0' style='width:100%; border:1px solid #000; font-size:8pt; font-family:Verdana,Arial,San-serif; margin-top:20px;'><tbody>");
                html.Append("<tr><td colspan='6' style='width:50%;'><b>Debit/Credit Note Serial No :</b> " + item.CRNoteNo + "</td> <td colspan='6' style='width:50%; text-align: right;'><b>Accounting Code of</b> " + SACCode + "</td></tr>");
                html.Append("<tr><td colspan='6' style='width:50%;'><b>Date of Issue :</b> " + Convert.ToDateTime(item.CRNoteDate).ToString("dd/MM/yyyy") + "</td> <td colspan='6' style='width:50%; text-align: right;'><b>Description of Services :</b> Other Storage & Warehousing Services</td></tr>");
                html.Append("<tr><td colspan='6' style='width:50%;'><b>Original Bill of Supply/Tax Invoice No :</b>  " + item.InvoiceNo + "</td> <td colspan='6' style='width:50%; text-align: right;'><b>Date :</b>  " + Convert.ToDateTime(item.InvoiceDate).ToString("dd/MM/yyyy") + "</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table cellpadding='5' cellspacing='0' style='width:100%; border:1px solid #000; font-size:8pt; font-family:Verdana,Arial,San-serif; margin-top:20px;'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Sl No.</th>");
                html.Append("<th colspan='1' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>Particulars</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Value</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>Total Amount</th></tr>");
                html.Append("<tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>Reason for increase/decrease in original invoice</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                int i = 1;
                decimal IGSTAmt = 0, CGSTAmt = 0, SGSTAmt = 0;
                decimal total = 0;
                objCR.lstCharges.Where(y => y.CRNoteId == item.CRNoteId).ToList().ForEach(data =>
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>" + data.ChargeName + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + data.Taxable + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.CGSTPer + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.CGSTAmt + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.SGSTPer + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.SGSTAmt + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.IGSTPer + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.IGSTAmt + "</td>");

                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>" + data.Total + "</td></tr>");
                        i = i + 1;
                        IGSTAmt += data.IGSTAmt;
                        CGSTAmt += data.CGSTAmt;
                        SGSTAmt += data.SGSTAmt;
                        total += data.Total;
                    });

                html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'></td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Total</td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + CGSTAmt + "</td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + SGSTAmt + "</td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + IGSTAmt + "</td>");
                html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>" + total + "</td></tr>");

                string AmountInWord = ConvertNumbertoWords((long)item.GrandTotal);
                html.Append("<tr><td style='border-bottom: 1px solid #000; font-size: 10px; text-align: left; padding: 5px;' colspan='10'><b>Total Debit/Credit Note Value (in figure):</b>" + item.GrandTotal + "</td></tr>");
                html.Append("<tr><td style='border-bottom: 1px solid #000; font-size: 10px; text-align: left; padding: 5px;' colspan='10'><b>Total Debit/Credit Note Value (in words):</b> " + AmountInWord + "</td></tr>");
                html.Append("<tr><td style='border-bottom: 1px solid #000; font-size: 10px; text-align: left; padding: 5px;' colspan='10'><b>Remarks:</b>" + item.Remarks + "</td></tr>");

                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table cellpadding='5' cellspacing='0' style='width:100%; font-size:9pt; margin-top:20px;'><tbody>");
                html.Append("<tr><td><span><br/></span></td></tr>");
                html.Append("<tr><th>Note:</th></tr>");
                html.Append("<tr><td colspan='12'><b>1.</b> The invoice issued earlier can be modified/cancelled by way of Debit Note/Credit Note.</td></tr>");
                html.Append("<tr><td colspan='12'><b>2.</b> Credit Note is to be issued where excess amount cliamed in original invoice.</td></tr>");
                html.Append("<tr><td colspan='12'><b>3.</b> Debit Note is to be issued where less amount claimed in original invoice.</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table cellpadding='5' cellspacing='0' style='width:100%; font-size:9pt; margin-top:20px;'><tbody>");
                html.Append("<tr><td><span><br/></span></td></tr>");
                html.Append("<tr><td colspan='6' width='80%'></td>");
                html.Append("<th colspan='5' width='50%'>Signature: ____________________________ <br/><br/> Name of the Signatory: __________________ <br/><br/> Designation/Status: ____________________</th></tr>");

                html.Append("<tr><td colspan='6' width='50%'>To, <br/> ____________________________ <br/>____________________________<br/>____________________________<br/><br/> Copy To: <br/> Duplicate Copy for RM, CWC,RO - <br/> 2.Triplicate Copy for Warehouse</td>");
                html.Append("<th colspan='6' width='50%'></th></tr>");


                html.Append("</tbody></table>");
                // html.Append("<div style='margin-top:10px;'><br/><br/><br/><br/></div>");
                // html.Append("<div style='margin-top:10px;'><br/><br/></div>");

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());

            });



            var FileName = "BulkDebitReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion


        #region TaxZeroInvoiceReport



        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult TaxZeroInvoiceReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //DSR_ReportRepository ObjReport = new DSR_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetTaxZeroInvoiceReport(DSR_DailyCashBook ObjDailyCashBook)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_DailyCashBook> LstDailyCashBook = new List<DSR_DailyCashBook>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.TaxZeroInvoiceReport(ObjDailyCashBook);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstDailyCashBook = (List<DSR_DailyCashBook>)ObjRR.DBResponse.Data;
                LstDailyCashBook = LstDailyCashBook.OrderBy(o => o.ReceiptDate).ThenBy(o => o.CRNo).ToList();

                LstDailyCashBook.Add(new DSR_DailyCashBook()
                {
                    /*ReceiptDate = "<strong>Total</strong>",
                    CRNo = "",
                    Depositor = "",*/

                    InvoiceDate = "<strong>Total</strong>",
                    InvoiceNo = "",
                    InvoiceType = "",
                    PartyName = "",
                    PayeeName = "",
                    ModeOfPay = "",
                    ChqNo = "",
                    GenSpace = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.GenSpace)).ToString(),
                    StorageCharge = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.StorageCharge)).ToString(),
                    Insurance = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Insurance)).ToString(),
                    GroundRentEmpty = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.GroundRentEmpty)).ToString(),
                    GroundRentLoaded = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.GroundRentLoaded)).ToString(),
                    MfCharge = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.MfCharge)).ToString(),
                    EntryCharge = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.EntryCharge)).ToString(),
                    Fumigation = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Fumigation)).ToString(),
                    OtherCharge = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.OtherCharge)).ToString(),
                    Misc = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Misc)).ToString(),
                    Cgst = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Cgst)).ToString(),
                    Sgst = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Sgst)).ToString(),
                    Igst = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Igst)).ToString(),

                    MiscExcess = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.MiscExcess)).ToString(),
                    TotalCash = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalCash)).ToString(),
                    TotalCheque = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalCheque)).ToString(),
                    TotalOthers = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalOthers)).ToString(),
                    Tds = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Tds)).ToString(),
                    CrTds = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.CrTds)).ToString(),
                    TotalPDA = LstDailyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalPDA)).ToString(),
                    Remarks = ""

                });
                ObjRR.DBResponse.Data = LstDailyCashBook;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateTaxZeroInvoiceReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "TaxZeroInvoiceReport.pdf";
                Pages[0] = fc["Page"].ToString();
                Pages[0] = fc["Page"].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/TaxZeroInvoiceReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.LegalLandscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                //using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f))
                //{

                //    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                //}
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/TaxZeroInvoiceReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }


        #endregion


        #region PDUtilizationSummary



        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult PDASummaryUtilizationReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //DSR_ReportRepository ObjReport = new DSR_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetPdSummaryUtilizationReport(PdSummary ObjPdSummary, int drpType)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<PdSummary> LstPdSummary = new List<PdSummary>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.PdSummaryUtilizationReport(ObjPdSummary, drpType);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstPdSummary = (List<PdSummary>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GeneratePdSummaryUtilizationPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "SdSummary.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/SdSummary/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/SdSummary/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion


        #region THCRR Report 
        [HttpGet]
        public ActionResult ExportTHCRRReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //DSR_ReportRepository ObjReport = new DSR_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportTHCRRReport(DSR_ThcRrReport Obj)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_ThcRrReport> LstTHCRR = new List<DSR_ThcRrReport>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.ExportTHCRRReport(Obj);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateExportTHCRRReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "ExportTHCRRReport.pdf";
                Pages[0] = fc["Page"].ToString();
                Pages[0] = fc["Page"].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/ExportTHCRRReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.LegalLandscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                //using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f))
                //{

                //    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                //}
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/ExportTHCRRReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion


        #region Import THCRR Report 
        [HttpGet]
        public ActionResult ImportTHCRRReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //DSR_ReportRepository ObjReport = new DSR_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportTHCRRReport(DSR_ThcRrReport Obj)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_ThcRrReport> LstTHCRR = new List<DSR_ThcRrReport>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.ImportTHCRRReport(Obj);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateImportTHCRRReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "ImportTHCRRReport.pdf";
                Pages[0] = fc["Page"].ToString();
                Pages[0] = fc["Page"].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/ImportTHCRRReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.LegalLandscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                //using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f))
                //{

                //    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                //}
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/ImportTHCRRReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion



        #region MPMPR_PORTWISE report

        [HttpGet]
        public ActionResult PortwiseReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Kdl_ReportRepository ObjReport = new Kdl_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }



        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult PortwiseReport(FormCollection fc)
        {
            //objRR.GetBulkDebitNoteReport(Convert.ToDateTime(fc["PeriodFrom"]).ToString("yyyy/MM/dd"), Convert.ToDateTime(fc["PeriodTo"]).ToString("yyyy/MM/dd"));
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();

            PrintModelOfBulkCrCompany objCR = new PrintModelOfBulkCrCompany();
            string Fdt = Convert.ToDateTime(fc["PeriodFrom"]).ToString("yyyy-MM-dd");
            string Tdt = Convert.ToDateTime(fc["PeriodTo"]).ToString("yyyy-MM-dd");
            ObjRR.PrintDetailsForPortwise(Fdt, Tdt);
            if (ObjRR.DBResponse.Data != null)
            {
                //DSRSDDetailsStatement SDData = new DSRSDDetailsStatement();
                PortWiseReport objport = new PortWiseReport();
                objport = (PortWiseReport)ObjRR.DBResponse.Data;
                //objCR = (PrintModelOfBulkCrCompany)objRepo.DBResponse.Data;
                string Path = GeneratePortwisePDF(objport, Convert.ToDateTime(Fdt).ToString("dd-MM-yyyy"), Convert.ToDateTime(Tdt).ToString("dd-MM-yyyy"));
                return Json(new { Status = 1, Message = Path });
            }
            else
            {
                return Json(new { Status = ObjRR.DBResponse.Status, Message = ObjRR.DBResponse.Message });
            }
        }

        //[HttpPost]
        //[ValidateAntiForgeryToken]
        //public JsonResult GetSDDetReport(string FromDate, string ToDate, int PartyId)
        //{
        //    DSR_ReportRepository ObjRR = new DSR_ReportRepository();

        //    string Fdt = Convert.ToDateTime(FromDate).ToString("yyyy-MM-dd");
        //    string Tdt = Convert.ToDateTime(ToDate).ToString("yyyy-MM-dd");

        //    ObjRR.GetSDDetStatement(PartyId, Fdt, Tdt);
        //    string Path = "";
        //    if (ObjRR.DBResponse.Data != null)
        //    {
        //        DSRSDDetailsStatement SDData = new DSRSDDetailsStatement();
        //        SDData = (DSRSDDetailsStatement)ObjRR.DBResponse.Data;

        //        Path = GeneratePDFSDDetReport(SDData, FromDate, ToDate);
        //    }
        //    return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
        //}


        [NonAction]
        public string GeneratePortwisePDF(PortWiseReport SDData, string FromDate, string ToDate)
        {
            int Total = 0;
            try
            {
                var FileName = "PortWiseReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                //***************************************************************************************

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>STATEMENT SHOWING DETAILS OF IMPORT LOADED CONTAINERS/TEUs</label><br/><label style='font-size: 14px; font-weight:bold;'>PORT WISE REPORT OF DIFFERENT SHIPPING LINES DURING " + FromDate + "-TO-" + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellpadding='5' cellspacing='0' style='width:100%; border:1px solid #000; border-bottom:0; font-size:8pt; font-family:Verdana,Arial,San-serif; margin-top:20px;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Sl No.</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Code</th>");
                Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>SLA</th>");
                Pages.Append("<th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>BY TRAIN</th>");
                Pages.Append("<th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 300px;'>BY ROAD</th>");
                Pages.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 120px;'>Total TEUs</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>LONI</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>TKD</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>OTH</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>LONI</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>TKD</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>OTH</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                SDData.PortWiseReportList.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + item.SlaCode + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + item.TLoni + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + item.TTkd + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + item.TOth + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + item.RLoni + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + item.RTkd + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + item.ROth + "</td>");
                    Pages.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + (item.TLoni + item.TTkd + item.TOth + item.RLoni + item.RTkd + item.ROth) + "</td></tr>");
                    i = i + 1;
                    SDData.RLoni += item.RLoni;
                    SDData.RTkd += item.RTkd;
                    SDData.ROth += item.ROth;
                    SDData.TLoni += item.TLoni;
                    SDData.TTkd += item.TTkd;
                    SDData.TOth += item.TOth;
                    Total += (item.TLoni + item.TTkd + item.TOth + item.RLoni + item.RTkd + item.ROth);
                });
                Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: left;'>Total</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + SDData.TLoni + "</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + SDData.TTkd + "</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + SDData.TOth + "</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + SDData.RLoni + "</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + SDData.RTkd + "</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + SDData.ROth + "</th>");
                Pages.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + Total + "</th></tr>");

                Pages.Append("<tr><th style='border-bottom: 1px solid #000; font-size: 10px; text-align: left; padding: 5px;' colspan='10'><b>Total LCL :</b> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> " + SDData.TotalLCL + "</th></tr>");
                Pages.Append("<tr><th style='border-bottom: 1px solid #000; font-size: 10px; text-align: left; padding: 5px;' colspan='10'><b>Total FCL :</b> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> " + SDData.TotalFCL + "</th></tr>");
                Pages.Append("</tbody>");
                Pages.Append("</table>");

                Pages.Append("<table cellpadding='5' cellspacing='0' style='width:100%; font-size:9pt;'><tbody>");
                Pages.Append("<tr><td><span><br/><br/></span></td></tr>");
                Pages.Append("<tr><th colspan='6' width='50%'>Submitted to <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>The Manager, ICD <br/> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> CWC,PPG,Delhi</th>");
                Pages.Append("<th colspan='6' width='50%' align='right'>Sr.Asstt. Manager</th></tr>");
                Pages.Append("</tbody></table>");

                //***************************************************************************************
                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Long Standing Export Cargo Report 
        [HttpGet]
        public ActionResult LongStandingExportCargoReport()
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            ObjGR.GetGodownRightsWise(((Login)Session["LoginUser"]).Uid);
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();


        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetLongStandingExportCargoReport(DSR_LongStandingExportCargo vm)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSR_LongStandingExportCargoDtl> lstLongStandingExportCargo = new List<DSR_LongStandingExportCargoDtl>();
            ObjRR.GetLongStandingExportLoadedCargo(vm);
            String Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                lstLongStandingExportCargo = (List<DSR_LongStandingExportCargoDtl>)ObjRR.DBResponse.Data;
                Path = GeneratePDFLongStandingExportLoadedCargo(lstLongStandingExportCargo, vm);

            }
            return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);

        }

        [NonAction]

        public String GeneratePDFLongStandingExportLoadedCargo(List<DSR_LongStandingExportCargoDtl> lstData, DSR_LongStandingExportCargo Obj)
        {
            try
            {
                var FileName = "LongStandingImpLoadCargo.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 28px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 14px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:14px;'>ICD Dashrath</span><br/><label style='font-size: 16px; font-weight:bold;'>Inland Container Depot.</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'><br/></td></tr>");
                Pages.Append("<tr><th colspan='12' style='font-size:14px; text-align: center;'>Export Cargo Lying in Shed more than " + Obj.days + " as on " + Obj.AsOnDate + " </th></tr>");
                Pages.Append("<tr><td colspan='12' style='font-size:12px;'><b>SHED :</b> " + Obj.GodownName + "</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:6pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Shipping Bill No.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Shipping Bill Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>CCIN Invoice No.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>CCIN Invoice Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Exporter Name</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Exporter Address</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>CHA Name</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Stuffing Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Shipping Line Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>No of Pkg</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Weight</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>FOB Value</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Commodity</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Area</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Storage Charges</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>G/H</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Notice1</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Notice2</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>NOC Apply Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Seize/Hold Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Remarks1</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Remarks2</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ShippingBillNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ShippingBillNoDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.CCINInvoiceNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.CCINInvoiceDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ExporterName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ExporterAddress + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ChaName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.InDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>" + item.StuffingDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.ShippingLineCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.NoOfPkg + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.GrWt + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Fob + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Commodity + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Area + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.StroageCharges + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.GH + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Notice1 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Date1 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Notice2 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Date2 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Nocr + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.SeizeDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Remarks1 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Remarks2 + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });
                Pages.Append("</tbody></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' valign='bottom' style='width:100%;'><tfoot>");
                Pages.Append("<tr><td colspan='12'><br/><br/><br/><br/></td></tr>");
                Pages.Append("</tfoot></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }

        }

        #endregion




        #region Long Standing Empty Container Report

        [HttpGet]
        public ActionResult LongStandingEmptyCont()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetLongStandingEmptyCont(DSR_PVReport ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.LongStandingEmptyCont(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    List<DSR_LongStandingEmptyCont> lstData = new List<DSR_LongStandingEmptyCont>();
                    lstData = (List<DSR_LongStandingEmptyCont>)ObjRR.DBResponse.Data;
                    Path = GenerateLongStandingPDFEmptyCont(lstData, ObjPV.AsOnDate);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GenerateLongStandingPDFEmptyCont(List<DSR_LongStandingEmptyCont> lstData, string Date)
        {
            try
            {
                var FileName = "EmptyContReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><span style='font-size:12px;'><b>As On - </b> " + Date + "</span><br/><label style='font-size: 14px; font-weight:bold;'>Long Standing Empty Containers</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>Sno</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>ShippingLine</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>Address</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>ICD Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Container In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Container Destuffing Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Sla Cd</th>");

                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>Out Date Ecy</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Days</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>GRE Amount</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>Notice1 Despatch NO</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>Notice2 Despatch NO</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>NOC Apply Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:12%;text-align:right;'>Remarks</th></tr></thead>");

                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>" + item.Address + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:11%;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.EntryDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.InDateEcy + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>" + item.EximTraderAlias + "</td>");

                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>" + item.OutDateEcy + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.Days + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.Amount + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.AuctionNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.Notices1 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.AuctionNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.Notices2 + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.NocDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;width:12%;text-align:right;'>" + item.Remarks + "</td>");



                    Pages.Append("</tr>");
                    i++;
                });
                Pages.Append("<tr>");
                Pages.Append("<th colspan='2' style='width:3%;'>Total :</th>");
                Pages.Append("<th style='width:11%;'></th>");
                Pages.Append("<th style='width:8%;'></th>");
                Pages.Append("<th style='width:3%;'></th>");
                Pages.Append("<th style='width:5%;'></th>");
                Pages.Append("<th style='width:8%;'></th>");
                Pages.Append("<th colspan='3' style='width:12%;text-align:right;'>" + lstData.Sum(o => o.Amount).ToString() + "</th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion



        #region Genarating For Excel CashBooKWithSd

        [HttpGet]
        public ActionResult CashBookWithSdExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public FileResult SdBookExcel(FormCollection fc)
        {
            try
            {
                var date1 = Convert.ToDateTime(fc["PeriodFrom"].ToString());
                var date2 = Convert.ToDateTime(fc["PeriodTo"].ToString());
                /// var Type = fc["ddlType"].ToString();
                var excelName = "";
                var ObjRR = new DSR_ReportRepository();
                ObjRR.GetCashBookWithSD(date1, date2);

                //if (Type == "Inv") { Type = "Invoice"; }
                //if (Type == "C") { Type = "Credit"; }
                //if (Type == "D") { Type = "Debit"; }
                //if (Type == "Unpaid") { Type = "Unpaid"; }
                //if (Type == "CancelInv") { Type = "Cancel Invoice"; }

                excelName = "CashBookWithSd" + "_" + ".xlsx";

                if (!string.IsNullOrEmpty(ObjRR.DBResponse.Data.ToString()))
                    return File(ObjRR.DBResponse.Data.ToString(), "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", excelName);
                else
                {
                    string name = DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
                    var excelFile = Server.MapPath("~/Docs/Excel/" + name + ".xlsx");
                    using (var exl = new DynamicExcel.ExcelGenerator(excelFile))
                    {
                        exl.AddCell("A1", "No data found");
                        exl.Save();
                        return File(excelFile, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", excelName);
                    }
                }
            }
            catch (Exception e)
            {
                string name = DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
                var excelFile = Server.MapPath("~/Docs/Excel/" + name + ".xlsx");
                using (var exl = new DynamicExcel.ExcelGenerator(excelFile))
                {
                    exl.AddCell("A1", "No data found");
                    exl.Save();
                    return File(excelFile, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "CashBookWithSd.xlsx");
                }
            }
            // return null;
        }

        #endregion

        #region Auction Cash Book

        public ActionResult AuctionCashBook()
        {
            return PartialView();
        }

        [HttpPost]
        public JsonResult GetAuctionCashBook(AuctionCashBookViewModel vm)
        {
            string AuctionPath = "";
            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetAuctionCashBook(vm.FromDate, vm.ToDate);
            if (obj.DBResponse.Data != null)
            {

                AuctionPath = GeneratePDFAuctionCashBookReport(((List<AuctionCashBookViewModel>)obj.DBResponse.Data), vm.FromDate, vm.ToDate);
                return Json(new { Message = AuctionPath, Status = 1 }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(new { Message = AuctionPath, Status = 2 }, JsonRequestBehavior.AllowGet);
            }

        }

        [NonAction]
        public string GeneratePDFAuctionCashBookReport(List<AuctionCashBookViewModel> lstData, String FromDate, String ToDate)
        {
            try
            {
                var FileName = "AuctionCashBook.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>Auction Cash Book For EMD Received </label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>S.NO.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Receipt No.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Receipt Date</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Bidder Name</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Chq/DD No. UTR No.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Bid No.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Bid Amount</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>EMD Amount</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Advance Amount Paid</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Advance Amount Adjust </th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Total Paid</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ReceiptNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ReceiptDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BidderName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ChqDDUTRNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BidNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BidAmount + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.EmdAmount + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.AdvanceAmountPaid + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.AdvanceAmountAdjust + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TotalPaid + " </td>");
                    Pages.Append("</tr>");
                    i++;
                });



                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A3Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion


        #region Auction Cash Book For Invoice

        public ActionResult AuctionCashBookForInvoice()
        {
            return PartialView();
        }

        [HttpPost]
        public JsonResult GetAuctionCashBookForInvoice(AuctionCashBookViewModel vm)
        {
            string AuctionPath = "";
            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetAuctionCashBookForInvoice(vm.FromDate, vm.ToDate);
            if (obj.DBResponse.Data != null)
            {

                AuctionPath = GeneratePDFAuctionCashBookReportForInvoice(((List<AuctionCashBookViewModel>)obj.DBResponse.Data), vm.FromDate, vm.ToDate);
                return Json(new { Message = AuctionPath, Status = 1 }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(new { Message = AuctionPath, Status = 2 }, JsonRequestBehavior.AllowGet);
            }

        }

        [NonAction]
        public string GeneratePDFAuctionCashBookReportForInvoice(List<AuctionCashBookViewModel> lstData, String FromDate, String ToDate)
        {
            try
            {
                var FileName = "AuctionCashBookForInvoice.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>Auction Cash Book For The Auction Invoice(Bid Amount) </label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>S.NO.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Receipt No.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Receipt Date</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Bidder Name</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Chq/DD No. UTR No.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Bid No.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Bid Amount</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>EMD Amount</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>EMD Amount Adjust</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Advance Amount Paid</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Advance Amount Adjust </th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>GST Amount Total </th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Net Amount Paid(Bid Amount - EMD Amount)+GST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Total Paid</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ReceiptNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ReceiptDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BidderName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ChqDDUTRNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BidNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.BidAmount + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.EmdAmount + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.EMDAmountAdjust + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.AdvanceAmountPaid + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.AdvanceAmountAdjust + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TotalGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.NetAmount + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.TotalPaid + " </td>");
                    Pages.Append("</tr>");
                    i++;
                });



                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A3Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Auction Cash Book For Statement

        public ActionResult AuctionCashBookForStatement()
        {
            return PartialView();
        }

        [HttpPost]
        public JsonResult GetAuctionCashBookForStatement(AuctionStatementViewModel vm)
        {
            string AuctionPath = "";
            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetAuctionStatement(vm.FromDate, vm.ToDate);
            if (obj.DBResponse.Data != null)
            {

                AuctionPath = GeneratePDFAuctionCashBookReportForStatement(((List<AuctionStatementViewModel>)obj.DBResponse.Data), vm.FromDate, vm.ToDate);
                return Json(new { Message = AuctionPath, Status = 1 }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(new { Message = AuctionPath, Status = 2 }, JsonRequestBehavior.AllowGet);
            }

        }

        [NonAction]
        public string GeneratePDFAuctionCashBookReportForStatement(List<AuctionStatementViewModel> lstData, String FromDate, String ToDate)
        {
            try
            {
                var FileName = "AuctionCashBookForInvoice.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>Auction Statement For The Auction Held On</label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>S.NO.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Bill Of Entry No.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Bill Of Entry Date</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>OBl No.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Shipping Bill No.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Container No.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Size</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>In Date</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Shed</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Area</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Pkg</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Weight</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Bid Amount</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Valuation Charge</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Auction Charge</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>MISC. Charge</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Custom Duty</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CWC Share</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Remarks</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.EntryNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.EntryDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Obl + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ShippingBill + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Shed + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Area + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Pkg + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Weight + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Bidamount + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.valueCharge + " </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.AuctionCharge + " </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.MiscCharge + " </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CustomDuty + " </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CwcShare + " </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Remarks + " </td>");
                    Pages.Append("</tr>");
                    i++;
                });



                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A3Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region PaymentVoucher Statement (Imprest Cash / Temporary Advance Report)
        [HttpGet]
        public ActionResult PaymentVoucherReport()
        {
            return PartialView();
        }

        [HttpPost]
        public JsonResult GetPaymentVoucherReport(string Fdt, string Tdt, string Purpose)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetPaymentVoucherReport(Fdt, Tdt, Purpose);
            if (ObjRR.DBResponse.Data != null)
            {

                //string json = JsonConvert.SerializeObject(ObjRR.DBResponse.Data);//JsonConvert.SerializeObject(ObjRR.DBResponse.Data);
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }

        }
        #endregion




        #region Import Container Income(Seci)
        [HttpGet]
        public ActionResult ImportConIncomeSeci()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult ImportConIncomeSeciDetail(DSR_ImportSeciIncRpt ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.ImportConIncomeSeciDetail(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    List<DSR_ImportSeciIncRpt> lstData = (List<DSR_ImportSeciIncRpt>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFImportConIncomeSeci(lstData, ObjPV.FromDate, ObjPV.ToDate);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFImportConIncomeSeci(List<DSR_ImportSeciIncRpt> lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "ImportConIncomeDetail.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>IMPORT CONTAINER INCOME REPORT(SECI)</label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>S.NO.</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CONTAINER NO.</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CONTAINER TYPE</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>SHIPPING LINE</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>FOREIGN LINER</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>VESSEL NAME</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>VESSEL/ VOYAGE NO.</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE DATE</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE NO.</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE TYPE</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PAYER NAME</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>GOODS CUSTOM VALUE</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>GOODS CUSTOM DUTY</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>THC</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>IRR</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CONTAINER HANDLING & TRANSPORTAION</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CARGO HANDLING</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>STORAGE & WAREHOUSING</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>OTHER SERVICES INCOME</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>SGST</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>IGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Total</th>");
                /* Pages.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Total</th></tr><tr>");
               Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>THC</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>TPT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>ECC</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>DTF</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>LOL</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IRR</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HAZ</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>CGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IGST</th>");*/
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ContainerType + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ForeignLiner + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.VesselName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.VesselNo + "  </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceType + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PayeeName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.GCD + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.GDV + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.THC + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.IRR + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CHT + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CH + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.SW + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.OSI + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Total + "</td></tr>");
                    i++;
                });

                Pages.Append("<tr><th colspan='11' style='border-right: 1px solid #000; font-size: 10px; text-align: left; width: 100px;'>TOTAL</th>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.GCD) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.GDV) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.THC) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IRR) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CHT) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CH) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.SW) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.OSI) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.SGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IGST) + "</td>");
                Pages.Append("<td style='font-size: 10px; text-align: center; width: 130px;'>" + lstData.Sum(item => item.Total) + "</td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A3Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Export Container Income(Seci)
        [HttpGet]
        public ActionResult ExportConIncomeSeci()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult ExportConIncomeSeciDetail(DSR_ExportSeciIncRpt ObjPV)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.ExportConIncomeSeciDetail(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null)
                {
                    List<DSR_ExportSeciIncRpt> lstData = (List<DSR_ExportSeciIncRpt>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFExportConIncomeSeci(lstData, ObjPV.FromDate, ObjPV.ToDate);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFExportConIncomeSeci(List<DSR_ExportSeciIncRpt> lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "ExportConIncomeDetail.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrath</span><br/><label style='font-size: 14px; font-weight:bold;'>EXPORT CONTAINER INCOME REPORT(SECI)</label><br/><label style='font-size: 12px;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>S.NO.</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CONTAINER NO.</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CONTAINER TYPE</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>SHIPPING LINE</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>FOREIGN LINER</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>VESSEL NAME</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>VESSEL/ VOYAGE NO.</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE DATE</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE NO.</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>INVOICE TYPE</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>PAYER NAME</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>GOODS CUSTOM VALUE</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>GOODS CUSTOM DUTY</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>THC</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>IRR</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CONTAINER HANDLING & TRANSPORTAION</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CARGO HANDLING</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>STORAGE & WAREHOUSING</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>OTHER SERVICES INCOME</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>CGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>SGST</th>");
                Pages.Append("<th  style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>IGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Total</th>");
                /* Pages.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Total</th></tr><tr>");
               Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>THC</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>TPT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>ECC</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>DTF</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>LOL</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IRR</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HAZ</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>CGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SGST</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>IGST</th>");*/
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ContainerType + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.ForeignLiner + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.VesselName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.VesselNo + "  </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceDate + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.InvoiceType + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.PayeeName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.GCD + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.GDV + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.THC + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.IRR + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CHT + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CH + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.SW + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.OSI + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + item.Total + "</td></tr>");
                    i++;
                });

                Pages.Append("<tr><th colspan='11' style='border-right: 1px solid #000; font-size: 10px; text-align: left; width: 100px;'>TOTAL</th>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.GCD) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.GDV) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.THC) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IRR) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CHT) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CH) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.SW) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.OSI) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.CGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.SGST) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + lstData.Sum(item => item.IGST) + "</td>");
                Pages.Append("<td style='font-size: 10px; text-align: center; width: 130px;'>" + lstData.Sum(item => item.Total) + "</td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A3Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Container Balance In CFS Report

        [HttpGet]
        public ActionResult ContainerBalanceInCFSReport()
        {

            ViewBag.BranchType = Session["BranchType"];
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetContainerBalanceInCFS(DSRContainerBalanceInCFS ObjContainerBalanceInCFS)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSRContainerBalanceInCFS> LstContainerBalanceInCFS = new List<DSRContainerBalanceInCFS>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.ContainerBalanceInCFS(ObjContainerBalanceInCFS);
            if (ObjRR.DBResponse.Data != null)
            {
                LstContainerBalanceInCFS = (List<DSRContainerBalanceInCFS>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateContainerBalanceInCFSPDF(FormCollection fc)
        {
            try
            {

                var Pages = new string[1];
                var FileName = "ContainerBalanceInCFS.pdf";
                Pages[0] = fc["Page"].ToString();

                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/ContainerBalanceInCFS/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/ContainerBalanceInCFS/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion



        #region De-stuffing Report

        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult DeStuffingReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Kdl_ReportRepository ObjReport = new Kdl_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetDeStuffingReport(DeStuffingReport ObjDeStuffingReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DeStuffingReport> LstDeStuffingReport = new List<DeStuffingReport>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.DeStuffingReport(ObjDeStuffingReport);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstDeStuffingReport = (List<DeStuffingReport>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateDeStuffingReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "DeStuffingReport.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/DeStuffingReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/DeStuffingReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion

        #region cargoInStock

        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult cargoInStockReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Kdl_ReportRepository ObjReport = new Kdl_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetcargoInStockReport(CargoInStockReport ObjCargoInStockReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<CargoInStockReport> LstCargoInStockReport = new List<CargoInStockReport>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.CargoInstockReport(ObjCargoInStockReport);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstCargoInStockReport = (List<CargoInStockReport>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GeneratecargoInStockReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "CargoInStockReport.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/CargoInStockReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/CargoInStockReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }



        #endregion

        #region ContainerMovementRegister

        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult ContainerMovementRegister()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Kdl_ReportRepository ObjReport = new Kdl_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetContainerMovementRegister(ContainerMovementRegister ObjContainerMovementRegister)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<ContainerMovementRegister> LstContainerMovementRegister = new List<ContainerMovementRegister>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.ContainerMovementRegister(ObjContainerMovementRegister);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstContainerMovementRegister = (List<ContainerMovementRegister>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateContainerMovementRegisterPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "ContainerMovementRegister.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/DailyCashBookReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/DailyCashBookReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion

        #region TDS Statement
        [HttpGet]
        public ActionResult TDSStatement()
        {
            return PartialView();
        }
        [HttpPost, ValidateAntiForgeryToken]
        public JsonResult GetTDSStatement(BTTDate objDt)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository objRR = new DSR_ReportRepository();
                objRR.TdsStatement(objDt.FromDate, objDt.ToDate);
                if (objRR.DBResponse.Data != null)
                {
                    List<DSRTDSStatement> lstTds = new List<DSRTDSStatement>();
                    lstTds = (List<DSRTDSStatement>)objRR.DBResponse.Data;
                    string html = GeneratePDFForTDSStmt(lstTds, objDt);
                    return Json(new { Status = 1, Message = html });
                }
                return Json(new { Status = -1, Message = "No Data" });
            }
            else
                return Json(new { Status = -1, Message = "No Data" });
        }
        [NonAction]
        public string GeneratePDFForTDSStmt(List<DSRTDSStatement> lstTds, BTTDate objDt)
        {
            int[] ArrayParty = lstTds.Select(x => x.PartyId).Distinct().ToArray();
            string html = "<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><thead><tr><th colspan='7' style='font-weight:600;text-align:center;border:1px solid #000;padding:5px;'>TDS Statement for the period <span>" + objDt.FromDate + "</span> To <span>" + objDt.ToDate + "</span></th></tr><tr><th colspan='2' style='border-left: 1px solid #000;'></th><th colspan='5' style='font-weight:600;text-align:center;border-bottom:1px solid #000;border-left:1px solid #000;border-right:1px solid #000;padding:5px;'>TDS</th></tr><tr><th style='border-left: 1px solid #000;border-bottom: 1px solid #000;padding: 5px;'>Date</th><th style='border-bottom: 1px solid #000;padding: 5px;'>CR. No.</th><th colspan='2' style='border-bottom: 1px solid #000;border-right: 1px solid #000;border-left: 1px solid #000;padding: 5px;'>Collection</th><th style='border-bottom: 1px solid #000;border-right: 1px solid #000;padding: 5px;'>CWC</th><th style='border-bottom: 1px solid #000;border-right: 1px solid #000;padding: 5px;'>H &amp; T</th><th style='border-bottom: 1px solid #000;border-right: 1px solid #000;padding: 5px;'>Total</th></tr></thead><tbody>";
            for (int i = 0; i < ArrayParty.Length; i++)
            {
                decimal TdsCol, CWCTds, HTTds, Tds = 0;
                html += "<tr><td colspan='7' style='text-align: left;padding: 4px;'><br/>" + lstTds.Where(x => x.PartyId == ArrayParty[i]).FirstOrDefault().PartyName.ToString() + "</td></tr>";
                lstTds.Where(x => x.PartyId == ArrayParty[i]).ToList().ForEach(item =>
                {
                    TdsCol = item.TDS;//item.TDSCol;
                    Tds = item.TDS;
                    CWCTds = Math.Round(item.CWCTDS, 2);
                    HTTds = Math.Round(item.HTTDS, 2);
                    html += "<tr><td style='border-top: 1px solid #000;border-left: 1px solid #000;border-bottom: 1px solid #000;padding: 4px;text-align: left;'>" + item.ReceiptDate + "</td><td style='border-top: 1px solid #000;border-left: 1px solid #000;border-bottom: 1px solid #000;padding: 4px;text-align: left;'>" + item.ReceiptNo + "</td><td style='border-top: 1px solid #000;border-left: 1px solid #000;border-bottom: 1px solid #000;padding: 4px;text-align: left;'></td><td style='border-top: 1px solid #000;border-bottom: 1px solid #000;padding: 4px;text-align: right;'>" + TdsCol + "</td><td style='border-top: 1px solid #000;border-left: 1px solid #000;border-bottom: 1px solid #000;padding: 4px;text-align: right;'>" + CWCTds + "</td><td style='border-top: 1px solid #000;border-left: 1px solid #000;border-bottom: 1px solid #000;padding: 4px;text-align: right;'>" + HTTds + "</td><td style='border-top: 1px solid #000;border-left: 1px solid #000;border-right: 1px solid #000;border-bottom: 1px solid #000;padding: 4px;text-align: right;'>" + Tds + "</td></tr>";
                });
                html += "<tr><td colspan='7'></td></tr><tr><td colspan='2'></td><td colspan='2' style='border-top: 1px solid #000;border-left: 1px solid #000;border-bottom: 1px solid #000;padding: 4px;text-align: right;'>" + Math.Round(lstTds.Where(x => x.PartyId == ArrayParty[i]).Select(x => x.TDSCol).Sum(), 2) + "</td><td style='border-top: 1px solid #000;border-left: 1px solid #000;border-bottom: 1px solid #000;padding: 4px;text-align: right;'>" + Math.Round(lstTds.Where(x => x.PartyId == ArrayParty[i]).Select(x => x.CWCTDS).Sum(), 2) + "</td><td style='border-top: 1px solid #000;border-left: 1px solid #000;border-bottom: 1px solid #000;padding: 4px;text-align: right;'>" + Math.Round(lstTds.Where(x => x.PartyId == ArrayParty[i]).Select(x => x.HTTDS).Sum(), 2) + "</td><td style='border-top: 1px solid #000;border-left: 1px solid #000;border-bottom: 1px solid #000;border-right: 1px solid #000; padding: 4px;text-align: right;'>" + Math.Round(lstTds.Where(x => x.PartyId == ArrayParty[i]).Select(x => x.TDS).Sum(), 2) + "</td></tr>";
            }
            //html += "</tbody><tfoot><tr><td colspan='7'></td></tr><tr><td colspan='3' style='text-align: left;'>Total:</td><td style='border: 1px solid #000;text-align: right;padding: 4px;'>" + lstTds.Select(x => x.TDSCol).Sum() + "</td><td style='border: 1px solid #000;text-align: right;padding: 4px;'>" + Math.Round(lstTds.Select(x => x.CWCTDS).Sum(), 2) + "</td><td style='border: 1px solid #000;text-align: right;padding: 4px;'>" + Math.Round(lstTds.Select(x => x.HTTDS).Sum(), 2) + "</td><td style='border: 1px solid #000;text-align: right;padding: 4px;'>" + lstTds.Select(x => x.TDS).Sum() + "</td></tr></tfoot></table>";
            html += "</tbody><tfoot><tr><td colspan='7'></td></tr><tr><td colspan='3' style='text-align: left;'>Total:</td><td style='border: 1px solid #000;text-align: right;padding: 4px;'>" + lstTds.Select(x => x.TDS).Sum() + "</td><td style='border: 1px solid #000;text-align: right;padding: 4px;'>" + Math.Round(lstTds.Select(x => x.CWCTDS).Sum(), 2) + "</td><td style='border: 1px solid #000;text-align: right;padding: 4px;'>" + Math.Round(lstTds.Select(x => x.HTTDS).Sum(), 2) + "</td><td style='border: 1px solid #000;text-align: right;padding: 4px;'>" + lstTds.Select(x => x.TDS).Sum() + "</td></tr></tfoot></table>";
            if (!Directory.Exists(Server.MapPath("~/Docs/Report/") + Session.SessionID))
                Directory.CreateDirectory(Server.MapPath("~/Docs/Report/") + Session.SessionID);
            if (System.IO.File.Exists(Server.MapPath("~/Docs/Report/") + Session.SessionID + "/TdsStatement.pdf"))
                System.IO.File.Delete(Server.MapPath("~/Docs/Report/") + Session.SessionID + "/TdsStatement.pdf");
            using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
            {
                rh.HeadOffice = this.HeadOffice;
                rh.HOAddress = this.HOAddress;
                rh.ZonalOffice = this.ZonalOffice;
                rh.ZOAddress = this.ZOAddress;
                rh.GeneratePDF(Server.MapPath("~/Docs/Report/") + Session.SessionID + "/TdsStatement.pdf", html);
            }
            return "/Docs/Report/" + Session.SessionID + "/TdsStatement.pdf";
        }
        #endregion

        #region Reservation Invoice
        [NonAction]
        public string GeneratingReservationBulkPDFforGE(DataSet ds, string InvoiceModuleName, string All)
        {
            Einvoice obj = new Einvoice(new HeaderParam(), "");
            var SEZis = "";
            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);

            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstGodownDetais = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);

            List<string> lstSB = new List<string>();
            UpiQRCodeInfo upiQRInfo = new UpiQRCodeInfo();
            upiQRInfo.ver = objCompany[0].ver;

            upiQRInfo.tn = objCompany[0].tn;
            upiQRInfo.tier = objCompany[0].tier;
            upiQRInfo.tid = objCompany[0].tid;
            upiQRInfo.qrMedium = Convert.ToInt32(objCompany[0].qrMedium);
            //  upiQRInfo.QRexpire = objCompany[0].QRexpire;
            upiQRInfo.pn = objCompany[0].pn;
            upiQRInfo.pa = objCompany[0].pa;
            // upiQRInfo.orgId = objCompany[0].orgId;
            upiQRInfo.mtid = objCompany[0].mtid;
            upiQRInfo.msid = objCompany[0].msid;
            upiQRInfo.mode = Convert.ToInt32(objCompany[0].mode);
            upiQRInfo.mid = objCompany[0].mid;
            upiQRInfo.mc = Convert.ToString(objCompany[0].mc);

            String RemarksValue = "";
            string Container = "";
            lstInvoice.ToList().ForEach(item =>
            {
                DSR_ReportRepository rep = new DSR_ReportRepository();
                DSRSDBalancePrint objSDBalance = new DSRSDBalancePrint();
                RemarksValue = "";//item.Remarks;

                rep.GetSDBalanceforReport(item.PayeeId, item.InvoiceId);
                if (rep.DBResponse.Data != null)
                {
                    objSDBalance = (DSRSDBalancePrint)rep.DBResponse.Data;
                }

                upiQRInfo.invoiceNo = Convert.ToString(item.InvoiceNo);
                upiQRInfo.InvoiceName = Convert.ToString(item.PartyName);
                upiQRInfo.mam = Convert.ToDecimal(item.InvoiceAmt);
                upiQRInfo.am = Convert.ToDecimal(item.InvoiceAmt);
                upiQRInfo.CGST = Convert.ToDecimal(item.CGST);
                upiQRInfo.SGST = Convert.ToDecimal(item.SGST);
                upiQRInfo.IGST = Convert.ToDecimal(item.IGST);
                upiQRInfo.GSTPCT = Convert.ToDecimal(item.IGSTPer);
                upiQRInfo.QRexpire = Convert.ToString(item.DocDt);
                upiQRInfo.tr = Convert.ToString(item.InvoiceId);

                Einvoice Eobj = new Einvoice();
                B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                objresponse = Eobj.GenerateB2cQRCode(upiQRInfo);
                IrnResponse objERes = new IrnResponse();
                objERes.SignedQRCode = objresponse.QrCodeBase64;
                objERes.SignedInvoice = objresponse.QrCodeJson;
                objERes.SignedQRCode = objresponse.QrCodeJson;

                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><thead>");
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr>");
                html.Append("<td width='80%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='60%' valign='top'><img align='right' src='IMGSRC'/></td>");
                html.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt; font-weight: bold;'>" + InvoiceModuleName + "</label><label style='font-size: 14px; font-weight:bold;'>" + Container + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' valign='top' style='font-size:8pt;'><b>IRN :</b> " + item.irn + " </td></tr>");
                html.Append("<tr><td colspan='12'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("</tbody></table></td>");
                if (item.SupplyType == "B2C")
                {
                    html.Append("<td align='left' valign='top'><img valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(objERes.SignedInvoice)) + "'/> </td>");
                }
                else if (!string.IsNullOrEmpty(item.SignedQRCode))
                {
                    html.Append("<td align='left' valign='top'><img valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                }
                //html.Append("<td align='left' valign='top'><img valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(item.SignedQRCode)) + "'/> </td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");
                html.Append("</thead></table>");

                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Place Of Supply</th><th>:</th><td colspan='6' width='70%'>" + item.PartyState + "(" + item.PartyStateCode + ")</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Is Service</th><th>:</th><td colspan='6' width='70%'>YES</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Supply Type</th><th>:</th><td colspan='6' width='50%'>" + item.SupplyType + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'><b>Godown Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Godown Name</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>GF</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>MF</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>Area</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; padding: 5px;'>To Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Godown Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/

                int i = 1;

                lstGodownDetais.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 5%;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 20%;'>" + elem.GodownName + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 10%;'>" + elem.GF + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 10%;'>" + elem.MF + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 10%;'>" + elem.Area + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 15%;'>" + elem.FromDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 15%;'>" + elem.ToDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 15%;'>" + elem.OperationType + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });

                /***************/
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0; margin-bottom: 0;'>Reservation Charges :</h3></th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.OperationSDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Rate.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "%</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 120px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align:right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top: 0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                //html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align:right; width: 130px;'>" + item.TotalTaxable.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; width: 100px; text-align:right;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align:right; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align:right; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align:right; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");

                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='4' width='20%'>Payer Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Payer Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 6pt; text-align: left; line-height: 30px;' colspan='6' width='50%'>SAM(A/C)</td></tr>");

                html.Append("<tr>");
                html.Append("<td style='font-size: 6pt; text-align: left;' colspan='12' width='100%'>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                if (item.SupplyType != "B2C")
                {
                    html.Append("<tr>");
                    html.Append("<td align='left' valign='top' colspan='6' width='50%'><p style='font-size:7pt; font-weight:bold;'>Scan for Payment</p><img style='width:115px; height:115px' valign='top' align='right' src='" + LoadImage(obj.GenerateQCCode(objERes.SignedInvoice)) + "'/> </td>");
                    html.Append("</tr>");
                }

                html.Append("</tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.Version = EffectVersion;
                rp.Effectlogofile = EffectVersionLogoFile;
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        #region Add Money On Account
        public JsonResult GetBulkReceiptReportAddMoneyOA(BulkReceiptReport ObjBulkReceiptReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetBulkCashreceipt(ObjBulkReceiptReport.PeriodFrom, ObjBulkReceiptReport.PeriodTo, ObjBulkReceiptReport.ReceiptNumber);
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                string Path = GenerateBulkReceiptReportAddMoneyOA(ds);
                return Json(new { Status = 1, Message = Path });
            }
            return Json(new { Status = 0, Message = "No Data Found" });
        }
        [NonAction]
        public string GenerateBulkReceiptReportAddMoneyOA(DataSet ds)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstMode = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();

            int i = 0;
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();

                //Page Header
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");

                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='150%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'>CASH RECEIPT</label>");
                html.Append("</td></tr>");


                //Header
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='9' width='80%' style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td colspan='3' width='20%' style='font-size: 13px; line-height: 26px; float:right;'><label style='font-weight: bold;'>Date : </label> <span>" + item.ReceiptDate + "</span></td>");
                html.Append("</tr>");

                html.Append("<tr><td colspan='9' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>By : </label><span>" + item.PartyName + "</span></td><td colspan='3' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'> </label><span>" + "" + "</span></td></tr>");
                html.Append("<tr><td colspan='12' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Address : </label><span>" + item.PartyAddress + "</span></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr><tr><td><hr/></td></tr>");


                //Banks
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:70%;' align='center' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Mode</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 140px;'>Drawee Bank</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Instrument</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Amount</th>");
                html.Append("</tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 80px;'>No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Date</th>");
                html.Append("</tr></thead><tbody>");

                //loop
                decimal totalpaymentreceiptAmt = 0;
                i = 1;
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Amount + "</td>");
                    html.Append("</tr>");
                    totalpaymentreceiptAmt = totalpaymentreceiptAmt + data.Amount;

                    i = i + 1;

                });

                //TDS
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>TDS</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TdsAmount.ToString() + "</td></tr>");


                //Total
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>Total Payment Receipt Amount</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + totalpaymentreceiptAmt + "</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'>In Words : " + objCurr.changeCurrencyToWords(totalpaymentreceiptAmt.ToString("0")) + "</th></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 80px;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><td width='10%' valign='top' align='right' style='font-size:13px;'><b>Remarks : </b></td><td colspan='2' width='85%' style='font-size:12px; line-height:22px;'>" + item.Remarks + "</td></tr>");

                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr>");
                html.Append("<th style='width:60%;'></th>");
                html.Append("<th style='border-top: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>For Central Warehousing Corporation</th>");
                html.Append("</tr></tbody></table></td></tr></tbody></table>");

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            var type = "bulkreport";
            var id = "BulkReceipt" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
            var fileName = id + ".pdf";
            string PdfDirectory = Server.MapPath("~/Docs") + "/" + type + "/";
            if (!Directory.Exists(PdfDirectory))
                Directory.CreateDirectory(PdfDirectory);
            using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                rh.HeadOffice = "";
                rh.HOAddress = "";
                rh.ZonalOffice = "";
                rh.ZOAddress = "";
                rh.GeneratePDF(PdfDirectory + fileName, lstSB);
            }
            return "/Docs/" + type + "/" + fileName;
        }
        #endregion

        #region Inventory Report Of Cargo & Container
        [HttpGet]
        public ActionResult InventoryReportCargoContainer()
        {
            ViewBag.BranchType = Session["BranchType"];
            return PartialView();

        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetInventoryReportCargoContainer(DSRInventoryReportModel ObjInventoryReportModel)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            DSRInventoryReportModel ObjLstInventoryReportModel = new DSRInventoryReportModel();
            //Login objLogin = (Login)Session["LoginUser"]

            ObjRR.InventoryReportCargoContainer(ObjInventoryReportModel);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                ObjLstInventoryReportModel = (DSRInventoryReportModel)ObjRR.DBResponse.Data;

                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateInventoryReportCargoContainerPDF(FormCollection fc)
        {
            try
            {


                var Pages = new string[1];
                var FileName = "InventoryReportCargoContainer.pdf";
                Pages[0] = fc["Page"].ToString();

                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/InventoryReportCargoContainer/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/InventoryReportCargoContainer/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }
        #endregion

        #region Container Master Register
        [HttpGet]
        public ActionResult GetContainerMasterRegister()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetContainerMasterRegisterDet(BTTDate date)
        {

            DSR_ReportRepository objRR = new DSR_ReportRepository();
            objRR.ContainerMasterRegister(date.FromDate, date.ToDate);
            if (objRR.DBResponse.Data != null)
            {
                List<ContainerMstReg> lstCont = new List<ContainerMstReg>();
                lstCont = (List<ContainerMstReg>)objRR.DBResponse.Data;
                if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID + "/Report"))
                    Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID + "/Report");
                if (System.IO.File.Exists(Server.MapPath("~/Docs/") + Session.SessionID + "/Report/ContainerMstReg.pdf"))
                    System.IO.File.Delete(Server.MapPath("~/Docs/") + Session.SessionID + "/Report/ContainerMstReg.pdf");
                string html = "<table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><thead><tr><th colspan='17' style='text-align:center;font-size:10pt;'>Container Master Register From <span>" + date.FromDate + "</span> To <span>" + date.ToDate + "</span><br/><br/></th></tr><tr><th rowspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:7%;'>Date of Arrival</th><th rowspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + Session["BranchType"] + "Code</th><th rowspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>Container No.</th><th rowspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>Size</th><th rowspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>Loaded /Empty</th><th rowspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>Shipping Line</th> <th rowspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>Source</th><th colspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>Import</th><th colspan='4' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>Empty Movement</th><th colspan='4' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>Export</th></tr><tr><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:7%;'>Date of Destuffing</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:7%;'>Date of Delivery</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:7%;'>Received Date </th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:7%;'>Utilization</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:7%;'>Out Date</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:7%;'>Destination</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:7%;'>Stuffing Date</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:7%;'>Exit Date</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:7%;'>Destination</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:7%;'>Remarks</th></tr></thead><tbody>";
                lstCont.ForEach(item =>
                {
                    html += "<tr><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.EntryDate + "</td><td style='text-align:left;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.CFSCode + "</td><td style='text-align:left;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.ContainerNo + "</td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.Size + "</td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.ContainerType + "</td><td style='text-align:left;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.ShippingLine + "</td><td style='text-align:left;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'></td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.DestuffingDate + "</td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.DeliveryDate + "</td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.ReceivedDate + "</td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.Utilization + "</td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.OExitDate + "</td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'></td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.Stuffingdate + "</td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.EExitDate + "</td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'></td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'></td></tr>";
                });
                html += "</tbody></table>";
                using (var rh = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, true))
                {
                    rh.HeadOffice = this.HeadOffice;
                    rh.HOAddress = this.HOAddress;
                    rh.ZonalOffice = this.ZonalOffice;
                    rh.ZOAddress = this.ZOAddress;
                    rh.GeneratePDF(Server.MapPath("~/Docs/") + Session.SessionID + "/Report/ContainerMstReg.pdf", html);
                }
                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/ContainerMstReg.pdf" });
            }
            else return Json(new { Status = -1, Message = "No Data" });
        }
        #endregion

        #region Export Loaded Container Out

        [HttpGet]
        public ActionResult LoadExpLoadedContainerOut()
        {
            return PartialView("LoadedContainerOut");
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetExpLoadedContrDet(ExpLoadedContrOut ObjLoadedContr)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.GetExpLoadedContrOut(ObjLoadedContr.FromDate, ObjLoadedContr.ToDate);
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GeneratePDFForExpLoadedContr(FormCollection Fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "LoadedContainerOutReport.pdf";
                Pages[0] = Fc["Page"].ToString();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report/ExportLoadedContainer/";
                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                Pages[0] = Pages[0].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                using (var Rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    Rh.HeadOffice = this.HeadOffice;
                    Rh.HOAddress = this.HOAddress;
                    Rh.ZonalOffice = this.ZonalOffice;
                    Rh.ZOAddress = this.ZOAddress;
                    Rh.GeneratePDF(LocalDirectory + FileName, Pages);
                }
                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/ExportLoadedContainer/" + FileName });
            }
            catch
            {
                return Json(new { Status = 0, Message = "Error" });
            }
        }

        #endregion

        #region CartingOrderRegister

        [HttpGet]
        public ActionResult StuffingRegisterReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Kdl_ReportRepository ObjReport = new Kdl_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}
            ViewBag.BranchType = Session["BranchType"];
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetStuffingRegister(StuffingRegister ObjStuffingRegister)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<StuffingRegister> LstStuffingRegister = new List<StuffingRegister>();
            // Login objLogin = (Login)Session["LoginUser"];


            ObjRR.StuffingRegister(ObjStuffingRegister);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstStuffingRegister = (List<StuffingRegister>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateStuffingRegisterPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "StuffingRegister.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/StuffingRegister/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/StuffingRegister/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }
        #endregion

        #region Stuffing Request Report

        [HttpGet]
        public ActionResult LoadStuffingReqReport()
        {
            return PartialView("StuffingReqReport");
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetStuffingReqDetails(Models.StuffingRequest ObjStuffingRequest)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.GetStuffingReqReport(ObjStuffingRequest.FromDate, ObjStuffingRequest.ToDate);
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GeneratePDFForStuffingReq(FormCollection Fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "StuffingRequestReport.pdf";
                Pages[0] = Fc["Page"].ToString();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report/StuffingRequest/";
                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                Pages[0] = Pages[0].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //using (var Rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f))
                //{
                //    Rh.GeneratePDF(LocalDirectory + FileName, Pages);
                //}

                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/StuffingRequest/" + FileName });
            }
            catch
            {
                return Json(new { Status = 0, Message = "Error" });
            }
        }
        #endregion

        #region BTT
        [HttpGet]
        public ActionResult GetBTTReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetBTTReportDetails(BTTDate objBTT)
        {
            DSR_ReportRepository objRR = new DSR_ReportRepository();
            List<BTT> lstBTT = new List<BTT>();
            objRR.GetBTTDetails(objBTT.FromDate, objBTT.ToDate);
            if (objRR.DBResponse.Data != null)
            {
                lstBTT = (List<BTT>)objRR.DBResponse.Data;
                string html = "<table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><thead><tr><th colspan='9' style='font-weight:600;font-size:10pt;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:5px;'>Excess Cargo (Back to Town) Daily Report <br/>From <span>" + objBTT.FromDate + "</span> To <span>" + objBTT.ToDate + "</span></th></tr><tr><th rowspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>Ship Bill No/ Check List/ Commercial Invoice</th><th rowspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:10%;'>Date</th><th rowspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>Commodity</th><th colspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:10%;'>Received</th><th colspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>Exported</th><th colspan='2' style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>Back To Town</th></tr><tr><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:8%;'>No of Packages</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:8%;'>WT</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:8%;'>No of Pkg</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:8%;'>WT</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:8%;'>No of Pkg</th><th style='font-weight:600;text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;width:8%;'>WT</th></tr></thead><tbody>";
                lstBTT.ForEach(item =>
                {
                    html += "<tr><td style='text-align:left;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.ShippingBillNo + "</td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.BTTCargoEntryDate + "</td><td style='text-align:left;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.CommName + "</td><td style='text-align:center;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.NoOfUnits + "</td><td style='text-align:right;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.GrossWeight + "</td><td style='text-align:right;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.ENoOfUnits + "</td><td style='text-align:right;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.EGrossWeight + "</td><td style='text-align:right;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.BTTQuantity + "</td><td style='text-align:right;border:1px solid #000;border-bottom:1px solid #000;padding:3px;'>" + item.BTTWeight + "</td></tr>";
                });
                html += "</tbody></table>";
                if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID + "/Report"))
                    Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID + "/Report");
                if (System.IO.File.Exists(Server.MapPath("~/Docs/") + Session.SessionID + "/Report/BTTReport.pdf"))
                    System.IO.File.Delete(Server.MapPath("~/Docs/") + Session.SessionID + "/Report/BTTReport.pdf");
                using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    rh.HeadOffice = this.HeadOffice;
                    rh.HOAddress = this.HOAddress;
                    rh.ZonalOffice = this.ZonalOffice;
                    rh.ZOAddress = this.ZOAddress;
                    rh.GeneratePDF(Server.MapPath("~/Docs/") + Session.SessionID + "/Report/BTTReport.pdf", html);
                }
                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/BTTReport.pdf" });
            }
            else return Json(new { Status = -1, Message = "Error" });
        }
        #endregion

        #region Shipping line cha importer wise daily activity report



        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult SlineChaImpDailyActivity()
        {

            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<SlineImpCHAList> LstSlineImpCHAList = new List<SlineImpCHAList>();
            ObjRR.ShippingLChaImpList();
            if (ObjRR.DBResponse.Data != null)
            {
                LstSlineImpCHAList = (List<SlineImpCHAList>)ObjRR.DBResponse.Data;
            }
            ViewBag.SlineImpCHAList = LstSlineImpCHAList;

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetSlineChaImpDailyActivity(SlineChaImpDailyActivity ObjSlineChaImpDailyActivity)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<SlineChaImpDailyActivity> LstSlineChaImpDailyActivity = new List<SlineChaImpDailyActivity>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.SlineChaImpDailyActivity(ObjSlineChaImpDailyActivity);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstSlineChaImpDailyActivity = (List<SlineChaImpDailyActivity>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateSlineChaImpDailyActivityPDF(FormCollection fc)
        {
            try
            {


                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "SlineChaImpDailyActivity.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/CargoStuffingRegister/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/CargoStuffingRegister/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }
        #endregion

        #region Monthly Performance Report

        public ActionResult MonthlyPerformanceReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetMonthlyPerformanceReportList(MonthlyPerformaceReport ObjMonthlyPerformaceReport)
        {
            try
            {
                var Pages = new string[1];
                string FileName = "MonthlyPerformanceRepor.pdf";
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                StringBuilder sb = new StringBuilder();
                List<MonthlyPerformaceReport> LstMonthlyPerformaceReport = ObjRR.GetMonthlyPerformanceReportDataToPrint(ObjMonthlyPerformaceReport.MonthNo, ObjMonthlyPerformaceReport.YearNo);

                if (LstMonthlyPerformaceReport != null && LstMonthlyPerformaceReport.Count > 0)
                {
                    sb.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                    sb.Append("<thead>");
                    sb.Append("<tr>");
                    sb.Append("<th style='text-align:center;border:1px solid #000;text-align:center;padding:5px;'>Particulars</th>");
                    sb.Append("<th style='text-align:center;border:1px solid #000;text-align:center;width:15%;padding:5px;'>Month Under Report</th>");
                    sb.Append("<th style='text-align:center;border:1px solid #000;text-align:center;width:15%;padding:5px;'>Previous Month</th>");
                    sb.Append("<th style='text-align:center;border:1px solid #000;text-align:center;width:15%;padding:5px;'>Corresponding Month of Previous Year</th>");
                    sb.Append("</tr>");
                    sb.Append("</thead>");
                    sb.Append("<tbody>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='4'style='text-align:center;border:1px solid #000;text-align:left;padding:3px;'>");
                    sb.Append("<strong>1. Import Container Received</strong>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>a) From ICD</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 1).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 1).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 1).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>b) From Gateway ports by Road</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 2).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 2).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 2).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='4'style='text-align:center;border:1px solid #000;text-align:left;padding:3px;'>");
                    sb.Append("<strong>2.Import Container Handled (Including reefers)</strong>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>a) Containers Destuffed</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 3).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 3).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 3).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>b) Containers despatched factor for destuffing</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 4).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 4).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 4).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>c) ");
                    sb.Append("Total Containers Handled 2(a+b) </span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 5).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 5).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 5).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='4'style='text-align:center;border:1px solid #000;text-align:left;padding:3px;'>");
                    sb.Append("<strong>3.Export Container Handled (Including reefers)</strong>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>a) Containers Stuffing at CFS/ICD</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 6).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 6).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 6).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>b) Containers moved/Shifted to rail head/ICD</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 7).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 7).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 7).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>c) Containers moved to Gateway Ports by Road</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 8).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 8).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 8).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>d)  Containers Shifted at factories and moved</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 9).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 9).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 9).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>e) Total Export Containers Handled 3(b+c+d)  </span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 10).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 10).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 10).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='4'style='text-align:center;border:1px solid #000;text-align:left;padding:3px;'>");
                    sb.Append("<strong>4.Export Container Handled (Including reefers)</strong>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='4'style='text-align:center;border:1px solid #000;text-align:left;padding:3px;'>");
                    sb.Append("<span style='padding-left:10px;'>a) Empty Containers received at ICD/CFS</span>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span style='padding-left:20px;'>a) From other ICD</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 11).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 11).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 11).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span style='padding-left:20px;'>b) From Gate way ports by Road</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 12).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 12).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 12).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='4'style='text-align:center;border:1px solid #000;text-align:left;padding:3px;'>");
                    sb.Append("<span style='padding-left:10px;'>b) Empty Containers dispatched/moved out from ICD/CFS</span>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span style='padding-left:20px;'>a) To other ICD/Yards</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 13).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 13).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 13).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span style='padding-left:20px;'>b) To Gate way ports by road</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 14).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 14).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 14).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span style='padding-left:20px;'>c) Total Export containers handled 4(a+b) </span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 15).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 15).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 15).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='4'style='text-align:center;border:1px solid #000;text-align:left;padding:3px;'>");
                    sb.Append("<strong>5.Total Containers Handles during the month</strong>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>a) Import</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 16).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 16).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 16).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>b) Export</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 17).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 17).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 17).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>c) Empty</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 18).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 18).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 18).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>Total (a+b+c) </span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 19).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 19).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 19).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='4'style='text-align:center;border:1px solid #000;text-align:left;padding:3px;'>");
                    sb.Append("<strong>6. Exported</strong>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>a) Quantity(MT)</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 20).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 20).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 20).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>b) FOB Value (Rs.In Lacs)</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 21).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 21).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 21).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='4'style='text-align:center;border:1px solid #000;text-align:left;padding:3px;'>");
                    sb.Append("<strong>7.Cargo Exported</strong>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>a) Quantity(MT)</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 22).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 22).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 22).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>b) FOB Value (Rs.In Lacs)</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 23).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 23).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 23).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='4'style='text-align:center;border:1px solid #000;text-align:left;padding:3px;'>");
                    sb.Append("<strong>8.Income from Refer Containers</strong>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>a) Export(Rs.)</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 24).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 24).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 24).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>b) Import(Rs.)</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 25).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 25).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 25).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='4'style='text-align:center;border:1px solid #000;text-align:left;padding:3px;'>");
                    sb.Append("<strong>9.Progressive total of containers handled</strong>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>a) Import i) Dry ii) Refer</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 26).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 26).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 26).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>b)  Export i) Dry ii) Refer</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 27).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 27).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 27).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>c)  Empty</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 28).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 28).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 28).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>Total (a+b+c) </span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 29).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 29).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 29).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='4'style='text-align:center;border:1px solid #000;text-align:left;padding:3px;'>");
                    sb.Append("<strong>10.Financial Performance</strong>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>a) Income</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 30).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 30).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 30).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>b) Expenditure</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 31).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 31).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 31).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:left;padding:3px;padding-left:15px;'>");
                    sb.Append("<span>c) Profit and Loss</span>");
                    sb.Append("</td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 32).Select(x => x.MonthUnderReport).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 32).Select(x => x.PrevMonth).FirstOrDefault() + "</span></td>");
                    sb.Append("<td style='text-align:center;border:1px solid #000;text-align:right;padding:3px;'><span>" + LstMonthlyPerformaceReport.Where(x => x.DescriptionId == 32).Select(x => x.CorresMonthPrevYear).FirstOrDefault() + "</span></td>");
                    sb.Append("</tr>");
                    sb.Append("<tr>");
                    sb.Append("<td colspan='2'style='padding:3px;vertical-align:top;'>");
                    sb.Append("<span>To:</span>");
                    sb.Append("<table style='width:35%;border:1px solid #000;'><tbody><tr><td><br/><br/><br/></td></tr></tbody></table>");
                    sb.Append("</td>");
                    sb.Append("<td colspan='2'style='padding:3px;vertical-align:bottom;text-align:center;'>");
                    sb.Append("<strong>Signature of Manager CFS/ICD</strong>");
                    sb.Append("</td>");
                    sb.Append("</tr>");
                    sb.Append("</tbody>");
                    sb.Append("</table>");
                }

                Pages[0] = sb.ToString();

                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/MonthlyPerformanceRepor/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                //using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f))
                //{
                //    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);
                //}
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/MonthlyPerformanceRepor/" + FileName };
                return Json(ObjResult, JsonRequestBehavior.AllowGet);
            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }
        }

        #endregion

        #region Party Wise Ledger
        // Copy to Kdl
        [HttpGet]
        public ActionResult PartyWiseLedger()
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<PartyLedgerList> LstParty = new List<PartyLedgerList>();
            //ObjRR.GetEximTraderForPartyLedger();
            //if (ObjRR.DBResponse.Data != null)
            //{
            //    ViewBag.PartyList = new SelectList((List<DSRPartyLedgerList>)ObjRR.DBResponse.Data, "PartyId", "PartyName");
            //}
            //else
            //{
            //    ViewBag.PartyList = null;
            //}

            ObjRR.GetEximTraderForPartyLedger();
            if (ObjRR.DBResponse.Data != null)
            {
                ViewBag.PartyList = new SelectList((List<PartyLedgerList>)ObjRR.DBResponse.Data, "PartyId", "PartyName");
            }
            else
            {
                ViewBag.PartyList = null;
            }

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetPartyWiseLedgerDetail(PartyWiseLedger ObjPartyLedger)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.GetPartyWiseLedger(ObjPartyLedger.FromDate, ObjPartyLedger.ToDate, ObjPartyLedger.PartyId);
                return Json(ObjRR.DBResponse);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GeneratePDFOfPartyWiseLedger(FormCollection Fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "PartyWiseLedger.pdf";
                Pages[0] = Fc["Page"].ToString();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report/PartyWiseLedger/";
                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                Pages[0] = Pages[0].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Fc["Page"].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //using (var Rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f))
                //{
                //    Rh.GeneratePDF(LocalDirectory + FileName, Pages);
                //}
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }

                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/PartyWiseLedger/" + FileName });
            }
            catch
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }
        }
        #endregion

        #region Certificate of PEST




        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult PrintCertificate(String InvoiceNumber)
        {
            DSR_ReportRepository ObjIR = new DSR_ReportRepository();
            ObjIR.GetCertificateForPreview(InvoiceNumber);
            if (ObjIR.DBResponse.Data != null)
            {
                DSRPestCertificate ObjCertificate = new DSRPestCertificate();
                ObjCertificate = (DSRPestCertificate)ObjIR.DBResponse.Data;
                string Path = GeneratePDFForCertificate(ObjCertificate);
                return Json(new { Status = 1, Message = Path });
            }
            else
                return Json(new { Status = -1, Message = "Error" });
        }
        [NonAction]
        public string GeneratePDFForCertificate(DSRPestCertificate DSRObj)
        {
            int Id;
            Id = 1;
            string Path = Server.MapPath("~/Docs/") + Session.SessionID + "/Certificate" + Id + ".pdf";
            int Count = 0;
            // decimal MarksNo = 0, Weight=0;
            string Html = "";
            string CompanyAddress = "";
            CompanyRepository ObjCR = new CompanyRepository();
            List<Company> LstCompany = new List<Company>();
            ObjCR.GetAllCompany();
            if (ObjCR.DBResponse.Data != null)
            {
                LstCompany = (List<Company>)ObjCR.DBResponse.Data;
                CompanyAddress = LstCompany[0].CompanyAddress;
            }
            if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            if (System.IO.File.Exists(Path))
            {
                System.IO.File.Delete(Path);
            }

            Html = "<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><thead>  <tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody><tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td><td width='100%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>Near Indira Nagar Colony, Village - Dashrath <br/> Vadodara - 391740 </ span><br/><label style='font-size: 7pt; font-weight:bold;'>FUMIGATION CERTIFICATE</label></td></tr></tbody></table></td></tr></thead></table> ";

            Html += "<table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse; border: 1px solid #000;'><tbody>";
            Html += "<tr><th><span><br/></span></th></tr>";
            Html += "<tr><th cellpadding='5'>DPPQS Regd. No. : IN-337/MB </th></tr>";
            Html += "<tr><th cellpadding='5' style='width:50%;'>Treatment Certificate No.CWC/A No. : " + DSRObj.CertificateNo + " </th>  <th cellpadding='5' style='width:50%; text-align: right;'>Date of Issue : " + DSRObj.IssueDate + " </th></tr>";
            Html += "<tr><td cellpadding='5' colspan='12'>This is to Certify that following regulated articles have been fumigated according to appropriate procedures to conform to the current Phytosanitary requirements of the importing country.</td></tr>";

            Html += "<tr><td><span><br/></span></td></tr>";
            Html += "<tr><td colspan='12'><table style='width:100%; border-bottom: 1px solid #000; padding-bottom:5px; font-size: 7pt;' cellspacing='0' cellpadding='5'><tbody>";
            Html += "<tr><th colspan='12'>DETAILS OF GOODS</th></tr>";
            Html += "<tr><td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Description of Goods</label> <span>" + DSRObj.GoodsDesc + "</span></td>";
            Html += "<td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Quantity declared : </label> <span>" + DSRObj.Quantity + "</span> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> " + DSRObj.PackType + "</td></tr>";
            Html += "<tr><td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Distinguishing marks : </label><span>Inv No. " + DSRObj.DistingMarks + "</span></td>";
            Html += "<td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Consign.Link/Container No. :</label> <span>" + DSRObj.ContainerNo + "</span> </td></tr>";
            Html += "<tr><td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Port & Country of loading :</label> <span>" + DSRObj.PortLoading + "</span></td>";
            Html += "<td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Name of Vessel/Ship :</label> <span>" + DSRObj.NameOfVessel + "</span></td></tr>";
            Html += "<tr><td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Country of destination :</label> <span>" + DSRObj.Destination + "</span></td>";
            Html += "<td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Declared point  of entry  :</label> <span>" + DSRObj.PortOfDischarge + "</span></td></tr>";
            Html += "<tr><td colspan='12' width='100%' style='font-size: 7pt;'><label style='font-weight: bold;'>Name and Address of Consignor/Exporter :</label> <span>" + DSRObj.Exporter + "</span></td></tr>";
            Html += "<tr><td colspan='12' width='100%' style='font-size: 7pt;'><label style='font-weight: bold;'>Declared Name and Address of Consignee :</label> <span>" + DSRObj.Consignee + "</span></td></tr>";
            Html += "</tbody></table></td></tr>";

            Html += "<tr><td><span><br/></span></td></tr>";
            Html += "<tr><td colspan='12'><table style='width:100%; border-bottom: 1px solid #000; padding-bottom:5px; font-size: 7pt;' cellspacing='0' cellpadding='5'><tbody>";
            Html += "<tr><th colspan='12'>DETAILS OF TREATEMENT</th></tr>";
            Html += "<tr><td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Name of Fumigant</label> <span>" + DSRObj.NameOfFumigant + "</span></td>";
            Html += "<td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Date of Fumigation : </label> <span>" + DSRObj.FamugationDate + "</span></td></tr>";
            Html += "<tr><td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Place of Fumigation : </label><span>" + DSRObj.Place + "</span></td>";
            Html += "<td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Dosage Rate of Fumigant :</label> <span>" + DSRObj.Dosage + "</span> </td></tr>";
            Html += "<tr><td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Duration of Fumigation :</label> <span>" + DSRObj.Duration + "</span><span>&nbsp;&nbsp;</span><span>Hrs</span></td>";
            Html += "<td colspan='6' width='60%' style='font-size: 7pt;'><label style='font-weight: bold;'>Minimum Air Temperature :</label> <span>" + DSRObj.Temp + " </span><span>°C</span></td></tr>";
            Html += "<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label>Fumigation has been performed in a container<span>&#8725;</span>under gas tight enclosure <span>&#8725;</span> sheet :</label></td>";
            Html += "<td colspan='4' width='30%' style='font-size: 7pt;'><label>" + DSRObj.GasTight + "</label></td></tr>";
            Html += "<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label>Container pressure test conducted :</label></td>";
            Html += "<td colspan='4' width='30%' style='font-size: 7pt;'><label>YES <span>&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> NO <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;</span> N<span>&#8725;</span>A</label></td></tr>";
            Html += "<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label>Container has 200 mm free air space at top of container :</label></td>";
            Html += "<td colspan='4' width='30%' style='font-size: 7pt;'><label>YES <span>&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> NO <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;</span> N<span>&#8725;</span>A</label></td></tr>";
            Html += "<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label>In trainsit fumigation - Needs Ventilation at Port of Discharge :</label></td>";
            Html += "<td colspan='4' width='30%' style='font-size: 7pt;'><label>YES <span>&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> NO <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;</span> N<span>&#8725;</span>A</label></td></tr>";
            Html += "<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label>Container <span>&#8725;</span> Enclosure has been ventilated to below 5ppm v<span>&#8725;</span>v methyl bromide :</label></td>";
            Html += "<td colspan='4' width='30%' style='font-size: 7pt;'><label>YES <span>&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> NO <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;</span> N<span>&#8725;</span>A</label></td></tr>";
            Html += "</tbody></table></td></tr>";

            Html += "<tr><td><span><br/></span></td></tr>";
            Html += "<tr><td colspan='12'><table style='width:100%; border-bottom: 1px solid #000; padding-bottom:5px; font-size: 7pt;' cellspacing='0' cellpadding='5'><tbody>";
            Html += "<tr><th colspan='12'>WRAPPING AND TIMBER</th></tr>";
            Html += "<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label>Has the commodity been fumigated prior to lacquering, varnishing, Painting or Wrapping :</label></td>";
            Html += "<td colspan='4' width='30%' style='font-size: 7pt;'><label>YES <span>&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> NO <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;</span> N<span>&#8725;</span>A</label></td></tr>";
            Html += "<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label>Has plastic wrapping been used in the consignment ? :</label></td>";
            Html += "<td colspan='4' width='30%' style='font-size: 7pt;'><label>YES <span>&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> NO <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;</span> N<span>&#8725;</span>A</label></td></tr>";
            Html += "<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label>*If yes, has the consignment been fumigated prior to wrapping :</label></td>";
            Html += "<td colspan='4' width='30%' style='font-size: 7pt;'><label>YES <span>&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> NO <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;</span> N<span>&#8725;</span>A</label></td></tr>";
            Html += "<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label>*Or has the plastic wrapping been slashed, opened, or perforated in accordance with the Wrapping and Perforation Standard ? :</label></td>";
            Html += "<td colspan='4' width='30%' style='font-size: 7pt;'><label>YES <span>&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> NO <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;</span> N<span>&#8725;</span>A</label></td></tr>";
            Html += "<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label>Is the timber in this consignment is less than 200 mm thick in One dimension and correctly spaced every 200 mm in height  :</label></td>";
            Html += "<td colspan='4' width='30%' style='font-size: 7pt;'><label>YES <span>&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> NO <span>&nbsp;&nbsp;&nbsp;&nbsp;</span> <span>&#8725;</span> <span>&nbsp;&nbsp;</span> N<span>&#8725;</span>A</label></td></tr>";
            Html += "</tbody></table></td></tr>";

            Html += "<tr><td><span><br/></span></td></tr>";
            Html += "<tr><th cellpadding='5' colspan='12'>ADDITIONAL DECLARATIONS</th></tr>";
            Html += "<tr><td cellpadding='5' colspan='12'>I declare that these details are true and the fumigation has been carried out in a accordance with the NSPM 12</td></tr>";
            Html += "<tr><th cellpadding='5' colspan='12'>PLACE & DATE</th></tr>";
            Html += "<tr><th cellpadding='5' colspan='12'>VADODARA</th></tr>";
            Html += "<tr><td><span><br/></span></td></tr>";
            Html += "<tr><th cellpadding='5' colspan='12'>Signature :</th></tr>";
            Html += "<tr><td><span><br/></span></td></tr>";

            Html += "<tr><td colspan='12'><table style='width:100%; font-size: 7pt;' cellspacing='0' cellpadding='5'><tbody>";
            Html += "<tr><td width='15%' style='font-size: 7pt;'><label>Name of Accredited Fumigation Operator <br/> DPPQ S Accreditation No.<span>&#8725;</span></label></td>";
            Html += "<th width='30%' style='font-size: 7pt; text-align:center;'><label> <br/> </label></th></tr>";
            Html += "</tbody></table></td></tr>";

            Html += "</tbody></table>";


            //  Html = "<table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;'><thead><tr><th style='width:15%;text-align:left;'><img src='IMGSRC' width='50%;'/></th><th style='text-align:center;'><span style='font-size:16pt;'><strong>CENTRAL WAREHOUSING CORPORATION</strong></span><br/><span>(A GOVT. OF INDIA UNDERTAKING)<br/>" + CompanyAddress + "</span></th></tr></thead><tbody><tr><td style='text-align:left;'><span style='border-bottom:1px solid #000;'></span></td><td style='text-align:right;'><span style='border-bottom:1px solid #000;'></span></td></tr><tr><td colspan='2' style='text-align:center;'><br/><span style='border-bottom:1px solid #000;font-size:12pt;font-weight:600;'>Issue Slip Of Container Freight Station.</span></td></tr><tr><td colspan='2' style='text-align:center;'><br/></td></tr><tr><td colspan='2' style='text-align:left;'><span style='border-bottom:1px solid #000;'></span><span style='border-bottom:1px solid #000;'></span></td></tr><tr><td colspan='2'><table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;border:1px solid #000;border-collapse:collapse;'><thead><tr><th style='border:1px solid #000;padding:5px;text-align:center;'>SL. NO.</th><th style='border:1px solid #000;padding:5px;text-align:center;'>CONTAINER NO.</th><th style='border:1px solid #000;padding:5px;text-align:center;'>SIZE</th><th style='border:1px solid #000;padding:5px;text-align:center;'>Bill of Entry No.</th><th style='border:1px solid #000;padding:5px;text-align:center;'>Bill of Entry Date</th></tr></thead><tbody><tr><td style='border:1px solid #000;padding:5px;'>" + Serial + "</td><td style='border:1px solid #000;padding:5px;'>" + ContainerNo + "</td><td style='border:1px solid #000;padding:5px;'>" + Size + "</td><td style='border:1px solid #000;padding:5px;'>" + BOENo + "</td><td style='border:1px solid #000;padding:5px;'>" + BOEDate + "</td></tr></tbody> </table></td></tr><tr><td colspan='2'><table style='width:100%;font-size:9pt;font-family:Verdana,Arial,San-serif;'><tbody><tr><td><span></span></td><td><br/><br/></td></tr></tbody></table></td></tr></tbody></table>";


            Html = Html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
            using (var Rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                Rh.GeneratePDF(Path, Html);
            }
            return "/Docs/" + Session.SessionID + "/Certificate" + Id + ".pdf";
        }


        #endregion


        #region Dose PCS Report


        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult DosewisePCSReport()
        {

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetDosewisePCSReport(DSRPcsReportHeader ObjDailyPdaActivityReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSRPcsReport> LstDailyPdaActivityReport = new List<DSRPcsReport>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.GetDosewisePCSReport(ObjDailyPdaActivityReport);//, objLogin.Uid
            string Path = "";
            //  return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            if (ObjRR.DBResponse.Data != null)
            {
                LstDailyPdaActivityReport = (List<DSRPcsReport>)ObjRR.DBResponse.Data;

                Path = GenerateDosewasePCSReportPDF(LstDailyPdaActivityReport, ObjDailyPdaActivityReport.PeriodFrom, ObjDailyPdaActivityReport.PeriodTo, ObjDailyPdaActivityReport.MbrType);

                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }

        [NonAction]
        public String GenerateDosewasePCSReportPDF(List<DSRPcsReport> lstData, string fromDate, string todate, string Dosegae)
        {
            try
            {

                var FileName = "PCSReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:8pt;'>Near Indira Nagar Colony, Village - Dashrath <br/> Vadodara - 391740 </span><br/><span style='font-size:8pt;'><b>Email -</b> cwccfs@gmail.com</span><br/><label style='font-size: 8pt; font-weight:bold;'>" + Dosegae + " PCS REPORT BETWEEN " + fromDate + " & " + todate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; font-size:7pt;'><thead>");
                Pages.Append("<tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Date of fumigation</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Place</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;'>CRT No</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;'>Date of Issue</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;'>Chemical</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;'>Dosages</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;'>No. Pkg.</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;'>No.Cane/APL</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:12%;'>Name of Cargo</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:12%;'>Name of Exporter</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:12%;'>Container No - Size</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;text-align:right;'>Volume</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;text-align:right;'>FUM. AMOUNT</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;text-align:right;'>SGST</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;text-align:right;'>CGST</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;text-align:right;'>IGST</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;text-align:right;'>Total Amount</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;'>Receipt No</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;'>Invoice No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:8%;text-align:right;'>Country Name</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");
                decimal TotalCons = 0M;
                decimal TotalPKG = 0M;
                int Total20 = 0;
                int Total40 = 0;
                int TotalTew = 0;
                decimal Volume = 0M;
                decimal Amount = 0M;
                decimal SGST = 0M;
                decimal CGST = 0M;
                decimal IGST = 0M;
                decimal Total = 0M;

                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.FumigationDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Place + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CertificateNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.IssueDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Chemical + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Dosages + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.PKG + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.NoCane + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Cargo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Exporter + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Container + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:right;'>" + item.Volume + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:right;'>" + item.Amount + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:right;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:right;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:right;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:right;'>" + item.Total + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ReceiptNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Country + "</td></tr>");
                    TotalCons = TotalCons + (item.NoCane == "" ? 0 : Convert.ToDecimal(item.NoCane));
                    TotalPKG = TotalPKG + (item.PKG == "" ? 0 : Convert.ToDecimal(item.PKG));
                    Total20 = Total20 + (item.Size == 20 ? 1 : 0);
                    Total40 = Total40 + (item.Size == 40 ? 1 : 0);
                    Volume = Volume + (item.Volume == "" ? 0 : Convert.ToDecimal(item.Volume));
                    Amount = Amount + Convert.ToDecimal(item.Amount);
                    SGST = SGST + Convert.ToDecimal(item.SGST);
                    CGST = CGST + Convert.ToDecimal(item.CGST);
                    IGST = IGST + Convert.ToDecimal(item.IGST);
                    Total = Total + Convert.ToDecimal(item.Total);

                });

                TotalTew = (Total20 + (Total40 * 2));



                Pages.Append("<tr><td colspan='9'><table cellspacing='0' cellpadding='5' style='width:100%; border-bottom: 1px solid #000; font-size:7pt;'><tbody><tr>");
                Pages.Append("<td style='width:110px;'>No. Of Certificate :</td>");
                Pages.Append("<td style='width:80px;'>" + lstData.GroupBy(x => x.CertificateNo).Count() + "</td>");
                Pages.Append("<td style='width:100px;'>Total Cons :</td>");
                Pages.Append("<td style='width:80px;'>" + TotalCons + "</td>");
                Pages.Append("<td style='width:80px;'>" + TotalPKG + "</td>");
                Pages.Append("<td style='width:80px;'>Grms.</td>");
                Pages.Append("<td style='width:100px;'>No. Of Teu's.:</td>");
                Pages.Append("<td style='width:350px;'><table cellspacing='0' cellpadding='5' style='border:1px solid #000; width:100%; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-right: 1px solid #000;'>20 Feet</th>");
                Pages.Append("<th style='border-right: 1px solid #000;'>40 Feet</th>");
                Pages.Append("<th>Teu's</th></tr></thead>");
                Pages.Append("<tbody><tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + Total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + Total40 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + TotalTew + "</td></tr></tbody>");
                Pages.Append("</table></td>");
                Pages.Append("</tr></tbody></table></td>");
                Pages.Append("<td style=''>Total</td>");
                Pages.Append("<td style=''></td>");
                Pages.Append("<td style=''>" + Volume + "</td>");
                Pages.Append("<td style=''>" + Amount + "</td>");
                Pages.Append("<td style=''>" + SGST + "</td>");
                Pages.Append("<td style=''>" + CGST + "</td>");
                Pages.Append("<td style=''>" + IGST + "</td>");
                Pages.Append("<td style=''>" + Total + "</td>");
                Pages.Append("<td colspan='3' style=''>PCS INCHARGE</td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;

            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region PCS Payment Report


        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult PCSPaymentReport()
        {

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetPCSPaymentReport(DSRPcsPaymentReportHeader ObjDailyPdaActivityReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSRPcsPaymentReport> LstDailyPdaActivityReport = new List<DSRPcsPaymentReport>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.GetPCSPaymentReport(ObjDailyPdaActivityReport);//, objLogin.Uid
            string Path = "";
            //  return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            if (ObjRR.DBResponse.Data != null)
            {
                LstDailyPdaActivityReport = (List<DSRPcsPaymentReport>)ObjRR.DBResponse.Data;

                Path = GeneratePCSPaymentReportPDF(LstDailyPdaActivityReport, ObjDailyPdaActivityReport.PeriodFrom, ObjDailyPdaActivityReport.PeriodTo);

                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }

        [NonAction]
        public String GeneratePCSPaymentReportPDF(List<DSRPcsPaymentReport> lstData, string fromDate, string todate)
        {
            try
            {

                var FileName = "PCSPaymentReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:8pt;'>Near Indira Nagar Colony, Village - Dashrath <br/> Vadodara - 391740 </span><br/><span style='font-size:8pt;'><b>Email -</b> cwccfs@gmail.com</span><br/><label style='font-size: 8pt; font-weight:bold;'> PCS Payment REPORT BETWEEN " + fromDate + " & " + todate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; font-size:7pt;'><thead>");
                Pages.Append("<tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Sl. No.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Invoice No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Certificate</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;'>Receipt No</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;'>Receipt Date</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;'>Party Description</th>");
                Pages.Append("<th style='border-right:1px solid #000;border-bottom:1px solid #000;width:8%;'>Amount</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");
                decimal TotalAmount = 0M;



                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CertificateNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ReceiptNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ReceiptDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.PartyDescription + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Amount + "</td></tr>");
                    TotalAmount = TotalAmount + item.Amount;
                    i++;
                });


                Pages.Append("<tr>");
                Pages.Append("<th colspan='6' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:left;'>TOTAL</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + TotalAmount + "</th></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;

            }
            catch
            {
                return "";
            }
        }
        #endregion


        #region Pest Certificate Details Report
        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult PestcertificatedtlReport()
        {

            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetPestcertificatedtlReport(DSRFumigationMBR ObjDailyPdaActivityReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<MBRReport> LstDailyPdaActivityReport = new List<MBRReport>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.GetMBRReport(ObjDailyPdaActivityReport);//, objLogin.Uid

            string Path = "";
            //  return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            if (ObjRR.DBResponse.Data != null)
            {
                LstDailyPdaActivityReport = (List<MBRReport>)ObjRR.DBResponse.Data;

                Path = GeneratePestcertificatedtlPDF(LstDailyPdaActivityReport, ObjDailyPdaActivityReport.AsOnDate, ObjDailyPdaActivityReport.MbrType, ObjDailyPdaActivityReport.ToDate, ObjDailyPdaActivityReport.OperationType);

                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }

        }

        [NonAction]
        public string GeneratePestcertificatedtlPDF(List<MBRReport> lstData, string fromDate, string mbtype, string ToDate, string OperationType)
        {
            try
            {

                var FileName = "PestcertificatedtlReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                //Pages.Append("<td width='90%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>Near Indira Nagar Colony, Village - Dashrath <br/> Vadodara - 391740 </span><br/><label style='font-size: 7pt; font-weight:bold;'>Statement Showing Details of Fumigation Undertaken With " + mbtype +" for the MOnth ending on, " + fromDate + " </label></td></tr>");
                Pages.Append("<td width='90%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>Near Indira Nagar Colony, Village - Dashrath <br/> Vadodara - 391740 </span><br/><label style='font-size: 7pt; font-weight:bold;'>Email: icd.dashrath@cewacor.nic.in <br/>Statement Showing Details of Fumigation Undertaken " + (mbtype == "All" ? "" : ("With " + mbtype)) + " for the Period of " + fromDate + " - " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                var Otype = "";
                if (OperationType == null)
                {
                    Otype = "";
                }
                else
                {
                    Otype = OperationType;
                }
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'>" + Otype + "</td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'><thead>");
                Pages.Append("<tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>S.N.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Certificate No. & Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Commodity</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Quantity</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Country of Import</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Does of MBr Applied</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Total Quantity of MBr Used</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:15%;'>Remarks 1 MBr CAN-680 Gms</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");
                int tot = 0; ;
                int totrem = 0;
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CertificateNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Commodity + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Quantity + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CountryImport + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Dosagesformbr + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.QuantityUsedMBR + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Remarks + " Gms </td></tr>");
                    tot = tot + item.QuantityUsedMBR;
                    i = i + 1;
                });
                totrem = tot * 680;
                Pages.Append("<tr><th colspan='6' style='border-bottom:1px solid #000;'>TOTAL</th>");
                Pages.Append("<th style='border-bottom:1px solid #000'>" + tot + "  </th><th style='border-bottom:1px solid #000'>" + totrem + " Gms</th></tr>");

                Pages.Append("</tbody></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; font-size:7pt;'><thead>");
                Pages.Append("<tr><td><br/><br/><br/><br/><br/><br/></td></tr>");
                Pages.Append("<tr><th colspan='6' width='50%'>Name & Signature of Accredited <br/> Fumigation Operator With Date</th>");
                Pages.Append("<th colspan='6' width='50%' align='right'>Name & Signature of  GM/BM of <br/> Fumigation Agency With Date</th></tr>");
                Pages.Append("</thead></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;

            }
            catch
            {
                return "";
            }
        }





        #endregion


        #region Chemical Stock Report
        [HttpGet]
        public ActionResult ChemicalStockReport()
        {
            DSR_PestRepository objCR = new DSR_PestRepository();
            objCR.ListOfChemicalNames();
            if (objCR.DBResponse.Data != null)
                ViewBag.ListOfChemical = objCR.DBResponse.Data;
            else
                ViewBag.ListOfChemical = null;
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetChemicalStockReport(DSRChemicalStock ObjPV)
        {

            DSR_ReportRepository ObjRR = new DSR_ReportRepository();

            ObjRR.GetChemicalStockReport(ObjPV);

            string Path = "";

            List<DSRStock> lstData = new List<DSRStock>();
            lstData = (List<DSRStock>)ObjRR.DBResponse.Data;
            Path = GeneratePDFChemicalStockReport(lstData, ObjPV.AsOnDate);

            return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
        }


        [NonAction]
        public string GeneratePDFChemicalStockReport(List<DSRStock> lstData, string Date)
        {
            try
            {
                var FileName = "ChemicalStockReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>ICD Dashrarath</span><br/><span style='font-size:12px;'><b>As On Date - </b> " + Date + "</span><br/><label style='font-size: 14px; font-weight:bold;'>Chemical Stock Report</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'><thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>S No</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Chemical Name</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Batch No.</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Expiry Date</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Stock</th></tr></thead><tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ChemicalName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.BatchNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ExpiryDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Stock + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });



                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region IWB Report

        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult GetInlandWayBillReport(int GatePassId)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.PrintInlandWayBill(GatePassId);//, objLogin.Uid
            DSRInlandWayBill ObjData = new DSRInlandWayBill();
            string FilePath = "";
            if (ObjRR.DBResponse.Data != null)
            {
                ObjData = (DSRInlandWayBill)ObjRR.DBResponse.Data;
                FilePath = GeneratingInlandWayBillPDF(ObjData, GatePassId);
                return Json(new { Status = 1, Message = FilePath });
            }
            else
                return Json(new { Status = -1, Message = "Print will not generate as it is an import Gate pass." });
        }
        [NonAction]
        private string GeneratingInlandWayBillPDF(DSRInlandWayBill ObjData, int GatePassId)
        {

            string html = "";

            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/IWBNo" + GatePassId + ".pdf";
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }
            html = ("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

            html += ("<tr><td colspan='12'>");
            html += ("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            html += ("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
            html += ("<td width='70%' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><span style='font-size:12px;'>(A Govt. of India Undertaking)</span><br/><span style='font-size:12px;'>CONTAINER FREIGHT STATION-DASHRATH</span><br/><label style='font-size: 12px;'>Near Indira Nagar Colony,Village - Dashrath,Vadodara - 391740</label><br/><label style='font-size: 14px; font-weight:bold;'>INLAND WAY BILL</label></td>");
            html += ("<td valign='top'><img align='right' src='ISO' width='100'/></td></tr>");
            html += ("</tbody></table>");
            html += ("</td></tr>");

            html += ("<tr><td><span><br/></span></td></tr>");

            html += ("<tr><td colspan='6' width='50%' style='font-size:8pt;'><b>No: " + ObjData.IWBNo + "</b></td> <td colspan='6' width='50%' style='text-align:right; font-size:8pt;'><b>Date: " + ObjData.IWBDate + "</b></td></tr>");

            html += ("<tr><td colspan='12'>");
            html += ("<table cellpadding='10' cellspacing='0' style='table-layout: fixed; width:100%; border:1px solid #000; font-size:8pt; font-family:Verdana,Arial,San-serif;'><tbody>");
            html += ("<tr><th colspan='3' width='30%' style='font-size:9pt;'>Consignor Name & Address</th> <td width='1%' valign='top'></td> <th colspan='4' width='40%' style='font-size:9pt;'>Consignee Name & Address</th></tr>");
            html += ("<tr><td colspan='3' width='30%'>Assistant Commissioner of Customs,<br/>Vadodara</td> <td width='1%' valign='top'>:</td> <td colspan='4' width='40%'>Assistant Commissioner of Customs<br/>MBPT/JNPT/NSICT/GTI/KANDLA/PIPAVA/MUNDRA/ADANI HAZIRA PORT/RCT/VADODARA</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Name Of the Liner </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.ShippingLineName + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Name Of the Freight Forwarder </td> <td width='1%'>:</td> <td colspan='4' width='40%'></td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Transport A/c </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.Transporter + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>CFS Code </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.CFSCode + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Container No & Size </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.Container + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Trailer No </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.TrailerNo + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>OTL No </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.OTLNo + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>SLA Seal No </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.SealNo + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>No of Packages </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.NoOfPkg + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Weight (Kgs) </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.Weight + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Value (Rs) </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.CIFValue + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Place of Stuffing </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.PlaceOfStuffing + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Port of Loading </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.PortOfLoading + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Name of CHA </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.CHAName + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Exporter's Name </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.ExporterName + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Cargo Description </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.CargoDesc + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Shipping Bill No & Date </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.ShippBillNo + " " + ObjData.ShippBillDate + "</td></tr>");
            html += ("<tr><td colspan='3' width='30%'>Destination </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.Destination + "</td></tr>");
            //html += ("<tr><td colspan='3' width='30%'>Country </td> <td width='1%'>:</td> <td colspan='4' width='40%'>" + ObjData.Country + "</td></tr>");

            html += ("</tbody></table>");
            html += ("</td></tr>");


            html += ("<tr><td><span><br/><br/></span></td></tr>");

            html += ("<tr><td colspan='6' width='50%' style='font-size:8pt;'><b>Time of Removal</b></td> <td colspan='6' width='50%' style='text-align:right; font-size:8pt;'><b>MANAGER CFS:</b></td></tr>");

            html += ("</tbody></table>");


            html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
            html = html.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = this.ZonalOffice;
                rp.HOAddress = "(A Govt.Of India Undertaking)";
                rp.ZonalOffice = this.ZOAddress;
                rp.ZOAddress = "";
                rp.GeneratePDF(location, html);
            }
            return "/Docs/" + Session.SessionID + "/IWBNo" + GatePassId + ".pdf";

        }


        #endregion

        #region Track Your Container
        [HttpGet]
        public ActionResult LoadContainerStatus()
        {
            DSR_ReportRepository ObjER = new DSR_ReportRepository();
            ViewBag.ContainerList = null;
            ObjER.GetShippingLine();
            if (ObjER.DBResponse.Data != null)
                ViewBag.ShippingLineList = new SelectList((List<Areas.Report.Models.WFLD_ShippingLineList>)ObjER.DBResponse.Data, "ShippingLineId", "ShippingLineName");
            else
                ViewBag.ShippingLineList = null;
            return PartialView();
        }
        [HttpGet]
        public JsonResult GetContWiseICDList(string ContainerNo)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetContWiseICDList(ContainerNo);
            if (ObjRR.DBResponse.Status > 0)
            {
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(null, JsonRequestBehavior.AllowGet);
            }
        }

        [HttpGet]
        public JsonResult GetContWiseLatestICD(string ContainerNo)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetContWiseLatestICD(ContainerNo);
            if (ObjRR.DBResponse.Status > 0)
            {
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(null, JsonRequestBehavior.AllowGet);
            }
        }


        [HttpGet]
        public JsonResult GetContainerStatusDetail(string ICDCode)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetContainerDetForTrackContStatus(ICDCode);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpGet]
        public JsonResult GetContainerNoList()
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            ObjRR.GetContainerNoForContStatus();
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        #endregion

        #region E-Invoice Excel Generation

        [HttpGet]
        public ActionResult RegisterOfEInvoice()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public FileResult EInvoiceExcel(FormCollection fc)
        {
            try
            {
                var date1 = Convert.ToDateTime(fc["PeriodFrom"].ToString());
                var date2 = Convert.ToDateTime(fc["PeriodTo"].ToString());
                var excelName = "";
                var ObjRR = new Ppg_ReportRepositoryV2();
                ObjRR.GetRegisterofEInvoice(date1, date2);

                excelName = "EInvoice.xls";

                if (!string.IsNullOrEmpty(ObjRR.DBResponse.Data.ToString()))
                    return File(ObjRR.DBResponse.Data.ToString(), "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", excelName);
                else
                {
                    string name = DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
                    var excelFile = Server.MapPath("~/Docs/Excel/" + name + ".xls");
                    using (var exl = new DynamicExcel.ExcelGenerator(excelFile))
                    {
                        exl.AddCell("A1", "No data found");
                        exl.Save();
                        return File(excelFile, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", excelName);
                    }
                }
            }
            catch
            {
                string name = DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
                var excelFile = Server.MapPath("~/Docs/Excel/" + name + ".xlsx");
                using (var exl = new DynamicExcel.ExcelGenerator(excelFile))
                {
                    exl.AddCell("A1", "No data found");
                    exl.Save();
                    return File(excelFile, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "EInvoice.xls");
                }
            }
            // return null;
        }

        #endregion

        #region Bulk IRN Generation

        [HttpGet]
        public ActionResult BulkIRNGeneration()
        {
            return PartialView();
        }

        [HttpPost]
        public JsonResult GetBulkIrnDetails()
        {
            DSR_ReportRepository objPpgRepo = new DSR_ReportRepository();
            objPpgRepo.GetBulkIrnDetails();
            var Output = (DSR_BulkIRN)objPpgRepo.DBResponse.Data;

            return Json(Output, JsonRequestBehavior.AllowGet);
        }

        public async Task<JsonResult> AddEditBulkIRN(FormCollection objForm)
        {
            //Ppg_CWCImportController objPpgIrn = new Ppg_CWCImportController();

            try
            {

                var invoiceData = JsonConvert.DeserializeObject<DSR_BulkIRN>(objForm["PaymentSheetModelJson"]);

                foreach (var item in invoiceData.lstPostPaymentChrg)
                {
                    try
                    {
                        if (item.InvoiceType == "Inv")
                        {
                            var result = await GetIRNForBulkInvoice(item.InvoiceNo, item.SupplyType);
                        }
                        if (item.InvoiceType == "C")
                        {
                            var result1 = await GetGenerateIRNForBulkCreditNote(item.InvoiceNo, item.SupplyType, "CRN", "C");
                        }
                        if (item.InvoiceType == "D")
                        {
                            var result2 = await GetGenerateIRNForBulkCreditNote(item.InvoiceNo, item.SupplyType, "DBN", "D");
                        }
                    }
                    catch (Exception ex)
                    {
                        continue;
                    }
                }
                //foreach (var item in invoiceData.lstOperationContwiseAmt)
                //{
                //    if (item.DocumentDate != "")
                //        item.DocumentDate = Convert.ToDateTime(item.DocumentDate).ToString("yyyy-MM-dd");
                //} 
                return Json(new { Status = 1, Message = "IRN Generated" });

            }
            catch (Exception ex)
            {
                var Err = new { Status = -1, Message = "Error" };
                return Json(Err);
            }
        }

        public async Task<JsonResult> GetIRNForBulkInvoice(String InvoiceNo, string SupplyType)
        {

            DSR_ImportRepository objPpgRepo = new DSR_ImportRepository();
            if (SupplyType == "B2B" || SupplyType == "SEZWP" || SupplyType == "SEZWOP")
            {
                objPpgRepo.GetIRNForYard(InvoiceNo);
                var Output = (EinvoicePayload)objPpgRepo.DBResponse.Data;

                if (Output.BuyerDtls.Gstin != "" || Output.BuyerDtls.Gstin != null)
                {
                    objPpgRepo.GetHeaderIRNForYard();

                    HeaderParam Hp = (HeaderParam)objPpgRepo.DBResponse.Data;

                    string jsonEInvoice = JsonConvert.SerializeObject(Output);
                    string jsonEInvoiceHeader = JsonConvert.SerializeObject(Hp);

                    Einvoice Eobj = new Einvoice(Hp, jsonEInvoice);

                    IrnResponse ERes = await Eobj.GenerateEinvoice();
                    if (ERes.Status == 0)
                    {
                        log.Info(ERes.ErrorDetails.ErrorMessage);
                        log.Info(ERes.ErrorDetails.ErrorCode);
                        log.Info("Invoice No:" + InvoiceNo);
                        log.Info(ERes.Status);
                    }
                    if (ERes.Status == 1)
                    {
                        objPpgRepo.AddEditIRNResponsec(ERes, InvoiceNo);
                    }
                    else
                    {
                        objPpgRepo.DBResponse.Message = ERes.ErrorDetails.ErrorMessage;
                        objPpgRepo.DBResponse.Status = Convert.ToInt32(ERes.ErrorDetails.ErrorCode);
                    }
                }
                else
                {

                    /*     Einvoice Eobj = new Einvoice();
                         objPpgRepo.GetIRNB2CForYard(InvoiceNo);
                         DSR_IrnB2CDetails irnb2cobj = new DSR_IrnB2CDetails();
                         irnb2cobj = (DSR_IrnB2CDetails)objPpgRepo.DBResponse.Data;

                         IrnModel irnModelObj = new IrnModel();
                         irnModelObj.DocumentDate = irnb2cobj.DocDt;
                         irnModelObj.DocumentNo = irnb2cobj.DocNo;
                         irnModelObj.DocumentType = irnb2cobj.DocTyp;
                         irnModelObj.SupplierGstNo = irnb2cobj.SellerGstin;
                         string ERes = Eobj.GenerateB2cIrn(irnModelObj);
                         var dt = DateTime.Now;
                         QrCodeInfo obj = new QrCodeInfo();
                         QrCodeData objQR = new QrCodeData();
                         objQR.Irn = ERes;
                         objQR.IrnDt = dt.ToString("dd/MM/yyyy");
                         objQR.iss = "NIC";
                         objQR.ItemCnt = irnb2cobj.ItemCnt;
                         objQR.MainHsnCode = irnb2cobj.MainHsnCode;
                         objQR.SellerGstin = irnb2cobj.SellerGstin;
                         objQR.TotInvVal = irnb2cobj.TotInvVal;
                         objQR.BuyerGstin = irnb2cobj.BuyerGstin;
                         objQR.DocDt = irnb2cobj.DocDt;
                         objQR.DocNo = irnb2cobj.DocNo;
                         objQR.DocTyp = irnb2cobj.DocTyp;
                         obj.Data = (QrCodeData)objQR;
                         B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                         objresponse = Eobj.GenerateB2cQRCode(obj);
                         IrnResponse objERes = new IrnResponse();
                         objERes.irn = ERes;
                         objERes.SignedQRCode = objresponse.QrCodeBase64;
                         objERes.SignedInvoice = objresponse.QrCodeJson;
                         objERes.SignedQRCode = objresponse.QrCodeJson;

                         objPpgRepo.AddEditIRNResponsec(objERes, InvoiceNo);
                     }

                 }
                 else
                 {
                     Einvoice Eobj = new Einvoice();
                     objPpgRepo.GetIRNB2CForYard(InvoiceNo);
                     DSR_IrnB2CDetails irnb2cobj = new DSR_IrnB2CDetails();
                     irnb2cobj = (DSR_IrnB2CDetails)objPpgRepo.DBResponse.Data;

                     IrnModel irnModelObj = new IrnModel();
                     irnModelObj.DocumentDate = irnb2cobj.DocDt;
                     irnModelObj.DocumentNo = irnb2cobj.DocNo;
                     irnModelObj.DocumentType = irnb2cobj.DocTyp;
                     irnModelObj.SupplierGstNo = irnb2cobj.SellerGstin;
                     string ERes = Eobj.GenerateB2cIrn(irnModelObj);
                     var dt = DateTime.Now;
                     QrCodeInfo obj = new QrCodeInfo();
                     QrCodeData objQR = new QrCodeData();
                     objQR.Irn = ERes;
                     objQR.IrnDt = dt.ToString("dd/MM/yyyy");
                     objQR.iss = "NIC";
                     objQR.ItemCnt = irnb2cobj.ItemCnt;
                     objQR.MainHsnCode = irnb2cobj.MainHsnCode;
                     objQR.SellerGstin = irnb2cobj.SellerGstin;
                     objQR.TotInvVal = irnb2cobj.TotInvVal;
                     objQR.BuyerGstin = irnb2cobj.BuyerGstin;
                     objQR.DocDt = irnb2cobj.DocDt;
                     objQR.DocNo = irnb2cobj.DocNo;
                     objQR.DocTyp = irnb2cobj.DocTyp;
                     obj.Data = (QrCodeData)objQR;
                     B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                     objresponse = Eobj.GenerateB2cQRCode(obj);
                     IrnResponse objERes = new IrnResponse();
                     objERes.irn = ERes;
                     objERes.SignedQRCode = objresponse.QrCodeBase64;
                     objERes.SignedInvoice = objresponse.QrCodeJson;
                     objERes.SignedQRCode = objresponse.QrCodeJson;

                     objPpgRepo.AddEditIRNResponsec(objERes, InvoiceNo);

                 }


                 return Json(objPpgRepo.DBResponse);*/
                    Einvoice Eobj = new Einvoice();
                    objPpgRepo.GetIRNB2CForYard(InvoiceNo);
                    DSR_IrnB2CDetails irnb2cobj = new DSR_IrnB2CDetails();
                    irnb2cobj = (DSR_IrnB2CDetails)objPpgRepo.DBResponse.Data;
                    if (irnb2cobj.mtid == "" || irnb2cobj.pa == "")
                    {
                        IrnModel irnModelObj = new IrnModel();
                        irnModelObj.DocumentDate = irnb2cobj.DocDt;
                        irnModelObj.DocumentNo = irnb2cobj.DocNo;
                        irnModelObj.DocumentType = irnb2cobj.DocTyp;
                        irnModelObj.SupplierGstNo = irnb2cobj.SellerGstin;
                        string ERes = Eobj.GenerateB2cIrn(irnModelObj);
                        B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                        string QRCodeInfo = "000201010211021644038499331959060415522024099331959061661000309933195920825HDFC00000015010030812820026560010A0000005240138centralwarehousingco.99331959@hdfcbank27430010A0000005240125STQ200318122305804I0401085204939953033565802IN5923CENTRAL WAREHOUSING NEW6009New Delhi610611001662410525STQ200318122305804I0401080708993319596304e9fc";
                        objresponse = Eobj.GenerateB2cQRCode(QRCodeInfo);
                        IrnResponse objERes = new IrnResponse();
                        objERes.irn = ERes;
                        objERes.SignedQRCode = objresponse.QrCodeBase64;
                        objERes.SignedInvoice = objresponse.QrCodeJson;
                        objERes.SignedQRCode = objresponse.QrCodeJson;

                        objPpgRepo.AddEditIRNResponsec(objERes, InvoiceNo);
                    }
                    else
                    {
                        var tn = "GST QR";
                        UpiQRCodeInfo idata = new UpiQRCodeInfo();
                        idata.ver = irnb2cobj.ver;
                        idata.mode = irnb2cobj.mode;
                        idata.mode = irnb2cobj.mode;
                        idata.tr = irnb2cobj.tr;
                        idata.tid = irnb2cobj.tid;
                        idata.tn = tn;
                        idata.pa = irnb2cobj.pa;
                        idata.pn = irnb2cobj.pn;
                        idata.mc = irnb2cobj.mc;
                        idata.am = irnb2cobj.TotInvVal;
                        idata.mam = irnb2cobj.TotInvVal;
                        idata.mid = irnb2cobj.mid;
                        idata.msid = irnb2cobj.msid;
                        idata.orgId = irnb2cobj.orgId;
                        idata.mtid = irnb2cobj.mtid;
                        idata.CESS = irnb2cobj.CESS;
                        idata.CGST = irnb2cobj.CGST;
                        idata.SGST = irnb2cobj.SGST;
                        idata.IGST = irnb2cobj.IGST;
                        idata.GSTIncentive = irnb2cobj.GSTIncentive;
                        idata.GSTPCT = irnb2cobj.GSTPCT;
                        idata.qrMedium = irnb2cobj.qrMedium;
                        idata.invoiceNo = irnb2cobj.DocNo;
                        idata.InvoiceDate = irnb2cobj.DocDt;
                        idata.InvoiceName = irnb2cobj.InvoiceName;
                        idata.QRexpire = irnb2cobj.DocDt;
                        idata.pinCode = irnb2cobj.pinCode;
                        idata.tier = irnb2cobj.tier;
                        idata.gstIn = irnb2cobj.gstIn;
                        B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                        objresponse = Eobj.GenerateB2cQRCode(idata);
                        IrnModel irnModelObj = new IrnModel();
                        irnModelObj.DocumentDate = irnb2cobj.DocDt;
                        irnModelObj.DocumentNo = irnb2cobj.DocNo;
                        irnModelObj.DocumentType = irnb2cobj.DocTyp;
                        irnModelObj.SupplierGstNo = irnb2cobj.SellerGstin;
                        string ERes = Eobj.GenerateB2cIrn(irnModelObj);
                        IrnResponse objERes = new IrnResponse();
                        objERes.irn = ERes;
                        objERes.SignedQRCode = objresponse.QrCodeBase64;
                        objERes.SignedInvoice = objresponse.QrCodeJson;
                        objERes.SignedQRCode = objresponse.QrCodeJson;

                        objPpgRepo.AddEditIRNResponsec(objERes, InvoiceNo);
                    }
                }

            }
            else
            {
                Einvoice Eobj = new Einvoice();
                objPpgRepo.GetIRNB2CForYard(InvoiceNo);
                DSR_IrnB2CDetails irnb2cobj = new DSR_IrnB2CDetails();
                irnb2cobj = (DSR_IrnB2CDetails)objPpgRepo.DBResponse.Data;
                if (irnb2cobj.mtid == "" || irnb2cobj.pa == "")
                {
                    IrnModel irnModelObj = new IrnModel();
                    irnModelObj.DocumentDate = irnb2cobj.DocDt;
                    irnModelObj.DocumentNo = irnb2cobj.DocNo;
                    irnModelObj.DocumentType = irnb2cobj.DocTyp;
                    irnModelObj.SupplierGstNo = irnb2cobj.SellerGstin;
                    string ERes = Eobj.GenerateB2cIrn(irnModelObj);
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    string QRCodeInfo = "000201010211021644038499331959060415522024099331959061661000309933195920825HDFC00000015010030812820026560010A0000005240138centralwarehousingco.99331959@hdfcbank27430010A0000005240125STQ200318122305804I0401085204939953033565802IN5923CENTRAL WAREHOUSING NEW6009New Delhi610611001662410525STQ200318122305804I0401080708993319596304e9fc";
                    objresponse = Eobj.GenerateB2cQRCode(QRCodeInfo);
                    IrnResponse objERes = new IrnResponse();
                    objERes.irn = ERes;
                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                    objPpgRepo.AddEditIRNResponsec(objERes, InvoiceNo);
                }
                else
                {
                    var tn = "GST QR";
                    UpiQRCodeInfo idata = new UpiQRCodeInfo();
                    idata.ver = irnb2cobj.ver;
                    idata.mode = irnb2cobj.mode;
                    idata.mode = irnb2cobj.mode;
                    idata.tr = irnb2cobj.tr;
                    idata.tid = irnb2cobj.tid;
                    idata.tn = tn;
                    idata.pa = irnb2cobj.pa;
                    idata.pn = irnb2cobj.pn;
                    idata.mc = irnb2cobj.mc;
                    idata.am = irnb2cobj.TotInvVal;
                    idata.mam = irnb2cobj.TotInvVal;
                    idata.mid = irnb2cobj.mid;
                    idata.msid = irnb2cobj.msid;
                    idata.orgId = irnb2cobj.orgId;
                    idata.mtid = irnb2cobj.mtid;
                    idata.CESS = irnb2cobj.CESS;
                    idata.CGST = irnb2cobj.CGST;
                    idata.SGST = irnb2cobj.SGST;
                    idata.IGST = irnb2cobj.IGST;
                    idata.GSTIncentive = irnb2cobj.GSTIncentive;
                    idata.GSTPCT = irnb2cobj.GSTPCT;
                    idata.qrMedium = irnb2cobj.qrMedium;
                    idata.invoiceNo = irnb2cobj.DocNo;
                    idata.InvoiceDate = irnb2cobj.DocDt;
                    idata.InvoiceName = irnb2cobj.InvoiceName;
                    idata.QRexpire = irnb2cobj.DocDt;
                    idata.pinCode = irnb2cobj.pinCode;
                    idata.tier = irnb2cobj.tier;
                    idata.gstIn = irnb2cobj.gstIn;
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode(idata);
                    IrnModel irnModelObj = new IrnModel();
                    irnModelObj.DocumentDate = irnb2cobj.DocDt;
                    irnModelObj.DocumentNo = irnb2cobj.DocNo;
                    irnModelObj.DocumentType = irnb2cobj.DocTyp;
                    irnModelObj.SupplierGstNo = irnb2cobj.SellerGstin;
                    string ERes = Eobj.GenerateB2cIrn(irnModelObj);
                    IrnResponse objERes = new IrnResponse();
                    objERes.irn = ERes;
                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                    objPpgRepo.AddEditIRNResponsec(objERes, InvoiceNo);
                }

            }


            return Json(objPpgRepo.DBResponse);
        }


        public async Task<JsonResult> GetGenerateIRNForBulkCreditNote(string CrNoteNo, string SupplyType, string Type, string CRDR)
        {
            Einvoice Eobj;
            IrnResponse ERes = null;

            DSR_CashManagementRepository objPpgRepo = new DSR_CashManagementRepository();



            if (SupplyType == "B2C" && CRDR == "C")
            {
                Eobj = new Einvoice();
                IrnModel m1 = new IrnModel();

                QrCodeInfo q1 = new QrCodeInfo();
                //   QrCodeData qdt = new QrCodeData();
                objPpgRepo.GetIRNForB2CInvoiceForCreditDebitNote(CrNoteNo, Type, CRDR);
                var Output = (QrCodeData)objPpgRepo.DBResponse.Data;

                m1.DocumentNo = Output.DocNo;
                m1.DocumentDate = Output.DocDt;
                m1.SupplierGstNo = Output.SellerGstin;
                m1.DocumentType = Output.DocTyp;
                String IRN = Eobj.GenerateB2cIrn(m1);
                Output.Irn = IRN;
                Output.IrnDt = Output.DocDt;
                Output.iss = "NIC";
                q1.Data = Output;
                B2cQRCodeResponse QRCode = Eobj.GenerateB2cQRCode(q1);
                objPpgRepo.AddEditIRNB2CCreditDebitNote(IRN, QRCode, CrNoteNo, CRDR);

                //   return Json(objPpgRepo.DBResponse.Status);
                //   IrnResponse ERes = await Eobj.GenerateB2cIrn();
            }
            else if (SupplyType == "B2C" && CRDR == "D")
            {
                Eobj = new Einvoice();
                IrnModel m1 = new IrnModel();

                Import.Models.DSR_IrnB2CDetails q1 = new Import.Models.DSR_IrnB2CDetails();
                //   QrCodeData qdt = new QrCodeData();
                objPpgRepo.GetIRNForB2CInvoiceForCreditDebitNoteDR(CrNoteNo, Type, CRDR);
                var irnb2cobj = (Import.Models.DSR_IrnB2CDetails)objPpgRepo.DBResponse.Data;

                if (irnb2cobj.mtid == "" || irnb2cobj.pa == "")
                {
                    IrnModel irnModelObj = new IrnModel();
                    irnModelObj.DocumentDate = irnb2cobj.DocDt;
                    irnModelObj.DocumentNo = irnb2cobj.DocNo;
                    irnModelObj.DocumentType = irnb2cobj.DocTyp;
                    irnModelObj.SupplierGstNo = irnb2cobj.SellerGstin;
                    string irn = Eobj.GenerateB2cIrn(irnModelObj);
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    string QRCodeInfo = "000201010211021644038499331959060415522024099331959061661000309933195920825HDFC00000015010030812820026560010A0000005240138centralwarehousingco.99331959@hdfcbank27430010A0000005240125STQ200318122305804I0401085204939953033565802IN5923CENTRAL WAREHOUSING NEW6009New Delhi610611001662410525STQ200318122305804I0401080708993319596304e9fc";
                    objresponse = Eobj.GenerateB2cQRCode(QRCodeInfo);
                    IrnResponse objERes = new IrnResponse();
                    objERes.irn = irn;
                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                    objPpgRepo.AddEditIRNB2CCreditDebitNote(irn, objresponse, CrNoteNo, CRDR);
                }
                else
                {
                    var tn = "GST QR";
                    UpiQRCodeInfo idata = new UpiQRCodeInfo();
                    idata.ver = irnb2cobj.ver;
                    idata.mode = irnb2cobj.mode;
                    idata.mode = irnb2cobj.mode;
                    idata.tr = irnb2cobj.tr;
                    idata.tid = irnb2cobj.tid;
                    idata.tn = tn;
                    idata.pa = irnb2cobj.pa;
                    idata.pn = irnb2cobj.pn;
                    idata.mc = irnb2cobj.mc;
                    idata.am = irnb2cobj.TotInvVal;
                    idata.mam = irnb2cobj.TotInvVal;
                    idata.mid = irnb2cobj.mid;
                    idata.msid = irnb2cobj.msid;
                    idata.orgId = irnb2cobj.orgId;
                    idata.mtid = irnb2cobj.mtid;
                    idata.CESS = irnb2cobj.CESS;
                    idata.CGST = irnb2cobj.CGST;
                    idata.SGST = irnb2cobj.SGST;
                    idata.IGST = irnb2cobj.IGST;
                    idata.GSTIncentive = irnb2cobj.GSTIncentive;
                    idata.GSTPCT = irnb2cobj.GSTPCT;
                    idata.qrMedium = irnb2cobj.qrMedium;
                    idata.invoiceNo = irnb2cobj.DocNo;
                    idata.InvoiceDate = irnb2cobj.DocDt;
                    idata.InvoiceName = irnb2cobj.InvoiceName;
                    idata.QRexpire = irnb2cobj.DocDt;
                    idata.pinCode = irnb2cobj.pinCode;
                    idata.tier = irnb2cobj.tier;
                    idata.gstIn = irnb2cobj.gstIn;
                    B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                    objresponse = Eobj.GenerateB2cQRCode(idata);
                    IrnModel irnModelObj = new IrnModel();
                    irnModelObj.DocumentDate = irnb2cobj.DocDt;
                    irnModelObj.DocumentNo = irnb2cobj.DocNo;
                    irnModelObj.DocumentType = irnb2cobj.DocTyp;
                    irnModelObj.SupplierGstNo = irnb2cobj.SellerGstin;
                    string IRN = Eobj.GenerateB2cIrn(irnModelObj);
                    IrnResponse objERes = new IrnResponse();
                    objERes.irn = IRN;
                    objERes.SignedQRCode = objresponse.QrCodeBase64;
                    objERes.SignedInvoice = objresponse.QrCodeJson;
                    objERes.SignedQRCode = objresponse.QrCodeJson;

                    objPpgRepo.AddEditIRNB2CCreditDebitNote(IRN, objresponse, CrNoteNo, CRDR);
                }
            }
            else
            {
                objPpgRepo.GetIRNForDebitCredit(CrNoteNo, Type, CRDR);
                var Output = (EinvoicePayload)objPpgRepo.DBResponse.Data;
                if (Output.BuyerDtls.Gstin != "" && Output.BuyerDtls.Gstin != null)
                {

                    objPpgRepo.GetHeaderIRNForCreditDebitNote();

                    HeaderParam Hp = (HeaderParam)objPpgRepo.DBResponse.Data;

                    string jsonEInvoice = JsonConvert.SerializeObject(Output);

                    string jsonEInvoiceHeader = JsonConvert.SerializeObject(Hp);
                    Eobj = new Einvoice(Hp, jsonEInvoice);
                    ERes = await Eobj.GenerateEinvoice();
                    if (ERes.Status == 1)
                    {
                        objPpgRepo.AddEditIRNResponsecForCreditDebitNote(ERes, CrNoteNo, CRDR);
                    }
                    else
                    {
                        objPpgRepo.DBResponse.Message = ERes.ErrorDetails.ErrorMessage;
                        objPpgRepo.DBResponse.Status = Convert.ToInt32(ERes.ErrorDetails.ErrorCode);
                    }
                }
                else
                {

                    if (SupplyType == "B2C" && CRDR == "C")
                    {
                        Eobj = new Einvoice();
                        IrnModel m1 = new IrnModel();

                        QrCodeInfo q1 = new QrCodeInfo();
                        //   QrCodeData qdt = new QrCodeData();
                        objPpgRepo.GetIRNForB2CInvoiceForCreditDebitNote(CrNoteNo, Type, CRDR);
                        var Output1 = (QrCodeData)objPpgRepo.DBResponse.Data;

                        m1.DocumentNo = Output1.DocNo;
                        m1.DocumentDate = Output1.DocDt;
                        m1.SupplierGstNo = Output1.SellerGstin;
                        m1.DocumentType = Output1.DocTyp;
                        String IRN = Eobj.GenerateB2cIrn(m1);
                        Output1.Irn = IRN;
                        Output1.IrnDt = Output1.DocDt;
                        Output1.iss = "NIC";
                        q1.Data = Output1;
                        B2cQRCodeResponse QRCode = Eobj.GenerateB2cQRCode(q1);
                        objPpgRepo.AddEditIRNB2CCreditDebitNote(IRN, QRCode, CrNoteNo, CRDR);

                        //   return Json(objPpgRepo.DBResponse.Status);
                        //   IrnResponse ERes = await Eobj.GenerateB2cIrn();
                    }
                    else if (SupplyType == "B2C" && CRDR == "D")
                    {
                        Eobj = new Einvoice();
                        IrnModel m1 = new IrnModel();

                        Import.Models.DSR_IrnB2CDetails q1 = new Import.Models.DSR_IrnB2CDetails();
                        //   QrCodeData qdt = new QrCodeData();
                        objPpgRepo.GetIRNForB2CInvoiceForCreditDebitNoteDR(CrNoteNo, Type, CRDR);
                        var irnb2cobj = (Import.Models.DSR_IrnB2CDetails)objPpgRepo.DBResponse.Data;

                        if (irnb2cobj.mtid == "" || irnb2cobj.pa == "")
                        {
                            IrnModel irnModelObj = new IrnModel();
                            irnModelObj.DocumentDate = irnb2cobj.DocDt;
                            irnModelObj.DocumentNo = irnb2cobj.DocNo;
                            irnModelObj.DocumentType = irnb2cobj.DocTyp;
                            irnModelObj.SupplierGstNo = irnb2cobj.SellerGstin;
                            string irn = Eobj.GenerateB2cIrn(irnModelObj);
                            B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                            string QRCodeInfo = "000201010211021644038499331959060415522024099331959061661000309933195920825HDFC00000015010030812820026560010A0000005240138centralwarehousingco.99331959@hdfcbank27430010A0000005240125STQ200318122305804I0401085204939953033565802IN5923CENTRAL WAREHOUSING NEW6009New Delhi610611001662410525STQ200318122305804I0401080708993319596304e9fc";
                            objresponse = Eobj.GenerateB2cQRCode(QRCodeInfo);
                            IrnResponse objERes = new IrnResponse();
                            objERes.irn = irn;
                            objERes.SignedQRCode = objresponse.QrCodeBase64;
                            objERes.SignedInvoice = objresponse.QrCodeJson;
                            objERes.SignedQRCode = objresponse.QrCodeJson;

                            objPpgRepo.AddEditIRNB2CCreditDebitNote(irn, objresponse, CrNoteNo, CRDR);
                        }
                        else
                        {
                            var tn = "GST QR";
                            UpiQRCodeInfo idata = new UpiQRCodeInfo();
                            idata.ver = irnb2cobj.ver;
                            idata.mode = irnb2cobj.mode;
                            idata.mode = irnb2cobj.mode;
                            idata.tr = irnb2cobj.tr;
                            idata.tid = irnb2cobj.tid;
                            idata.tn = tn;
                            idata.pa = irnb2cobj.pa;
                            idata.pn = irnb2cobj.pn;
                            idata.mc = irnb2cobj.mc;
                            idata.am = irnb2cobj.TotInvVal;
                            idata.mam = irnb2cobj.TotInvVal;
                            idata.mid = irnb2cobj.mid;
                            idata.msid = irnb2cobj.msid;
                            idata.orgId = irnb2cobj.orgId;
                            idata.mtid = irnb2cobj.mtid;
                            idata.CESS = irnb2cobj.CESS;
                            idata.CGST = irnb2cobj.CGST;
                            idata.SGST = irnb2cobj.SGST;
                            idata.IGST = irnb2cobj.IGST;
                            idata.GSTIncentive = irnb2cobj.GSTIncentive;
                            idata.GSTPCT = irnb2cobj.GSTPCT;
                            idata.qrMedium = irnb2cobj.qrMedium;
                            idata.invoiceNo = irnb2cobj.DocNo;
                            idata.InvoiceDate = irnb2cobj.DocDt;
                            idata.InvoiceName = irnb2cobj.InvoiceName;
                            idata.QRexpire = irnb2cobj.DocDt;
                            idata.pinCode = irnb2cobj.pinCode;
                            idata.tier = irnb2cobj.tier;
                            idata.gstIn = irnb2cobj.gstIn;
                            B2cQRCodeResponse objresponse = new B2cQRCodeResponse();
                            objresponse = Eobj.GenerateB2cQRCode(idata);
                            IrnModel irnModelObj = new IrnModel();
                            irnModelObj.DocumentDate = irnb2cobj.DocDt;
                            irnModelObj.DocumentNo = irnb2cobj.DocNo;
                            irnModelObj.DocumentType = irnb2cobj.DocTyp;
                            irnModelObj.SupplierGstNo = irnb2cobj.SellerGstin;
                            string IRN = Eobj.GenerateB2cIrn(irnModelObj);
                            IrnResponse objERes = new IrnResponse();
                            objERes.irn = IRN;
                            objERes.SignedQRCode = objresponse.QrCodeBase64;
                            objERes.SignedInvoice = objresponse.QrCodeJson;
                            objERes.SignedQRCode = objresponse.QrCodeJson;

                            objPpgRepo.AddEditIRNB2CCreditDebitNote(IRN, objresponse, CrNoteNo, CRDR);
                        }
                    }
                }


            }
            // var Images = LoadImage(ERes.QRCodeImageBase64);

            return Json(objPpgRepo.DBResponse);
        }

        #endregion

        #region Fumigation Record
        public ActionResult FumigationUndertaken()
        {
            return View();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetFumigationUndertaken(FormCollection formCollection)
        {
            string CertificateNo = Convert.ToString(formCollection["CertificateNo"]);
            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetFumigationReportDetails(CertificateNo);
            if (obj.DBResponse.Status == 1)
            {
                DataSet ds = new DataSet();
                ds = (DataSet)obj.DBResponse.Data;
                string Path = GenerateFumigationUndertakenPDF(ds);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(new { Status = 0, Data = "" }, JsonRequestBehavior.AllowGet);
            }
        }
        public ActionResult FumigationRecord()
        {
            return PartialView();
        }


        public JsonResult GetCertificateNo()
        {
            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetCertificateNo();
            return Json(obj.DBResponse, JsonRequestBehavior.AllowGet);
        }





        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetFumigationRecord(FormCollection formCollection)
        {
            string CertificateNo = Convert.ToString(formCollection["CertificateNo"]);
            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetFumigationReportDetails(CertificateNo);
            if (obj.DBResponse.Status == 1)
            {
                DataSet ds = new DataSet();
                ds = (DataSet)obj.DBResponse.Data;
                string Path = GenerateFumigationRecordPDF(ds);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(new { Status = 0, Data = "" }, JsonRequestBehavior.AllowGet);
            }

        }
        #endregion



        [NonAction]
        public string GenerateFumigationUndertakenPDF(DataSet ds)
        {
            try
            {
                List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
                List<dynamic> lstDesciptionofGood = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
                List<dynamic> lstShipment = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
                List<dynamic> lstTreatment = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
                var FileName = "GenerateFumigationRecordPDF.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:9pt;'><tbody>");

                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='80'/></td>");
                Pages.Append("<td width='150%' valign='top' align='center'><h1 style='font-size: 16px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                Pages.Append("<label style='display: block; font-size: 7pt;'>(A Govt. of India Undertaking) </label><br />");
                Pages.Append("<span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span></td>");
                Pages.Append("</tr>");

                Pages.Append("<tr><td colspan='12'><br/><br/></td></tr>");

                Pages.Append("<tr><td cellpadding='10' colspan='12' style='border-top: 1px solid #000; border-bottom: 1px solid #000; padding:10px; margin-top:10px;'>Statement Showing Details of Fumigation Undertaken with Methyl Bromide (MBr)</td></tr>");

                Pages.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
                Pages.Append("<tr>");
                Pages.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
                Pages.Append("<tr><td colspan='12'>Name of the Agency: Dynamic</td></tr>");
                Pages.Append("<tr><td colspan='12'>Email: Dynamic</td></tr>");
                Pages.Append("</tbody></table></td>");

                Pages.Append("<td colspan='6' width='50%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
                Pages.Append("<tr><td colspan='12' align='right'>Accreditation No: Dynamic</td></tr>");
                Pages.Append("<tr><td colspan='12' align='right'>Contact No: Dynamic</td></tr>");
                Pages.Append("<tr><td colspan='12' align='right'>Mobile No: Dynamic</td></tr>");
                Pages.Append("</tbody></table></td>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table></td></tr>");

                Pages.Append("<tr><td colspan='12'><span><br/></span></td></tr>");

                Pages.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='border:1px solid #000; text-align: center; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr>");
                Pages.Append("<th style='border-right: 1px solid #000;'>Opening Balance</th>");
                Pages.Append("<th style='border-right: 1px solid #000;'>MBr Procured</th>");
                Pages.Append("<th style='border-right: 1px solid #000;'>From Whom Procured</th>");
                Pages.Append("<th style='border-right: 1px solid #000;'>Invoice No & Date</th>");
                Pages.Append("<th style='border-right: 1px solid #000;'>Despatch & Issue</th>");
                Pages.Append("<th>Closing Stock</th>");
                Pages.Append("</tr>");
                Pages.Append("</thead>");
                Pages.Append("<tbody>");
                Pages.Append("<tr>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>Dynamic</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>Dynamic</td>");
                Pages.Append("</tr>");
                Pages.Append("</tbody>");
                Pages.Append("</table></td></tr>");

                Pages.Append("<tr><td colspan='12'><span><br/><br/><br/><br/><br/><br/></span></td></tr>");

                Pages.Append("<tr><th colspan='6' width='50%' align='left'>Name & Signature of Accredited <br/> Fumigation Operator With Date</th>");
                Pages.Append("<th colspan='6' width='50%' align='right'>Name & Signature of GM / BM of <br/> Fumigation Agency With Date</th></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 30f, 30f, 30f, 30f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;

            }
            catch (Exception ex)
            {
                return "";
            }
        }
        [NonAction]
        public string GenerateFumigationRecordPDF(DataSet ds)
        {
            try
            {
                List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
                List<dynamic> lstDesciptionofGood = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
                List<dynamic> lstShipment = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
                List<dynamic> lstTreatment = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
                var FileName = "GenerateFumigationRecordPDF.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");

                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='80'/></td>");
                Pages.Append("<td width='150%' valign='top' align='center'><h1 style='font-size: 16px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                Pages.Append("<label style='display: block; font-size: 7pt;'>(A Govt. of India Undertaking) </label><br />");
                Pages.Append("<span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span></td>");
                Pages.Append("</tr>");

                Pages.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='0' style='border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin-top:10px; margin-bottom: 20px; font-size:8pt;'><tbody>");
                Pages.Append("<tr><th colspan='12' cellpadding='5' align='center' style='border-bottom:1px solid #000; font-size:9pt;'>FUMIGATION RECORD</th></tr>");

                Pages.Append("<tr>");
                Pages.Append("<td colspan='8' cellpadding='0' style='width:66.66666666666667%;'><table cellspacing='0' cellpadding='5' style='text-align:left; width:100%; font-family: Arial, Helvetica, sans-serif; font-size:8pt;'><tbody>");
                Pages.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='0' style='text-align:left; width:100%; font-family: Arial, Helvetica, sans-serif; font-size:8pt;'><tbody><tr><th colspan='6' width='50%'>Fumigation Company/Branch</th><th colspan='6' style='width:50%; padding:0;'>Certificate No: " + lstDesciptionofGood[0].CertificateNo + "</th></tr></tbody></table></td></tr>");
                Pages.Append("<tr><td colspan='12'>" + objCompany[0].CompanyName + " / " + objCompany[0].BranchType + "  " + objCompany[0].BranchName + "</td></tr>");
                Pages.Append("</tbody></table></td>");                
                Pages.Append("<td colspan='4' style='width:33.33333333333333%; padding:0;'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; font-size:8pt; '><tbody>");
                Pages.Append("<tr><td colspan='12' style='border-bottom:1px solid #000; border-left:1px solid #000;'><b>Reged.Number :</b>IN-337/MB</td></tr>");
                Pages.Append("<tr><td colspan='12' style='border-left:1px solid #000;'><b>Date :</b> 30/05/2010 </td></tr>");
                Pages.Append("</tbody></table></td>");
                Pages.Append("</tr>");

                Pages.Append("<tr><th colspan='12' cellpadding='5' style='border-top:1px solid #000; font-size:9pt;' align='left'>Description of Goods Fumigated</th></tr>	");
                Pages.Append("<tr><td colspan='12' style='padding:0;'><table cellspacing='0' cellpadding='5' style='text-align: center; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Commodity</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Quantity</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>No of Package</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Mode of Packing</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Marks</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Number(s)</th>");
                Pages.Append("<th style='border-top: 1px solid #000;'>Place of Fumigation</th>");
                Pages.Append("</tr>");
                Pages.Append("</thead>");
                Pages.Append("<tbody>");
                lstDesciptionofGood.ToList().ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CargoDesc + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.NoOfPkg + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.NoOfPkg + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.PackageType + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.InvSplNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Container + "</td>");
                    Pages.Append("<td style='border-top: 1px solid #000;'>" + item.Place + "</td>");
                    Pages.Append("</tr>");

                });


                Pages.Append("</tbody>");
                Pages.Append("</table></td></tr>");

                Pages.Append("<tr><th colspan='12' cellpadding='5' style='border-top:1px solid #000; font-size:9pt;' align='left'>Shipment Particulars</th></tr>");
                Pages.Append("<tr><td colspan='12' style='padding:0;'><table cellspacing='0' cellpadding='5' style='text-align: center; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'>");
                Pages.Append("<thead>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vessel Name</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Loading</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Country of Export</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Foreign Port of Shipment</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Name of Exporter</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Name of Importer</th>");

                Pages.Append("</tr>");
                Pages.Append("</thead>");
                Pages.Append("<tbody>");


                lstShipment.ToList().ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.VesselNo + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.PortOfLoading + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.CountryName + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.PortOfDischarge + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Exporter + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.Consignee + "</td>");

                    Pages.Append("</tr>");
                });

                Pages.Append("</tbody>");
                Pages.Append("</table></td></tr>");

                Pages.Append("<tr><th colspan='12' cellpadding='5' style='border-top:1px solid #000; font-size:9pt;' align='left'>Detail of Fumigation Treatment</th></tr>");
                Pages.Append("<tr><td colspan='12' style='padding:0;'><table cellspacing='0' cellpadding='5' style='text-align: center; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top:1px solid #000; width: 100px;'>Fumigant</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top:1px solid #000; width: 100px;'>Dosage <br/> (g/m)</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top:1px solid #000; width: 100px;'>Date/Timeof starting Fumigation</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top:1px solid #000; width: 100px;'>Date/Timeof Ending Fumigation</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top:1px solid #000; width: 100px;'>Temp in °C</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top:1px solid #000; width: 100px;'>Quantity of Fumigant</th>");
                Pages.Append("<th style='border-top:1px solid #000; width: 200px;'>Volume/Type of Fumigation enclosure</th>");
                Pages.Append("</tr>");
                Pages.Append("</thead>");
                Pages.Append("<tbody>");
                lstTreatment.ToList().ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; vertical-align: top;'>" + item.NameOfFumigant + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; vertical-align: top;'>" + item.Dosages + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; vertical-align: top; height:60px;'>" + item.DateOfFumigation + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; vertical-align: top; height:60px;'>" + item.DateOfFumigationEnd + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; vertical-align: top;'>" + item.Temp + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; vertical-align: top;'></td>");
                    Pages.Append("<td style='border-top: 1px solid #000; vertical-align: top;'>" + item.Volum + "</td>");
                    Pages.Append("</tr>");
                });
                Pages.Append("</tbody>");
                Pages.Append("</table></td></tr>");
                Pages.Append("</tbody></table></td></tr>");

                Pages.Append("<tr><th colspan='12' style='font-size:9pt;' align='left'>If Containers are not sheeted, the pressure decay (gas-tightness)</th></tr>");
                Pages.Append("<tr><th colspan='12' style='font-size:9pt;' align='left'>Value for 200-100 Pascals (in seconds).</th></tr>");

                Pages.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='0' style='border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin-top: 20px; font-size:8pt;'><tbody>");
                Pages.Append("<tr>");
                Pages.Append("<th colspan='6' cellpadding='5' width='50%' style='border-right:1px solid #000;'>Record of Monitoring gas concentration</th>");
                Pages.Append("<th colspan='6' cellpadding='5' width='50%'>Gas Monitor type Used :</th>");
                Pages.Append("</tr>");

                Pages.Append("<tr><td colspan='12' style='padding:0;'><table cellspacing='0' cellpadding='5' style='text-align: center; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr>");
                Pages.Append("<th rowspan='2' style='border-right:1px solid #000; border-top:1px solid #000;'>Date/Time</th>");
                Pages.Append("<th rowspan='2' style='border-right:1px solid #000; border-top:1px solid #000;'>Time Interval</th>");
                Pages.Append("<th colspan='3' style='border-right:1px solid #000; border-top:1px solid #000;'>Reading of Sampling lines</th>");
                Pages.Append("<th rowspan='2' style='border-top:1px solid #000;'>Monitored by</th>");
                Pages.Append("</tr>");
                Pages.Append("<tr>");
                Pages.Append("<th style='border-right:1px solid #000; border-top:1px solid #000;'>S1</th>");
                Pages.Append("<th style='border-right:1px solid #000; border-top:1px solid #000;'>S2</th>");
                Pages.Append("<th style='border-right:1px solid #000; border-top:1px solid #000;'>S3</th>");
                Pages.Append("</tr>");
                Pages.Append("</thead>");
                Pages.Append("<tbody>");
                Pages.Append("<tr>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>0.5hr</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-top: 1px solid #000;'></td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>1.0hr</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-top: 1px solid #000;'></td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>2.0hr</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-top: 1px solid #000;'></td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>4.0hr</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-top: 1px solid #000;'></td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>12.0hr</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-top: 1px solid #000;'></td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>24.0hr</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-top: 1px solid #000;'></td>");
                Pages.Append("</tr>");


                Pages.Append("<tr>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>48.0hr</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-top: 1px solid #000;'></td>");
                Pages.Append("</tr>");


                Pages.Append("</tbody>");
                Pages.Append("</table></td></tr>");
                Pages.Append("</tbody></table></td></tr>");

                Pages.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='10' style='text-align: left; border: 1px solid #000; border-top: 0; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");
                Pages.Append("<tr>");
                Pages.Append("<th colspan='6' width='50%' style='border-right:1px solid #000; border-bottom:1px solid #000;'>Particulars of top up of fumigant at the end point of fumigation, if any undertaken</th>");
                Pages.Append("<th colspan='6' width='50%' style='border-bottom:1px solid #000;'></th>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th colspan='6' width='50%' style='border-right:1px solid #000; border-bottom:1px solid #000;'>Name & Signature of accredited Fumigation <br/> Operator with Date/Accreditation Number</th>");
                Pages.Append("<th colspan='6' width='50%' style='border-bottom:1px solid #000;'></th>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th colspan='6' width='50%' style='border-right:1px solid #000;'>Supervised by Specified officer of Dte PPQS (Applicable in case of non-accredited agency)</th>");
                Pages.Append("<th colspan='6' width='50%'></th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table></td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 30f, 30f, 30f, 30f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;

            }
            catch (Exception ex)
            {
                return "";
            }
        }


        public string LoadImage(string img)
        {

            if (img != "")
            {

                string strm = img;

                //this is a simple white background image
                var myfilename = string.Format(@"{0}", Guid.NewGuid());

                //Generate unique filename
                string filepath = Server.MapPath("~/Docs/QRCode/") + myfilename + ".jpeg";
                var bytess = Convert.FromBase64String(strm);
                using (var imageFile = new FileStream(filepath, FileMode.Create))
                {
                    imageFile.Write(bytess, 0, bytess.Length);
                    imageFile.Flush();
                }


                string targetpath = Server.MapPath("~/Docs/QRCode/") + myfilename + "crop" + ".jpeg";
                String newfilepath = Utility.ResizeImage(filepath, targetpath);
                return newfilepath;
            }
            else
            {
                return "";

            }
        }








        #region PCS Report



        [HttpGet]
        public ActionResult PCSReport()
        {

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetPCSReport(DSRPcsReportHeader ObjDailyPdaActivityReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<DSRPcsReport> LstDailyPdaActivityReport = new List<DSRPcsReport>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.GetPCSReport(ObjDailyPdaActivityReport);//, objLogin.Uid
            string Path = "";
            //  return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            if (ObjRR.DBResponse.Data != null)
            {
                LstDailyPdaActivityReport = (List<DSRPcsReport>)ObjRR.DBResponse.Data;

                Path = GeneratePCSReportPDF(LstDailyPdaActivityReport, ObjDailyPdaActivityReport.PeriodFrom, ObjDailyPdaActivityReport.PeriodTo);

                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }

        [NonAction]
        public String GeneratePCSReportPDF(List<DSRPcsReport> lstData, string fromDate, string todate)
        {
            try
            {

                var FileName = "PCSReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='300%' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:8pt;'>Near Indira Nagar Colony, Village - Dashrath <br/> Vadodara - 391740 </span><br/><span style='font-size:8pt;'><b>Email -</b> cwccfs@gmail.com</span><br/><label style='font-size: 8pt; font-weight:bold;'>PCS REPORT BETWEEN " + fromDate + " & " + todate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; font-size:7pt;'><thead>");
                Pages.Append("<tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Date of fumigation</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Place</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>CRT No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Date of Issue</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Chemical</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Dosages</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>No. Pkg.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>No.Cane/APL</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:12%;'>Name of Cargo</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:12%;'>Name of Exporter</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:12%;'>Container No - Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:right;'>Volume</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:right;'>FUM. AMOUNT</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:right;'>SGST</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:right;'>CGST</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:right;'>IGST</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:right;'>Total Amount</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Receipt No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Invoice No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:8%;text-align:right;'>Country Name</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");
                decimal TotalCons = 0M;
                decimal TotalPKG = 0M;
                int Total20 = 0;
                int Total40 = 0;
                int TotalTew = 0;
                decimal Volume = 0M;
                decimal Amount = 0M;
                decimal SGST = 0M;
                decimal CGST = 0M;
                decimal IGST = 0M;
                decimal Total = 0M;

                lstData.ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.FumigationDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Place + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CertificateNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.IssueDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Chemical + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Dosages + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.PKG + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.NoCane + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Cargo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Exporter + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Container + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:right;'>" + item.Volume + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:right;'>" + item.Amount + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:right;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:right;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:right;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;text-align:right;'>" + item.Total + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ReceiptNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Country + "</td></tr>");

                    TotalCons = TotalCons + (item.NoCane == "" ? 0 : Convert.ToDecimal(item.NoCane));
                    TotalPKG = TotalPKG + (item.PKG == "" ? 0 : Convert.ToDecimal(item.PKG));
                    Total20 = Total20 + (item.Size == 20 ? 1 : 0);
                    Total40 = Total40 + (item.Size == 40 ? 1 : 0);
                    Volume = Volume + Convert.ToDecimal(item.Volume);
                    Amount = Amount + Convert.ToDecimal(item.Amount);
                    SGST = SGST + Convert.ToDecimal(item.SGST);
                    CGST = CGST + Convert.ToDecimal(item.CGST);
                    IGST = IGST + Convert.ToDecimal(item.IGST);
                    Total = Total + Convert.ToDecimal(item.Total);
                });

                TotalTew = (Total20 + (Total40 * 2));

                Pages.Append("<tr><td colspan='9'><table cellspacing='0' cellpadding='5' style='width:100%; font-size:7pt;'><tbody><tr>");
                Pages.Append("<td style='width:110px;'>No. Of Certificate :</td>");
                Pages.Append("<td style='width:80px;'>" + lstData.GroupBy(x => x.CertificateNo).Count() + "</td>");
                Pages.Append("<td style='width:100px;'>Total Cons :</td>");
                Pages.Append("<td style='width:80px;'>" + TotalCons + "</td>");
                Pages.Append("<td style='width:90px;'>" + TotalPKG + "</td>");
                Pages.Append("<td style='width:90px;'>Grms.</td>");
                Pages.Append("<td style='width:110px;'>No. Of Teu's.:</td>");
                Pages.Append("<td style='width:360px;'><table cellspacing='0' cellpadding='5' style='border:1px solid #000; width:100%; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-right: 1px solid #000;'>20 Feet</th>");
                Pages.Append("<th style='border-right: 1px solid #000;'>40 Feet</th>");
                Pages.Append("<th>Teu's</th></tr></thead>");
                Pages.Append("<tbody><tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + Total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + Total40 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + TotalTew + "</td></tr></tbody>");
                Pages.Append("</table></td>");
                Pages.Append("</tr></tbody></table></td>");
                Pages.Append("<td style=''>Total</td>");
                Pages.Append("<td style=''></td>");
                Pages.Append("<td style=''>" + Volume + "</td>");
                Pages.Append("<td style=''>" + Amount + "</td>");
                Pages.Append("<td style=''>" + SGST + "</td>");
                Pages.Append("<td style=''>" + CGST + "</td>");
                Pages.Append("<td style=''>" + IGST + "</td>");
                Pages.Append("<td style=''>" + Total + "</td>");
                Pages.Append("<td colspan='3' style='solid #000;'>PCS INCHARGE</td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;

            }
            catch
            {
                return "";
            }
        }
        #endregion

        //#region PCS Payment Report

        //[HttpGet]
        //public ActionResult PCSPaymentReport()
        //{
        //    return PartialView();
        //}

        //[HttpPost]
        //[ValidateAntiForgeryToken]
        //public ActionResult GetPCSPaymentReport(PCSPaymentReport ObjPCSPaymentReport)
        //{
        //    DSR_ReportRepository ObjRR = new DSR_ReportRepository();
        //    PCSPaymentReport LstPCSPaymentReport = new PCSPaymentReport();
        //    Login objLogin = (Login)Session["LoginUser"];
        //    string df = Convert.ToDateTime(ObjPCSPaymentReport.PeriodFrom).ToString("yyyy-MM-dd");
        //    string dt = Convert.ToDateTime(ObjPCSPaymentReport.PeriodTo).ToString("yyyy-MM-dd");
        //    ObjRR.GetPCSPaymentReport(ObjPCSPaymentReport);//, objLogin.Uid
        //    string FilePath = "";
        //    if (ObjRR.DBResponse.Status == 1)
        //    {
        //        DataSet ds = (DataSet)ObjRR.DBResponse.Data;
        //        FilePath = GeneratingPDFforPCSPaymentReport(ds, Convert.ToDateTime(df).ToString("dd-MMM-yy"),Convert.ToDateTime(dt).ToString("dd-MMM-yy"));
        //        return Json(new { Status = 1, Data = FilePath });
        //    }
        //    else
        //        return Json(new { Status = -1, Data = "No Record Found." });

        //}

        //[NonAction]
        //public string GeneratingPDFforPCSPaymentReport(DataSet ds, string df, string dt)
        //{
        //    List<dynamic> lstCont = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);            
        //    List<string> lstSB = new List<string>();
        //    StringBuilder html = new StringBuilder();            

        //    var sumAmount = lstCont.AsEnumerable()
        //                .Sum(r => (decimal)r.Amount);


        //    html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

        //    html.Append("<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>ICD Dashrath</label><br/><label style='font-size: 12px;'>For Workslip</label><br/><label style='font-size: 14px; font-weight:bold;'>Daily Transaction Report</label></td></tr>");

        //    html.Append("<tr><td><br/><br/></td></tr>");            
        //    html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin:0;'><tbody>");
        //    html.Append("<tr><th style='font-size:13px; text-align:left;' width='30%'>PCS Payment Report Between :</th><td style='font-size:12px;' width='57%'>" + df + "</td> and <td style='font-size:12px;' width='57%'>" + dt + "</td>");
        //    html.Append("<th style='font-size:13px; text-align:right;'>Date : <span>&nbsp;</span></th><td style='font-size:12px;'>" + dt + "</td></tr></tbody></table></td></tr>");

        //    html.Append("<tr><td><br/><br/></td></tr>");

        //    html.Append("<tr><td colspan='12'><table style='border:1px solid #000;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
        //    html.Append("<thead><tr>");
        //    html.Append("<th style='text-align:left;padding:10px;border-bottom:1px solid #000;width:3%;'>SL No</th>");
        //    html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:12%;'>Invoice No.</th>");
        //    html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:5%;'>Certificate</th>");
        //    html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:12%;'>Receipt No</th>");
        //    html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Receipt Date</th>");
        //    html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Party Description</th>");
        //    html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Amount</th>");            
        //    html.Append("</tr></thead>");
        //    html.Append("<tbody>");

        //    lstCont.ForEach(item =>
        //    {
        //        html.Append("<tr>");
        //        html.Append("<td style='text-align:left;padding:10px;width:3%;'>" + item.SlNo + "</td>");
        //        html.Append("<td style='text-align:center;padding:10px;width:12%;'>" + item.invoiceNo + "</td>");
        //        html.Append("<td style='text-align:center;padding:10px;width:5%;'>" + item.CertificateNo + "</td>");
        //        html.Append("<td style='text-align:center;padding:10px;width:12%;'>" + item.ReceiptNo + "</td>");
        //        html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.ReceiptDate + "</td>");
        //        html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.PartyName + "</td>");
        //        html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.InvoiceAmt + "</td>");
        //        html.Append("</tr>");
        //    });

        //    html.Append("</tbody>");
        //    html.Append("</table></td></tr>");

        //    html.Append("<tr><td><br/><br/></td></tr>");            

        //    html.Append("</tr></tbody>");
        //    html.Append("</table></td></tr>");

        //    html.Append("<tr><td><br/><br/></td></tr>");
        //    html.Append("<tr><td colspan='12' style='font-size:13px;'>SUMMARY</td></tr>");            

        //    html.Append("</tbody></table>");
        //    lstSB.Add(html.ToString());

        //    var FileName = "DTR" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
        //    var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
        //    if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
        //    {
        //        System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
        //    }
        //    /*if (System.IO.File.Exists(location))
        //    {
        //        System.IO.File.Delete(location);
        //    }*/
        //    using (var rp = new ReportingHelper(PdfPageSize.A4Landscape, 20f, 40f, 20f, 20f, false, true))
        //    {
        //        rp.HeadOffice = "";
        //        rp.HOAddress = "";
        //        rp.ZonalOffice = "";
        //        rp.ZOAddress = "";
        //        rp.GeneratePDF(location, lstSB);
        //    }
        //    return "/Docs/" + Session.SessionID + "/" + FileName;
        //}


        //#endregion



        #region PARTY WISE DAILY SD TRANSACTION REPORT

        public ActionResult PartywiseDailySdTransactionReport()
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<PartyLedgerList> LstParty = new List<PartyLedgerList>();
            //ObjRR.GetEximTraderForPartyLedger();
            //if (ObjRR.DBResponse.Data != null)
            //{
            //    ViewBag.PartyList = new SelectList((List<DSRPartyLedgerList>)ObjRR.DBResponse.Data, "PartyId", "PartyName");
            //}
            //else
            //{
            //    ViewBag.PartyList = null;
            //}

            ObjRR.GetEximTraderForPartyLedger();
            if (ObjRR.DBResponse.Data != null)
            {
                ViewBag.PartyList = new SelectList((List<PartyLedgerList>)ObjRR.DBResponse.Data, "PartyId", "PartyName");
            }
            else
            {
                ViewBag.PartyList = null;
            }

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult PartywiseDailySdTransactionReport(DSR_SDTransactionPartyDetails vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=PdaTransactionReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetDailySDTransactionExcel(vm.FromDate, vm.ToDate, vm.PartyId);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(PartywiseDailySdTransactionReportPDF(ds, vm.FromDate, vm.ToDate));
            Response.End();


            return Content("xc");
        }



        private string PartywiseDailySdTransactionReportPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "PdaTransactionReport.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td width='300%' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>PARTY WISE DAILY SD TRANSACTION REPORT FOR FROM " + FromDate + " TO " + ToDate + "</h5></td></tr>";

            lstPartyDetails.ToList().ForEach(elem =>
            {
                decimal IMPSTO = 0M; decimal IMPINS = 0M; decimal IMPGRL = 0M; decimal IMPHT = 0M; decimal EXPSTO = 0M; decimal EMPINS = 0M;
                decimal EXPHTT = 0M; decimal EXPOTHS = 0M; decimal EXPHTN = 0M; decimal BNDSTO = 0M; decimal BNDINS = 0M; decimal BNDHT = 0M;
                decimal BNDOTHS = 0M; decimal WET = 0M; decimal ADM = 0M; decimal DOC = 0M; decimal CGSTAmt = 0M; decimal SGSTAmt = 0M;
                decimal IGSTAmt = 0M; decimal MISCT = 0M; decimal MISCN = 0M; decimal OTHS = 0M; decimal MPCS = 0M; decimal PCS = 0M;
                decimal RCTSEAL = 0M; decimal Total = 0M; decimal Deposite = 0M; decimal Creadit = 0M; decimal EXPGRE = 0M;
                decimal TotalTexable = 0M; decimal RoundUp = 0M; decimal GrossTotal = 0M;

                decimal Closing = 0M;
                Closing = Convert.ToDecimal(elem.OpeningBalance);
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'><tbody>";

                html += "<tr><td colspan='12' align='right'><b>Opening Balance :</b> " + elem.OpeningBalance + "</td></tr>";
                html += "<tr><td colspan='6' width='50%'><b>Name of Depositor Party :</b> " + elem.EximTraderName + "</td>";
                html += "<td colspan='6' width='50%' align='right'><b>Closing Balance :</b> " + elem.ClosingBalance + "</td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th colspan='5' style='border-right: 1px solid #000;'></th>";
                html += "<th colspan='4' style='border-right: 1px solid #000;'>IMPORT OPERATION</th>";
                html += "<th colspan='4' style='border-right: 1px solid #000;'>EXPORT OPERATION</th>";
                html += "<th colspan='3' style='border-right: 1px solid #000;'>BOND OPERATION</th>";
                html += "<th colspan='14'></th>";
                html += "</tr>";
                html += "<tr>";
                html += "<th width='150px' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Deposit Amount</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Credit</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INS</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>H&T</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GRL</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INS</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>H&T</th>";
                //  html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>H&T</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GRE</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INS</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>H&T</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Other</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>WB</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DOC/AMDT</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Miscllaneous</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PCS</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>RCTS</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Taxable Amount</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SGST</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CGST</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IGST</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Round Up</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gross Total</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>TDS Deduct</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Adjust</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Net Total</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Opening B. <br/> Closing B.</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                lstSDTransaction.Where(x => x.EximTraderId == elem.EximTraderId).ToList().ForEach(item =>
                {

                    if (item.Flag == 1)
                    {
                        Closing = Closing - Convert.ToDecimal(item.Total);
                    }
                    else
                    {
                        Closing = Closing + Convert.ToDecimal(item.Total);
                    }
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Deposite + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Creadit + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IMPSTO + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IMPINS + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IMPHT + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IMPGRL + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EXPSTO + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EXPINS + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EXPHTT + "</td>";
                    // html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EXPHTT + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EXPGRE + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BNDSTO + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BNDINS + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BNDHT + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OTHS + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.WET + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DOC + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MISCT + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PCS + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RCTSEAL + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TotalTexable + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SGSTAmt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CGSTAmt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGSTAmt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RoundUp + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GrossTotal + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>0</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>0</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Total + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + Closing + "</td>";
                    html += "</tr>";
                    IMPSTO = IMPSTO + item.IMPSTO;
                    IMPINS = IMPINS + item.IMPINS; IMPGRL = IMPGRL + item.IMPGRL; IMPHT = IMPHT + item.IMPHT; EXPSTO = EXPSTO + item.EXPSTO; EMPINS = EMPINS + item.EXPINS;
                    EXPGRE = EXPGRE + item.EXPGRE; EXPHTT = EXPHTT + item.EXPHTT; EXPOTHS = EXPOTHS + item.EXPOTHS; EXPHTN = EXPHTN + item.EXPHTN; BNDSTO = BNDSTO + item.BNDSTO; BNDINS = BNDINS + item.BNDINS; BNDHT = BNDHT + item.BNDHT;
                    BNDOTHS = BNDOTHS + item.BNDOTHS; WET = WET + item.WET; ADM = ADM + item.ADM; DOC = DOC + item.DOC; CGSTAmt = CGSTAmt + item.CGSTAmt; SGSTAmt = SGSTAmt + item.SGSTAmt;
                    IGSTAmt = IGSTAmt + item.IGSTAmt; MISCT = MISCT + item.MISCT; MISCN = MISCN + item.MISCN; OTHS = OTHS + item.OTHS; MPCS = MPCS + item.MPCS; PCS = PCS + item.PCS;
                    RCTSEAL = RCTSEAL + item.RCTSEAL; Total = Total + item.Total; Deposite = Deposite + item.Deposite; Creadit = Creadit + item.Creadit; TotalTexable = TotalTexable + item.TotalTexable; RoundUp = RoundUp + item.RoundUp;
                    GrossTotal = GrossTotal + item.GrossTotal;
                });
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: right;'>Total</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + lstSDTransaction.Where(x => x.EximTraderId == elem.EximTraderId).Count() + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: right;'>Total</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + Deposite + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + Creadit + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + IMPSTO + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + IMPINS + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + IMPHT + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + IMPGRL + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + EXPSTO + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + EMPINS + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + EXPHTT + "</th>";
                //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + EXPHTT + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + EXPGRE + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + BNDSTO + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + BNDINS + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + BNDHT + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + OTHS + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + WET + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + DOC + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + MISCT + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + PCS + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + RCTSEAL + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + TotalTexable + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + SGSTAmt + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + CGSTAmt + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + IGSTAmt + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + RoundUp + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + GrossTotal + "</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>0</th>";
                //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + Total + "</th>";
                //html += "<th style='border-top: 1px solid #000;'>" + Closing + "</th>";
                //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
                html += "<th style='border-top: 1px solid #000;border-right: 1px solid #000;'></th>";
                html += "</tr>";
                html += "</tbody>";
                html += "</table></td></tr>";
                html += "</tbody></table></td></tr>";
                html += "<tr><td><br/><br/></td></tr>";
            });
            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion


        #region Gate Operation Report in Excel

        public ActionResult GateOperationReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GateOperationReportExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetOperationExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(GateOperationReportExcelPDF(ds));
            Response.End();


            return Content("xc");
        }



        private string GateOperationReportExcelPDF(DataSet ds)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstGateDetails1 = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstGateDetails2 = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstGateDetails3 = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstGateDetails4 = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<dynamic> lstGateDetails5 = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[5]);
            List<dynamic> lstGateDetails6 = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[6]);
            List<dynamic> lstGateDetails7 = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[7]);
            List<dynamic> lstGateDetails8 = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[8]);
            List<dynamic> lstGateDetails9 = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[9]);
            List<dynamic> lstGateDetails10 = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[10]);
            List<dynamic> lstGateDetails11 = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[11]);
            // List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";

            //Report of Import Loaded Gate IN								
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Import Loaded Gate IN	</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='10'>By Train/Road</td></tr>";
            html += "<tr><td colspan='10' style='border-top: 1px solid #000;'>Import</td></tr>";
            html += "<tr><td colspan='10' style='border-top: 1px solid #000;'>Loaded</td></tr>";
            html += "<tr><th colspan='10' style='border-top: 1px solid #000;'>Report of Import Loaded Gate IN</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ENTRY DATE & TIME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SIZE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING LINE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Order No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Order Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-top: 1px solid #000;'>Importer</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EntryDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobOrderNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobOrderDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            //JOB Order Details																		
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Import Job Orders	</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='12'>JOB Order Details</td></tr>";
            html += "<tr><th colspan='12' style='border-top: 1px solid #000;'>Report of Import Job Orders</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Order Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Order No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Order Invoice</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Importer</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Payer Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Party Name</th>";
            html += "<th style='border-top: 1px solid #000;'>Port</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails1.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobOrderNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobOrderDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.PortName + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            //Report of Import Loaded OUT (Factory Destuffing)									
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Import Loaded OUT (Factory Destuffing)</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='11'>Import</td></tr>";
            html += "<tr><td colspan='11' style='border-top: 1px solid #000;'>Loaded</td></tr>";
            html += "<tr><th colspan='11' style='border-top: 1px solid #000;'>Report of Import Loaded OUT (Factory Destuffing)</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exit through Gate DATE (Gate Pass- Yard Factory Destuffing)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SIZE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING LINE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Importer</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Movement Type CWC/PVT (Yard Factory Destuffing)</th>";
            html += "<th style='border-top: 1px solid #000;'>Empty back to (Empty Port)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails2.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MovementType + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.EmptyPort + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            //Report of ICD Destuffed Containers							
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of ICD Destuffed Containers</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='9'>ICD DESTUFFING of Containers</td></tr>";
            html += "<tr><th colspan='9' style='border-top: 1px solid #000;'>Report of ICD Destuffed Containers</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ICD Destuffing Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SIZE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING LINE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Destuffing No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-top: 1px solid #000;'>Importer</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails3.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            //Report of Import Empty (FD) IN
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Import Empty (FD) IN</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='8'>By Road</td></tr>";
            html += "<tr><td colspan='8' style='border-top: 1px solid #000;'>Import</td></tr>";
            html += "<tr><td colspan='8' style='border-top: 1px solid #000;'>Empty (FD)</td></tr>";
            html += "<tr><th colspan='8' style='border-top: 1px solid #000;'>Report of Import Empty (FD) IN</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ENTRY DATE & TIME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SIZE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING LINE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-top: 1px solid #000;'>Importer</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails4.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EntryDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            //Report of Import Empty (FD) IN
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Import Empty (FD) IN</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='6'>By Road</td></tr>";
            html += "<tr><td colspan='6' style='border-top: 1px solid #000;'>Import</td></tr>";
            html += "<tr><td colspan='6' style='border-top: 1px solid #000;'>Empty</td></tr>";
            html += "<tr><th colspan='6' style='border-top: 1px solid #000;'>Report of Import Empty IN</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ENTRY DATE & TIME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SIZE</th>";
            html += "<th style='border-top: 1px solid #000;'>SHIPPING LINE</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails5.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EntryDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            //Report of Export Empty IN
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Export Empty IN</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='6'>By Road</td></tr>";
            html += "<tr><td colspan='6' style='border-top: 1px solid #000;'>Export</td></tr>";
            html += "<tr><td colspan='6' style='border-top: 1px solid #000;'>Empty</td></tr>";
            html += "<tr><th colspan='6' style='border-top: 1px solid #000;'>Report of Export Empty IN</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ENTRY DATE & TIME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SIZE</th>";
            html += "<th style='border-top: 1px solid #000;'>SHIPPING LINE</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails6.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EntryDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            //Report of ICD stuffing Container Out
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of ICD stuffing Container Out</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><th colspan='12'>Gate Out- GatePass(Export Payment Sheet)</th></tr>";
            html += "<tr><th colspan='12' style='border-top: 1px solid #000;'>Report of ICD stuffing Container Out</th></tr>";
            html += "<tr><td colspan='12' style='border-top: 1px solid #000;'>ICD Stuffing</td></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exit through Gate DATE (Gate Pass- Export Payment Sheet)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Move To (Export Payment Sheet)</th>";
            html += "<th style='border-top: 1px solid #000;'>Container Weight (Kg.) (Export Paymnet Sheet)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails7.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImpExpName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.GrossWt + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            //Report of Factory Stuffing Job Order
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Factory Stuffing Job Order</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><th colspan='12'>Gate Out- Gate Exit Factory Stuffing</th></tr>";
            html += "<tr><th colspan='12' style='border-top: 1px solid #000;'>Report of Factory Stuffing Job Order</th></tr>";
            html += "<tr><td colspan='12' style='border-top: 1px solid #000;'>Loaded Container Request (Factory Stuffing)</td></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exit through Gate DATE (Gate Exit Factory Stuffing)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Request No.(Gate Exit Factory Stuffing)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Distance (km)</th>";
            html += "<th style='border-top: 1px solid #000;'>Movement Type CWC/PVT (Gate Exit Factory Stuffing)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails8.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImpExpName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.LoadContReqNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Distance + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Movement + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            //Report of Empty Container Gate Out
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Empty Container Gate Out</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><th colspan='12'>Gate Out- Empty Container Gate Out</th></tr>";
            html += "<tr><th colspan='12' style='border-top: 1px solid #000;'>Report of Empty Container Gate Out</th></tr>";
            html += "<tr><td colspan='12' style='border-top: 1px solid #000;'>Empty Container Invoice</td></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exit through Gate DATE (Gate Pass- Empty Container Gate Out)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Party</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Payer</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Move To</th>";
            html += "<th style='border-top: 1px solid #000;'>Movement Type CWC/PVT  (Gate Pass- Empty Container Gate Out)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails9.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.MovementType + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            //Report of Export Loaded Container Gate IN
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Export Loaded Container Gate IN</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='10'>By Road</td></tr>";
            html += "<tr><td colspan='10' style='border-top: 1px solid #000;'>Export Loaded Container (Loaded Container Request)</td></tr>";
            html += "<tr><td colspan='10' style='border-top: 1px solid #000;'>Loaded IN</td></tr>";
            html += "<tr><th colspan='10' style='border-top: 1px solid #000;'>Report of Export Loaded Container Gate IN</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ENTRY DATE & TIME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reference No. (Loaded Container Request No.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-top: 1px solid #000;'>Exporter</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails10.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EntryDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'></td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.LoadContReqNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + " </td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            //Report of Export Loaded Container Gate OUT
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Export Loaded Container Gate OUT</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='10'>By Road</td></tr>";
            html += "<tr><td colspan='10' style='border-top: 1px solid #000;'>Export Loaded Container (Loaded Container Request)</td></tr>";
            html += "<tr><td colspan='10' style='border-top: 1px solid #000;'>Loaded OUT</td></tr>";
            html += "<tr><th colspan='10' style='border-top: 1px solid #000;'>Report of Export Loaded Container Gate OUT</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exit through Gate DATE (Gate Pass- Loaded Container Payment Sheet)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transfer To (Loaded Container Payment Sheet)</th>";
            html += "<th style='border-top: 1px solid #000;'>Container Weight</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails11.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImpExpName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.PortName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.GrossWt + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        #endregion

        #region Import Report in Excel

        public ActionResult ImportReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportReporExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            // html += "<tr><td width='100%' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>REPORT IN EXCEL </h5></td></tr>";
            html += "<tr><td width='300%' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>IMPORT EXCEL REPORT FOR FROM " + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            //html += "<tr>";
            //html += "<th colspan='1' style='border-right: 1px solid #000;'></th>";
            //html += "<th colspan='16' style='border-right: 1px solid #000;'>OBL Entry Details</th>";
            //html += "<th colspan='16' style='border-right: 1px solid #000;'>Loaded GATE IN</th>";
            //html += "<th colspan='6' style='border-right: 1px solid #000;'>CUSTOM EXAMINATION</th>";
            //html += "<th colspan='17' style='border-right: 1px solid #000;'>De-Stufiing Details</th>";            
            //html += "<th colspan='4' style='border-right: 1px solid #000;'>Yard Payment Sheet</th>";
            //html += "<th colspan='4' style='border-right: 1px solid #000;'>Yard Payment Sheet (Reassessment)</th>";
            //html += "<th colspan='7' style='border-right: 1px solid #000;'>GATE OUT details For Containers (Yard - Factory Destuffing)</th>";
            //html += "<th colspan='4' style='border-right: 1px solid #000;'>Delivery Application to Invoice Checking</th>";
            //html += "<th colspan='4' style='border-right: 1px solid #000;'>Godown Delivery Payment Sheet(Reassessment)</th>";
            //html += "<th colspan='6' style='border-right: 1px solid #000;'>GATE OUT details For Cargo Delivery</th>";
            //html += "<th colspan='4' style='border-right: 1px solid #000;'>Cargo Shifting to PBW</th>";
            //html += "<th colspan='21' style='border-right: 1px solid #000;'>Import RCT Sealing</th>";
            //html += "<th colspan='1' style='border-right: 1px solid #000;'>Empty(FD) Back IN ICD Date</th>";
            //html += "</tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IGM NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IGM DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>PKGS</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Commodity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo Type (Gen/Hazardous)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo description</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR wt (Kg.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF VALUE (Rs.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IEC Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>SLA Cd</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>POL (foreign port)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>POD (India's Port)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Job-Order No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Job-Order Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CFS Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IN DATE & TIME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR WT of container</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Status (Loaded/Empty)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Movement By (CWC/ Private)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Customs seal no</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping/Agent seal no</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container type (Open Top, Over Dimension, Normal, Flat Rake)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container class (Gen/Haz, Reefer)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container received from (Port /RCT)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Remarks</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>APPRAISEMENT NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>BOE No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>BOE DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF (Rs.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty (Rs.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Examination type (RMS/UPTO  25%/ BEYOND 25%)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>ISO CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GODOWN NO/Loaded Yard/Empty Yard</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>SLOT/STACK Location</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Pkgs in Bill of Entry</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Pkgs Received</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>PKG type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>AREA(Sqm)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>De-Stuffing No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>De-Stuffing date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gr wt (kgs)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo Type(Gen/Haz)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Via No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vessel Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Main Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Remarks</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Movement By (CWC/ Private)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Empty Back to (ICD/Golden/Kishan Marine/ Other)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Movement By (CWC/ Private)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Empty Back to (ICD/Golden/Kishan Marine/ Other)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Custom Seal No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Pass No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>No.of PKG</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate pass date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Out date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Remarks</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Entry No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Delivery No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Entry No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Delivery No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Pass No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>No.of PKG</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate pass date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Out date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Remarks</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Entry No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Delivery No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>BOE NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>BOE  DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL DATE</th>";//20
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IGM NO</th>";//19
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IGM DATE</th>";//18
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>PKGS</th>";//17
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Commodity</th>";//16
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo Type (Gen/Hazardous)</th>";//15
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo description</th>";//14
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR wt</th>";//13
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF VALUE</th>";//12
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";//11
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IEC Code</th>";//10
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";//9
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Consignee Name</th>";//8
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Consignee Address</th>";//7
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>SLA Cd</th>";//6
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Cd</th>";//5
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>POL (foreign port)</th>";//4
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>POD (India's Port)</th>";//3
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Empty(FD) Back IN ICD Date</th>";//2
            html += "<th style='border-top: 1px solid #000; padding:20px;'>Shipping Line DO Validity</th>";//1
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.bolno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.boldate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.igmno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.igmdate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.noofpkg + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.commodityname + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargotype + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargodescription + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.grossweights + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cifvalue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IECCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cha + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.importer + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.sla + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.pol + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.POD + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.vehicleno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.referenceno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.referencedate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cfscode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.entrydatetime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.containerno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GrossWeight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.containertype + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.movement + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CustomSealNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineSealNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.containerrtype + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.containerclass + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.portname + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.remarks + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BOENo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BOEDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cif + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExamType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.container + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.sizee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.isocode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GodownName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.LocationNames + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfPackages + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceivedPackages + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.pkgtype + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.area + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gwt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.viano + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.vesselname + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MainLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.remark + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoiceno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExpMovementType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExpEmptyPort + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invod + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.mvm + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.expex + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.WithoutDOSealNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gatepassno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.vehicleno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfUnits + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gatepassdate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.remarkkk + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicenoo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedatee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.destuffno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.deliveryno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.inv + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invd + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.des + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.del + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gps + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gpv + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gnu + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gpd + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gpex + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gpre + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoino + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoiceda + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.stuffingreqno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.deno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.boenoo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.boedatee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBLNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBLDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.igmnoo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.igmdatee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfPkgg + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.commodity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargotypee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargodesription + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GrossWt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FobValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Dutyy + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ieccodee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyAddress + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLinaName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.portnamee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.podd + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.entrydttm + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ValidDate + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        //import obl entry report






        #endregion

        #region Bond Report in Excel

        #region Space Availability

        public ActionResult BondReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetBondReportExcelSAC(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=BondReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetBondReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(BondReportExcelSACPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string BondReportExcelSACPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstSACDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "SACTransactionReport.pdf";
            string html = "<html><body>";

            //SAC DETAILS
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>SAC DETAILS</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC AREA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC VALID UPTO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOL NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOL DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOE NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOE DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IGM NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IGM DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PKGS</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>NATURE OF PKG</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Commodity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GR wt</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CARGO VALUE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Duty</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STORAGE TYPE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>AREA TYPE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INVOICE NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INVOICE DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PARTY NAME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PAYER NAME</th>";
            html += "<th style='border-top: 1px solid #000;'>REMARKS</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstSACDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SacDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SacNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SacArea + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SacValidUpto + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBLNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBLDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BOENo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BOEDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGMNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGMDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfUnits + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NatureOfPackages + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ComodityName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Weight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AssessCIFvalue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DutyAmt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StorageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SpaceType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Party + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Payee + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            //IN BOND DETAILS
            //html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            //html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>IN BOND DETAILS</h5></td></tr>";
            //html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            //html += "<thead>";
            //html += "<tr>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DEPOSIT DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DEPOSIT NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IMPORTER Name</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA Name</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GODOWN NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STACK NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOE NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOE  DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IGM NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IGM DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOND NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOND DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PKGS</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Commodity</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo Type (Gen/Hazardous)</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GR wt</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CARGO VALUE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Duty</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>AREA OCCUPIED</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            //html += "<th style='border-top: 1px solid #000;'>REMARKS</th>";
            //html += "</tr>";
            //html += "</thead>";
            //html += "<tbody>";
            //lstDepositDetails.ToList().ForEach(item =>
            //{
            //    try
            //    {
            //        html += "<tr>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DepositDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DepositNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GodownNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StackNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SACNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SacDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondBOENo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondBOEDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGMNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGMDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Pkgs + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Commodity + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoType + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Weight + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondValue + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondDuty + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AreaOccupied + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
            //        html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
            //        html += "</tr>";

            //        i++;
            //    }
            //    catch (Exception Ex)
            //    {

            //    }
            //});
            //html += "</tbody>";
            //html += "</table></td></tr>";
            //html += "</tbody></table>";

            ////IN BOND DETAILS
            //html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            //html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>IN BOND DETAILS</h5></td></tr>";
            //html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            //html += "<thead>";
            //html += "<tr>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DELIVERY ORDER DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DELIVERY ORDER NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IMPORTER Name</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA Name</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GODOWN NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STACK NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOE NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOE  DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IGM NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IGM DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOND NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOND DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EX BOE NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EX BOE DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DELIVERY PKG</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>REMAINING PKG</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DELIVERY GR wt</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>REMAINING GR wt</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIF</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>REMAINING CIF</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Duty</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>REMAINING DUTY</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>AREA RELEASED</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>REMAINING AREA</ th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INVOICE NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INVOICE DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PARTY NAME</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PAYER NAME</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STORAGE PAID UPTO DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INSURANCE PAID UPTO DATE</th>";
            //html += "<th style='border-top: 1px solid #000;'>REMARKS</th>";
            //html += "</tr>";
            //html += "</thead>";
            //html += "<tbody>";
            //lstDeliveryDetails.ToList().ForEach(item =>
            //{
            //    try
            //    {
            //        html += "<tr>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryOrderDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryOrderNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SACNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SacDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GodownNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StackNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondBOENo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondBOEDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGMNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGMDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExBoeNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExBoeDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryPkg + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RemainingPkg + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryWt + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RemainingWt + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryValue + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ClosingValue + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryDuty + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ClosingDuty + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryArea + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RemainingArea + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Party + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Payee + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StoragePaidUptoDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InsurancePaidUptoDate + "</td>";
            //        html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
            //        html += "</tr>";

            //        i++;
            //    }
            //    catch (Exception Ex)
            //    {

            //    }
            //});
            //html += "</tbody>";
            //html += "</table></td></tr>";
            //html += "</tbody></table>";

            ////GATE OUT details For Containers														
            //html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            //html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>GATE OUT details For Containers</h5></td></tr>";
            //html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            //html += "<thead>";
            //html += "<tr>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Out Date</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Out No</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass No</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass Date</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INVOICE NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INVOICE DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IMPORTER Name</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA Name</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC NO</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC DATE</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GODOWN NO.</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STACK NO.</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo Type (Gen/Hazardous)</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DELIVERY PKG</th>";
            //html += "<th style='border-top: 1px solid #000;'>DELIVERY GR wt</th>";
            //html += "</tr>";
            //html += "</thead>";
            //html += "<tbody>";
            //lstExitDetails.ToList().ForEach(item =>
            //{
            //    try
            //    {
            //        html += "<tr>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateOutDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SACNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SacDate + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GodownNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StackNo + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoType + "</td>";
            //        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryPkg + "</td>";
            //        html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.DeliveryWeight + "</td>";
            //        html += "</tr>";

            //        i++;
            //    }
            //    catch (Exception Ex)
            //    {

            //    }
            //});
            //html += "</tbody>";
            //html += "</table></td></tr>";
            //html += "</tbody></table>";

            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region Bond Deposit Excel

        public ActionResult BondReportExcelDEP()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetBondReportExcelDEP(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=BondReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetBondReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(BondReportExcelDEPPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string BondReportExcelDEPPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstDepositDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);

            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "BondDepositTransactionReport.pdf";
            string html = "<html><body>";
            var i = 1;

            //IN BOND DETAILS
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>IN BOND DETAILS</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DEPOSIT DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DEPOSIT NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GODOWN NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STACK NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOE NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOE  DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IGM NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IGM DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOND NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOND DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PKGS</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Commodity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo Type (Gen/Hazardous)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GR wt</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CARGO VALUE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Duty</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>AREA OCCUPIED</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-top: 1px solid #000;'>REMARKS</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstDepositDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DepositDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DepositNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GodownNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StackNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SACNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SacDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondBOENo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondBOEDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGMNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGMDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Pkgs + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Commodity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Weight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondDuty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AreaOccupied + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";
            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region Bond Delivery Excel

        public ActionResult BondReportExcelDEL()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetBondReportExcelDEL(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=BondReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetBondReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(BondReportExcelDELPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string BondReportExcelDELPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstDeliveryDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);

            var FileName = "BondDeliveryTransactionReport.pdf";
            string html = "<html><body>";
            var i = 1;

            //IN BOND DETAILS
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>EX BOND DETAILS</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DELIVERY ORDER DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DELIVERY ORDER NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GODOWN NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STACK NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOE NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOE  DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IGM NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IGM DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOND NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BOND DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EX BOE NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EX BOE DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DELIVERY PKG</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>REMAINING PKG</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DELIVERY GR wt</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>REMAINING GR wt</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIF</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>REMAINING CIF</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Duty</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>REMAINING DUTY</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>AREA RELEASED</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>REMAINING AREA</ th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INVOICE NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INVOICE DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PARTY NAME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PAYER NAME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STORAGE PAID UPTO DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INSURANCE PAID UPTO DATE</th>";
            html += "<th style='border-top: 1px solid #000;'>REMARKS</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstDeliveryDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryOrderDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryOrderNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SACNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SacDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GodownNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StackNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondBOENo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondBOEDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGMNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGMDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExBoeNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExBoeDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryPkg + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RemainingPkg + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryWt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RemainingWt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ClosingValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryDuty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ClosingDuty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryArea + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RemainingArea + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Party + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Payee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StoragePaidUptoDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InsurancePaidUptoDate + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region Bond Gate Exit and Gate Pass Excel

        public ActionResult BondReportExcelGate()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetBondReportExcelGate(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=BondReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetBondReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(BondReportExcelGatePDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string BondReportExcelGatePDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstExitDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);

            var FileName = "BondGateOutTransactionReport.pdf";
            string html = "<html><body>";
            var i = 1;

            //GATE OUT details For Containers														
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>GATE OUT details For Containers</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Out Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Out No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INVOICE NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>INVOICE DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SAC DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GODOWN NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STACK NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo Type (Gen/Hazardous)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DELIVERY PKG</th>";
            html += "<th style='border-top: 1px solid #000;'>DELIVERY GR wt</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstExitDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateOutDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SACNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SacDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GodownNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StackNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DeliveryPkg + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.DeliveryWeight + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #endregion





        #region External User Login 


        [HttpGet]
        public ActionResult BulkInvoiceReportExternalUser()
        {

            Login objLogin = (Login)Session["LoginUser"];
            ViewBag.PartyId = objLogin.EximTraderId;
            ViewBag.PartyName = objLogin.Name;
            return PartialView();
        }

        [HttpPost]
        //[ValidateAntiForgeryToken]
        public JsonResult GetBulkInvoiceReportForExternalUser(DSRBulkInvoiceReport ObjBulkInvoiceReport)
        {
            if (ObjBulkInvoiceReport.InvoiceNumber == null)
            {
                ObjBulkInvoiceReport.InvoiceNumber = "";
            }
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            ObjBulkInvoiceReport.PartyId = objLogin.EximTraderId;
            //When Module is selected All Condition against a party

            if (ObjBulkInvoiceReport.InvoiceModule == "All")
            {
                string ModuleName = "";
                //delete all the files in the folder before creating it
                if (System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    string deletelocation = Server.MapPath("~/Docs/All/") + Session.SessionID + "/";
                    DeleteDirectory(deletelocation);
                }

                //get all the distinct invoice module and invoices list with respect to party and date range 
                ObjRR.ModuleListWithInvoiceExternalUser(ObjBulkInvoiceReport);
                if (ObjRR.DBResponse.Status == 1)
                {
                    DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                    List<dynamic> lstModule = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
                    IList lstDistModule = lstModule.Select(x => x.Module).Distinct().ToList();
                    string FilePath = "";


                    foreach (string Mod in lstDistModule)
                    {
                        //lstModule.Where(x => x.Module == Mod).ToList().ForEach(itemInv =>
                        //{
                        //    String ModuleName= itemInv.Module;
                        switch (Mod)
                        {
                            //Here ds is list of invoice of a module between two dates 
                            case "IMPYard":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "ASSESSMENT SHEET FCL";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforYard((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "IMPDeli":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "ASSESSMENT SHEET LCL";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforGodown((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "EXPLod":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "LOADED CONTAINER PAYMENT SHEET";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforContainer((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "EXPMovement":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "CONTAINER MOVEMENT";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforContainerMov((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "EXP":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "EXPORT PAYMENT SHEET";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforContainerMov((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "CCIN":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "CCIN ENTRY";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforCCINEntry((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "BTT":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "BTT";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBTT((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "AUC":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Auction";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforAuction((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "EC":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "EMPTY CONTAINER PAYMENT SHEET";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforEmptyContainer((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "ECTrns":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "EMPTY CONTAINER TRANSFER";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforEmptyContainer((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "IMPSC":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "SEAL CUTTING";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforSealCutting((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "PEST":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "PEST";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforPest((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "EXPCRGSHFT":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "CARGO SHIFTING";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforCargoSF((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "Fumigation":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "FUMIGATION";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforFumigationInvoice((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "EXPCS":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "EXPORT CONTAINER STUFFING";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforContainerStuffingInvoice((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "BTTCon":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "EXPORT BTT CONTAINER ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBTTContainerInvoice((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "RCTSeal":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "RCT SEALING ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforRCTSealing((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "EXPGRE":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Export GRE Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforExpGRE((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "BND":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Bond Delivery Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBND((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "bnd":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Bond Delivery Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBND((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "BNDadv":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Bond Advance Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBondWhiteField((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "BNDAdv":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Bond Advance Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBondWhiteField((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "BNDAdvance":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Bond Advance Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBondAdvanceWhiteField((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "BNDUnloading":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Bond Unloading Payment Sheet ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforBonUnloadingInvoice((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "RESERV":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "RESERVATION ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingReservationBulkPDFforGE((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                            case "Rent":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Rent ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforRentInvoice((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            case "IMPRCTSeal":
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                ModuleName = "Import RCT Seal ";
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforImportRCTSealing((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;

                            default:
                                ObjBulkInvoiceReport.InvoiceModule = Mod;
                                //case statement for printing name of invoices                                
                                if (Mod == "GE") { ModuleName = "GATE ENTRY"; }
                                else if (Mod == "IMPFCLLCL") { ModuleName = "FCL To LCL CONVERSION"; }
                                else if (Mod == "MiscInv") { ModuleName = "MISCELLANEOUS"; }
                                /*  else if (Mod == "EXPCS") { ModuleName = "EXPORT CONTAINER STUFFING"; }*/
                                //else if (Mod == "RENT") { ModuleName = "RENT"; }
                                //else if (Mod == "RESERV") { ModuleName = "RESERVATION"; }
                                else if (Mod == "IRR") { ModuleName = "IRR"; }
                                else if (Mod == "INVDEBT") { ModuleName = "CONTAINER DEBIT INVOICE"; }
                                else if (Mod == "EXPRRCD") { ModuleName = "EXPORT RR CREDIT DEBIT"; }
                                else if (Mod == "JO") { ModuleName = "JOB ORDER"; }
                                else ModuleName = Mod;
                                ObjBulkInvoiceReport.All = "All";
                                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);
                                FilePath = GeneratingBulkPDFforGE((DataSet)ObjRR.DBResponse.Data, ModuleName, ObjBulkInvoiceReport.All);
                                break;
                        }
                        //});

                    }
                    return Json(new { Status = 1, Data = FilePath });
                }
                else
                    return Json(new { Status = -1, Data = "No Record Found." });
            }

            else
            {
                // List<DSRInvoiceGate> DSRInvoiceGateList = ObjRR.GetBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);//, objLogin.Uid
                ObjRR.GenericBulkInvoiceDetailsForPrintForExternalUser(ObjBulkInvoiceReport);//, objLogin.Uid

                if (ObjRR.DBResponse.Status == 1)
                {
                    DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                    //string FilePath = GeneratingBulkPDF(DSRInvoiceGateList, ObjBulkInvoiceReport.InvoiceModuleName);
                    string FilePath = "";
                    switch (ObjBulkInvoiceReport.InvoiceModule)
                    {
                        case "IMPYard":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforYard(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "IMPDeli":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforGodown(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EXPLod":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforContainer(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EXPMovement":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforContainerMov(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;

                        case "EXP":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforContainerMov(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "CCIN":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforCCINEntry(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BTT":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforBTT(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "PEST":
                            FilePath = GeneratingBulkPDFforPest(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;

                        case "AUC":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforAuction(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EC":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforEmptyContainer(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "ECTrns":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforEmptyContainer(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "IMPSC":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforSealCutting(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EXPCRGSHFT":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforCargoSF(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "Fumigation":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforFumigationInvoice(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EXPCS":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforContainerStuffingInvoice(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BND":
                            FilePath = GeneratingBulkPDFforBND(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "bnd":
                            FilePath = GeneratingBulkPDFforBND(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BNDadv":
                            FilePath = GeneratingBulkPDFforBondWhiteField(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BNDAdv":
                            FilePath = GeneratingBulkPDFforBondWhiteField(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BNDAdvance":
                            FilePath = GeneratingBulkPDFforBondAdvanceWhiteField(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BNDUnloading":
                            FilePath = GeneratingBulkPDFforBonUnloadingInvoice(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "BTTCon":

                            FilePath = GeneratingBulkPDFforBTTContainerInvoice(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;

                        case "RESERV":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingReservationBulkPDFforGE(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "Rent":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforRentInvoice(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "RCTSeal":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforRCTSealing(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "IMPRCTSeal":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforImportRCTSealing(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        case "EXPGRE":
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforExpGRE(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                        default:
                            ObjBulkInvoiceReport.All = "";
                            FilePath = GeneratingBulkPDFforGE(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                            break;
                    }

                    return Json(new { Status = 1, Data = FilePath });
                }
                else
                    return Json(new { Status = -1, Data = "No Record Found." });
            }
        }

        #endregion



        #region External User Login For Bulk Report

        [HttpGet]
        public ActionResult BulkReceiptReportExternalUser()
        {
            return PartialView();
        }
        [HttpPost]
        //[ValidateAntiForgeryToken]
        public JsonResult GetBulkReceiptReportExternalUser(BulkReceiptReport ObjBulkReceiptReport)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.GetBulkCashreceiptForExternalUser(ObjBulkReceiptReport.PeriodFrom, ObjBulkReceiptReport.PeriodTo, ObjBulkReceiptReport.ReceiptNumber, objLogin.EximTraderId);
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                string Path = GenerateBulkReceiptReport(ds);
                return Json(new { Status = 1, Message = Path });
            }
            return Json(new { Status = 0, Message = "No Data Found" });
        }

        [HttpGet]
        [CustomValidateAntiForgeryToken]
        public ActionResult ListOfInvoiceDateWiseExternalUser(string FromDate, string ToDate, string invoiceType)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<invoiceLIst> LstinvoiceLIst = new List<invoiceLIst>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.GetInvoiceListExternalUser(FromDate, ToDate, invoiceType, objLogin.EximTraderId);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                //LstinvoiceLIst = (List<invoiceLIst>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }

        }

        [HttpGet]
        [CustomValidateAntiForgeryToken]
        public ActionResult ListOfReceiptDateWiseForExternalUser(string FromDate, string ToDate)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.GetReceiptListForExternalUser(FromDate, ToDate, objLogin.EximTraderId);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        #endregion

        #region External User Login For BulkCredit Note
        [HttpGet]
        public ActionResult GetBulkCreditNoteExternalUser()
        {
            return PartialView();
        }

        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult GetBulkCreditNoteReportForExternalUser(FormCollection fc)
        {
            DSR_ReportRepository objRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            objRR.GetBulkCreditNoteReportForExternalUser(Convert.ToDateTime(fc["PeriodFrom"]).ToString("yyyy/MM/dd"), Convert.ToDateTime(fc["PeriodTo"]).ToString("yyyy/MM/dd"), objLogin.EximTraderId);
            List<string> lststring = new List<string>();
            if (objRR.DBResponse.Data != null)
            {
                lststring = (List<string>)objRR.DBResponse.Data;
                List<string> pdfPages = new List<string>();
                /*PDF Gneration*/
                string Path = Server.MapPath("~/Docs/") + Session.SessionID + "/";
                string FileName = "BulkCRNote" + "CR" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                    Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                lststring.ForEach(item =>
                {
                    if (!string.IsNullOrEmpty(item) && item != "")
                    {
                        item = System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(item));
                        pdfPages.Add(item.Replace("|_br_|", "<br/>"));
                    }
                });
                //using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f))
                //{
                //    rh.GeneratePDF(Path + FileName, pdfPages.ToArray());
                //}
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(Path + FileName, pdfPages.ToArray());

                }
                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/" + FileName });
            }
            else
                return Json(new { Status = -1, Message = "No Data" });
        }
        #endregion


        #region External User Login For Bulk DebitNote
        [HttpGet]
        public ActionResult GetBulkDeditNoteExternalUser()
        {
            return PartialView();
        }

        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult GetBulkDebitNoteReportExternalUser(FormCollection fc)
        {
            DSR_ReportRepository objRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            objRR.GetBulkDebitNoteReportForExternalUser(Convert.ToDateTime(fc["PeriodFrom"]).ToString("yyyy/MM/dd"), Convert.ToDateTime(fc["PeriodTo"]).ToString("yyyy/MM/dd"), objLogin.EximTraderId);
            List<string> lststring = new List<string>();
            if (objRR.DBResponse.Data != null)
            {
                lststring = (List<string>)objRR.DBResponse.Data;
                List<string> pdfPages = new List<string>();
                /*PDF Gneration*/
                string Path = Server.MapPath("~/Docs/") + Session.SessionID + "/";
                string FileName = "BulkDRNote" + "DR" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                    Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                lststring.ForEach(item =>
                {
                    if (!string.IsNullOrEmpty(item) && item != "")
                    {
                        item = System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(item));
                        pdfPages.Add(item.Replace("|_br_|", "<br/>"));
                    }
                });
                //using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f))
                //{
                //    rh.GeneratePDF(Path + FileName, pdfPages.ToArray());
                //}

                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(Path + FileName, pdfPages.ToArray());

                }
                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/" + FileName });
            }
            else
                return Json(new { Status = -1, Message = "No Data" });
        }
        #endregion

        #region Party Ledger For External User
        public ActionResult SDDetailsReportForExternalUser()
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            ViewBag.PartyId = objLogin.EximTraderId;
            ViewBag.PartyName = objLogin.Name;
            return PartialView();
        }

        #endregion


        #region Export Shipping Bill Details (CCIN Entry) Report in Excel

        public ActionResult ExportShippingBillReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportShippingBillReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportShippingBillReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportShippingBillReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportShippingBillReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportShippingBillReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstShippingDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportShippingBillReportExcel.pdf";
            string html = "<html><body>";

            //Shipping Bill Details (CCIN Entry)													
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Shipping Bill Details (CCIN Entry)</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CCIN Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SB DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PKGS</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Commodity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo type (Gen/Haz)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GR wt (Kg)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB (Rs.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Consignee Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Consignee Address</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PKG type</th>";
            html += "<th style='border-top: 1px solid #000;'>Port of Discharge (Foreign Port)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstShippingDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CCINDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SBDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SBNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Package + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CommodityName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Weight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FOB + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ConsigneeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ConsigneeAdd + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PackageType + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.PortOfDischarge + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export Entry Through Gate CBT Report in Excel

        public ActionResult ExportCBTGateInReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportCBTGateInReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportCBTGateInReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportCBTGateInReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportCBTGateInReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportCBTGateInReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstCBTGateInDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportCBTGateInReportExcel.pdf";
            string html = "<html><body>";

            //Entry Through Gate CBT													
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Entry Through Gate CBT</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CBT Gate In date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Entry No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CCIN No.</th>";
            html += "<th style='border-top: 1px solid #000;'>Actual PKG Received</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstCBTGateInDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CBTGateIndate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SBNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateInNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CCINNo + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ActualPackages + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export Carting Register Report in Excel

        public ActionResult ExportCartingReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportCartingReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportCartingReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportCartingReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportCartingReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportCartingReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstCartingDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportCartingReportExcel.pdf";
            string html = "<html><body>";

            //Carting Register												
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Carting Register</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Carting Register Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Carting REGISTER No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Godown Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Pkgs received</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Manual Weight</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Mechanical Weight</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Area</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo type (Gen/Haz)</th>";
            html += "<th style='border-top: 1px solid #000;'>Cargo Description</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstCartingDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RegisterDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CartingRegisterNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GodownName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PkgReceived + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ManualWT + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MechanicalWT + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Area + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoType + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.CargoDescription + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export Carting Register Short Cargo Entry Report in Excel

        public ActionResult ExportCartingShortCargoReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportCartingShortCargoReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportCartingShortCargoReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportCartingShortCargoReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportCartingShortCargoReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportCartingShortCargoReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstShortCargoDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportCartingShortCargoReportExcel.pdf";
            string html = "<html><body>";

            //Short Cargo Entry											
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Short Cargo Entry</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Short Cargo Carting Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Carting REGISTER No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Godown Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Pkgs received</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Manual Weight</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Mechanical Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Area</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo type (Gen/Haz)</th>";
            html += "<th style='border-top: 1px solid #000;'>Cargo Description</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstShortCargoDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";

                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RegisterDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CartingRegisterNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GodownName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PkgReceived + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ManualWT + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MechanicalWT + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Area + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoType + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.CargoDescription + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export Stuffing Request Details Report in Excel

        public ActionResult ExportStuffingRequestReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportStuffingRequestReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportStuffingRequestReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportStuffingRequestReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportStuffingRequestReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportStuffingRequestReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstStuffingReqDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportStuffingRequestReportExcel.pdf";
            string html = "<html><body>";

            //Stuffing Request Details										
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Stuffing Request Details</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffing req date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffing req no</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Forwarder</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Main Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vessel</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Voyage</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Quantity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Weight</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB</th>";
            html += "<th style='border-top: 1px solid #000;'>FCL/LCL</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstStuffingReqDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RequestDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffingReqNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Forwarder + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MainLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Vessel + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Voyage + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffQuantity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffWeight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Fob + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.StuffingType + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export Container Stuffing Report in Excel

        public ActionResult ExportContainerStuffingReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportContainerStuffingReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportContainerStuffingReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportContainerStuffingReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportContainerStuffingReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportContainerStuffingReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstContainerStufiingDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportContainerStuffingReportExcel.pdf";
            string html = "<html><body>";

            //Container Stufiing									
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Container Stufiing</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Stuffing date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STUFFING Sheet NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container type (Genral/ flat rake/ odc/ open top)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container class(Gen/haz)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reefer (Yes/No)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Via</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vessel Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Quantity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Weight</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Loading</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Discharge (Foreign Port)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Final Destination Location</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Insured</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Palletisation</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reworking</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Lift Off Empty</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Customs seal no</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line Seal No</th>";
            html += "<th style='border-top: 1px solid #000;'>Remarks</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstContainerStufiingDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffingDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffingNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerClass + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Refer + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Via + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VesselName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffQuantity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffWeight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Fob + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofLoading + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofDischarge + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FinalDestinationLocation + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Insured + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Palletaisation + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Reworking + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.LiftOffEmpty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CustomSeal + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingSeal + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export Stuffing Payment Sheet Report in Excel

        public ActionResult ExportStuffingPaymentReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportStuffingPaymentReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportStuffingPaymentReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportStuffingPaymentReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportStuffingPaymentReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportStuffingPaymentReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstStuffingPaymentDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportStuffingPaymentReportExcel.pdf";
            string html = "<html><body>";

            //ICD Stuffing Payment Sheet (Export Payment Sheet)									
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>ICD Stuffing Payment Sheet (Export Payment Sheet)</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STUFFING Sheet </th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Party Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Payer Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Empty IN Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffing Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GR wt for container</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Move To</th>";
            html += "<th style='border-top: 1px solid #000;'>Remarks</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstStuffingPaymentDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffingSheetNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLinaName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Exporter + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ArrivalDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffingDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TotalGrossWt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MoveTo + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export GATE Pass (Export Payment Sheet) Report in Excel

        public ActionResult ExportGatePassReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportGatePassReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportGatePassReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportGatePassReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportGatePassReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportGatePassReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstGatePassDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportGatePassReportExcel.pdf";
            string html = "<html><body>";

            //GATE Pass (Export Payment Sheet)								
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>GATE Pass (Export Payment Sheet)</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Out Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GR wt for container</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Loading</th>";
            html += "<th style='border-top: 1px solid #000;'>Remarks</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstGatePassDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Exporter + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GrossWeight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofLoading + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export Loaded Container Request/Update Report in Excel

        public ActionResult ExportLoadedContRequestReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportLoadedContRequestReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportLoadedContRequestReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportLoadedContRequestReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportLoadedContRequestReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportLoadedContRequestReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstLoadedContRequestDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportLoadedContRequestReportExcel.pdf";
            string html = "<html><body>";

            //Loaded Container Request/Update
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Loaded Container Request/Update</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Request Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Request No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Empty Pick Up From</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Load Movement For Examination (YES/NO)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Move To</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Empty Container IN Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Distance</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Movement type(CWC/PVT)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Final Destination</th>";
            //html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Remarks</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vessel</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Voyage</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Bill No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Bill Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Commodity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>No of unit</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gr. Wt.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Seal</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Custom Seal</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Discharge (Foreign Port)</th>";
            html += "<th style='border-top: 1px solid #000;'>Remarks</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstLoadedContRequestDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.LoadContReqDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.LoadContReqNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PickUpFrom + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Loadmovement + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MoveTo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EmptyContIndate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Distance + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MovementType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FinalDestinationLocation + "</td>";
                    // html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.LoadContReqDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Vessel + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Voyage + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CommodityName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfUnits + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GrossWt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FobValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingSeal + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CustomSeal + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofDischarge + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion


        #region  Export Loaded Container Payment Sheet Report in Excel

        public ActionResult ExportLoadedContPaymentReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportLoadedContPaymentReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportLoadedContPaymentReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportLoadedContPaymentReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportLoadedContPaymentReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportLoadedContPaymentReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstLoadedContPaymentDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportLoadedContPaymentReportExcel.pdf";
            string html = "<html><body>";

            //Loaded Container Payment Sheet
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Loaded Container Payment Sheet</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Request No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transfer From</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transfer To</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Loading</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Empty Container IN Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>F/S Out Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Loaded Gate In Date</th>";
            html += "<th style='border-top: 1px solid #000;'>Remarks</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstLoadedContPaymentDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerRequestNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TransferFrom + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TransferTo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortOfLoading + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EmptyContInDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FSOutDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.LoadedGateInDate + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export GATE Pass (Export Loaded Container) Report in Excel

        public ActionResult ExportLoadedGatePassReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportLoadedGatePassReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportLoadedGatePassReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportLoadedGatePassReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportLoadedGatePassReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportLoadedGatePassReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstLoadedGatePassDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportLoadedGatePassReportExcel.pdf";
            string html = "<html><body>";

            //GATE Pass (Export Loaded Container)
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>GATE Pass (Export Loaded Container)</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Out Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate pass Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Loading</th>";
            html += "<th style='border-top: 1px solid #000;'>Remarks</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstLoadedGatePassDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofLoading + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export GRE Invoice For Shipping Line Report in Excel

        public ActionResult ExportGREInvoiceReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportGREInvoiceReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportGREInvoiceReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportGREInvoiceReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportGREInvoiceReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportGREInvoiceReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstGREInvoiceDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportGREInvoiceReportExcel.pdf";
            string html = "<html><body>";

            //GRE Invoice For Shipping Line
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>GRE Invoice For Shipping Line</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Party</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Payer</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Empty In Date/ Destuffing Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Empty Out Date/ ICD Stuffing Date</th>";
            html += "<th style='border-top: 1px solid #000;'>Days (Empty Period)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstGREInvoiceDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLinaName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OutDate + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Days + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export Back to Town Cargo Entry Report in Excel

        public ActionResult ExportBTTCargoReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportBTTCargoReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportBTTCargoReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportBTTCargoReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportBTTCargoReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportBTTCargoReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstBTTCargoDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportBTTCargoReportExcel.pdf";
            string html = "<html><body>";

            //Back to Town Cargo Entry
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Back to Town Cargo Entry</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BTT Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BTT No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA Cd</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Carting No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Carting Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BTT Qty.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BTT Manual Weight (kg)</th>";
            html += "<th style='border-top: 1px solid #000;'>BTT Mechanical Weight(kg)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstBTTCargoDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BTTCargoEntryDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BTTCargoEntryNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CartingAppNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CartingDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BTTQuantity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ManualWT + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.MechanicalWT + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export BTT Payment Sheet Report in Excel

        public ActionResult ExportBTTPaymentSheetReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportBTTPaymentSheetReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportBTTPaymentSheetReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportBTTPaymentSheetReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportBTTPaymentSheetReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportBTTPaymentSheetReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstBTTPaymentSheetDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportBTTPaymentSheetReportExcel.pdf";
            string html = "<html><body>";

            //BTT Payment Sheet
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>BTT Payment Sheet</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BTT No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA Cd</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt Date</th>";
            html += "<th style='border-top: 1px solid #000;'>Invoice No</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstBTTPaymentSheetDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BTTCargoEntryNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippinBillNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptDate + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export GATE Pass BTT Report in Excel

        public ActionResult ExportBTTGatePassReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportBTTGatePassReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportBTTGatePassReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportBTTGatePassReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportBTTGatePassReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportBTTGatePassReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstBTTGatePassDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportBTTGatePassReportExcel.pdf";
            string html = "<html><body>";

            //GATE Pass BTT (Back to Town)
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>GATE Pass BTT (Back to Town)</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Out Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass No</th>";
            html += "<th style='border-top: 1px solid #000;'>Packages</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstBTTGatePassDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassNo + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Packages + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  Export Export RCT Sealing Report in Excel

        public ActionResult ExportRCTSealingReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetExportRCTSealingReportExcel(DSR_ExportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ExportRCTSealingReportExcel.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetExportRCTSealingReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ExportRCTSealingReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string ExportRCTSealingReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstRCTSealingDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ExportRCTSealingReportExcel.pdf";
            string html = "<html><body>";

            //Export RCT Sealing
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Export RCT Sealing</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Bill</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Bill Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>No of PKG</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GR wt</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB Value</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Discharge (Foreign Port)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Commodity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo Type (Gen/Hazardous)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo description</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-top: 1px solid #000;'>SLA</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstRCTSealingDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShipbillDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfPkg + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GrossWt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FobValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofDischarge + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Commodity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoDescription + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        //private string ExportReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        //{
        //    int SLNo = 0;

        //    List<dynamic> lstShippingDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
        //    List<dynamic> lstCBTGateInDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
        //    List<dynamic> lstCartingDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);

        //    var FileName = "ExportinReportExcel.pdf";
        //    string html = "<html><body>";

        //    //Shipping Bill Details (CCIN Entry)													
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Shipping Bill Details (CCIN Entry)</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CCIN Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SB DATE</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PKGS</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Commodity</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo type (Gen/Haz)</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GR wt (Kg)</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB (Rs.)</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Consignee Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Consignee Address</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PKG type</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Port of Discharge (Foreign Port)</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    int i = 1;
        //    lstShippingDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CCINDate + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SBDate + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SBNo + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Package + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CommodityName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoType + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Weight + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FOB + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ConsigneeName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ConsigneeAdd + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PackageType + "</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.PortOfDischarge + "</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //Entry Through Gate CBT													
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Entry Through Gate CBT</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CBT Gate In date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Entry No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CCIN No.</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Actual PKG Received</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    i = 1;
        //    lstCBTGateInDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //Carting Register												
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Carting Register</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Carting Register Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Carting REGISTER No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Godown Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Pkgs received</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Manual Weight</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Mechanical Weight</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Area</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo type (Gen/Haz)</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Cargo Description</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    i = 1;
        //    lstCartingDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RegisterDate + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CartingRegisterNo + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GodownName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PkgReceived + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ManualWT + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MechanicalWT + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Area + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoType + "</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.CargoDescription + "</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //Short Cargo Entry											
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Short Cargo Entry</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Short Cargo Carting Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Carting REGISTER No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Godown Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Pkgs received</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Manual Weight</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Mechanical Type</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Area</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo type (Gen/Haz)</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Cargo Description</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    i = 1;
        //    lstShortCargoDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";

        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RegisterDate + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CartingRegisterNo + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GodownName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PkgReceived + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ManualWT + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MechanicalWT + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Area + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoType + "</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.CargoDescription + "</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //Stuffing Request Details										
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Stuffing Request Details</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffing req date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffing req no</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Forwarder</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Main Line</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vessel</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Voyage</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Quantity</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Weight</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB</th>";
        //    html += "<th style='border-top: 1px solid #000;'>FCL/LCL</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    i = 1;
        //    lstStuffingReqDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.RequestDate + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffingReqNo + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Forwarder + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MainLine + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Vessel + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Voyage + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffQuantity + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffWeight + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Fob + "</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.StuffingType + "</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //Container Stufiing									
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Container Stufiing</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Stuffing date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STUFFING Sheet NO</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container type (Genral/ flat rake/ odc/ open top)</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container class(Gen/haz)</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reefer (Yes/No)</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Via</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vessel Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Quantity</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Weight</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Loading</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Discharge (Foreign Port)</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Final Destination Location</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Insured</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Palletisation</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reworking</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Lift Off Empty</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Customs seal no</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line Seal No</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Remarks</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    i = 1;
        //    lstStuffingDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffingDate + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffingNo + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerType + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerClass + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Refer + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Via + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VesselName + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffQuantity + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffWeight + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Fob + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofLoading + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofDischarge + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FinalDestinationLocation + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Insured + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Palletaisation + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Reworking + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.LiftOffEmpty + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CustomSeal + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingSeal + "</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //ICD Stuffing Payment Sheet (Export Payment Sheet)									
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>ICD Stuffing Payment Sheet (Export Payment Sheet)</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STUFFING Sheet </th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Party Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Payer Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Empty IN Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffing Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GR wt for container</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Move To</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Remarks</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    lstStuffingReqDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //GATE Pass (Export Payment Sheet)								
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>GATE Pass (Export Payment Sheet)</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Out Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GR wt for container</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Loading</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Remarks</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    lstStuffingReqDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //Loaded Container Request/Update
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Loaded Container Request/Update</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Request Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Request No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Empty Pick Up From</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Load Movement For Examination (YES/NO)</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Move To</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Empty Container IN Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Distance</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Movement type(CWC/PVT)</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Final Destination</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Remarks</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vessel</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Voyage</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Bill No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Bill Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Commodity</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>No of unit</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gr. Wt.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Seal</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Custom Seal</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Discharge (Foreign Port)</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Remarks</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    lstStuffingReqDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //Loaded Container Payment Sheet
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Loaded Container Payment Sheet</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Request No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transfer From</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transfer To</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Loading</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Empty Container IN Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>F/S Out Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Loaded Gate In Date</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Remarks</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    lstStuffingReqDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //GATE Pass (Export Loaded Container)
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>GATE Pass (Export Loaded Container)</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Out Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>EXPORTER</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate pass Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Loading</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Remarks</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    lstStuffingReqDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //GRE Invoice For Shipping Line
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>GRE Invoice For Shipping Line</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Size</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Party</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Payer</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Empty In Date/ Destuffing Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Empty Out Date/ ICD Stuffing Date</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Days (Empty Period)</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    lstStuffingReqDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //Back to Town Cargo Entry
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Back to Town Cargo Entry</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BTT Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BTT No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA Cd</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Carting No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Carting Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BTT Qty.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BTT Manual Weight (kg)</th>";
        //    html += "<th style='border-top: 1px solid #000;'>BTT Mechanical Weight(kg)</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    lstStuffingReqDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //BTT Payment Sheet
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>BTT Payment Sheet</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BTT No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA Cd</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt Date</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Invoice No</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    lstStuffingReqDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //BTT Payment Sheet
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>BTT Payment Sheet</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>BTT No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA Cd</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter Name</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt Date</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Invoice No</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    lstStuffingReqDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //GATE Pass BTT (Back to Town)
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>GATE Pass BTT (Back to Town)</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Out Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass No</th>";
        //    html += "<th style='border-top: 1px solid #000;'>Packages</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    lstStuffingReqDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    //Export RCT Sealing
        //    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
        //    html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Export RCT Sealing</h5></td></tr>";
        //    html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
        //    html += "<thead>";
        //    html += "<tr>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Bill</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Bill Date</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>No of PKG</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>GR wt</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB Value</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Discharge (Foreign Port)</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Commodity</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo Type (Gen/Hazardous)</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo description</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
        //    html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
        //    html += "<th style='border-top: 1px solid #000;'>SLA Cd</th>";
        //    html += "</tr>";
        //    html += "</thead>";
        //    html += "<tbody>";
        //    lstStuffingReqDetails.ToList().ForEach(item =>
        //    {
        //        try
        //        {
        //            html += "<tr>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
        //            html += "</tr>";

        //            i++;
        //        }
        //        catch (Exception Ex)
        //        {

        //        }
        //    });
        //    html += "</tbody>";
        //    html += "</table></td></tr>";
        //    html += "</tbody></table>";

        //    html += "</body></html>";

        //    string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

        //    if (!Directory.Exists(LocalDirectory))
        //    {
        //        Directory.CreateDirectory(LocalDirectory);
        //    }
        //    if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
        //    {
        //        System.IO.File.Delete(LocalDirectory + "/" + FileName);
        //    }

        //    System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


        //    FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



        //    //Open a file for Read\Write
        //    FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


        //    StreamReader sr = new StreamReader(fs);

        //    //Use the ReadToEnd method to read all the content from file
        //    string fileContent = sr.ReadToEnd();

        //    //Close the StreamReader object after operation
        //    sr.Close();
        //    // fs.Close();

        //    return fileContent;
        //}





        #region Import job Report in Excel

        // joborder report
        public ActionResult ImportJobOrderReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportjoborderReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportjobReporExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportjoborderReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportjoborderReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstjobDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            /*   List<dynamic> lstoblDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
                List<dynamic> lstgateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
                List<dynamic> lstappraisementDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
               // List<dynamic> lstdestuffDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
                List<dynamic> lstyardpayDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
                List<dynamic> lstyardreassess = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[5]);
                List<dynamic> lstfdyard = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[6]);
                List<dynamic> lstdelinvchk = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[7]);
                List<dynamic> lstdelinvrechk = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[8]);
                List<dynamic> lstgpcargo = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[9]);
               // List<dynamic> lstgpcnvbnd = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[11]);
                List<dynamic> lstconvertbond = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[10]);
                List<dynamic> lstrctseal = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[11]);
                List<dynamic> lstfdentry = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[12]);
                List<dynamic> lstEmptyContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[13]);
                List<dynamic> lstecout = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[14]);*/
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Job Details Report.pdf";
            string html = "<html><body>";
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            // var FileName = "Import Report.pdf";
            // string html = "<html><body
            // job order 
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Job Order Details EXCEL Report For From " + PeriodFrom + " To " + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Job Order Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Job Order No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Job Order Invoice</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Importer</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Haz/ Non Haz</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>FCL/LCL</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>ODC Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party Name</th>";
            html += "<th style='border-top: 1px solid #000; padding:20px;'>Transport From(Origin Code)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstjobDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobOrderDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobOrderNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoiceno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.containerno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.containersize + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargotype + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerLoadType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Ct_ODC + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayerName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.PortName + "</td>";
                    html += "</tr>";
                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            //job order ends
            // html += "</body></html>";
            // obl details
            /*    html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>OBL Entry Details Excel Report For From " + PeriodFrom + " To " + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL Entry Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL NO </th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL DATE</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IGM NO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IGM DATE</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>PKGS</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Commodity</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo Type (Gen/Hazardous)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo description</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR wt (Kg.)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF VALUE (Rs.)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IEC Code</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>SLA Cd</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>POL (foreign port)</th>";
                html += "<th style='border-top: 1px solid #000; padding:20px;'>POD (India's Port)</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int j = 1;
                lstoblDetails.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + j + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.OBLCreate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.OBL_No + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.OBL_Date + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.IGM_No + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.IGM_Date + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.NO_PKG + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.commodityname + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.cargotype+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CargoDescription + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.GR_WT + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CIFValue + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.IECcode + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ContainerNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Size + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.shippingline + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Chaname + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Importername + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.SlaCode + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.POL + "</td>";
                        html += "<td style='border-top: 1px solid #000; text-align: center;'>"+item.POD+"</td>";
                        html += "</tr>";
                        j++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
              //  html += "</body></html>";

                //obl details ends
                //gate operation 
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Loaded In Excel Report For From " + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IN DATE & TIME</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Job-Order No.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Job-Order Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CFS Code</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR WT of container</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Status (Loaded/Empty)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Movement By (CWC/ Private)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Customs seal no</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping/Agent seal no</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container type (Open Top, Over Dimension, Normal, Flat Rake)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container class (Gen/Haz, Reefer)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container received from (Port /RCT)</th>";
                html += "<th style='border-top: 1px solid #000; padding:20px;'>Remarks</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int k = 1;
                lstgateDetails.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + k + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.EntryDateTime + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.VehicleNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ReferenceNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CFSCode + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ContainerNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Size + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ShippingLine + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.GrossWeight + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CHAName+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.NewImporterName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ContainerType + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.movement + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CustomSealNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ShippingLineSealNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ContainerType + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ContClass + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.portname + "</td>";
                        html += "<td style='border-top: 1px solid #000; text-align: center;'>"+item.Remarks + "</td>";
                        html += "</tr>";

                        k++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                //gate operation end

                //Appraisement details
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Custom Appraisement Excel Report For From" + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>APPRAISEMENT DATE</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>APPRAISEMENT NO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR WT of container</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>BOE NO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>BOE DATE</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Haz/Non Haz</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF (Rs.)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty (Rs.)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Examination type (RMS/UPTO  25%/ BEYOND 25%)</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int l = 1;
                lstappraisementDetails.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + l + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.shippinglinename + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GrossWeight + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Cha + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Importer + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BOENo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BOEDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargotype + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cif + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExamType + "</td>";

                        html += "</tr>";

                        l++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                // html += "</body></html>";
                //Appraisement ends
                //destuffing detail
              /*  html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>DeStufiing Entry Excel Report For Form" + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>De-Stuffing date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>De-Stuffing No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR WT of container</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>ISO CODE</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GODOWN NO/Loaded Yard/Empty Yard</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>SLOT/STACK Location</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Pkgs in Bill of Entry</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Pkgs Received</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>PKG type</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>AREA(Sqm)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gr wt (kgs)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>APPRAISEMENT NO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>APPRAISEMENT Date</th>";
              //  html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Haz/Non Haz</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF (Rs.)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty (Rs.)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo Type (Gen/Haz)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Via No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vessel Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Main Line</th>";
                html += "<th style='border-top: 1px solid #000; padding:20px;'>Remarks</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int m = 1; 
                lstdestuffDetails.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + m + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.DestuffingEntryNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ContainerNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Size+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.shippingline + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Weight+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CHA+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Importer+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.isocode+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.GodownName+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.LocationNames+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.NoOfPackages+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ReceivedPackages+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.PkgType+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Area+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.GrossWeight + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.AppraisementNo+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.AppraisementDate+"</td>";
                       // html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargotype + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CIFValue+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Duty+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.cargotype+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.viano+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.vesselname+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.MainLine+"</td>";
                        html += "<td style='border-top: 1px solid #000; text-align: center;'>"+item.remark+"</td>";
                        html += "</tr>";
                        m++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                //  html += "</body></html>";

                // destuffing ens
                // yard paymentsheet
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Yard Payment Sheet/Invoice Excel Report For From" + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";

                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR wt of container</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Apparaisement No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Appraisement Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line DO Validity</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Movement By (CWC/ Private)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Distance (Km)</th>";
                html += "<th style='border-top: 1px solid #000; padding:20px;'>Empty Back to (ICD/Golden/Kishan Marine/ Other)</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int n = 1;
                lstyardpayDetails.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + n + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedate+ "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoiceno+ "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.containerno+ "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size+ "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLinaName+ "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TotalGrossWt + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterImporterName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBLNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIFValue + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ValidDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MovementType + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Distance + "</td>";
                        html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.EmptyPort + "</td>";
                        html += "</tr>";

                        n++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                // html += "</body></html>";
                // yard paymentsheet end
                //yard paymentsheet reasses
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Yard Payment Sheet (Reassessment) Excel Report For From" + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";

                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR wt of container</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Apparaisement No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Appraisement Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line DO Validity</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Movement By (CWC/ Private)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Distance (Km)</th>";
                html += "<th style='border-top: 1px solid #000; padding:20px;'>Empty Back to (ICD/Golden/Kishan Marine/ Other)</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int o = 1;
                lstyardreassess.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + o + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoiceno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.containerno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLinaName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TotalGrossWt + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterImporterName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBLNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIFValue + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ValidDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MovementType + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Distance + "</td>";
                        html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.EmptyPort + "</td>";
                        html += "</tr>";

                        o++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                //  html += "</body></html>";
                //yard paymentsheet reassess end

                //yard factory destuffing
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Gate Pass  (Yard - Factory Destuffing) Excel Report For From" + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Out date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Pass No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Custom Seal No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Importer Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>No.of PKG</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate pass date</th>";
               // html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Out date</th>";
                html += "<th style='border-top: 1px solid #000; padding:20px;'>Remarks</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int p = 1;
                lstfdyard.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + p + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.GateExitDateTime + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.GatePassNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ContainerNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Size + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ShippingLineName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.VehicleNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.WithoutDOSealNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.importer + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CHA + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.NoOfPackage + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.GatePassDate + "</td>";
                       // html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.GateExitDateTime + "</td>";
                        html += "<td style='border-top: 1px solid #000; text-align: center;'>"+item.Remarks + "</td>";
                        html += "</tr>";

                        p++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                //   html += "</body></html>";
                //yard factory destuffing end
                // Delivery Application to Invoice Checking
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Delivery Application to Invoice Checking Excel Report For From" + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Entry No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Apparaisement No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Appraisement Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL No.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Delivery NO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>No. Of Packages</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No.</th>";
               // html += "<th style='border-top: 1px solid #000; padding:20px;'>Delivery No</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int q = 1;
                lstdelinvchk.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + q + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedatee + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicenoo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.destuffno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.obloo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.deliveryno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIFValue + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Importer + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.PayeeName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.PartyName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.NoOfPackage + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.vehicleno + "</td>";
                       // html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
                        html += "</tr>";

                        q++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                //  html += "</body></html>";
                // Delivery Application to Invoice Checking end
                // Delivery Application to Invoice Checking reassess
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Delivery Application to Invoice Checking Excel Report For From" + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Entry No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Apparaisement No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Appraisement Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL No.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Delivery NO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>No. Of Packages</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No.</th>";
                // html += "<th style='border-top: 1px solid #000; padding:20px;'>Delivery No</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int r = 1;
                lstdelinvrechk.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + q + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedatee + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicenoo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.destuffno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.obloo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.deliveryno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIFValue + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Importer + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfPackage + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.vehicleno + "</td>";
                        // html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
                        html += "</tr>";

                        r++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                //  html += "</body></html>";
                // Delivery Application to Invoice Checking  reassess end
                // gatepass cargo delivery
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Gate Pass Cargo Delivery Excel Report For From" + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Out date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Pass No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Importer</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>No.of PKG</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate pass date</th>";
                html += "<th style='border-top: 1px solid #000; padding:20px;'>Remarks</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int s = 1;
                lstgpcargo.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + s + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.gateexitdate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.gps + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CHAName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.importer + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.invoiceno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.gpv + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.gnu + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.gpd + "</td>";
                        html += "<td style='border-top: 1px solid #000; text-align: center;'>"+item.gpre + "</td>";
                        html += "</tr>";

                        s++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                //  html += "</body></html>";
                // gatepass end

                // convert to bond
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Convert to Bond Excel Report For From" + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Entry No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Apparaisement No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Appraisement Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL No.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Delivery NO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>No. Of Packages</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No.</th>";
              //  html += "<th style='border-top: 1px solid #000; padding:20px;'>Delivery No</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int u = 1;
                lstconvertbond.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + u + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.invoiceda + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.invoino + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.deno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.DestuffingEntryDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.AppraisementNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.AppraisementDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.obloo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.deliveryno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CIFValue + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Duty + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CHAName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Importer + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.PayeeName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.PartyName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.NoOfPackage + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.vehicleno + "</td>";
                     //   html += "<td style='border-top: 1px solid #000; text-align: center;'>Dynamic</td>";
                        html += "</tr>";

                        u++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                // html += "</body></html>";
                // convert to bond end
                //rct sealing
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Import RCT Sealing Excel Report For From " + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>BOE NO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>BOE  DATE</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL NO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL DATE</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IGM NO</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IGM DATE</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>PKGS</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Commodity</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo Type (Gen/Hazardous)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo description</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR wt</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF VALUE</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IEC Code</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Cd</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer Name</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>SLA Cd</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>POL (foreign port)</th>";
                html += "<th style='border-top: 1px solid #000; padding:20px;'>POD (India's Port)</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int v = 1;
                lstrctseal.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + v + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.invoicedate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.invoiceno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+ item.boenoo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+ item.boedate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.OBLNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.OBLDate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.igmno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.igmdate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.NoOfpkgg + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.commodity + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.cargotypee + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.cargodesription + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+ item.GrossWt + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.FobValue + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Duty+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ieccodee + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CHAName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.importer + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.PartyName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.PayeeName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ContainerNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Size + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ShippingLinaName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.portnamee + "</td>";
                        html += "<td style='border-top: 1px solid #000; text-align: center;'>"+item.podd + "</td>";
                        html += "</tr>";

                        v++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                // html += "</body></html>";
                // rct sealing end
                // import fd entry
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Import (FD) Excel Report For From " + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Empty(FD) Back IN ICD Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Cd</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
                html += "<th style='border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int w = 1;
                lstfdentry.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + w + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.entrydttm + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.ContainerNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Size+"</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.CHAName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.Importer + "</td>";
                        html += "<td style='border-top: 1px solid #000; text-align: center;'>"+item.ShippingLine + "</td>";
                        html += "</tr>";

                        w++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                // html += "</body></html>";
                // import fd end

                //Empty Container Invoice
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Empty Container Invoice Excel Report For From" + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CFS CODE</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Empty Container GATE IN Date</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Date of Destuffing</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Move To</th>";
                html += "<th style='border-top: 1px solid #000; padding:20px;'>Remarks</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int x = 1;
                lstEmptyContainer.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoiceno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLinaName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.entrydate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Destuffingdate + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EmptyPort + "</td>";
                        html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                        html += "</tr>";

                        x++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                // html += "</body></html>";
                //Empty Container Invoice end
                // Empty Container gatepass
                html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
                html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Gate Pass (Empty Container Gate Out) Excel Report For From" + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
                html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
                html += "<thead>";
                html += "<tr>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Exit through Gate DATE (Gate Pass- Empty Container Gate Out)</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Pass No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CFS CODE</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Move To</th>";
                html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Movement Type CWC/PVT  (Gate Pass- Empty Container Gate Out)</th>";
                html += "<th style='border-top: 1px solid #000; padding:20px;'>Remarks</th>";
                html += "</tr>";
                html += "</thead>";
                html += "<tbody>";
                int y = 1;
                lstecout.ToList().ForEach(item =>
                {
                    try
                    {
                        html += "<tr>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + y + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gatepassno + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EmptyPort + "</td>";
                        html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MovementType + "</td>";
                        html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                        html += "</tr>";

                        y++;
                    }
                    catch (Exception Ex)
                    {

                    }
                });
                html += "</tbody>";
                html += "</table></td></tr>";

                html += "</tbody></table>";
                html += "</body></html>";*/
            // Empty Container gatepass end

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report

        #endregion
        #region import obl excel
        public ActionResult ImportoblReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportoblReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportoblReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportoblReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportoblReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Obl Detail Excel Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>OBL Entry Details Excel Report For From " + PeriodFrom + " To " + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL Entry Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL NO </th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IGM NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IGM DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>PKGS</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Commodity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo Type (Gen/Hazardous)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo description</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR wt (Kg.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF VALUE (Rs.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IEC Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>SLA Cd</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>POL (foreign port)</th>";
            html += "<th style='border-top: 1px solid #000; padding:20px;'>POD (India's Port)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBLCreate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBL_No + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBL_Date + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGM_No + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IGM_Date + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NO_PKG + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.commodityname + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargotype + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoDescription + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GR_WT + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIFValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IECcode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.shippingline + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Chaname + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Importername + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SlaCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.POL + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.POD + "</td>";
                    html += "</tr>";
                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report
        //

        #endregion
        #region Import gate operation in Excel

        // joborder report
        public ActionResult ImportgateReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportgateReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.Importgateoperationexcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportgateReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportgateReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Loaded In Excel Report For From " + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IN DATE & TIME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Job-Order No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Job-Order Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CFS Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR WT of container</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Status (Loaded/Empty)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Movement By (CWC/ Private)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Customs seal no</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping/Agent seal no</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container type (Open Top, Over Dimension, Normal, Flat Rake)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container class (Gen/Haz, Reefer)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container received from (Port /RCT)</th>";
            html += "<th style='border-top: 1px solid #000; padding:20px;'>Remarks</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EntryDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReferenceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GrossWeight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NewImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.movement + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CustomSealNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineSealNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContClass + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.portname + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report

        #endregion
        #region import custom appraisement excel
        public ActionResult ImportcustomappReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportcustomapplReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportcustomExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportcustomReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportcustomReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Custom Appraisement Excel Report For From" + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>APPRAISEMENT DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>APPRAISEMENT NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR WT of container</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>BOE NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>BOE DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Haz/Non Haz</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF (Rs.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty (Rs.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Examination type (RMS/UPTO  25%/ BEYOND 25%)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.shippinglinename + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GrossWeight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Cha + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Importer + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BOENo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BOEDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargotype + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cif + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExamType + "</td>";

                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report
        //

        #endregion
        #region Import Destuffing Report in Excel

        // joborder report
        public ActionResult ImportDestuffingReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportDestuffingReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportDestuffingExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportDestuffingReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportDestuffingReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>DeStufiing Entry Excel Report For Form" + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>De-Stuffing date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>De-Stuffing No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR WT of container</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>ISO CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GODOWN NO/Loaded Yard/Empty Yard</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>SLOT/STACK Location</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Pkgs in Bill of Entry</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Pkgs Received</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>PKG type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>AREA(Sqm)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gr wt (kgs)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>APPRAISEMENT NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>APPRAISEMENT Date</th>";
            //  html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Haz/Non Haz</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF (Rs.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty (Rs.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo Type (Gen/Haz)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Via No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vessel Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Main Line</th>";
            html += "<th style='border-top: 1px solid #000; padding:20px;'>Remarks</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.shippingline + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Weight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHA + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Importer + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.isocode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GodownName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.LocationNames + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfPackages + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceivedPackages + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PkgType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Area + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GrossWeight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementDate + "</td>";
                    // html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargotype + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIFValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargotype + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.viano + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.vesselname + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MainLine + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.remark + "</td>";
                    html += "</tr>";
                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report

        #endregion
        #region import yard paymentsheet excel
        public ActionResult ImportyardpaymentReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportyardpaymentReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportyardReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportyardpamentReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportyardpamentReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Yard Payment Sheet/Invoice Excel Report For From" + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR wt of container</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Apparaisement No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Appraisement Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line DO Validity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Movement By (CWC/ Private)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Distance (Km)</th>";
            html += "<th style='border-top: 1px solid #000; padding:20px;'>Empty Back to (ICD/Golden/Kishan Marine/ Other)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoiceno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.containerno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLinaName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TotalGrossWt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBLNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIFValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ValidDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MovementType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Distance + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.EmptyPort + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report
        //

        #endregion
        #region Import yard paymentsheet reassess operation in Excel

        // joborder report
        public ActionResult ImportyardreassesReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportyardreassessReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportyardreassessReporExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportyardreassesReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportyardreassesReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Yard Payment Sheet (Reassessment) Excel Report For From" + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR wt of container</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Apparaisement No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Appraisement Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line DO Validity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Movement By (CWC/ Private)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Distance (Km)</th>";
            html += "<th style='border-top: 1px solid #000; padding:20px;'>Empty Back to (ICD/Golden/Kishan Marine/ Other)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoiceno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.containerno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLinaName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TotalGrossWt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBLNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIFValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ValidDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MovementType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Distance + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.EmptyPort + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report

        #endregion
        #region import Yard Factory Destuffing excel
        public ActionResult ImportyardfdpReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportyardfdReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportyardfdExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportyardfdReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportyardfdReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Gate Pass  (Yard - Factory Destuffing) Excel Report For From" + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Out date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Pass No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Custom Seal No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Importer Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>No.of PKG</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate pass date</th>";
            // html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Out date</th>";
            html += "<th style='border-top: 1px solid #000; padding:20px;'>Remarks</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.WithoutDOSealNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.importer + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHA + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfPackage + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassDate + "</td>";
                    // html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>"+item.GateExitDateTime + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report
        //

        #endregion
        #region Import Delivery Application to Invoice Checking in Excel

        // joborder report
        public ActionResult ImportdelinvReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportdelinvReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportdelReporExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportdelinvReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportdelinvReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Delivery Application to Invoice Checking Excel Report For From" + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Entry No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Apparaisement No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Appraisement Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Delivery NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>No. Of Packages</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No.</th>";
            // html += "<th style='border-top: 1px solid #000; padding:20px;'>Delivery No</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedatee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicenoo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.destuffno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.obloo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.deliveryno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIFValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Importer + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfPackage + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.vehicleno + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report

        #endregion
        #region import delivery paymentsheet reasses excel
        public ActionResult ImportdelreassesReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportdelreassesReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportdelreassessExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportdelreassesReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportdelreassesReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Godown Delivery Payment Sheet(Reassessment) Excel Report For From" + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Entry No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Apparaisement No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Appraisement Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Delivery NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>No. Of Packages</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No.</th>";
            // html += "<th style='border-top: 1px solid #000; padding:20px;'>Delivery No</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedatee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicenoo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.destuffno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.obloo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.deliveryno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIFValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Importer + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfPackage + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.vehicleno + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report
        //

        #endregion
        #region Import gate pass cargo delivery in Excel

        // joborder report
        public ActionResult ImportgpcargodelReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportgpcargodelReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportgpcReporExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportgpcargodelReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportgpcargodelReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Gate Pass Cargo Delivery Excel Report For From" + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Out date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Pass No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Importer</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>No.of PKG</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate pass date</th>";
            html += "<th style='border-top: 1px solid #000; padding:20px;'>Remarks</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gateexitdate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gps + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.importer + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoiceno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gpv + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gnu + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gpd + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.gpre + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report

        #endregion
        #region import convert to bond excel
        public ActionResult ImportconverttobondReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportconverttobondReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportcbReporExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportconverttobondReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportconverttobondReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Convert to Bond Excel Report For From" + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Entry No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Destuffing Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Apparaisement No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Appraisement Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Delivery NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>No. Of Packages</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No.</th>";
            //   html += "<th style='border-top: 1px solid #000; padding:20px;'>Delivery No</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoiceda + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoino + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.deno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AppraisementDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.obloo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.deliveryno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIFValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Importer + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfPackage + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.vehicleno + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report
        //

        #endregion
        #region Import rct sealing in Excel

        // joborder report
        public ActionResult ImportrctsealingReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportrctsealingReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportrctReporExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportrctsealingReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportrctsealingReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Import RCT Sealing Excel Report For From " + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>BOE NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>BOE  DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>OBL DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IGM NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IGM DATE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>PKGS</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Commodity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo Type (Gen/Hazardous)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Cargo description</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>GR wt</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CIF VALUE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Duty</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IEC Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Cd</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>SLA Cd</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>POL (foreign port)</th>";
            html += "<th style='border-top: 1px solid #000; padding:20px;'>POD (India's Port)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoiceno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.boenoo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.boedate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBLNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OBLDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.igmno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.igmdate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NoOfpkgg + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.commodity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargotypee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cargodesription + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GrossWt + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FobValue + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Duty + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ieccodee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.importer + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLinaName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.portnamee + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.podd + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report

        #endregion
        #region import fd excel
        public ActionResult ImportfdReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportfdReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportfdReporExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportfdReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportfdReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Import (FD) Excel Report For From " + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Empty(FD) Back IN ICD Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CHA Cd</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>IMPORTER Name</th>";
            html += "<th style='border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.entrydttm + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Importer + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report
        //

        #endregion
        #region Import empty container invoice in Excel

        // joborder report
        public ActionResult ImportempcontinvReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetempcontinvReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportempcExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportcontinvReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportcontinvReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Empty Container Invoice Excel Report For From" + PeriodFrom + " TO " + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Empty Container GATE IN Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Date of Destuffing</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Move To</th>";
            html += "<th style='border-top: 1px solid #000; padding:20px;'>Remarks</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoicedate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.invoiceno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLinaName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.entrydate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Destuffingdate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EmptyPort + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report

        #endregion
        #region import empty cont out excel
        public ActionResult ImportemptycontoutReportExcel()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetImportemptycontoutReportExcel(DSR_ImportReportExcel vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ImportReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ImportempcoutExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            //  Response.Write(ImportReportExcelPDF(ds),vm.PeriodFrom,vm.PeriodTo);
            Response.Write(ImportemptycontoutReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ImportemptycontoutReportExcelPDF(DataSet ds, string PeriodFrom, string PeriodTo)
        {

            List<dynamic> lstPartyDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            //List<dynamic> lstSDTransaction = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            var FileName = "Import Report.pdf";
            string html = "<html><body>";
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Gate Pass (Empty Container Gate Out) Excel Report For From" + PeriodFrom + " To" + PeriodTo + "</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Exit through Gate DATE (Gate Pass- Empty Container Gate Out)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Gate Pass No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Party</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Payer</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Move To</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; padding:20px;'>Movement Type CWC/PVT  (Gate Pass- Empty Container Gate Out)</th>";
            html += "<th style='border-top: 1px solid #000; padding:20px;'>Remarks</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstPartyDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.gatepassno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EmptyPort + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MovementType + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";

            html += "</tbody></table>";
            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        // end job order report
        //

        #endregion






        #region Report of Import Loaded Gate IN

        public ActionResult ReportofImportLoadedGateIN()
        {
            return View();
        }


        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult ReportofImportLoadedGateINExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ReportofImportLoadedGateIN(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ReportofImportLoadedGateINExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ReportofImportLoadedGateINExcelPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";

            //Report of Import Loaded Gate IN								
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='10' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Import Loaded Gate IN	</h5></td></tr>";
            html += "<tr><td colspan='10'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='10' align='center'>From " + FromDate + " to " + ToDate + "</td></tr>";
            html += "<tr><td colspan='10' align='center' style='border-top: 1px solid #000;'>By Train/Road</td></tr>";
            html += "<tr><td colspan='10' align='center' style='border-top: 1px solid #000;'>Import</td></tr>";
            html += "<tr><td colspan='10' align='center' style='border-top: 1px solid #000;'>Loaded</td></tr>";
            html += "<tr><th colspan='10' style='border-top: 1px solid #000;'>Report of Import Loaded Gate IN</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ENTRY DATE & TIME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SIZE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING LINE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Order No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Order Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-top: 1px solid #000;'>Importer</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EntryDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobOrderNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobOrderDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";



            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        #endregion

        #region Report of Import Job Orders

        public ActionResult ReportofImportJobOrders()
        {
            return View();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult ReportofImportJobOrdersExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ReportofImportJobOrders(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ReportofImportJobOrdersExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ReportofImportJobOrdersExcelPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";

            var i = 1;

            //JOB Order Details																		
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Import Job Orders	</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='12' align='center'>From " + FromDate + " to " + ToDate + "</td></tr>";
            html += "<tr><td colspan='12' align='center' style='border-top: 1px solid #000;'>JOB Order Details</td></tr>";
            html += "<tr><th colspan='12' style='border-top: 1px solid #000;'>Report of Import Job Orders</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Order Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Order No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Order Invoice</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Importer</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Payer Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Party Name</th>";
            html += "<th style='border-top: 1px solid #000;'>Port</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobOrderNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobOrderDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.PortName + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region Report of Import Loaded OUT (Factory Destuffing)

        public ActionResult ReportofImportLoadedOUTFactoryDestuffing()
        {
            return View();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult ReportofImportLoadedOUTFactoryDestuffingExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ReportofImportLoadedOUTFactoryDestuffing(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ReportofImportLoadedOUTFactoryDestuffingExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ReportofImportLoadedOUTFactoryDestuffingExcelPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            // List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";

            var i = 1;

            //Report of Import Loaded OUT (Factory Destuffing)									
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='11' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Import Loaded OUT (Factory Destuffing)</h5></td></tr>";
            html += "<tr><td colspan='11'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='11' align='center'>From " + FromDate + " to " + ToDate + "</td></tr>";
            html += "<tr><td colspan='11' align='center' style='border-top: 1px solid #000;'>Import</td></tr>";
            html += "<tr><td colspan='11' align='center' style='border-top: 1px solid #000;'>Loaded</td></tr>";
            html += "<tr><th colspan='11' style='border-top: 1px solid #000;'>Report of Import Loaded OUT (Factory Destuffing)</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exit through Gate DATE (Gate Pass- Yard Factory Destuffing)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SIZE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING LINE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Importer</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Movement Type CWC/PVT (Yard Factory Destuffing)</th>";
            html += "<th style='border-top: 1px solid #000;'>Empty back to (Empty Port)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExporterImporterName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MovementType + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.EmptyPort + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";



            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        #endregion

        #region Report of ICD Destuffed Containers

        public ActionResult ReportofICDDestuffedContainers()
        {
            return View();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult ReportofICDDestuffedContainersExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ReportofICDDestuffedContainers(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ReportofICDDestuffedContainersExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ReportofICDDestuffedContainersExcelPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";

            var i = 1;

            //Report of ICD Destuffed Containers							
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='9' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of ICD Destuffed Containers</h5></td></tr>";
            html += "<tr><td colspan='9'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='9' align='center'>From " + FromDate + " to " + ToDate + "</td></tr>";
            html += "<tr><td colspan='9' align='center' style='border-top: 1px solid #000;'>ICD DESTUFFING of Containers</td></tr>";
            html += "<tr><th colspan='9' style='border-top: 1px solid #000;'>Report of ICD Destuffed Containers</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ICD Destuffing Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SIZE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING LINE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Destuffing No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-top: 1px solid #000;'>Importer</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DestuffingEntryNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        #endregion

        #region Report of Import Empty FDIN

        public ActionResult ReportofImportEmptyFDIN()
        {
            return View();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult ReportofImportEmptyFDINExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ReportofImportEmptyFDIN(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ReportofImportEmptyFDINExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ReportofImportEmptyFDINExcelPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";
            var i = 1;

            //Report of Import Empty (FD) IN
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='8' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Import Empty (FD) IN</h5></td></tr>";
            html += "<tr><td colspan='8'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='8' align='center'>From " + FromDate + " to " + ToDate + "</td></tr>";
            html += "<tr><td colspan='8' align='center' style='border-top: 1px solid #000;'>By Road</td></tr>";
            html += "<tr><td colspan='8' align='center' style='border-top: 1px solid #000;'>Import</td></tr>";
            html += "<tr><td colspan='8' align='center' style='border-top: 1px solid #000;'>Empty (FD)</td></tr>";
            html += "<tr><th colspan='8' style='border-top: 1px solid #000;'>Report of Import Empty (FD) IN</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ENTRY DATE & TIME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SIZE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING LINE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-top: 1px solid #000;'>Importer</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EntryDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ImporterName + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        #endregion

        #region Report of Import Empty IN

        public ActionResult ReportofImportEmptyIN()
        {
            return View();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult ReportofImportEmptyINExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ReportofImportEmptyIN(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ReportofImportEmptyINExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ReportofImportEmptyINExcelPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";

            var i = 1;

            //Report of Import Empty (FD) IN
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='6' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Import Empty (FD) IN</h5></td></tr>";
            html += "<tr><td colspan='6'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='6' align='center'>From " + FromDate + " to " + ToDate + "</td></tr>";
            html += "<tr><td colspan='6' align='center' style='border-top: 1px solid #000;'>By Road</td></tr>";
            html += "<tr><td colspan='6' align='center' style='border-top: 1px solid #000;'>Import</td></tr>";
            html += "<tr><td colspan='6' align='center' style='border-top: 1px solid #000;'>Empty</td></tr>";
            html += "<tr><th colspan='6' style='border-top: 1px solid #000;'>Report of Import Empty IN</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ENTRY DATE & TIME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SIZE</th>";
            html += "<th style='border-top: 1px solid #000;'>SHIPPING LINE</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EntryDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";



            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region Report of Export Empty IN

        public ActionResult ReportofExportEmptyIN()
        {
            return View();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult ReportofExportEmptyINExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ReportofExportEmptyIN(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ReportofExportEmptyINExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ReportofExportEmptyINExcelPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";

            var i = 1;

            //Report of Export Empty IN
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='6' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Export Empty IN</h5></td></tr>";
            html += "<tr><td colspan='6'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='6' align='center'>From " + FromDate + " to " + ToDate + "</td></tr>";
            html += "<tr><td colspan='6' align='center' style='border-top: 1px solid #000;'>By Road</td></tr>";
            html += "<tr><td colspan='6' align='center' style='border-top: 1px solid #000;'>Export</td></tr>";
            html += "<tr><td colspan='6' align='center' style='border-top: 1px solid #000;'>Empty</td></tr>";
            html += "<tr><th colspan='6' style='border-top: 1px solid #000;'>Report of Export Empty IN</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ENTRY DATE & TIME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SIZE</th>";
            html += "<th style='border-top: 1px solid #000;'>SHIPPING LINE</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EntryDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";



            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        #endregion

        #region Report of ICD stuffing Container Out

        public ActionResult ReportofICDStuffingContainerOut()
        {
            return View();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult ReportofICDStuffingContainerOutExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ReportofICDStuffingContainerOut(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ReportofICDStuffingContainerOutExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ReportofICDStuffingContainerOutExcelPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";
            var i = 1;


            //Report of ICD stuffing Container Out
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of ICD stuffing Container Out</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='12' align='center'>From " + FromDate + " to " + ToDate + "</td></tr>";
            html += "<tr><th colspan='12' style='border-top: 1px solid #000;'>Gate Out- GatePass(Export Payment Sheet)</th></tr>";
            html += "<tr><th colspan='12' style='border-top: 1px solid #000;'>Report of ICD stuffing Container Out</th></tr>";
            html += "<tr><td colspan='12' align='center' style='border-top: 1px solid #000;'>ICD Stuffing</td></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exit through Gate DATE (Gate Pass- Export Payment Sheet)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Move To (Export Payment Sheet)</th>";
            html += "<th style='border-top: 1px solid #000;'>Container Weight (Kg.) (Export Paymnet Sheet)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImpExpName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.GrossWt + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";



            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        #endregion

        #region Report of Factory Stuffing Job Order

        public ActionResult ReportofFactoryStuffingJobOrder()
        {
            return View();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult ReportofFactoryStuffingJobOrderExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ReportofFactoryStuffingJobOrder(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ReportofFactoryStuffingJobOrderExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ReportofFactoryStuffingJobOrderExcelPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var i = 1;
            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";



            //Report of Factory Stuffing Job Order
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Factory Stuffing Job Order</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='12' align='center'>From " + FromDate + " to " + ToDate + "</td></tr>";
            html += "<tr><th colspan='12' style='border-top: 1px solid #000;'>Gate Out- Gate Exit Factory Stuffing</th></tr>";
            html += "<tr><th colspan='12' style='border-top: 1px solid #000;'>Report of Factory Stuffing Job Order</th></tr>";
            html += "<tr><td colspan='12' align='center' style='border-top: 1px solid #000;'>Loaded Container Request (Factory Stuffing)</td></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exit through Gate DATE (Gate Exit Factory Stuffing)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Request No.(Gate Exit Factory Stuffing)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Distance (km)</th>";
            html += "<th style='border-top: 1px solid #000;'>Movement Type CWC/PVT (Gate Exit Factory Stuffing)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImpExpName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.LoadContReqNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Distance + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Movement + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";



            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        #endregion

        #region Report of Empty Container Gate Out

        public ActionResult ReportofEmptyContainerGateOut()
        {
            return View();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult ReportofEmptyContainerGateOutExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ReportofEmptyContainerGateOut(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ReportofEmptyContainerGateOutExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ReportofEmptyContainerGateOutExcelPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            var i = 1;
            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";



            //Report of Empty Container Gate Out
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Empty Container Gate Out</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='12' align='center'>From " + FromDate + " to " + ToDate + "</td></tr>";
            html += "<tr><th colspan='12' style='border-top: 1px solid #000;'>Gate Out- Empty Container Gate Out</th></tr>";
            html += "<tr><th colspan='12' style='border-top: 1px solid #000;'>Report of Empty Container Gate Out</th></tr>";
            html += "<tr><td colspan='12' align='center' style='border-top: 1px solid #000;'>Empty Container Invoice</td></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exit through Gate DATE (Gate Pass- Empty Container Gate Out)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Gate Pass No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Party</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Payer</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Move To</th>";
            html += "<th style='border-top: 1px solid #000;'>Movement Type CWC/PVT  (Gate Pass- Empty Container Gate Out)</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GatePassNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayeeName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.MovementType + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";



            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        #endregion

        #region Report of Export Loaded Container Gate IN

        public ActionResult ReportofExportLoadedContainerGateIN()
        {
            return View();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult ReportofExportLoadedContainerGateINExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ReportofExportLoadedContainerGateIN(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ReportofExportLoadedContainerGateINExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ReportofExportLoadedContainerGateINExcelPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            var i = 1;
            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";



            //Report of Export Loaded Container Gate IN
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='10' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Export Loaded Container Gate IN</h5></td></tr>";
            html += "<tr><td colspan='10'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='10' align='center'>From " + FromDate + " to " + ToDate + "</td></tr>";
            html += "<tr><td colspan='10' align='center' style='border-top: 1px solid #000;'>By Road</td></tr>";
            html += "<tr><td colspan='10' align='center' style='border-top: 1px solid #000;'>Export Loaded Container (Loaded Container Request)</td></tr>";
            html += "<tr><td colspan='10' align='center' style='border-top: 1px solid #000;'>Loaded IN</td></tr>";
            html += "<tr><th colspan='10' style='border-top: 1px solid #000;'>Report of Export Loaded Container Gate IN</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ENTRY DATE & TIME</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reference No. (Loaded Container Request No.)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-top: 1px solid #000;'>Exporter</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EntryDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'></td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.LoadContReqNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLine + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.ExporterName + " </td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";



            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        #endregion


        #region Report of Export Loaded Container Gate OUT

        public ActionResult ReportofExportLoadedContainerGateOUT()
        {
            return View();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult ReportofExportLoadedContainerGateOUTExcel(DSR_DailyCashBook vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=GateOperationReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.ReportofExportLoadedContainerGateOUT(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(ReportofExportLoadedContainerGateOUTExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }



        private string ReportofExportLoadedContainerGateOUTExcelPDF(DataSet ds, string FromDate, string ToDate)
        {

            List<dynamic> lstGateDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "GateOperationReport.pdf";
            string html = "<html><body>";

            var i = 1;
            //Report of Export Loaded Container Gate OUT
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='11' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Report of Export Loaded Container Gate OUT</h5></td></tr>";
            html += "<tr><td colspan='11'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr><td colspan='11' align='center'>From " + FromDate + " to " + ToDate + "</td></tr>";
            html += "<tr><td colspan='11' align='center' style='border-top: 1px solid #000;'>By Road</td></tr>";
            html += "<tr><td colspan='11' align='center' style='border-top: 1px solid #000;'>Export Loaded Container (Loaded Container Request)</td></tr>";
            html += "<tr><td colspan='11' align='center' style='border-top: 1px solid #000;'>Loaded OUT</td></tr>";
            html += "<tr><th colspan='11' style='border-top: 1px solid #000;'>Report of Export Loaded Container Gate OUT</th></tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exit through Gate DATE (Gate Pass- Loaded Container Payment Sheet)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS CODE</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Vehicle No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CONTAINER NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipping Line</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CHA</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Exporter</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transfer To (Loaded Container Payment Sheet)</th>";
            html += "<th style='border-top: 1px solid #000;'>Container Weight</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            lstGateDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.GateExitDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VehicleNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingLineName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CHAName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ImpExpName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.PortName + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.GrossWt + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        #endregion
        #region Stuffing Acknowledgement Search       

        [HttpGet]
        public ActionResult StfAckSearch()
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();

            ObjGR.GetAllContainerNoForContstufserach("", 0);

            if (ObjGR.DBResponse.Data != null)
            {
                var Jobj = Newtonsoft.Json.JsonConvert.SerializeObject(ObjGR.DBResponse.Data);
                var Jobject = Newtonsoft.Json.Linq.JObject.Parse(Jobj);
                ViewBag.LstStuffing = Jobject["LstStuffing"];
                ViewBag.StateCont = Jobject["State"];
            }
            else
            {
                ViewBag.LstStuffing = null;
            }


            ObjGR.GetAllShippingBillNoForContstufserach("", 0);
            if (ObjGR.DBResponse.Data != null)
            {
                var Jobj = Newtonsoft.Json.JsonConvert.SerializeObject(ObjGR.DBResponse.Data);
                var Jobject = Newtonsoft.Json.Linq.JObject.Parse(Jobj);
                ViewBag.LstStuff = Jobject["LstStuff"];
                ViewBag.StateShipbill = Jobject["State"];
            }
            else
            {
                ViewBag.LstStuff = null;
            }

            return PartialView();
        }
        [HttpGet]
        public JsonResult SearchContainerNo(string cont)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            ObjGR.GetAllContainerNoForContstufserach(cont, 0);
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        [HttpGet]
        public JsonResult SearchShipbill(string shipbill)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            ObjGR.GetAllShippingBillNoForContstufserach(shipbill, 0);
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        [HttpGet]
        public JsonResult LoadContainerLists(string cont, int Page)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            ObjGR.GetAllContainerNoForContstufserach(cont, Page);
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }


        [HttpGet]
        public JsonResult LoadShipbillLists(string shipbill, int Page)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            ObjGR.GetAllShippingBillNoForContstufserach(shipbill, Page);
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        [HttpGet]
        public JsonResult getcontstuffingacksearch(string container, string shipbill, string cfscode)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            List<Dsr_ContStufAckRes> Lststufack = new List<Dsr_ContStufAckRes>();
            ObjGR.GetStufAckResult(container, shipbill, cfscode);


            if (ObjGR.DBResponse.Data != null)
            {
                Lststufack = (List<Dsr_ContStufAckRes>)ObjGR.DBResponse.Data;
            }
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        #endregion

        #region SBill Query
        [HttpGet]
        public ActionResult SBQuery()
        {
            var ObjRR = new DSR_ReportRepository();
            ObjRR.GetAllSB();

            if (ObjRR.DBResponse.Data != null)
            {
                ViewBag.ListOfSB = new SelectList((List<DSR_SBQuery>)ObjRR.DBResponse.Data, "Id", "SBNODate");
            }
            return PartialView();
        }

        // [HttpPost, ValidateAntiForgeryToken]
        public JsonResult GetApplicationDetForSBQuery(string Id, string sbno, string sbdate)
        {
            int id = Convert.ToInt32(Id);
            string SBNO = Convert.ToString(sbno);
            DSR_SBQuery objCR = new DSR_SBQuery();
            DSR_ReportRepository objRR = new DSR_ReportRepository();
            objRR.SBQueryReport(id, sbno, sbdate);
            if (objRR.DBResponse.Data != null)
            {
                objCR = (DSR_SBQuery)objRR.DBResponse.Data;
                return Json(objCR, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(new { Status = -1, Message = "No Data" }, JsonRequestBehavior.AllowGet);
            }
        }


        #endregion
        #region ASR Acknowledgement Search       

        [HttpGet]
        public ActionResult StuffingASRAckSearch()
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();

            //ObjGR.GetAllShippingBillNoForASRACK("", 0);
            //if (ObjGR.DBResponse.Data != null)
            //{
            //    var Jobj = Newtonsoft.Json.JsonConvert.SerializeObject(ObjGR.DBResponse.Data);
            //    var Jobject = Newtonsoft.Json.Linq.JObject.Parse(Jobj);
            //    ViewBag.LstStuff = Jobject["LstStuff"];
            //    ViewBag.StateShipbill = Jobject["State"];
            //}
            //else
            //{
            //    ViewBag.LstStuff = null;
            //}

            return PartialView();
        }

        [HttpGet]
        public JsonResult ASRSearchContainerNo(string cont)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            ObjGR.GetCotainerNoForASRAck(cont, 0);
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpGet]
        public JsonResult ASRLoadContainerLists(string cont, int Page)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            ObjGR.GetCotainerNoForASRAck(cont, Page);
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        [HttpGet]
        public JsonResult ASRSearchShipbill(string shipbill)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            ObjGR.GetAllShippingBillNoForASRACK(shipbill, 0);
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpGet]
        public JsonResult ASRLoadShipbillLists(string shipbill, int Page)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            ObjGR.GetAllShippingBillNoForASRACK(shipbill, Page);
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        [HttpGet]
        public JsonResult GetASRACKStatusSearch(string shipbill, string CFSCode, string container)

        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            List<Dsr_ContStufAckRes> Lststufack = new List<Dsr_ContStufAckRes>();
            ObjGR.GetASRAckResult(shipbill, CFSCode, container);


            if (ObjGR.DBResponse.Data != null)
            {
                Lststufack = (List<Dsr_ContStufAckRes>)ObjGR.DBResponse.Data;
            }
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        #endregion

        #region DP Acknowledment Serach  

        [HttpGet]
        public ActionResult DPAckSearch()
        {
            return PartialView();
        }

        public JsonResult GetGatePassNoDPForAckSearch(string GatePassNo = "", int Page = 0)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            List<Dsr_GatePassDPAckSearch> lstDPGPAck = new List<Dsr_GatePassDPAckSearch>();
            ObjGR.GetGatePassNoDPForAckSearch(GatePassNo, Page);
            //if (ObjGR.DBResponse.Data != null)
            //{
            //    lstDTGPAck = (List<Dsr_GatePassDTAckSearch>)ObjGR.DBResponse.Data;
            //}
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        public JsonResult GetContainerNoForDPAckSearch(string ContainerNo = "", int Page = 0)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            List<Dsr_ContDPAckSearch> lstDPContACK = new List<Dsr_ContDPAckSearch>();
            ObjGR.GetContainerNoForDPAckSearch(ContainerNo, Page);
            //if (ObjGR.DBResponse.Data != null)
            //{
            //    lstDTContACK = (List<Dsr_ContDTAckSearch>)ObjGR.DBResponse.Data;
            //}
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        public JsonResult GetDPAckSearch(int GatePassId, string ContainerNo, int GatePassdtlId = 0)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            List<Dsr_DPAckRes> lstDPAckRes = new List<Dsr_DPAckRes>();
            ObjGR.GetDPAckSearch(GatePassId, ContainerNo, GatePassdtlId);

            if (ObjGR.DBResponse.Data != null)
            {
                lstDPAckRes = (List<Dsr_DPAckRes>)ObjGR.DBResponse.Data;
            }
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        #endregion

        #region DT Acknowledment Serach  

        [HttpGet]
        public ActionResult DTAckSearch()
        {
            return PartialView();
        }

        public JsonResult GetGatePassNoDTForAckSearch(string GatePassNo = "", int Page = 0)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            List<Dsr_GatePassDTAckSearch> lstDTGPAck = new List<Dsr_GatePassDTAckSearch>();
            ObjGR.GetGatePassNoDTForAckSearch(GatePassNo, Page);

            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        public JsonResult GetContainerNoForDTAckSearch(string ContainerNo = "", int Page = 0)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            List<Dsr_ContDTAckSearch> lstDTContACK = new List<Dsr_ContDTAckSearch>();
            ObjGR.GetContainerNoForDTAckSearch(ContainerNo, Page);

            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        public JsonResult GetDTAckSearch(int GatePassId, string ContainerNo)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            List<Dsr_DTAckRes> lstDTAckRes = new List<Dsr_DTAckRes>();
            ObjGR.GetDTAckSearch(GatePassId, ContainerNo);

            if (ObjGR.DBResponse.Data != null)
            {
                lstDTAckRes = (List<Dsr_DTAckRes>)ObjGR.DBResponse.Data;
            }
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        #endregion

        #region Stuffing Loaded Search
        [HttpGet]
        public ActionResult StfLoadSearch()
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            return PartialView();
        }

        [HttpGet]
        public JsonResult getloadstufsearch(string jobno)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            List<DSR_loadstuf> Lststufack = new List<DSR_loadstuf>();
            ObjGR.GetStufloadResult(jobno);


            if (ObjGR.DBResponse.Data != null)
            {
                Lststufack = (List<DSR_loadstuf>)ObjGR.DBResponse.Data;
            }
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        [HttpGet]
        public JsonResult getloadstufasrsearch(string jobasrno)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            List<DSR_loadstufasr> Lststufack = new List<DSR_loadstufasr>();
            ObjGR.GetStufloadasrResult(jobasrno);


            if (ObjGR.DBResponse.Data != null)
            {
                Lststufack = (List<DSR_loadstufasr>)ObjGR.DBResponse.Data;
            }
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        [HttpGet]
        public JsonResult getloadstufdpsearch(string jobdpno)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            List<DSR_loadstufdp> Lststufack = new List<DSR_loadstufdp>();
            ObjGR.GetStufloaddpResult(jobdpno);


            if (ObjGR.DBResponse.Data != null)
            {
                Lststufack = (List<DSR_loadstufdp>)ObjGR.DBResponse.Data;
            }
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        [HttpGet]
        public JsonResult getloadstufdtsearch(string jobdtno)
        {
            DSR_ReportRepository ObjGR = new DSR_ReportRepository();
            List<DSR_loadstufdt> Lststufack = new List<DSR_loadstufdt>();
            ObjGR.GetStufloaddtResult(jobdtno);


            if (ObjGR.DBResponse.Data != null)
            {
                Lststufack = (List<DSR_loadstufdt>)ObjGR.DBResponse.Data;
            }
            return Json(ObjGR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        #endregion

        #region  Bond STORAGE COLLECTION REPORT 
        [HttpGet]
        public ActionResult BondStorageCollectionReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult BondStorageCollectionReport(string FromDate, string ToDate)
        {
            try
            {
                var ObjRR = new DSR_ReportRepository();
                ObjRR.BondStorageCollectionReport(FromDate, ToDate);
                if (ObjRR.DBResponse.Data != null)
                {
                    DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                    string Path = BondStorageCollectionReportPDF(ds, FromDate, ToDate);
                    return Json(new { Status = 1, Message = Path });

                }
                return Json(new { Status = -1, Message = "No data found" });
            }
            catch
            {
                return Json(new { Status = -1, Message = "Error" });
            }
        }
        [NonAction]
        public string BondStorageCollectionReportPDF(DataSet ds, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "BondStorageCollectionReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + ds.Tables[0].Rows[0]["CompanyAddress"].ToString() + "<br/>Email : " + ds.Tables[0].Rows[0]["EmailAddress"].ToString() + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Bond Storage Collection REGISTER</label><br/><label style='font-size: 7pt;'><b>From Date :</b> " + FromDate + " - <b>To Date :</b> " + ToDate + "</label></td>");
                Pages.Append("<td valign='top'><img align='right' src='ISO_IMG' width='100'/></td>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                decimal StoAmount = 0;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt; text-align: center;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 5%;'>Sl No.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 10%;'>Date</th>");
                Pages.Append("<th style='border-bottom: 1px solid #000; width: 10%;'>Storage Amount</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                ds.Tables[0].AsEnumerable().ToList().ForEach(item =>
                {
                    Pages.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + item["Date"].ToString() + " </td>");
                    Pages.Append("<td style='border-bottom: 1px solid #000;'>" + item["Amount"].ToString() + "</td>");
                    Pages.Append("</tr>");
                    StoAmount = StoAmount + Convert.ToDecimal(item["Amount"]);
                    i++;
                });
                Pages.Append("<tr>");
                Pages.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:left;'>TOTAL</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + StoAmount + "</th></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                Pages.Replace("ISO_IMG", Server.MapPath("~/Content/Images/iso_logo.jpg"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                //if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                //{
                //    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                //}
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO_IMG", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch (Exception ex)
            {
                return "";
            }
        }
        #endregion

        #region Indent of Disinfestation Material

        public ActionResult IndDisinfestationMaterialPCSReport()
        {
            return PartialView();
        }


        public JsonResult GetIndDisinfectionMaterialCertificateNo()
        {
            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetCertificateNo();
            return Json(obj.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetIndDisinfestationMaterial(FormCollection formCollection)
        {
            string CertificateNo = Convert.ToString(formCollection["CertificateNo"]);
            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetPcsIndDisinfestationMaterial(CertificateNo);
            if (obj.DBResponse.Status == 1)
            {
                DataSet ds = new DataSet();
                ds = (DataSet)obj.DBResponse.Data;
                string Path = GenerateIndDisinfestationMaterialPDF(ds);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(new { Status = 0, Data = "" }, JsonRequestBehavior.AllowGet);
            }

        }

        [NonAction]
        public string GenerateIndDisinfestationMaterialPDF(DataSet ds)
        {
            try
            {
                List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
                List<dynamic> lstDisinfestation = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
                List<dynamic> objDisinfestationSummary = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);

                var FileName = "GenerateIndDisinfestationMaterialPDF.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'><tbody>");

                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='80'/></td>");
                Pages.Append("<td width='150%' valign='top' align='center'><h1 style='font-size: 16px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                Pages.Append("<label style='display: block; font-size: 7pt;'>(A Govt. of India Undertaking) </label><br />");
                Pages.Append("<span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br />");
                Pages.Append("<label style='display: block; font-size: 7pt; font-weight: bold;'>INDENT OF DISINFESTATION MATERIAL</label></td>");
                Pages.Append("</tr>");

                Pages.Append("<tr><td colspan='12'><span><br/><br/></span></td></tr>");

                Pages.Append("<tr><td colspan='6' width='50%'>Indent Serial No.: .....................</td> <td colspan='6' width='50%' align='right'>Region: Gujarat</td></tr>");

                Pages.Append("<tr><td colspan='12'><span><br/><br/></span></td></tr>");

                Pages.Append("<tr><td colspan='12'><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> Thre following materials are required for the purpose of <b><u>Fumigation</u></b> for use at <b><u>ICD-DASHRATH</u></b> (Place, Godown and Stack No.) on <b><u>" + objDisinfestationSummary[0].DateOfFumigation + "</u></b> </td></tr>");

                Pages.Append("<tr><td colspan='12'><span><br/></span></td></tr>");

                Pages.Append("<tr><td colspan='12' style='padding:0;'><table cellspacing='0' cellpadding='5' style='border: 1px solid #000; text-align: center; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:8pt;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr>");
                Pages.Append("<th rowspan='2' style='border-right:1px solid #000;'>Sr.No.</th>");
                Pages.Append("<th rowspan='2' style='border-right:1px solid #000;'>Material & brief Particulars</th>");
                Pages.Append("<th colspan='2' style='border-right:1px solid #000;'>Quantity</th>");
                Pages.Append("<th colspan='2' style='border-right:1px solid #000;'>MTs/Volume to be disifested</th>");
                Pages.Append("<th rowspan='2'>Remarks</th>");
                Pages.Append("</tr>");
                Pages.Append("<tr>");
                Pages.Append("<th style='border-right:1px solid #000; border-top:1px solid #000;'>ALP GMs</th>");
                Pages.Append("<th style='border-right:1px solid #000; border-top:1px solid #000;'>No. Cans</th>");
                Pages.Append("<th style='border-right:1px solid #000; border-top:1px solid #000;'>MTs</th>");
                Pages.Append("<th style='border-right:1px solid #000; border-top:1px solid #000;'>CM</th>");
                Pages.Append("</tr>");
                Pages.Append("</thead>");
                Pages.Append("<tbody>");
                Pages.Append("<tr>");
                if (lstDisinfestation != null)
                {
                    for (int i = 0; i < lstDisinfestation.Count; i++)
                    {
                        Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + (i + 1) + "</td>");
                        Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + lstDisinfestation[i].Material + "</td>");
                        Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + lstDisinfestation[i].Alp + "</td>");
                        Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + lstDisinfestation[i].NoCanes + "</td>");
                        Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + lstDisinfestation[i].MTS + "</td>");
                        Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + lstDisinfestation[i].Volume + "</td>");
                        Pages.Append("<td style='border-top: 1px solid #000;'>" + lstDisinfestation[i].Remarks + "</td>");
                        Pages.Append("</tr>");
                    }
                }
                Pages.Append("<tr>");
                Pages.Append("<th colspan='2' style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: right;'>Total</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + objDisinfestationSummary[0].TotalAlp + "</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + objDisinfestationSummary[0].TotalNoCanes + "</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + objDisinfestationSummary[0].TotalMTS + "</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + objDisinfestationSummary[0].TotalVolume + "</th>");
                Pages.Append("<th style='border-top: 1px solid #000;'></th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody>");
                Pages.Append("</table></td></tr>");

                Pages.Append("<tr><td colspan='12'><span><br/><br/><br/><br/></span></td></tr>");

                Pages.Append("<tr><td colspan='6' width='50%'>Date: " + objDisinfestationSummary[0].DateOfFumigation + "</td> <td colspan='6' width='50%' align='right'>(Signature of TA/JTA)</td></tr>");

                Pages.Append("<tr><td colspan='12'><span><br/></span></td></tr>");

                Pages.Append("<tr><td colspan='12'><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> The above required materials have been issued to <b><u>Supdt/DO</u></b> on  <b>" + objDisinfestationSummary[0].DateOfFumigation + "</b> and entered in then Chemical Consumable Register at Folio No <b><u>..........................</u></b> </td></tr>");
                Pages.Append("<tr><td colspan='12'><span><br/></span></td></tr>");
                Pages.Append("<tr><td colspan='12'>Quantity Consumed <b><u>Full/..</u></b></td></tr>");
                Pages.Append("<tr><td colspan='12'><span><br/></span></td></tr>");
                Pages.Append("<tr><td colspan='12'>Quantity Consumed <b><u>Nil/..</u></b></td></tr>");
                Pages.Append("<tr><td colspan='12'><span><br/></span></td></tr>");
                Pages.Append("<tr><td colspan='12'>(If any)</td></tr>");
                Pages.Append("<tr><td colspan='12'><span><br/></span></td></tr>");
                Pages.Append("<tr><td colspan='12'>Date: <b>" + objDisinfestationSummary[0].DateOfFumigation + "</b></td></tr>");
                Pages.Append("<tr><td colspan='12'><span><br/></span></td></tr>");
                Pages.Append("<tr><td colspan='6' width='50%'>Technical Assistant/Jr.Technical Assistant</td> <td colspan='6' width='50%' align='right'>Warehouse Manager</td></tr>");
                Pages.Append("<tr><td colspan='12' align='right'>Date: <b>" + objDisinfestationSummary[0].DateOfFumigation + "</b></td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 30f, 30f, 30f, 30f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;

            }
            catch (Exception ex)
            {
                return "";
            }
        }
        #endregion


        #region  Receipt Register

        public ActionResult ReceiptRegisterReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetReceiptRegisterReport(DSR_ReportRegister vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=ReceiptRegister.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetReceiptReportExcel(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(GetReceiptRegisterReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string GetReceiptRegisterReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstBTTGatePassDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "ReceiptRegister.pdf";
            string html = "<html><body>";

            //GATE Pass BTT (Back to Town)
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>Receipt Register</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th colspan='1' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='1' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='1' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='1' style='border-right: 1px solid #000; border-top: 1px solid #000;'></ th>";
            html += "<th colspan='1' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='1' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='1' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='1' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='1' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='1' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='1' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='2' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Payment Receipt (Excluding TDS)</th>";
            html += "<th colspan='2' style='border-right: 1px solid #000; border-top: 1px solid #000;'>TDS</th>";
            html += "<th colspan='1' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='1' style='border-top: 1px solid #000;'></th>";
            html += "</tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Instrument Number (NEFT/RTGS/CHEQUE ETC. NO)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Instrument Date  (NEFT/RTGS/CHEQUE ETC. DATE)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice no.(For Cash)</ th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date(For Cash) </th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipts No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receipt Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Payment By</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Party Address</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>MODE OF PAYMNET(CASH / NEFT / RTGS / CHEQUE / SD) </th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Drawee Bank</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>OTHER THAN SD DEPOSIT</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; width:100px;'>SD</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>OTHER THAN SD DEPOSIT</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; width:100px;'>SD</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>TOTAL AMOUNT INCLUDING TDS</th>";
            html += "<th style='border-top: 1px solid #000;'>REMARK</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstBTTGatePassDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InstrumentNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Date + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PartyAddress + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PayMode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DraweeBank + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.rcptotherthansd + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TotalPaymentReceiptassd + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TdsAmount + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TDSDeposit + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Total + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.Remarks + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  SCMTR CIM SF Report

        public ActionResult SCMTRCIMSFReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetSCMTRReport(DSR_SCMTRSFRpt vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=CIMSFReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetCIMSFReport(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(GetSCMTRReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string GetSCMTRReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstBTTGatePassDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "CIMSFReport.pdf";
            string html = "<html><body>";

            //GATE Pass BTT (Back to Town)
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>SCMTR CIM SF Report</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th colspan='22' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='9' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>HEADER FILED</th>";
            html += "<th colspan='5' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master Declaration</th>";
            html += "<th colspan='2' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master CIM</th>";
            html += "<th colspan='10' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master Location</th>";
            html += "<th colspan='16' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master: Cargo Container</th>";
            html += "<th colspan='8' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master: Supporting Document</th>";
            html += "<th colspan='13' align='left' style='border-top: 1px solid #000;'>Master: Cargo Details</th>";
            html += "</tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Stuffing Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STUFFING Sheet NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</ th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIM SF Sent (Successful/ Unsuccessful)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIM SF Sent (Date & Time)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SF File Job No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SF Ack (Successful/ Not Received)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>If SF ACK Unsuccessful, SF Error Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>If SF ACK Unsuccessful, SF Error Code Name/ Description</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIM SF APPROVAL</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PackUQC/ PackUOM</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Quantity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Weight</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Loading</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Discharge (Foreign Port)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Final Destination Location</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Indicator</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>MessageID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sequence Or Control Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Time</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Event</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sender ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receiver ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Version No</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Message Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port Of Reporting</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Event</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIM No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIM Date</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Party Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Party Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reference Movement Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reference Movement No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reference Movement Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Bond No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Location Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Location Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Next Destination of Unlading</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Authorized Person PAN</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Message Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Sequence No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Load Status</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Additional Equipment Hold</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Final Destination Location</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Event Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Seal Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Seal No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Other Equipment ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Status</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Pkg</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Quantity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment UQC</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Message Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Serial No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Serial No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Icegate User ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IRN No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Reference No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Type Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Beneficiary Code</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Message Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo Sequence No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Site</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipment Load Status</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Quantity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Packets From</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Packets To</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Pack UQC</th>";
            html += "<th style='border-top: 1px solid #000;'>MCIN / PCIN</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstBTTGatePassDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.stuffingdate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffingNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.cimsfsent + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CreatedOn + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.sffilejobno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SFAck + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ERRORCODE + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ErrorMessage + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIMCustoms + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PackUQCPackUOM + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffedQuantity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffedWeight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FOB + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofLoading + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofDischarge + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FinalDestinationLocation + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Indicator + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SequenceOrControlNumber + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Date + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Time + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingEvent + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SenderID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiverID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VersionNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortOfReporting + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingEvent + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'></td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIMNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIMDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingPartyType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingpartyCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReferenceMovementType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReferenceMovementNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReferenceMovementDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingLocationCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingLocationName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NextDestinationofUnlading + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AuthorizedPersonPAN + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentSequenceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Equipmenttype + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentSize + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentLoadStatus + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AdditionalEquipmentHold + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FinalDestinationLocation + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EventDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentsealType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentSealNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OtherEquipmentID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentStatus + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentPkg + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentQuantity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentUQC + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentSerialno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IcegateUserID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IRNNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentReferenceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentTypeCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BeneficiaryCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoSequenceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentSite + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShipmentLoadStatus + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PackageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Quantity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PacketsFrom + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PacketsTo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PackUQC + "</td>";
                    html += "<td style='border-top: 1px solid #000; text-align: center;'>" + item.MCINPCIN + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion
        #region  SCMTR CIM DP Report

        public ActionResult SCMTRCIMDPReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetSCMTRDPReport(DSR_SCMTRDPRpt vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=CIMDPReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetCIMDPReport(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(GetSCMTRReportDPExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string GetSCMTRReportDPExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstBTTGatePassDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "CIMDPReport.pdf";
            string html = "<html><body>";

            //GATE Pass BTT (Back to Town)
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>SCMTR CIM SF Report</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th colspan='22' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='9' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>HEADER FILED</th>";
            html += "<th colspan='5' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master Declaration</th>";
            html += "<th colspan='2' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master CIM</th>";
            html += "<th colspan='10' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master Location</th>";
            html += "<th colspan='5' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master: Transport Means</th>";
            html += "<th colspan='4' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master: Events</th>";
            html += "<th colspan='16' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master: Cargo Container</th>";
            html += "<th colspan='8' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master: Supporting Document</th>";
            html += "<th colspan='13' align='left' style='border-top: 1px solid #000;'>Master: Cargo Document</th>";
            html += "</tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Stuffing Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STUFFING Sheet NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CFS Code</ th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SF File Job No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SF Ack File Successful/ Error Description</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIM SF APPROVAL</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIM DP Sent (Date & Time)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIM DP Sent (Successful/ Unsuccessful)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DP Job No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>DP Ack (Successful/ Not Received)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>If DP ACK Unsuccessful, DP Error Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>If DP ACK Unsuccessful, DP Error Code Name/ Description</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PackUQC/ PackUOM</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Quantity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Weight</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Loading</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Discharge (Foreign Port)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Final Destination Location</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Next Port of Call Name</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Indicator</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>MessageID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sequence Or Control Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Time</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Event</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sender ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receiver ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Version No</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Message Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port Of Reporting</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Event</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIM No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIM Date</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Party Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Party Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reference Movement Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reference Movement No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reference Movement Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Bond No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Location Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Location Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Next Destination of Unlading</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Authorized Person PAN</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transport Means Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transport Means No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transport Means eID Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transport Means eID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Total Equipment’s</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Expected Time of Departure</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Actual Time of Departure</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Expected Time of Arrival</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Actual Time of Arrival</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Message Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Sequence No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Load Status</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Additional Equipment Hold</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Final Destination Location</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Event Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Seal Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Seal No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Other Equipment ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Status</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Pkg</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Quantity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment UQC</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Message Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Serial No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Serial No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Icegate User ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IRN No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Reference No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Type Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Beneficiary Code</th>";

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Message Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo Sequence No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Site</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipment Load Status</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Quantity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Packets From</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Packets To</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Pack UQC</th>";
            html += "<th style='border-top: 1px solid #000;'>MCIN / PCIN</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstBTTGatePassDetails.ToList().ForEach(item =>
            {
                try
                {
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.stuffingdate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffingNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CFSCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ContainerNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Size + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.sffilejobno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SFAck + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIMCustoms + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIMDPSentDateTime + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIMDPSent + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DPJobNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DPAck + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DPACKerror + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DPAckdescription + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PackUQCPackUOM + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffedQuantity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffedWeight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FOB + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofLoading + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofDischarge + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FinalDestinationLocation + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NextPortofCallName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Indicator + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SequenceOrControlNumber + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Date + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Time + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingEvent + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SenderID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiverID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VersionNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortOfReporting + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingEvent + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIMNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIMDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingPartyType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingpartyCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReferenceMovementType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReferenceMovementNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReferenceMovementDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingLocationCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingLocationName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NextDestinationofUnlading + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AuthorizedPersonPAN + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TransportMeansType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TransportMeansNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'></td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TransportMeanseIDType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TransportMeanseID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TotalEquipments + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExpectedTimeofDeparture + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ActualTimeofDeparture + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ExpectedTimeofArrival + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ActualTimeofArrival + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageTypee + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentSequenceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Equipmenttype + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentSize + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentLoadStatus + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AdditionalEquipmentHold + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FinalDestinationLocations + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EventDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentsealType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentSealNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OtherEquipmentID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentStatus + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentPkg + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentQuantity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentUQC + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageTypes + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentSerialno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IcegateUserID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IRNNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentReferenceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentTypeCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BeneficiaryCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoSequenceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentType + "</td>";


                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentSite + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShipmentLoadStatus + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PackageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Quantity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PacketsFrom + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PacketsTo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PackUQC + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MCINPCIN + "</td>";

                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion

        #region  SCMTR CIM ASR Report

        public ActionResult SCMTRCIMASRReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetSCMTRASRReport(DSR_SCMTRSFRpt vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=CIMASRReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.GetCIMASRReport(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(GetSCMTRASRReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();


            return Content("xc");
        }


        private string GetSCMTRASRReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {
            int SLNo = 0;

            List<dynamic> lstBTTGatePassDetails = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);

            var FileName = "CIMASRReport.pdf";
            string html = "<html><body>";

            //GATE Pass BTT (Back to Town)
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 7pt;'>ICD-DASHRATH, VADODARA</label><h5 style='font-weight: bold;'>SCMTR CIM ASR Report</h5></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";
            html += "<thead>";
            html += "<tr>";
            html += "<th colspan='19' style='border-right: 1px solid #000; border-top: 1px solid #000;'></th>";
            html += "<th colspan='9' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>HEADER FILED</th>";
            html += "<th colspan='5' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master Declaration</th>";
            html += "<th colspan='10' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master Location</th>";
            html += "<th colspan='5' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master: Transport Means</th>";
            html += "<th colspan='6' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo Entry</th>";
            html += "<th colspan='13' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master: Cargo Details</th>";
            html += "<th colspan='8' align='left' style='border-right: 1px solid #000; border-top: 1px solid #000;'>Master: Supporting Document</th>";
            html += "<th colspan='16' align='left' style='border-top: 1px solid #000;'>Master: Cargo Container</th>";
            html += "</tr>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sl no.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Container Stuffing date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>STUFFING Sheet NO</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SHIPPING Bill Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIM ASR Sent(Date & Time)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>CIM ASR Sent(Successful / Unsuccessful)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ASR Job No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>ASR Ack(Successful/ Not Received)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>If ASR ACK Unsuccessful, ASR Error Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>If ASR ACK Unsuccessful, ASR Error Code Name / Description</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>PackUQC / PackUOM</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Quantity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Stuffed Weight</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>FOB</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Loading</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port of Discharge(Foreign Port)</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Final Destination Location</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Next Port of Call Name</th>";

            //HEADER FILED

            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Indicator</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>MessageID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sequence Or Control Number</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Time</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Event</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Sender ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Receiver ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Version No</th>";

            //Master Declaration
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Message Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port Of Reporting</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Job Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Event</th>";

            //Master Location
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Party Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Party Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reference Movement Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reference Movement No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reference Movement Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Bond No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Location Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Reporting Location Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Next Destination of Unlading</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Authorized Person PAN</th>";

            //Master: Transport Means
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transport Means Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transport Means No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transport Means eID Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Transport Means eID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Total Equipment’s</th>";

            //Cargo Etnry
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port Of Call SeqNmbr</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port Of Call Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Port Of Call Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Next Port Of Call Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Next Port Of Call Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Mode Of Transport</th>";

            //Master: Cargo Details
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Message Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Cargo Sequence No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Site</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Shipment Load Status</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Package Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Quantity</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Packets From</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Packets To</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Pack UQC</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>MCIN / PCIN</th>";

            //Master: Supporting Document
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Message Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Serial No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Serial No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Icegate User ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>IRN No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Reference No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Document Type Code</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Beneficiary Code</th>";

            //Master:  Cargo Container			
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Message Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Sequence No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Size</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Load Status</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Additional Equipment Hold</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Final Destination Location</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Event Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Seal Type</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Seal No.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Other Equipment ID</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Status</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Pkg</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Equipment Quantity</th>";
            html += "<th style='border-top: 1px solid #000;'>Equipment UQC</th>";
            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int i = 1;
            lstBTTGatePassDetails.ToList().ForEach(item =>
            {
                try
                {
                    //18
                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffingDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffingNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShippingBillDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIMAsrSent + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CIMAsrSentDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ASRJobno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ASRAck + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ASRAckErrorCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ASRAckErrorDesc + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PackUQCPackUOM + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffedQuantity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.StuffedWeight + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FOB + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofLoading + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortofDischarge + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FinalDestinationLocation + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NextPortCallName + "</td>";
                    //HEADER FILED(9)
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Indicator + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SequenceOrControlNumber + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Date + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Time + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingEvent + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.SenderID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiverID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.VersionNo + "</td>";
                    //Master Declaration(5)
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortOfReporting + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.JobDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingEvent + "</td>";
                    //Master Location(10)
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingPartyType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingpartyCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReferenceMovementType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReferenceMovementNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReferenceMovementDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BondNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingLocationCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReportingLocationName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NextDestinationofUnlading + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AuthorizedPersonPAN + "</td>";
                    //Master: Transport Means(5)
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TransportMeansType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TransportMeansNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TransportMeanseIDType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TransportMeanseID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TotalEquipments + "</td>";
                    //Cargo Itnry(6)
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortOfCallSeqNmbr + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortOfCallCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PortOfCallName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NextPortOfCallCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.NextPortOfCallName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ModeOfTransport + "</td>";
                    //Master: Cargo Details(13)
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.CargoSequenceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentSite + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ShipmentLoadStatus + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PackageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Quantity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PacketsFrom + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PacketsTo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.PackUQC + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MCINorPCIN + "</td>";
                    //Master: Supporting Document(8)
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentSerialNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentSerialno + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IcegateUserID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.IRNNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentReferenceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DocumentTypeCode + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BeneficiaryCode + "</td>";
                    //Master: Cargo Container(16)
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.MessageType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentSequenceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Equipmenttype + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentSize + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentLoadStatus + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.AdditionalEquipmentHold + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.FinalDestinationLocations + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EventDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentsealType + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentSealNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.OtherEquipmentID + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentStatus + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentPkg + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentQuantity + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.EquipmentUQC + "</td>";
                    html += "</tr>";

                    i++;
                }
                catch (Exception Ex)
                {

                }
            });
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";


            html += "</body></html>";

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }

        #endregion




        #region Daily Inventory for NLDSL

        public ActionResult DailyInventoryForNldsl()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public FileResult DailyInventoryForNldslReport(FormCollection fc)
        {
            string AsOnDate = Convert.ToString(fc["AsOnDate"].ToString());
            var excelName = "CFS_ICD_01_ORGCODE_" + DateTime.ParseExact(AsOnDate, "dd/MM/yyyy", CultureInfo.InvariantCulture).ToString("ddMMyyyy") + DateTime.Now.ToString("HHmmss") + ".xls";
            try
            {



                var ObjRR = new DSR_ReportRepository();
                DataTable dt = new DataTable();
                DataSet ds = new DataSet();
                ObjRR.DailyInventoryForNldsl(AsOnDate);
                if (ObjRR.DBResponse.Status == 1)
                {
                    ds = (DataSet)ObjRR.DBResponse.Data;
                    dt = ds.Tables[0];
                }






                if (dt.Rows.Count > 0)
                    return File(GetDailyInventoryForNldslExcel(dt), "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", excelName);
                else
                {
                    string name = DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
                    var excelFile = Server.MapPath("~/Docs/Excel/" + name + ".xls");
                    using (var exl = new DynamicExcel.ExcelGenerator(excelFile))
                    {
                        exl.AddCell("A1", "No data found");
                        exl.Save();
                        return File(excelFile, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", excelName);
                    }
                }
            }
            catch (Exception ex)
            {
                string name = DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
                var excelFile = Server.MapPath("~/Docs/Excel/" + name + ".xlsx");
                using (var exl = new DynamicExcel.ExcelGenerator(excelFile))
                {
                    exl.AddCell("A1", "No data found");
                    exl.Save();
                    return File(excelFile, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", excelName);
                }
            }
            // return null;
        }


        private string GetDailyInventoryForNldslExcel(DataTable dt)
        {
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/Excel")))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/Excel"));
            }
            var excelFile = Server.MapPath("~/Docs/Excel/" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".xlsx");
            System.Web.UI.WebControls.GridView Grid = new System.Web.UI.WebControls.GridView();


            System.Web.UI.WebControls.Table tb = new System.Web.UI.WebControls.Table();

            if (dt.Rows.Count > 0)
            {

                Grid.AllowPaging = false;
                Grid.DataSource = dt;
                Grid.DataBind();


                for (int i = 0; i < Grid.HeaderRow.Cells.Count; i++)
                {
                    Grid.HeaderRow.Cells[i].Style.Add("background-color", "#edebeb");
                    Grid.HeaderRow.Cells[i].Attributes.Add("class", "Headermode");

                }

                for (int i = 0; i < Grid.Rows.Count; i++)
                {

                    Grid.Rows[i].BackColor = System.Drawing.Color.White;


                    if (i % 2 != 0)
                    {
                        Grid.Rows[i].Attributes.Add("class", "textmode");
                    }
                    else
                    {
                        Grid.Rows[i].Attributes.Add("class", "textmode2");
                    }

                }


                //System.Web.UI.WebControls.TableCell cell1 = new System.Web.UI.WebControls.TableCell();
                //cell1.Text = "<b> CENTRAL WAREHOUSING CORPORATION </b> ";
                //cell1.ForeColor = System.Drawing.Color.Black;
                //System.Web.UI.WebControls.TableRow tr1 = new System.Web.UI.WebControls.TableRow();
                //tr1.Cells.Add(cell1);
                //tr1.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;

                //System.Web.UI.WebControls.TableCell cell3 = new System.Web.UI.WebControls.TableCell();
                //cell3.Text = "CENTRAL WAREHOUSE";
                //cell3.ForeColor = System.Drawing.Color.Black;

                //System.Web.UI.WebControls.TableRow tr3 = new System.Web.UI.WebControls.TableRow();
                //tr3.Cells.Add(cell3);
                //tr3.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;


                //System.Web.UI.WebControls.TableCell cell4 = new System.Web.UI.WebControls.TableCell();
                //cell4.Text = "Import Stock Value Report From " + datevalue + " to " + datevalueto;
                //System.Web.UI.WebControls.TableRow tr4 = new System.Web.UI.WebControls.TableRow();
                //cell4.ForeColor = System.Drawing.Color.Black;

                //tr4.Cells.Add(cell4);
                //tr4.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;



                System.Web.UI.WebControls.TableCell cell5 = new System.Web.UI.WebControls.TableCell();
                cell5.Controls.Add(Grid);
                System.Web.UI.WebControls.TableRow tr5 = new System.Web.UI.WebControls.TableRow();
                tr5.Cells.Add(cell5);

                //tb.Rows.Add(tr1);
                ////   tb.Rows.Add(tr2);
                //tb.Rows.Add(tr3);
                //tb.Rows.Add(tr4);
                tb.Rows.Add(tr5);

            }
            using (System.IO.StringWriter sw = new System.IO.StringWriter())
            {
                using (System.Web.UI.HtmlTextWriter hw = new System.Web.UI.HtmlTextWriter(sw))
                {
                    System.IO.StreamWriter writer = System.IO.File.AppendText(excelFile);
                    tb.RenderControl(hw);
                    writer.WriteLine(sw.ToString());
                    writer.Close();
                }
            }



            return excelFile;
        }
        #endregion

        #region   Tally Response Report
        public ActionResult TallyResponseReport()
        {
            return View();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult TallyResponseReport(TallyResponse vm)
        {
            DSR_ReportRepository ObjRR = new DSR_ReportRepository();
            List<TallyResponse> lstData = new List<TallyResponse>();

            ObjRR.GetTallyResponse(vm);//, objLogin.Uid
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {

                lstData = (List<TallyResponse>)ObjRR.DBResponse.Data;
                Path = GenerateTallyResponseReport(lstData, vm.FromDate, vm.ToDate);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(new { Status = 0, Message = "No Record Found.." }, JsonRequestBehavior.AllowGet);
            }
        }

        [NonAction]
        public string GenerateTallyResponseReport(List<TallyResponse> lstData, string FromDate, string ToDate)
        {
            try
            {

                CompanyDetailsForReport objCompanyDetails = new CompanyDetailsForReport();
                WFLD_ReportRepository ObjRR = new WFLD_ReportRepository();
                ObjRR.getCompanyDetails();
                objCompanyDetails = (CompanyDetailsForReport)ObjRR.DBResponse.Data;
                var FileName = "TallyResponseReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td valign='top' width='10%'><img align='right' src='IMGSRC'/></td>");
                Pages.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1>");
                Pages.Append("<label style='font-size: 7pt;'>(A Govt. of India Undertaking) </label><br />");
                Pages.Append("<span style='font-size: 7pt; padding-bottom: 10px;'>Near Indira Nagar Colony, Village - Dashrath<br/> Pin: 391740</span><br/><label style='font-size: 7pt;'></label>");
                Pages.Append("<br /><label style='font-size: 7pt; font-weight:bold;'>Tally Response Report</label> <br/> <label style='font-size: 7pt; font-weight:bold;' ><b>From Date :</b> " + FromDate + " <b>To Date :</b> " + ToDate + "</label>");
                Pages.Append("</td>");
                Pages.Append("<td width='10%' valign='top'><img align='right' src='ISO_IMG'/></td>");
                Pages.Append("<td width='10%' valign='top'><img align='right' src='SWACHBHARAT'/></td>");
                Pages.Append("</tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; margin-bottom:10px; border-collapse:collapse; border:1px solid #000; border-bottom:0; text-align: center; font-size:7pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 10%;'>Sl.No.</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 10%;'>Date</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 15%;'>Bill of Supply</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 12%;'>Tax Invoice</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 5%;'>Debit Note</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 12%;'>Credit Note</th>");
                Pages.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 15%;'>Receipt Voucher</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");


                lstData.ForEach(item =>
                {

                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + item.Date + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + item.Bill + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + item.Invoice + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + item.Dr + "</td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + item.Cr + " </td>");
                    Pages.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + item.Receipt + "</td>");
                    Pages.Append("</tr>");
                    i++;

                });



                // Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='font-size:10pt; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td><br/></td></tr>");
                Pages.Append("<tr><th colspan='12' style='text-align:left;'>* Contact with Helpdesk (CWC) team for resolution.</th></tr>");
                Pages.Append("</thead></table>");


                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                Pages.Replace("ISO_IMG", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                Pages.Replace("SWACHBHARAT", Server.MapPath("~/Content/Images/SwachhBharat-Logo.png"));



                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO_IMG", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 20f, 30f, 20f, 30f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion


        #region Account Report Export Cargo In General Carting
        [HttpGet]
        public ActionResult ExportCargoReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetCargoReport(string AsOnDate)
        {
            if (ModelState.IsValid)
            {
                DSR_ReportRepository ObjRR = new DSR_ReportRepository();
                ObjRR.GetCargoExport(AsOnDate);
                string Path = "";
                List<Hdb_ExpCargo> lstData = new List<Hdb_ExpCargo>();
                lstData = (List<Hdb_ExpCargo>)ObjRR.DBResponse.Data;
                Path = GeneratePDFExpCarReport(lstData, AsOnDate);

                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFExpCarReport(List<Hdb_ExpCargo> lstData, string Date)
        {
            try
            {
                var FileName = "ExportCargoReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 28px; line-height: 30px;margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1>");
                Pages.Append("<label style='font-size: 14px;'>(A Govt. of India Undertaking) </label><br />");
                Pages.Append("<span style='font-size: 14px; padding-bottom: 10px;'></span><br/><span style='font-size: 14px; padding-bottom: 10px;'>Near Indira Nagar Colony, Village - Dashrath Pin: 391740</span><br/><label style='font-size: 14px;'></label><br/><label style='font-size: 14px;'>As On Date - " + Date + "</label><br/><label style='font-size: 14px;'></label>");
                Pages.Append("<br /><label style='font-size: 16px; font-weight:bold;'>Accrued Income Report for Export Cargo In General Carting</label>");
                Pages.Append("</td>");
                Pages.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                //Pages.Append("<tr><td colspan='12'>");
                //Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                //Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                //Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>CFS Kukatpally-Hyderabad</span><br/><span style='font-size:12px;'><b>As On Date - </b> " + Date + "</span><br/><label style='font-size: 14px; font-weight:bold;'>Account Report for Export Cargo In General Carting</label></td></tr>");
                //Pages.Append("</tbody></table>");
                //Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>S No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>Entry No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Sb No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Sb Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Shed</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Storage Type</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>FCL / LCL</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Area</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>No Of Days</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>No Of Week</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Storage Amt</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:12%;text-align:right;'>Insurance Amt</th>");
                Pages.Append("</tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>" + item.EntryNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.InDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.SbNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.SbDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Shed + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.StorageType + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.FCLLCL + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Area + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>" + item.NoOfDays + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>" + item.NoOfWeek + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>" + item.GeneralAmount + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;width:12%;text-align:right;'>" + item.InsuranceAmount + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });

                Pages.Append("<tr>");
                Pages.Append("<th colspan='7' style='width:3%;'>Total :</th>");
                Pages.Append("<th style='border-right:1px solid #000;width:8%;'></th>");
                Pages.Append("<th style='border-right:1px solid #000;width:8%;'>" + lstData.AsEnumerable().Sum(item => item.Area) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;width:6%;'>" + lstData.AsEnumerable().Sum(item => item.NoOfDays) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;width:6%;'>" + lstData.AsEnumerable().Sum(item => item.NoOfWeek) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;width:6%;'>" + lstData.AsEnumerable().Sum(item => item.GeneralAmount) + "</th>");
                Pages.Append("<th style='width:12%;text-align:right;'>" + lstData.AsEnumerable().Sum(item => item.InsuranceAmount) + "</th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }


        #endregion

        #region Accounts Report for Import Cargo
        [HttpGet]
        public ActionResult ImportCargoAccountsReport()
        {
            HDBMasterRepository ObjYR = new HDBMasterRepository();
            ObjYR.GetAllGodown();
            if (ObjYR.DBResponse.Data != null)
            {
                ViewBag.ListOfGodown = (List<CwcExim.Areas.Master.Models.HDBGodown>)ObjYR.DBResponse.Data;
            }
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetImpCargo(string AsOnDate, string GodownId, string GodownName)
        {
            if (ModelState.IsValid)
            {
                Hdb_ReportRepository ObjRR = new Hdb_ReportRepository();
                ObjRR.GetImpCargo(AsOnDate, GodownId);
                string Path = "";
                List<Hdb_ImpCargo> lstData = new List<Hdb_ImpCargo>();
                lstData = (List<Hdb_ImpCargo>)ObjRR.DBResponse.Data;
                Path = GeneratePDFImpCargo(lstData, AsOnDate, GodownName);

                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFImpCargo(List<Hdb_ImpCargo> lstData, string Date, string GodownName)
        {
            try
            {
                var FileName = "ImpCargoReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 28px; line-height: 30px;margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1>");
                Pages.Append("<label style='font-size: 14px;'>(A Govt. of India Undertaking) </label><br />");
                Pages.Append("<span style='font-size: 14px; padding-bottom: 10px;'></span><br/><span style='font-size: 14px; padding-bottom: 10px;'>Near Indira Nagar Colony, Village - Dashrath Pin: 391740</span><br/><label style='font-size: 14px;'></label><br/><label style='font-size: 14px;'>As On Date - " + Date + "</label><br/><label style='font-size: 14px;'>Shed Cd - " + GodownName + "</label>");
                Pages.Append("<br /><label style='font-size: 16px; font-weight:bold;'>Account Report for Import Cargo</label>");
                Pages.Append("</td>");
                Pages.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                //Pages.Append("<tr><td colspan='12'>");
                //Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                //Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                //Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 28px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 14px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:14px;'>CFS Kukatpally-Hyderabad</span><br/><span style='font-size:14px;'><b>As On Date - </b> " + Date + "</span><br/><span style='font-size:14px;'><b>Shed Cd - </b>" + GodownName + "</span><br/><label style='font-size: 16px; font-weight:bold;'>Account Report for Import Cargo</label></td></tr>");
                //Pages.Append("</tbody></table>");
                //Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>S No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:12%;'>OBL No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Dstf Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>Entry No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>Entry Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>FCL / LCL</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>Storage Type</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Item No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Pkg</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Rcvd Pkg</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Gr Wt</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>Area</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>Slot No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>Remarks</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Total Wk</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Storage Amount</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:12%;text-align:right;'>Insurance Amount</th></tr></thead>");
                Pages.Append("<tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:12%;'>" + item.BOLNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>" + item.DestuffingEntryDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>" + item.CFSCode + "</td>");

                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>" + item.EntryDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>" + item.LCLFCL + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>" + item.StorageArea + "</td>");

                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>" + item.CommodityAlias + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>" + item.NoOfUnits + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>" + item.NoOfUnitsRec + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>" + item.Weight.ToString("0.00") + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>" + item.Area.ToString("0.00") + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>" + item.LocationName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>" + item.Remarks + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.TotWk + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + item.Amount + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;width:12%;text-align:right;'>" + item.InsuranceAmount + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });

                Pages.Append("<tr>");
                Pages.Append("<th colspan='2' style='width:3%;'>Total :</th>");
                Pages.Append("<th style='width:6%;'></th>");
                Pages.Append("<th style='width:7%;'></th>");
                Pages.Append("<th style='width:7%;'></th>");
                Pages.Append("<th style='width:7%;'></th>");
                Pages.Append("<th style='width:7%;'></th>");
                Pages.Append("<th style='width:7%;'></th>");
                Pages.Append("<th style='width:4%;'></th>");
                Pages.Append("<th style='border-right:1px solid #000;width:4%;'>" + lstData.AsEnumerable().Sum(item => item.NoOfUnits) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;width:4%;'>" + lstData.AsEnumerable().Sum(item => item.NoOfUnitsRec) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;width:8%;'>" + lstData.AsEnumerable().Sum(item => item.Weight) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;width:7%;'>" + lstData.AsEnumerable().Sum(item => item.Area) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;width:7%;'></th>");
                Pages.Append("<th style='border-right:1px solid #000;width:7%;'></th>");
                Pages.Append("<th style='border-right:1px solid #000;width:5%;'>" + lstData.AsEnumerable().Sum(item => item.TotWk) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;width:5%;'>" + lstData.AsEnumerable().Sum(item => item.Amount) + "</th>");
                Pages.Append("<th style='width:12%;text-align:right;'>" + lstData.AsEnumerable().Sum(item => item.InsuranceAmount) + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        //Added by Susmita-24-04-2024
        #region Tds Deduction Report
        public ActionResult TdsDeductionReport()
        {
            return View();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetTdsDeductionReport(DSR_TdsDeductionReport vm)
        {

            Response.AppendHeader("content-disposition", "attachment;filename=TDSDeductionReport.xls");
            Response.Charset = "";
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            Response.ContentType = "application/vnd.ms-excel";

            DSR_ReportRepository obj = new DSR_ReportRepository();
            obj.TdsDeductionExcelRpt(vm.PeriodFrom, vm.PeriodTo);
            DataSet ds = new DataSet();
            ds = (DataSet)obj.DBResponse.Data;
            Response.Write(TdsDeductionReportExcelPDF(ds, vm.PeriodFrom, vm.PeriodTo));
            Response.End();

            return Content("xc");
        }

        private string TdsDeductionReportExcelPDF(DataSet ds, string FromDate, string ToDate)
        {


            List<dynamic> lstTdsDeductionRptSummary = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            var i = 1;
            var FileName = "TdsDeductionReport.pdf";
            string html = "<html><body>";

            //Report of TDS Deduction Report
            html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; font-size:8pt;'><tbody>";
            html += "<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>TDS Deduction Report</h1></td></tr>";
            html += "<tr><td colspan='10' valign='top' align='center'><h1 style='font-size: 20px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION, DELHI : RO DASHRATH(" + FromDate + " to " + ToDate + ") </h1></td></tr>";
            html += "<tr><td colspan='12'><table cellspacing='0' cellpadding='15' style='text-align: center; border: 1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'>";

            html += "<thead>";

            html += "<tr>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>SL NO.</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Branch Name</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Name Of Depositor</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>TAN Number of Depositor</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice No</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Date</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Invoice Amount</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>TDS Amount</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000;'>TDS Deduction Date</th>";

            html += "</tr>";
            html += "</thead>";
            html += "<tbody>";
            int totalInvAmt = 0;
            int totalTdsAmt = 0;

            lstTdsDeductionRptSummary.ToList().ForEach(item =>
            {
                try
                {

                    html += "<tr>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + i + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.BranchName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.DepositorName + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TanNumber + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceNo + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.InvoiceDate + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.Amount + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.TDS + "</td>";
                    html += "<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + item.ReceiptDate + "</td>";
                    html += "</tr>";

                    totalInvAmt = totalInvAmt + Convert.ToInt32(item.Amount);
                    totalTdsAmt = totalTdsAmt + Convert.ToInt32(item.TDS);

                    i++;

                }
                catch (Exception Ex)
                {

                }
            });

            html += "<tr>";
            html += "<th colspan='6' style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: right;'>TOTAL :</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + totalInvAmt + "</th>";
            html += "<th style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center;'>" + totalTdsAmt + "</th>";
            html += "<th style='border-top: 1px solid #000; text-align: center;'></th>";
            html += "</tr>";
            html += "</tbody>";
            html += "</table></td></tr>";
            html += "</tbody></table>";

            html += "</body></html>";
            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/HtmlReport";

            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }

            System.IO.File.WriteAllText(LocalDirectory + "/" + FileName, html);


            FileInfo fi = new FileInfo(LocalDirectory + "/" + FileName);



            //Open a file for Read\Write
            FileStream fs = fi.Open(FileMode.OpenOrCreate, FileAccess.Read, FileShare.Read);


            StreamReader sr = new StreamReader(fs);

            //Use the ReadToEnd method to read all the content from file
            string fileContent = sr.ReadToEnd();

            //Close the StreamReader object after operation
            sr.Close();
            // fs.Close();

            return fileContent;
        }
        #endregion
    }
}
