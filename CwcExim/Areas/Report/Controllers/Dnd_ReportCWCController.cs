using Newtonsoft.Json;
using Newtonsoft.Json.Linq;
using System;
using System.Collections;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using CwcExim.Areas.Report.Models;
using CwcExim.Controllers;
using CwcExim.Models;
using CwcExim.Repositories;
using CwcExim.Filters;
using CwcExim.UtilityClasses;
using System.Reflection;
using System.Text;
using CwcExim.Areas.Import.Models;
using System.Data;
using CwcExim.Areas.Export.Models;
using CwcExim.Areas.GateOperation.Models;

namespace CwcExim.Areas.Report.Controllers
{
    public class Dnd_ReportCWCController : BaseController
    {
        // private readonly object DateTime;
        private string HeadOffice { get; set; }
        private string HOAddress { get; set; }
        public string ZonalOffice { get; set; }
        public string ZOAddress { get; set; }
        // GET: Report/Dnd_ReportCWC
        public Dnd_ReportCWCController()
        {
            /*
             * CALL PROCEDURE AND SET VALUE OF PROPERTIES
             */
            CompanyDetailsForReport objCompanyDetails = new CompanyDetailsForReport();
            Ppg_ReportRepository ObjRR = new Ppg_ReportRepository();
            ObjRR.getCompanyDetails();
            objCompanyDetails = (CompanyDetailsForReport)ObjRR.DBResponse.Data;
            HeadOffice = ""; //objCompanyDetails.CompanyName;
            HOAddress = "";//objCompanyDetails.RoAddress;
            ZonalOffice = objCompanyDetails.CompanyName;
            ZOAddress = objCompanyDetails.CompanyAddress;


        }
        public ActionResult Index()
        {
            return View();
        }


        #region Bulk Invoice

        [HttpGet]
        public ActionResult BulkInvoiceReport()
        {

            ExportRepository objExport = new ExportRepository();
            objExport.GetPaymentParty();
            if (objExport.DBResponse.Status > 0)
                ViewBag.PaymentParty = JsonConvert.SerializeObject(objExport.DBResponse.Data);
            else
                ViewBag.PaymentParty = null;
            return PartialView();
        }

        [HttpPost]
        //[ValidateAntiForgeryToken]
        public JsonResult GetBulkInvoiceReport(BulkInvoiceReport ObjBulkInvoiceReport)
        {
            // if (ObjBulkInvoiceReport.InvoiceNumber == null)
            // {
            //   ObjBulkInvoiceReport.InvoiceNumber = "";
            // }
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            // if (ObjBulkInvoiceReport.InvoiceNumber == null)
            //  {
            ObjRR.GenericBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);
            //  }
            //  else
            //  {
            // List<PpgInvoiceGate> PpgInvoiceGateList = ObjRR.GetBulkInvoiceDetailsForPrint(ObjBulkInvoiceReport);//, objLogin.Uid
            //     ObjRR.InvoiceDetailsForPrint(ObjBulkInvoiceReport);//, objLogin.Uid
            //  }
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                //string FilePath = GeneratingBulkPDF(PpgInvoiceGateList, ObjBulkInvoiceReport.InvoiceModuleName);
                string FilePath = "";
                switch (ObjBulkInvoiceReport.InvoiceModule)
                {
                    case "IMPYard":
                        FilePath = GeneratingBulkPDFforDndYard(ds, ObjBulkInvoiceReport.InvoiceModuleName);
                        break;
                    case "IMPDeli":
                        FilePath = GeneratingBulkPDF_GodownDnd(ds, ObjBulkInvoiceReport.InvoiceModuleName);
                        break;
                    case "EXPSEALCHEKING":
                        FilePath = GeneratingBulkPDFforChnExpSealChecking(ds, ObjBulkInvoiceReport.InvoiceModuleName);
                        break;
                    case "BTT":
                        ObjBulkInvoiceReport.All = "";
                        FilePath = GeneratingBulkPDFforBTT(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                        break;
                    case "EXP":
                        ObjBulkInvoiceReport.All = "";
                        FilePath = GeneratingBulkPDFforExport(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                        break;
                    case "ITPEXP":
                        ObjBulkInvoiceReport.All = "";
                        FilePath = GeneratingBulkPDFforExportITP(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                        break;
                    case "MiscInv":
                        ObjBulkInvoiceReport.All = "";
                        FilePath = GeneratingBulkPDFforMisc(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                        break;
                    case "BND":
                        FilePath = GeneratingBulkPDFforBND(ds, ObjBulkInvoiceReport.InvoiceModuleName);
                        break;
                    case "BNDAdv":
                        FilePath = GeneratingBulkPDFforBondHdb(ds, ObjBulkInvoiceReport.InvoiceModuleName);
                        break;
                    case "EXPLod":
                        ObjBulkInvoiceReport.All = "";
                        FilePath = GeneratingBulkPDFforExportLoadedCont(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                        break;
                    case "SO":
                        ObjBulkInvoiceReport.All = "";
                        FilePath = GeneratingBulkPDFforSO(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                        break;
                    case "EXPReMo":
                        ObjBulkInvoiceReport.All = "";
                        FilePath = GeneratingBulkPDFforReMovementCont(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                        break;
                    case "EC":
                        ObjBulkInvoiceReport.All = "";
                        FilePath = GeneratingBulkPDFforEmptyContainer(ds, ObjBulkInvoiceReport.InvoiceModuleName, ObjBulkInvoiceReport.All);
                        break;
                    default:
                        FilePath = GeneratingBulkPDFforCHNAll(ds, ObjBulkInvoiceReport.InvoiceModuleName);
                        break;
                }

                return Json(new { Status = 1, Data = FilePath });
            }
            else
                return Json(new { Status = -1, Data = "No Record Found." });

        }

        [NonAction]
        public string GeneratingBulkPDFforChnExpSealChecking(DataSet ds, string InvoiceModuleName)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='3'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><span style='font-size:12px;'>(A Govt. of India Undertaking)</span><br/><span style='font-size: 12px;'>Container Freight Station,</span><br /><span style='font-size:12px;'>" + objCompany[0].CompanyAddress + "</span><br/><span style='font-size: 12px;'><b>Phone No:</b> " + objCompany[0].PhoneNo + " </span><br /><span style='font-size: 12px;'><b>Email:</b> " + objCompany[0].EmailAddress + " </span><br/><label style='font-size: 16px; font-weight:bold;'>Seal Checking Payment Sheet</label></td>");
                html.Append("<td valign='top'><img align='right' src='SWACHBHARAT' width='100'/></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='3' style='text-align: right;'><span style='display: block; font-size: 12px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td colspan='3'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + "</h2> </td></tr>");
                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyGSTNo.Substring(0, 2) + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>Payee Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td></tr><tr><td><hr /></td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 13px; margin-top: 10px;'>Container/Cargo Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Arrival</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Delivery</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + i + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;

                    /***************/
                    html.Append("</tbody></table></td></tr>");
                    html.Append("<tr><td>");
                    html.Append("</td></tr>");


                    html.Append("<tr><td>");
                    html.Append("<table cellspacing='0' cellpadding='5' style='border: 1px solid #000;width:100%; margin: 0;'><tbody>");
                    html.Append("<tr><td colspan='8' width='70%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>Previous Seal No. :</label> <span>" + elem.PresentSealNo + "</span></td>");
                    html.Append("<td colspan='4' width='30%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>New Seal No. : </label> <span>" + elem.NewSealNo + "</span></td></tr>");
                    html.Append("<tr><td colspan='8' width='70%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>Detention From :</label> <span>" + elem.Days + " Days</span></td>");
                    html.Append("<td colspan='4' width='30%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>Lock Provided : </label> <span>" + elem.LockProvided + "</span></td></tr>");
                    html.Append("<tr><td colspan='8' width='70%' style='font-size: 12px; line-height: 26px;'><label style='font-weight: bold;'>Custom Examinatiom :</label> <span>" + elem.ExamRequired + "</span></td></tr>");
                    html.Append("</tbody></table>");
                    html.Append("</td></tr>");
                });
                html.Append("<tr><th><h3 style='text-align: left; font-size: 13px;margin-top: 20px;'>Container/Cargo Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InoviceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 150px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>" + totamt.ToString("0") + "</th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");

                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-bottom:0; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 170px;'><span>&nbsp;&nbsp;</span>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th></tr>");


                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; padding: 5px;' colspan='13'><span>&nbsp;&nbsp;&nbsp;</span>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 11px; text-align: left; padding: 5px;' colspan='7'><span>&nbsp;&nbsp;&nbsp;</span>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 12px; text-align: left; width: 50%; vertical-align: bottom;'>");
                html.Append("</td>");
                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0;'>");
                html.Append("<span><br/></span>");
                html.Append("<p style='display: block; font-size: 11px; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span>" + objCompany[0].BankName + "</p>");
                html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span>" + objCompany[0].AccountNo + "</p>");
                html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span>" + objCompany[0].Branch + " & " + objCompany[0].IFSC + "</p>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='border: 1px solid #333; border-bottom: 0; border-right: 0; padding: 0 15px;'>");
                html.Append("<p style='text-align: right; font-size: 11px; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 11px; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody><tr><td style='font-size: 12px; text-align: left; line-height: 30px;'colspan='2'>Receipt No.: ");
                html.Append("<label style='font-weight: bold;'></label></td><td style='font-size: 12px; text-align: left; line-height: 30px;' colspan='2'>Party Code:");
                html.Append("<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 11px; text-align: left;'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 11px; text-align: left;'><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 11px; text-align: left;'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 11px; text-align: left;'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("SWACHBHARAT", Server.MapPath("~/Content/Images/SwachhBharat-Logo.png"));
                lstSB.Add(html.ToString());
            });
            var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforCHNAll(DataSet ds, string InvoiceModuleName)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            var distinctValues = ds.Tables[3].AsEnumerable()
                       .Select(row => new
                       {
                           SACCode = row.Field<string>("SACCode")

                       })
                       .Distinct();


            List<string> lstSB = new List<string>();

            lstInvoice.ToList().ForEach(item =>
            {
                System.Text.StringBuilder html = new System.Text.StringBuilder();
                /*Header Part*/





                Decimal CTax = 0;
                if (item.TotalIGST > 0)
                {
                    CTax = item.TotalIGST;
                }
                else
                {
                    CTax = item.TotalCGST;
                }
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");

                html.Append("<tr style='text-align: center;'><td colspan='2'><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Tax Invoice</h2></td></tr>");

                html.Append("<tr cellspacing='0' cellpadding='0'>");
                html.Append("<td style='border:1px solid #333; border-bottom: none;'>");
                html.Append("<table cellspacing='0' style='width:100%;'><tbody>");
                html.Append("<tr>");
                html.Append("<td style='vertical-align: top;'><img style='width: 100%;' src='logo.png'/></td>");
                html.Append("<td style='padding: 0 10px;'>");
                html.Append("<h1 style='font-size: 16px; margin:0; padding: 0;'>Central Warehousing Corporation</h1>");
                html.Append("<label style='font-size: 13px; text-transform:uppercase;'>(A Govt. of India Undertaking) </label>");
                html.Append("<h6 style='font-size: 12px; margin:0; font-weight:normal;'>Principle Place of Business-RO Hyderabad,</h6>");
                html.Append("<h6 style='font-size: 12px; margin:0; font-weight:normal;'>1st Floor Warehousing Sadan,</h6>");
                html.Append("<h6 style='font-size: 12px; margin:0; font-weight:normal;'>Nampally, Behind Gandhi Bhavan</h6>");
                html.Append("<h6 style='font-size: 12px; margin:0; font-weight:normal;'>GSTIN/UIN: 36AAACC1206D2ZG</h6>");
                html.Append("<h6 style='font-size: 12px; margin:0; font-weight:normal;'>State Name: Telangana, Code: 36</h6>");
                html.Append("<h6 style='font-size: 11px; margin:0; font-weight:normal;'>Contact: 040-23773751,8142456715,9966483827,7337516165</h6>");
                html.Append("<h6 style='font-size: 12px; margin:0; font-weight:normal;'>E-Mail: cwccfs@gmail.com</h6>");
                html.Append("<h6 style='font-size: 12px; margin:0; font-weight:normal;'>www.cewacor.nic.in</h6>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("<td valign='top' cellspacing='0' cellpadding='0' style='border:1px solid #333; border-left: none; padding:0; border-bottom: none;'>");
                html.Append("<table cellspacing='0' style='width:100%;'><tbody>");
                html.Append("<tr>");
                html.Append("<td valign='top' style='width:50%; border-right:1px solid #333; padding: 10px; font-size: 12px;'>Invoice No.<br/><h2 style='font-size: 13px; padding-bottom: 10px; margin: 0; padding: 0;'>" + item.InvoiceNo + "</h2></td>");
                html.Append("<td valign='top' style='width:50%; padding: 10px; font-size: 12px;'>Dated<br/><h2 style='font-size: 13px; padding-bottom: 10px; margin: 0; padding: 0;'>" + item.InvoiceDate + "</h2></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td valign='top' style='width:50%; border-top:1px solid #333; border-right:1px solid #333; padding: 10px; font-size: 12px;'>Delivery Note<br/><h2 style='font-size: 13px; padding-bottom: 10px; text-transform:uppercase; margin: 0; padding: 0;'>Account</h2></td>");
                html.Append("<td valign='top' style='width:50%; border-top:1px solid #333; padding: 10px; font-size: 12px;'>Mode/Terms of Payment<br/><h2 style='font-size: 13px; padding-bottom: 10px; margin: 0; padding: 0;'>15 Days</h2></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td valign='top' style='width:50%; border-top:1px solid #333; border-right:1px solid #333; padding: 10px; font-size: 12px;'>Supplier's Ref.<br/><h2 style='font-size: 13px; padding-bottom: 10px; text-transform:uppercase; margin: 0; padding: 0;'>Cfs Kukarpally</h2></td>");
                html.Append("<td valign='top' style='width:50%; border-top:1px solid #333; padding: 10px; font-size: 12px;'>Other Reference(s)<br/><h2 style='font-size: 13px; padding-bottom: 10px; text-transform:uppercase;margin: 0; padding: 0;'>Tn56h2594</h2></td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr>");

                html.Append("<tr valign='top' cellpadding='0'>");
                html.Append("<td style='border:1px solid #333; border-bottom: none;'>");
                html.Append("<br/>");
                html.Append("<p style='display: block; font-size: 12px; margin:0; padding: 0 10px;'>Consignee</p>");
                html.Append("<p style='display: block; text-transform:uppercase; padding: 0 10px; font-size: 13px; font-weight: bold; margin:0;'>" + item.PartyName + "</p>");
                html.Append("<p style='display: block; text-transform:uppercase; padding: 0 10px; font-size: 13px; margin:0;'>" + item.PartyAddress + "</p>");
                html.Append("<p style='display: block; text-transform:uppercase; padding: 0 10px; font-size: 13px; margin:0;'></p>");
                html.Append("<p style='display: block; text-transform:uppercase; padding: 0 10px; font-size: 13px; margin:0;'><span style='display: inline-block; width: 100px;'>GSTIN/UIN:</span>" + item.PartyGSTNo + "</p>");
                html.Append("<p style='display: block; text-transform:uppercase; padding: 0 10px; font-size: 13px; margin:0;'><span style='display: inline-block; width: 100px;'>Pan/It No:</span> </p>");
                html.Append("<p style='display: block; font-size: 13px; margin:0; padding: 0 10px;'><span style='display: inline-block; width: 100px;'>State Name:</span> " + item.PartyState + "</p>");
                html.Append("</td>");
                int i = 1;
                String cfscd = "";
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    cfscd = cfscd + elem.CFSCode + ",";
                });

                html.Append("<td valign='top' cellspacing='0' cellpadding='0' style='border:1px solid #333; border-left: 0; border-top: 0;'>");
                html.Append("<table cellspacing='0' style='width:100%;'><tbody>");
                html.Append("<tr>");
                html.Append("<td valign='top' style='width:50%; border-top: 0; border-right:1px solid #333; padding: 10px; font-size: 12px;'>Buyer's Order No.<br/><h2 style='font-size: 13px; padding-bottom: 10px; text-transform:uppercase; margin: 0; padding: 0;'>" + cfscd + "</h2></td>");
                html.Append("<td valign='top' style='width:50%; border-top: 0; padding: 10px; font-size: 12px;'>Dated<br/><h2 style='font-size: 13px; padding-bottom: 10px; margin: 0; padding: 0;'></h2></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td valign='top' style='width:50%; border-top:1px solid #333; border-right:1px solid #333; padding: 10px; font-size: 12px;'>Despatch Document No.<br/><h2 style='font-size: 13px; padding-bottom: 10px; text-transform:uppercase; margin: 0; padding: 0;'>Be No: " + item.BOENo + " ," + item.BOEDate + "</h2></td>");
                html.Append("<td valign='top' style='width:50%; border-top:1px solid #333; padding: 10px; font-size: 12px;'>Delivery Note Date<br/><h2 style='font-size: 13px; padding-bottom: 10px; margin: 0; padding: 0;'>" + item.DeliveryDate + "</h2></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td valign='top' style='width:50%; border-top:1px solid #333; border-right:1px solid #333; padding: 10px; font-size: 12px;'>despatched througn<br/><h2 style='font-size: 13px; padding-bottom: 10px; text-transform:uppercase; margin: 0; padding: 0;'></h2></td>");
                html.Append("<td valign='top' style='width:50%; border-top:1px solid #333; padding: 10px; font-size: 12px;'>Destination<br/><h2 style='font-size: 13px; padding-bottom: 10px; text-transform:uppercase;margin: 0; padding: 0;'></h2></td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr>");

                html.Append("<tr>");
                html.Append("<td style='border:1px solid #333; padding: 10px;'>");
                html.Append("<p style='display: block; font-size: 12px; margin:0;'>Buyer(if other than consignee)</p>");
                html.Append("<p style='display: block; text-transform:uppercase; font-size: 13px; font-weight: bold; margin:0;'> " + item.PayeeName + " </p>");
                html.Append("<p style='display: block; text-transform:uppercase; font-size: 13px; margin:0;'>" + item.PartyAddress + "</p>");
                html.Append("<p style='display: block; text-transform:uppercase; font-size: 13px; margin:0;'></p>");
                html.Append("<p style='display: block; text-transform:uppercase; font-size: 13px; margin:0;'>" + item.PartyState + "</p>");
                html.Append("<p style='display: block; text-transform:uppercase; font-size: 13px; margin:0;'><span style='display: inline-block; width: 100px;'>GSTIN/UIN:</span> " + item.PartyGSTNo + "</p>");
                html.Append("<p style='display: block; text-transform:uppercase; font-size: 13px; margin:0;'><span style='display: inline-block; width: 100px;'>Pan/It No:</span> </p>");
                html.Append("<p style='display: block; font-size: 13px; margin:0;'><span style='display: inline-block; width: 100px;'>State Name:</span> " + item.PartyState + "</p>");
                html.Append("</td>");
                html.Append("<td style='border:1px solid #333; border-top: 0; border-left: none; padding:10px; vertical-align: top;'>");
                html.Append("<span style='display: block; font-size: 12px;'>Terms of Delivery</span>");
                html.Append("<h2 style='font-size: 13px; padding-bottom: 10px; text-transform:uppercase; margin: 0; padding: 0;'>" + item.TotalNoOfPackages.ToString() + "</h2>");
                html.Append("<h2 style='font-size: 13px; padding-bottom: 10px; text-transform:uppercase; margin: 0; padding: 0;'>" + item.TotalGrossWt.ToString("0.000") + "</h2>");
                html.Append("<h2 style='font-size: 13px; padding-bottom: 10px; text-transform:uppercase; margin: 0; padding: 0;'>Godown no: </h2>");
                html.Append("<h2 style='font-size: 13px; padding-bottom: 10px; text-transform:uppercase; margin: 0; padding: 0;'>No of Grids: </h2>");
                html.Append("</td>");
                html.Append("</tr>");

                /***************/
                html.Append("<tr cellspacing='0' cellpadding='0'>");
                html.Append("<td colspan='2' style='padding:0;'>");
                html.Append("<table style='border: 1px solid #000; border-bottom: 0; border-top: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>SL No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 300px;'>Particulars</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 80px;'>HSN/SAC</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>GST Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Quantity</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>per</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; width:100px;'>Amount</th>");
                html.Append("</tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                Decimal cgstamt = 0;
                Decimal sgstamt = 0;
                Decimal igstamt = 0;
                Decimal tot = 0;
                String[] Sac;
                Sac = new string[50];
                Decimal[] Taxa;
                Decimal[] CenPer;
                Decimal[] StatePer;
                CenPer = new Decimal[50];
                StatePer = new Decimal[50];
                Taxa = new decimal[50];
                Decimal[] StateTax;
                StateTax = new decimal[50];
                Decimal[] CentralTax;
                CentralTax = new decimal[50];
                Decimal[] TotTax;
                TotTax = new decimal[50];
                Decimal Tamt = 0;
                Decimal Tcen = 0;
                Decimal Tstate = 0;
                Decimal TTax = 0;
                int count = 0;
                distinctValues.ToList().ForEach(data1 =>
                {
                    Sac[count] = data1.SACCode;
                    count++;
                });

                for (int ii = 0; ii < count; ii++)
                {
                    Taxa[ii] = 0;
                    CentralTax[ii] = 0;
                    StateTax[ii] = 0;
                    TotTax[ii] = 0;
                    lstCharges.ToList().ForEach(data =>
                    {


                        if (data.SACCode == Sac[ii] && data.InvoiceId == item.InvoiceId)
                        {
                            Taxa[ii] = Taxa[ii] + data.Taxable;
                            cgstamt = cgstamt + data.CGSTAmt;
                            sgstamt = sgstamt + data.SGSTAmt;
                            igstamt = igstamt + data.IGSTAmt;
                            if (data.IGSTAmt > 0)
                            {
                                CenPer[ii] = data.IGSTPer;
                                StatePer[ii] = data.SGSTPer;
                                CentralTax[ii] = CentralTax[ii] + data.IGSTAmt;
                                StateTax[ii] = StateTax[ii] + (data.SGSTAmt + data.CGSTAmt);
                                TotTax[ii] = TotTax[ii] + (CentralTax[ii] + StateTax[ii]);
                                Tamt = Tamt + Taxa[ii];
                                Tcen = Tcen + CentralTax[ii];
                                Tstate = Tstate + StateTax[ii];
                                TTax = TTax + TotTax[ii];
                            }

                            else
                            {
                                CenPer[ii] = data.SGSTPer;
                                StatePer[ii] = data.CGSTPer;
                                CentralTax[ii] = CentralTax[ii] + data.SGSTAmt;
                                StateTax[ii] = StateTax[ii] + (data.CGSTAmt);
                                TotTax[ii] = TotTax[ii] + (CentralTax[ii] + StateTax[ii]);
                                Tamt = Tamt + Taxa[ii];
                                Tcen = Tcen + CentralTax[ii];
                                Tstate = Tstate + StateTax[ii];
                                TTax = TTax + TotTax[ii];

                            }
                        }
                    });
                }

                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    Decimal gstper = 0;
                    gstper = data.CGSTPer + data.SGSTPer;

                    tot = data.Total;
                    if (data.Taxable > 0)
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: left; padding:0 20px 0 60px; font-weight:bold;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'>" + gstper + " %</td>");
                        html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                        html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: right;'></td>");
                        html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: left;'></td>");
                        html.Append("<td style='font-size: 11px; text-align: right; font-weight: bold;'>" + data.Taxable.ToString("0") + "</td></tr>");
                        i = i + 1;
                    }
                });
                html.Append("<tr><td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'> " + i.ToString() + " </td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: right; padding:0 20px 0 60px; font-weight:bold; text-transform:uppercase;'>CGST</td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: right;'>9</td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: left;'>%</td>");
                html.Append("<td style='font-size: 11px; text-align: right; font-weight: bold;'>" + item.TotalCGST.ToString("0") + "</td></tr>");
                i = i + 1;
                html.Append("<tr><td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'>" + i.ToString() + "</td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: right; padding:0 20px 0 60px; font-weight:bold; text-transform:uppercase;'>SGST</td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: right;'>9</td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: left;'>%</td>");
                html.Append("<td style='font-size: 11px; text-align: right; font-weight: bold;'>" + item.TotalSGST.ToString("0") + "</td></tr>");
                i = i + 1;
                html.Append("<tr><td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'>" + i.ToString() + "</td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: right; padding:0 20px 0 60px; font-weight:bold; text-transform:uppercase;'>IGST</td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: right;'>9</td>");
                html.Append("<td style='border-right: 1px solid #000; font-size: 11px; text-align: left;'>%</td>");
                html.Append("<td style='font-size: 11px; text-align: right; font-weight: bold;'>" + item.TotalIGST.ToString("0") + "</td></tr>");

                html.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000; border-bottom: 1px solid #000; font-size: 13px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; border-bottom: 1px solid #000;  font-size: 13px; text-align: right; padding:0 20px 0 60px;'>Total</td>");
                html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; border-bottom: 1px solid #000;  font-size: 13px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; border-bottom: 1px solid #000;  font-size: 13px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; border-bottom: 1px solid #000;  font-size: 13px; text-align: center;'></td>");
                html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; border-bottom: 1px solid #000;  font-size: 13px; text-align: right;'></td>");
                html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; border-bottom: 1px solid #000;  font-size: 13px; text-align: left;'></td>");
                html.Append("<td style=' border-top: 1px solid #000; border-bottom: 1px solid #000; font-size: 18px; text-align: right; font-weight: bold;'>" + item.InvoiceAmt.ToString("0") + " &#8377;</td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td></tr>");

                html.Append("<tr cellspacing='0' cellpadding='0'><td colspan='2' style='padding:0;'>");
                html.Append("<table style='border: 1px solid #000; border-top:0; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 12px; border-bottom: 1px solid #000; text-align: left;'>Amount Chargeable(in words)<br/><span style='font-size: 13px; font-weight:bold;'>" + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</span></td>");
                html.Append("<td style='font-size: 13px; border-bottom: 1px solid #000; text-align: right; vertical-align: top;'><em>E. & o.E</em></td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                //Group OF CHARGES SECTION START
                // distinctValues.ToList().ForEach(item => item.SACCode=
                // {

                html.Append("<tr cellspacing='0' cellpadding='0'>");
                html.Append("<td colspan='2' style='padding:0;'>");
                html.Append("<table style='border: 1px solid #000; border-top: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 160px;'>HSN/SAC</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Taxable Value</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Central Tax</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>State Tax</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Total Tax Amount</th>");
                html.Append("</tr>");

                html.Append("<tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Amount</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Amount</th>");
                html.Append("</tr>");
                html.Append("</thead>");
                html.Append("<tbody>");
                //int j = 1;
                /*Charges Bind*/
                // lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                //{

                for (int ii = 0; ii < count; ii++)
                {
                    if (Taxa[ii] > 0)
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; font-size: 12px; text-align: left;'>" + Sac[ii] + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; font-size: 12px; text-align: right;'>" + Taxa[ii] + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; font-size: 12px; text-align: right;'>" + CenPer[ii] + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; font-size: 12px; text-align: right;'>" + CentralTax[ii] + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; font-size: 12px; text-align: right;'>" + StatePer[ii] + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; font-size: 12px; text-align: right;'>" + StateTax[ii] + " </td>");
                        html.Append("<td style='font-size: 12px; text-align: right;'>" + (CentralTax[ii] + StateTax[ii]) + "</td></tr>");
                    }
                }
                // });
                html.Append("<tr><td style='border-top: 1px solid #000; border-right: 1px solid #000; font-weight: bold; font-size: 13px; text-align: right;'>Total</td>");
                html.Append("<td style='border-top: 1px solid #000; border-right: 1px solid #000; font-weight: bold; font-size: 13px; text-align: right;'>" + item.TotalTaxable + "</td>");
                html.Append("<td style='border-top: 1px solid #000; border-right: 1px solid #000; font-weight: bold; font-size: 13px; text-align: right;'></td>");
                html.Append("<td style='border-top: 1px solid #000; border-right: 1px solid #000; font-weight: bold; font-size: 13px; text-align: right;'>" + (CTax) + "</td>");
                html.Append("<td style='border-top: 1px solid #000; border-right: 1px solid #000; font-weight: bold; font-size: 13px; text-align: right;'></td>");
                html.Append("<td style='border-top: 1px solid #000; border-right: 1px solid #000; font-weight: bold; font-size: 13px; text-align: right;'>" + (item.TotalSGST) + "</td>");
                html.Append("<td style='border-top: 1px solid #000; font-size: 13px; text-align: right; font-weight: bold;'>" + (item.TotalCGST + item.TotalSGST + item.TotalIGST) + "</td></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border-left: 1px solid #000; border-right: 1px solid #000; width:100%;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr style='margin: 0 0 40px;'>");
                html.Append("<td colspan='2' style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'>Tax Amount(in words) : <span style='font-size:14px; font-weight:bold;'>" + objCurr.changeCurrencyToWords((item.TotalCGST + item.TotalSGST + item.TotalIGST).ToString("0")) + "</span></td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width:100%; border-left: 1px solid #333; border-right: 1px solid #333; border-bottom: 1px solid #333;' cellspacing='0' cellpadding='0'><tbody>");
                html.Append("<tr>");
                html.Append("<td colspan='2' style='padding:0;'>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                html.Append("<tr>");
                html.Append("<td>");
                html.Append("<p style='font-size: 13px; margin:0; padding: 0 0 0 5px;'>Company's PAN: <b>AAACC1206D</b></p>");
                html.Append("<p style='font-size: 12px; margin:0; padding: 0 0 0 5px;'>Declaration</p>");
                html.Append("<p style='font-size: 12px; margin:0; padding: 0 0 0 5px;'>We declare that this invoice shows the actual price of the goods described and that all particulars are true and correct</p>");
                html.Append("</td>");
                html.Append("<td style='padding-right: 0; padding-bottom: 0;'>");
                html.Append("<p style='font-size: 12px; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> " + objCompany[0].BankName + "</p>");
                html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> " + objCompany[0].AccountNo + "</p>");
                html.Append("<p style='display: block; font-size: 11px; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span>" + objCompany[0].Branch + " & " + objCompany[0].IFSC + "</p>");
                html.Append("<table style='border: 1px solid #000; border-bottom: 0; border-right: 0;  width:100%;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr>");
                html.Append("<td><p align='right' style='font-size: 13px; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p><span><br/><br/></span></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td><p align='right' style='font-size: 13px; margin:0;'>Authorised Signatory</p></td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%;' cellspacing='0' cellpadding='2'><tbody>");
                html.Append("<tr>");
                html.Append("<td style='text-align:center; font-size: 11px; padding:0;'>SUBJECT TO HYDERABAD JURISDICTION</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td style='text-align:center; font-size: 11px;'>This is a Computer Generated Invoice</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");

                html.Append("</td></tr>");

                html.Append("</tbody></table>");
                /***************/
                lstSB.Add(html.ToString());
            });
            var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateBulkInvoiceReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "BulkInvoice.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/BulkInvoice/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f))
                {

                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/BulkInvoice/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        [HttpGet]
        [CustomValidateAntiForgeryToken]
        public ActionResult ListOfInvoiceDateWise(string FromDate, string ToDate, string invoiceType)
        {
            Hdb_ReportRepository ObjRR = new Hdb_ReportRepository();
            List<invoiceLIst> LstinvoiceLIst = new List<invoiceLIst>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.GetInvoiceList(FromDate, ToDate, invoiceType);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                //LstinvoiceLIst = (List<invoiceLIst>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }

        }

        [NonAction]
        public string GeneratingBulkPDFforBTT(DataSet ds, string InvoiceModuleName, string All)
        {
            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                Dnd_ExportRepository rep = new Dnd_ExportRepository();
                Dnd_BTTCargoEntryDtl objCargoDet = new Dnd_BTTCargoEntryDtl();
                rep.GetCargoDetBTTById(Convert.ToInt32(item.StuffingReqId));
                if (rep.DBResponse.Data != null)
                {
                    objCargoDet = (Dnd_BTTCargoEntryDtl)rep.DBResponse.Data;
                }

                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><span style='font-size:7pt;'>(A Govt. of India Undertaking)</span><br/><span style='font-size: 7pt;'>Container Freight Station,</span><br /><span style='font-size:7pt;'>" + objCompany[0].CompanyAddress + "</span><br/><span style='font-size: 7pt;'><b>Phone No:</b> " + objCompany[0].PhoneNo + " </span><br /><span style='font-size: 7pt;'><b>Email:</b> " + objCompany[0].EmailAddress + " </span><br/><label style='font-size: 7pt; font-weight:bold;'>EXPORT BTT PAYMENT SHEET</label></td>");
                //html.Append("<td valign='top'><img align='right' src='SWACHBHARAT' width='100'/></td></tr>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='12' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%'>");
                html.Append("<table style='width:100%; font-size:7pt; margin:0 0 20px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%; font-size:7pt; border:1px solid #333; margin:0 0 20px;' cellspacing='0' cellpadding='5'><tbody><tr>");
                html.Append("<td colspan='4' width='33.33333333333333%'><b>Exporter :</b> " + item.ExporterImporterName + " </td>");
                html.Append("<td colspan='4' width='33.33333333333333%'><b>CHA :</b> " + item.CHAName + " </td>");
                html.Append("<td colspan='4' width='33.33333333333333%'><b>Shipping Line :</b>" + item.ShippingLineName + "</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                //html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                //html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                //html.Append("<span>" + item.PartyName + "</span></td>");
                //html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                //html.Append("Party Address :</label> <span>" + item.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                //html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                //html.Append("Party GST :</label> <span>" + item.PartyGSTNo + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                //html.Append("<label style='font-weight: bold;'>Invoice Generated By :</label> <span>" + item.PaymentMode + "</span></td></tr>");
                //html.Append("</tbody> ");
                //html.Append("</table></td></tr>");

                //html.Append("<tr><td><hr/></td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin: 0;'>Container / CBT Details :</b> </th></tr>");
                html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'>To Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align:center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'></td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'></td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'></td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'></td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center;'></td>");
                    html.Append("<td style='border-bottom: 1px solid #000; text-align:center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });

                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin: 0;'>Cargo Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:5%;'>Entry No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>SB No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>SB Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>Commodity</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>No of pkg</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>GR WT</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>Area</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align:center; width:10%;'>FOB</th>");
                html.Append("</tr></thead><tbody>");
                i = 1;

                // objCargoDet.ForEach(elem =>
                // {
                html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:5%;'>" + i.ToString() + "</td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'> " + objCargoDet.ShippingBillNo.ToString() + " </td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>" + objCargoDet.ShippingBillDate.ToString() + "</td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>" + objCargoDet.CommodityName.ToString() + "</td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>" + objCargoDet.NoOfUnits.ToString() + "</td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>" + objCargoDet.GrossWeight.ToString("0.###") + "</td>");
                html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align:center; width:10%;'>" + objCargoDet.BTTArea.ToString("0.###") + "</td>");
                html.Append("<td style='border-bottom: 1px solid #000; text-align:center; width:10%;'> " + objCargoDet.Fob.ToString() + "</td>");
                html.Append("</tr>");
                //   i = i + 1;
                // });
                html.Append("</tbody></table></td></tr>");


                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin: 0;'>Container / CBT Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/
                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.00") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                    i = i + 1;
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000;border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + item.TotalTaxable.ToString("0.00") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td cellpadding='5' style='font-size: 7pt; text-align: left; width: 50%; vertical-align: bottom;'>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span>" + objCompany[0].BankName + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span>" + objCompany[0].AccountNo + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span>" + objCompany[0].Branch + " & " + objCompany[0].IFSC + "</p>");
                html.Append("</td>");
                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0;'>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='border: 1px solid #333; border-top: 0; border-bottom: 0; border-right: 0; padding: 0 15px;'>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody><tr><td style='font-size: 7pt; text-align: left;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 7pt; text-align: left;' colspan='2'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left;'><br/><br/><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");
                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("SWACHBHARAT", Server.MapPath("~/Content/Images/SwachhBharat-Logo.png"));
                lstSB.Add(html.ToString());
            });
            FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforExport(DataSet ds, string InvoiceModuleName, string All)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='3'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><span style='font-size:7pt;'>(A Govt. of India Undertaking)</span><br/><span style='font-size: 7pt;'>Container Freight Station,</span><br /><span style='font-size:7pt;'>" + objCompany[0].CompanyAddress + "</span><br/><span style='font-size: 7pt;'><b>Phone No:</b> " + objCompany[0].PhoneNo + " </span><br /><span style='font-size: 7pt;'><b>Email:</b> " + objCompany[0].EmailAddress + " </span><br/><label style='font-size: 7pt; font-weight:bold;'>EXPORT PAYMENT SHEET</label></td>");
                //html.Append("<td valign='top'><img align='right' src='SWACHBHARAT' width='100'/></td></tr>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='3' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='3'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + "</h2> </td></tr>");

                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px; font-size: 7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='border-bottom:1px solid #000; padding-bottom: 5px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='border-bottom:1px solid #000; padding-bottom: 5px;'><label style='font-weight: bold;'>Payee Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td></tr>");


                //html.Append("<tr><td><table style='width:100%;font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                //html.Append("<tr><td colspan='6' width='50%'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                //html.Append("<td colspan='6' width='50%'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                //html.Append("<tr><td colspan='6' width='50%'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                //html.Append("<td colspan='6' width='50%'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                //html.Append("<tr><td colspan='6' width='50%'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                //html.Append("<td colspan='6' width='50%'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                //html.Append("<tr><td colspan='6' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                //html.Append("<td colspan='6' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Payee Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                //html.Append("</tbody>");
                //html.Append("</table></td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt;'>Assessment No :</b> <span style='font-size:7pt;'> " + item.StuffingReqNo + " </span></th></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt;'>Container/Cargo Details :</b> </th></tr>");

                html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:100%; font-size: 7pt; text-align: center;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Date of Arrival</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Date of Delivery</th>");
                html.Append("<th style='border-bottom: 1px solid #000;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><td>");
                html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line</td><td>:</td><td colspan='6' width='70%'>" + item.ShippingLineName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line No.</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>OBL No.</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>Item No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer.Where(x => x.InvoiceId == item.InvoiceId).Count().ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Bill No.</td><td>:</td><td colspan='6' width='70%'>" + item.BOENo + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Bill Date</td><td>:</td><td colspan='6' width='70%'>" + item.BOEDate + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='border-left: 1px solid #000; width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Exporter</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>FOB Value</td><td>:</td><td colspan='6' width='70%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>FOB Value</td><td>:</td><td colspan='6' width='70%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>CHA Name</td><td>:</td><td colspan='6' width='70%'>" + item.CHAName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>No Of Pkg</td><td>:</td><td colspan='6' width='70%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalSpaceOccupied.ToString("0.000") + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt;'>Container/Cargo Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 150px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.00") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 170px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");


                html.Append("<tr>");
                html.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 7pt; text-align: left; width: 50%; vertical-align: top;'>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> " + objCompany[0].BankName + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> " + objCompany[0].AccountNo + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span>" + objCompany[0].Branch + " & " + objCompany[0].IFSC + "</p>");
                html.Append("</td>");

                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0; border-left: 1px solid #000;'>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");



                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody><tr><td style='font-size: 7pt; text-align: left;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td><");
                html.Append("td style='font-size: 7pt; text-align: left;' colspan='2'>Party Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left;'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("SWACHBHARAT", Server.MapPath("~/Content/Images/SwachhBharat-Logo.png"));
                lstSB.Add(html.ToString());
            });
            var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        [NonAction]
        public string GeneratingBulkPDFforMisc(DataSet ds, string InvoiceModuleName, string All)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='3'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><span style='font-size:7pt;'>(A Govt. of India Undertaking)</span><br/><span style='font-size: 7pt;'>Container Freight Station,</span><br /><span style='font-size:7pt;'>" + objCompany[0].CompanyAddress + "</span><br/><span style='font-size: 7pt;'><b>Phone No:</b> " + objCompany[0].PhoneNo + " </span><br /><span style='font-size: 7pt;'><b>Email:</b> " + objCompany[0].EmailAddress + " </span><br/><label style='font-size: 7pt; font-weight:bold;'>MISCELLANEOUS INVOICE</label></td>");
                //html.Append("<td valign='top'><img align='right' src='SWACHBHARAT' width='100'/></td></tr>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='3' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='3'><table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + "</h2> </td></tr>");

                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px; font-size: 7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyState + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='border-bottom:1px solid #000; padding-bottom: 5px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='border-bottom:1px solid #000; padding-bottom: 5px;'><label style='font-weight: bold;'>Payee Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td></tr>");

                //html.Append("<tr><th><b style='text-align: left; font-size: 13px; margin-top: 10px;'>Assessment No :</b> " + item.StuffingReqNo + "</th></tr>");

                /*html.Append("<tr><th><b style='text-align: left; font-size: 13px; margin-top: 10px;'>Container/Cargo Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Arrival</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Delivery</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");*/
                /*************/
                /*Container Bind*/
                /*int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InoviceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + i + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });*/
                /***************/
                /*html.Append("</tbody></table></td></tr>");
                html.Append("<tr><td>");
                html.Append("</td></tr>");*/

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin:0;'>Container/Cargo Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 150px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                int i = 1; Decimal totamt = 0;
                /*Charges Bind*/

                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 150px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 150px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 150px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 170px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 150px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");


                html.Append("<tr>");
                html.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td cellpadding='5' style='font-size: 7pt; text-align: left; width: 50%; vertical-align: bottom;'>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> " + objCompany[0].BankName + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> " + objCompany[0].AccountNo + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span>" + objCompany[0].Branch + " & " + objCompany[0].IFSC + "</p>");
                html.Append("</td>");
                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0;'>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='border: 1px solid #333; border-top: 0; border-bottom: 0; border-right: 0; padding: 0 15px;'>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left; line-height: 30px;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 7pt; text-align: left; line-height: 30px;' colspan='2'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");

                html.Append("<tr><td style='font-size: 7pt; text-align: left;'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("SWACHBHARAT", Server.MapPath("~/Content/Images/SwachhBharat-Logo.png"));
                lstSB.Add(html.ToString());
            });
            var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforBND(DataSet ds, string InvoiceModuleName)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstStorageDate = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='font-size: 7pt;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt;'>Email - " + objCompany[0].EmailAddress + "</label>");
                html.Append("<br /><label style='font-size: 7pt; font-weight:bold;'>Bond Delivery Paymentsheet</label>");
                html.Append("</td>");
                //html.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='3' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='3'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='12'><h2 style='font-size: 13px; text-align: center; margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + " </h2> </td></tr>");

                html.Append("<tr><td colspan='12'><table style='width:100%; font-size: 7pt; border-bottom:1px solid #000; padding-bottom:5px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'></label> <span></span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>Delivery Date : </label> <span>" + item.DeliveryDate + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>Payee Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td></tr>");
                html.Append("<tr><th colspan='6' width='50%'><b style='text-align: left; font-size: 7pt;margin-top: 8px;'>Bond No :" + item.StuffingReqNo + "</b></th>");
                html.Append("<td colspan='6' width='50%' style='font-size:7pt; text-align: right'><label width='15%'><b>SAC validity :</b></label> From <u>" + lstContainer[0].SacApprovedDate + "</u> to <u>" + lstContainer[0].SacValidityDate + "</u></td></tr>");
                html.Append("<tr><th colspan='2' width='20%' style='text-align: left; font-size: 7pt; margin-top: 15px;' valign='top'>Storage Period :</th>");
                html.Append("<td colspan='10' width='80%'><table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='0'><tbody>");

                var SacId = 0;
                var DeliId = 0;
                if (lstStorageDate.Where(x => x.InvoiceId == item.InvoiceId).Count() > 0)
                {
                    SacId = lstStorageDate.Where(x => x.InvoiceId == item.InvoiceId).ToList().Select(y => y.SacId).ToArray()[0];
                    DeliId = lstStorageDate.Where(x => x.InvoiceId == item.InvoiceId).ToList().Select(y => y.SacDelivryId).ToArray()[0];
                }

                lstStorageDate.Where(x => x.SacId == SacId && x.InvoiceId <= item.InvoiceId && x.SacDelivryId <= DeliId).ToList().ForEach(storage =>
                {
                    int j = 1;
                    html.Append("<tr><td colspan='12' cellpadding='5' valign='top'>From <u>" + storage.StorageFromDt + "</u> to <u>" + storage.StorageToDt + "</u></td></tr>");
                    j = j + 1;
                });
                html.Append("</tbody></table></td></tr>");


                html.Append("<tr><td colspan='12'>");
                int i = 1;
                Decimal totamt = 0;
                html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Bond No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].BondNo.ToString().TrimEnd(',') + " </td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Bond Date</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].BondDate.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOL No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].BOLNo.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOL Date</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].BOLDate.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOE No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].BOENo.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOE Date.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].BOEDate.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>AWB No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].AWBNo.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>AWB Date</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].AWBDate.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Godown No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer[0].GodownName.ToString().TrimEnd(',') + "</td></tr>");

                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='border-left: 1px solid #000; width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='40%'>Ex-BOE No.</td><td>:</td><td colspan='6' width='60%'>" + lstContainer[0].ExBOENo.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>Ex-BOE Date.</td><td>:</td><td colspan='6' width='60%'>" + lstContainer[0].ExBOEDate.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>Importer</td><td>:</td><td colspan='6' width='60%'>" + lstInvoice[0].ExporterImporterName.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>CHA Name</td><td>:</td><td colspan='6' width='60%'>" + lstInvoice[0].CHAName.ToString().TrimEnd(',') + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>CIF Value</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIF)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>DUTY</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.Duty)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>Total</td><td>:</td><td colspan='6' width='60%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIF) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>No Of Pkg</td><td>:</td><td colspan='6' width='60%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='40%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalSpaceOccupied.ToString("0.000") + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th colspan='12'><h3 style='text-align: left; font-size: 7pt; margin: 0;'>Container/Cargo Charges :</h3> </th></tr>");
                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Rate.ToString("0.000") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.00") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td cellpadding='5' style='font-size: 7pt; text-align: left; width: 50%; vertical-align: bottom;'>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> " + objCompany[0].BankName + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> " + objCompany[0].AccountNo + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span> " + objCompany[0].Branch + " & " + objCompany[0].IFSC + "</p>");
                html.Append("</td>");
                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0;'>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='border: 1px solid #333; border-top: 0; border-bottom: 0; border-right: 0; padding: 0 15px;'>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody><tr><td style='font-size: 7pt; text-align: left;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 7pt; text-align: left; line-height: 30px;' colspan='2'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left;'><br/><br/><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                lstSB.Add(html.ToString());

            });
            var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        [NonAction]
        public string GeneratingBulkPDFforBondHdb(DataSet ds, string InvoiceModuleName)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
             {
                 StringBuilder html = new StringBuilder();
                 /*Header Part*/
                 html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                 html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='50'/></td>");
                 html.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 16px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                 html.Append("<label style='display: block; font-size: 7pt;'>(A Govt. of India Undertaking) </label><br />");
                 html.Append("<span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt;'>Email - cwccfs@gmail.com</label>");
                 html.Append("<br /><label style='font-size: 7pt; font-weight:bold;'>Bond Advance Paymentsheet</label>");
                 html.Append("</td>");
                 html.Append("</tr>");

                 html.Append("<tr><td colspan='3' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                 html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                 html.Append("<tr><td colspan='3'><table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                 html.Append("<tbody><tr><td colspan='12'><h2 style='font-size: 13px;text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice (SAC)</h2> </td></tr>");

                 html.Append("<tr><td colspan='12'><table style='width:100%; border-bottom: 1px solid #000; padding-bottom:5px;' cellspacing='0'><tbody>");
                 html.Append("<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                 html.Append("<td colspan='4' width='30%' style='font-size: 7pt;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                 html.Append("<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                 html.Append("<td colspan='4' width='30%' style='font-size: 7pt;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                 html.Append("<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                 html.Append("<td colspan='4' width='30%' style='font-size: 7pt;'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyGSTStateCode + "</span></td></tr>");
                 html.Append("<tr><td colspan='8' width='100%' style='font-size: 7pt;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                 html.Append("<td colspan='4' width='30%' style='font-size: 7pt;'><label style='font-weight: bold;'>Payer Name  :</label> <span>" + item.PayeeName + "</span></td></tr>");
                 // html.Append("<tr><td colspan='12' width='100%' style='font-size: 7pt;border-bottom:1px solid #000;padding-bottom:5px;'><label style='font-weight: bold;'>Under :</label> <span>" + item.ExportUnder + "</span></td></tr>");
                 html.Append("</tbody>");
                 html.Append("</table></td></tr>");

                 html.Append("<tr><th colspan='6' width='50%'><b style='text-align: left; font-size: 7pt;'>SAC No :" + item.StuffingReqNo + "</b></th>");

                 lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                 {
                     html.Append("<td colspan='6' width='50%' style='font-size:7pt;'><b>SAC validity :</b> From <u>" + elem.SacApprovedDate + "</u> to <u>" + elem.SacValidityDate + "</u></td></tr>");
                 });

                 //html.Append("<tr><th colspan='12'><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container/Cargo Details :</b> </th></tr>");
                 //html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='10'>");
                 //html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>SR No.</th>");
                 //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>CFS Code</th>");
                 //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Container No.</th>");
                 //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Size</th>");
                 //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Arrival</th>");
                 //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Carting</th>");
                 //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Destuffing</th>");
                 //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>Date of Delivery</th>");
                 //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>No of Days</th>");
                 //html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; padding: 5px;'>No of Week</th>");
                 //html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>Cargo Type</th>");
                 //html.Append("</tr></thead><tbody>");
                 /*************/
                 /*Container Bind*/

                 // lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                 //{
                 //    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + i + "</td>");
                 //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                 //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                 //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                 //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + elem.ArrivalDate + "</td>");
                 //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                 //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'></td>");
                 //    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + item.DeliveryDate + "</td>");
                 //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + ((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.ArrivalDate)).TotalDays + 1).ToString() + "</td>");
                 //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + Math.Ceiling(((((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(item.ArrivalDate)).TotalDays + 1)) / 7)).ToString() + "</td>");
                 //    //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + Convert.ToDateTime(elem.DeliveryDate)+ "</td>");
                 //    html.Append("<td style='border-bottom: 1px solid #000; font-size: 11px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                 //    html.Append("</tr>");
                 //    i = i + 1;
                 //});
                 /***************/
                 //html.Append("</tbody></table></td></tr>");

                 html.Append("<tr><td colspan='12'>");

                 //html.Append("<table style=' border: 1px solid #000; width:100%;' cellspacing='0' cellpadding='5'>");
                 //html.Append("<tr><td style='font-size: 12px;' colspan='5'>Shipping Line : " + item.ShippingLineName + " </td></tr>");
                 //html.Append("<tr><td style='font-size: 12px;'>Shipping Line No.:  </td>");
                 //html.Append("<td style='font-size: 12px;'>OBL No :  </td>");
                 //html.Append("<td style='font-size: 12px;'>Item No. : " + lstContainer.Where(x => x.InvoiceId == item.InvoiceId).Count().ToString() + "</td>");
                 //html.Append("<td style='font-size: 12px;'>BOE No : " + item.BOENo.ToString().TrimEnd(',') + " </td>");
                 //html.Append("<td style='font-size: 12px;'>BOE Date : " + item.BOEDate.ToString().TrimEnd(',') + " </td>");
                 //html.Append("</tr>");
                 //html.Append("<tr><td style='font-size: 12px;' colspan='3'>Importer : " + item.ExporterImporterName + " </td>");
                 //html.Append("<td style='font-size: 12px;' colspan='2'>VALUE : " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                 //html.Append("<tr><td style='font-size: 12px;' colspan='5'>CHA Name : " + item.CHAName + " </td></tr>");
                 //html.Append("<tr><td style='font-size: 12px;'>No Of Pkg : " + item.TotalNoOfPackages.ToString() + " </td>");
                 //html.Append("<td style='font-size: 12px;'>Total Gr.Wt (In Kg) : " + item.TotalGrossWt.ToString("0.000") + " </td>");
                 //html.Append("<td style='font-size: 12px;'>Total Area (In Sqr Mtr) : " + item.TotalSpaceOccupied.ToString("0.000") + "</td>");
                 //html.Append("<td></td>");
                 //html.Append("<td></td>");
                 //html.Append("</tr>");
                 //html.Append("</table>");
                 int i = 1;
                 Decimal totamt = 0;
                 lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                 {
                     html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                     html.Append("<td colspan='6' width='50%'>");
                     html.Append("<table style='border-right: 1px solid #000; width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                     html.Append("<tr><td colspan='6' width='30%'>BOL No.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOLNo.ToString().TrimEnd(',') + "</td></tr>");
                     html.Append("<tr><td colspan='6' width='30%'>BOL Date</td><td>:</td><td colspan='6' width='70%'>" + elem.BOLDate.ToString().TrimEnd(',') + "</td></tr>");
                     html.Append("<tr><td colspan='6' width='30%'>BOE No.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOENo.ToString().TrimEnd(',') + "</td></tr>");
                     html.Append("<tr><td colspan='6' width='30%'>BOE Date.</td><td>:</td><td colspan='6' width='70%'>" + elem.BOEDate.ToString().TrimEnd(',') + "</td></tr>");
                     html.Append("<tr><td colspan='6' width='30%'>AWB No.</td><td>:</td><td colspan='6' width='70%'>" + elem.AWBNo.ToString().TrimEnd(',') + "</td></tr>");
                     html.Append("<tr><td colspan='6' width='30%'>AWB Date</td><td>:</td><td colspan='6' width='70%'>" + elem.AWBDate.ToString().TrimEnd(',') + "</td></tr>");
                     html.Append("<tr><td colspan='6' width='30%'>Godown No.</td><td>:</td><td colspan='6' width='70%'>" + elem.GodownName + "</td></tr>");
                     html.Append("<tr><td colspan='6' width='30%'>Importer</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                     html.Append("</tbody></table>");
                     html.Append("</td>");

                     html.Append("<td colspan='6' width='50%'>");
                     html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                     html.Append("<tr><td colspan='6' width='40%'>CHA Name</td><td>:</td><td colspan='6' width='60%'>" + item.CHAName + "</td></tr>");
                     html.Append("<tr><td colspan='6' width='40%'></td><td>" + " " + "</td><td colspan='6' width='60%'></td></tr>");
                     html.Append("<tr><td colspan='6' width='40%'></td><td>" + " " + "</td><td colspan='6' width='60%'></td></tr>");
                     html.Append("<tr><td colspan='6' width='40%'></td><td>" + "" + "</td><td colspan='6' width='60%'></td></tr>");
                     html.Append("<tr><td colspan='6' width='40%'>No Of Pkg</td><td>:</td><td colspan='6' width='60%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                     html.Append("<tr><td colspan='6' width='40%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                     html.Append("<tr><td colspan='6' width='40%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='60%'>" + item.TotalSpaceOccupied.ToString("0.000") + "</td></tr>");
                     html.Append("<tr><td colspan='6' width='40%'>No Of Weeks </td><td>:</td><td colspan='6' width='60%'>" + elem.Week.ToString() + "</td></tr>");
                     html.Append("</tbody></table>");
                     html.Append("</td>");

                     html.Append("</tr></tbody></table>");
                     html.Append("</td></tr>");

                     html.Append("<tr><td colspan='12'><table style='width:100%;'><tbody>");

                     html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin:0;'>Container/Cargo Charges :</h3> </th></tr>");
                     html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                     html.Append("<thead><tr>");
                     html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>SR No.</th>");
                     //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                     html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                     html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                     html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                     html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                     html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                     html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                     html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                     html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                     html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                     html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                     html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                     html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                     html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                     html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                     html.Append("<tbody>");
                     i = 1;
                     /*Charges Bind*/
                 });
                 i = 1;
                 lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                 {
                     if (data.Taxable > 0)
                     {

                         html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + i.ToString() + "</td>");
                         //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                         html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                         html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                         html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Rate.ToString("0.00") + "</td>");
                         html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                         html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                         html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                         html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                         html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                         html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                         html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                         html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                         i = i + 1;
                         totamt = totamt + data.Taxable;
                     }
                 });
                 html.Append("</tbody>");
                 html.Append("</table></td></tr>");
                 html.Append("</tbody></table></td></tr>");
                 html.Append("</tbody></table>");


                 html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                 html.Append("<tbody>");
                 html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                 html.Append("<th rowspan='2' style='width: 24%;'></th>");
                 html.Append("<th rowspan='2' style='width: 100px;'></th>");
                 html.Append("<th rowspan='2' style='width: 80px;'></th>");
                 html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.00") + "</th>");
                 html.Append("<th colspan='2' style='width: 200px;'></th>");
                 html.Append("<th colspan='2' style='width: 200px;'></th>");
                 html.Append("<th colspan='2' style='width: 200px;'></th>");
                 html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                 html.Append("</tbody>");
                 html.Append("</table>");

                 html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                 html.Append("<tbody>");
                 html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                 html.Append("<th rowspan='2' style='width: 140px;'></th>");
                 html.Append("<th rowspan='2' style='width: 24%;'></th>");
                 html.Append("<th rowspan='2' style='width: 100px;'></th>");
                 html.Append("<th rowspan='2' style='width: 80px;'></th>");
                 html.Append("<th rowspan='2' style='width: 130px;'></th>");
                 html.Append("<th colspan='2' style='width: 200px;'></th>");
                 html.Append("<th colspan='2' style='width: 200px;'></th>");
                 html.Append("<th colspan='2' style='width: 200px;'></th>");
                 html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='width: 50px;'></th></tr>");
                 html.Append("</tbody>");
                 html.Append("</table>");

                 html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                 html.Append("<tbody>");
                 html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                 html.Append("<th rowspan='2' style='width: 140px;'></th>");
                 html.Append("<th rowspan='2' style='width: 24%;'></th>");
                 html.Append("<th rowspan='2' style='width: 100px;'></th>");
                 html.Append("<th rowspan='2' style='width: 80px;'></th>");
                 html.Append("<th rowspan='2' style='width: 130px;'></th>");
                 html.Append("<th colspan='2' style='width: 200px;'></th>");
                 html.Append("<th colspan='2' style='width: 200px;'></th>");
                 html.Append("<th colspan='2' style='width: 200px;'></th>");
                 html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='width: 50px;'></th>");
                 html.Append("<th style='width: 50px;'></th></tr>");
                 html.Append("</tbody>");
                 html.Append("</table>");

                 html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                 html.Append("<tbody>");
                 html.Append("<tr>");
                 html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : <span style='font-size:7pt;'>" + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</span></th>");
                 html.Append("</tr>");
                 html.Append("<tr>");
                 html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                 html.Append("</tr>");
                 html.Append("</tbody>");
                 html.Append("</table>");

                 html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                 html.Append("<tbody>");
                 html.Append("<tr>");
                 html.Append("<td cellpadding='5' style='font-size: 6pt; text-align: left; width: 50%; vertical-align: bottom;'>");
                 html.Append("<p style='display: block; font-size: 6pt; margin:0;'>Company's Bank Details</p>");
                 html.Append("<p style='display: block; font-size: 6pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> Punjab National Bank</p>");
                 html.Append("<p style='display: block; font-size: 6pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> 4737002100000318</p>");
                 html.Append("<p style='display: block; font-size: 6pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span> Balanagar & PUNB0473700</p>");
                 html.Append("</td>");
                 html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0;'>");
                 html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                 html.Append("<tbody>");
                 html.Append("<tr>");
                 html.Append("<td style='border: 1px solid #333; border-top: 0; border-bottom: 0; border-right: 0; padding: 0 15px;'>");
                 html.Append("<p style='text-align: right; font-size: 6pt; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                 html.Append("<span><br/><br/></span>");
                 html.Append("<p style='text-align: right; font-size: 6pt; margin:0;'>Authorised Signatory</p>");
                 html.Append("</td>");
                 html.Append("</tr>");
                 html.Append("</tbody>");
                 html.Append("</table>");
                 html.Append("</td>");
                 html.Append("</tr>");
                 html.Append("</tbody>");
                 html.Append("</table>");

                 html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                 html.Append("<tbody><tr><td style='font-size: 6pt; text-align: left;'colspan='2'>Receipt No.: ");
                 html.Append("<label style='font-weight: bold;'></label></td><td style='font-size: 6pt; text-align: left;' colspan='2'>Party Code:");
                 html.Append("<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                 html.Append("<tr><td style='font-size: 6pt; text-align: left;'><br/><br/>Signature CHA / Importer</td>");
                 html.Append("<td style='font-size: 6pt; text-align: left;'><br/><br/>Assistant <br/>(Signature)</td>");
                 html.Append("<td style='font-size: 6pt; text-align: left;'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                 html.Append("<td style='font-size: 6pt; text-align: left;'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                 html.Append("</tr></tbody></table>");
                 html.Append("</td></tr></tbody></table>");

                 /***************/
                 html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                 html.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                 lstSB.Add(html.ToString());
             });
            var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        [NonAction]
        public string GeneratingBulkPDFforExportLoadedCont(DataSet ds, string InvoiceModuleName, string All)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='3'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0; text-transform: uppercase;'>" + objCompany[0].CompanyName + "</h1><span style='font-size:7pt;'>(A Govt. of India Undertaking)</span><br/><span style='font-size: 7pt;'>Container Freight Station,</span><br /><span style='font-size:7pt;'>" + objCompany[0].CompanyAddress + "</span><br/><span style='font-size: 7pt;'><b>Phone No:</b> " + objCompany[0].PhoneNo + " </span><br /><span style='font-size: 7pt;'><b>Email:</b> " + objCompany[0].EmailAddress + " </span><br/><label style='font-size: 7pt; font-weight:bold;'>LOADED CONTAINER PAYMENT SHEET</label></td>");
                //html.Append("<td valign='top'><img align='right' src='SWACHBHARAT' width='100'/></td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='3' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='3'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + "</h2> </td></tr>");

                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px; font-size:7pt;' cellspacing='0' cellpadding='3'><tbody>");
                html.Append("<tr><td colspan='6' width='50%'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td colspan='6' width='50%'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td colspan='6' width='50%'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td colspan='6' width='50%'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td colspan='6' width='50%'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td colspan='6' width='50%'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td style='border-bottom: 1px solid #000; padding-bottom:5px;' colspan='6' width='50%' style='border-bottom:1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td style='border-bottom: 1px solid #000; padding-bottom:5px;' colspan='6' width='50%' style='border-bottom:1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Payee Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td></tr>");

                html.Append("<tr><th style='text-align: left; font-size: 7pt; margin:0;'><b>Assessment No :</b> <span>" + item.StuffingReqNo + "</span></th></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin:0;'>Container/Cargo Details :</b> </th></tr>");
                html.Append("<tr><td><table style='border: 1px solid #000; width:100%; font-size: 6pt; text-align: center;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000;'>Date of Arrival</th>");
                html.Append("<th style='border-right: 1px solid #000;'>Date of Delivery</th>");
                html.Append("<th>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + i + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-top: 1px solid #000;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line</td><td>:</td><td colspan='6' width='70%'>" + item.ShippingLineName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Seal No.</td><td>:</td><td colspan='6' width='70%'>" + item.ShippingSealNo + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Custom Seal No.</td><td>:</td><td colspan='6' width='70%'>" + item.CustomSealNo + "</td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>OBL No.</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>Item No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer.Where(x => x.InvoiceId == item.InvoiceId).Count().ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Bill No.</td><td>:</td><td colspan='6' width='70%'>" + item.BOENo + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Bill Date</td><td>:</td><td colspan='6' width='70%'>" + item.BOEDate + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Movement No.</td><td>:</td><td colspan='6' width='70%'>" + item.MovementNo + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='border-left: 1px solid #000; width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Exporter</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>FOB Value</td><td>:</td><td colspan='6' width='70%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>FOB Value</td><td>:</td><td colspan='6' width='70%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>CHA Name</td><td>:</td><td colspan='6' width='70%'>" + item.CHAName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>No Of Pkg</td><td>:</td><td colspan='6' width='70%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalSpaceOccupied.ToString("0.000") + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0;'>Container/Cargo Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.00") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 170px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");


                html.Append("<tr>");
                html.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td cellpadding='5' style='font-size: 7pt; text-align: left; width: 50%; vertical-align: bottom;'>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> Punjab National Bank</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> 4737002100000318</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span> Balanagar & PUNB0473700</p>");
                html.Append("</td>");
                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0; border-left: 1px solid #000;'>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='padding: 0 15px;'>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody><tr><td style='font-size: 7pt; text-align: left;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 7pt; text-align: left;' colspan='2'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left;'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("SWACHBHARAT", Server.MapPath("~/Content/Images/SwachhBharat-Logo.png"));
                lstSB.Add(html.ToString());
            });
            var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        [NonAction]
        public string GeneratingBulkPDFforSO(DataSet ds, string InvoiceModuleName, string All)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><span style='font-size:7pt;'>(A Govt. of India Undertaking)</span><br/><span style='font-size: 7pt;'>Container Freight Station,</span><br /><span style='font-size:7pt;'>" + objCompany[0].CompanyAddress + "</span><br/><span style='font-size: 7pt;'><b>Phone No:</b> " + objCompany[0].PhoneNo + " </span><br /><span style='font-size: 7pt;'><b>Email:</b> " + objCompany[0].EmailAddress + " </span><br/><label style='font-size: 7pt; font-weight:bold;'>SPECIAL OPERATION INVOICE</label></td>");
                //html.Append("<td valign='top'><img align='right' src='SWACHBHARAT' width='100'/></td></tr>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='12' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + "</h2> </td></tr>");

                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='border-bottom:1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='border-bottom:1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Payee Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td></tr>");

                html.Append("<tr><th style='text-align: left; font-size: 7pt; margin: 0;'><b>Assessment No :</b> " + item.StuffingReqNo + "</th></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin: 0px;'>Container/Cargo Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size: 6pt; text-align: center;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt;'>Date of Arrival</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt;'>Date of Delivery</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><td>");
                html.Append("</td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0;'>Container/Cargo Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.00") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 170px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");


                html.Append("<tr>");
                html.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 7pt; text-align: left; width: 50%; vertical-align: top;'>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> " + objCompany[0].BankName + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> " + objCompany[0].AccountNo + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span>" + objCompany[0].Branch + " & " + objCompany[0].IFSC + "</p>");
                html.Append("</td>");

                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0; border-left: 1px solid #000;'>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody><tr><td style='font-size: 7pt; text-align: left; line-height: 30px;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 7pt; text-align: left; line-height: 30px;' colspan='2'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left;'><br/><br/><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("SWACHBHARAT", Server.MapPath("~/Content/Images/SwachhBharat-Logo.png"));
                lstSB.Add(html.ToString());
            });
            var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforDndYard(DataSet ds, string InvoiceModuleName)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();
            Decimal totamt = 0;
            lstInvoice.ToList().ForEach(item =>
            {

                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='80%' valign='top' align='center'><h1 style='font-size: 16px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 7pt;'>(A Govt. of India Undertaking) </label><br />");
                //html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 12px;'>Email - cwccfs@gmail.com</label>");
                //html.Append("<br />" + InvoiceModuleName);
                html.Append("<span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br/><label style='font-size: 7pt;'><b>Phone No:</b> 022-27243271/72 </label><br/><label style='font-size: 7pt;'><b>Email:</b> drt@concorindia.com </label>");
                // html.Append("<br /><label style='font-size: 7pt; font-weight:bold;'>" + InvoiceModuleName + "</label>");
                html.Append("<br /><label style='font-size: 7pt; font-weight:bold;'>ASSESSMENT SHEET FCL</label>");
                html.Append("</td>");
                //html.Append("<td valign='top'><img align='right' src='ISO' width='60'/></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='3' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td colspan='3'><table style=' border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px;text-align: center;margin: 0; padding: 0;'>" + item.InvoiceType + "   " + "Invoice</h2> </td></tr>");
                html.Append("<tr><td><table style='width:100%;' cellspacing='0'><tbody>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 7pt;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 7pt;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 7pt;'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 7pt;'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyGSTStateCode + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='font-size: 7pt; border-bottom: 1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='font-size: 7pt; border-bottom: 1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Payer Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                //html.Append("<tr><td colspan='12' width='100%' style='font-size: 7pt;border-bottom:1px solid #000;padding-bottom:5px;'><label style='font-weight: bold;'>Under :</label> <span>" + item.ExportUnder + "</span></td></tr>");
                html.Append("</tbody> ");
                html.Append("</table></td></tr><tr><th><b style='text-align: left; font-size: 7pt; margin:0;'>Assessment No :" + item.StuffingReqNo + "</b> ");
                html.Append("<br /><b style='text-align: left; font-size: 7pt;'>Container Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>CFS Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Date of Arrival</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Weight</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Date of Delivery</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>No of Days</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>Cargo Type</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 7%;'>ODC</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.GrossWt.ToString("0.000") + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + ((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.ArrivalDate)).TotalDays + 1).ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: center;'>" + elem.ISODC + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><td>");
                html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line</td><td>:</td><td colspan='6' width='70%'>" + item.ShippingLineName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line No.</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>OBL/HBL No.</td><td>:</td><td colspan='6' width='70%'>" + item.BOLNo + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>OBL/HBL Date</td><td>:</td><td colspan='6' width='70%'>" + item.BOLDate + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOE No.</td><td>:</td><td colspan='6' width='70%'>" + item.BOENo + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOE Date</td><td>:</td><td colspan='6' width='70%'>" + item.BOEDate + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='border-left: 1px solid #000; width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Importer</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Value</td><td>:</td><td colspan='6' width='70%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>CHA Name</td><td>:</td><td colspan='6' width='70%'>" + item.CHAName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>No Of Pkg</td><td>:</td><td colspan='6' width='70%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("</tr></tbody></table>");

                //html.Append("<table style=' border: 1px solid #000; width:100%;' cellspacing='0' cellpadding='5'>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='5'>Shipping Line : " + item.ShippingLineName + " </td></tr>");
                //html.Append("<tr><td style='font-size: 12px;'>Shipping Line No.:  </td>");
                //html.Append("<td style='font-size: 12px;'>OBL No :  </td>");
                //html.Append("<td style='font-size: 12px;'>Item No. : " + lstContainer.Where(x => x.InvoiceId == item.InvoiceId).Count().ToString() + "</td>");
                //html.Append("<td style='font-size: 12px;'>BOE No : " + item.BOENo + " </td>");
                //html.Append("<td style='font-size: 12px;'>BOE Date : " + item.BOEDate + " </td>");
                //html.Append("</tr>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='3'>Importer : " + item.ExporterImporterName + " </td>");
                //html.Append("<td style='font-size: 12px;' colspan='2'>VALUE : " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='5'>CHA Name : " + item.CHAName + " </td></tr>");
                //html.Append("<tr><td style='font-size: 12px;'>No Of Pkg : " + item.TotalNoOfPackages.ToString() + " </td>");
                //html.Append("<td style='font-size: 12px;'>Total Gr.Wt (In Kg) : " + item.TotalGrossWt.ToString("0.000") + " </td>");
                //html.Append("<td style='font-size: 12px;'>Total Area (In Sqr Mtr) :  </td>");
                //html.Append("<td></td>");
                //html.Append("<td></td>");
                //html.Append("</tr>");
                //html.Append("</table>");

                html.Append("</td></tr>");
                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin:0;'>Container Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                //html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 120px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 30px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 30px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 30px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");

                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        //html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 150px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 30px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 30px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 30px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 120px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 150px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.00") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 120px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 200px;'>Round Up :</th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 150px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 120px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 200px;'>Total(Rounded) :</th>");
                //html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 150px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 120px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 30px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : <span style='font-size:7pt;'>" + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</span></th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td cellpadding='5' style='font-size: 7pt; text-align: left; width: 50%; vertical-align: bottom;'>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> Punjab National Bank</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> 4737002100000318</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span> Balanagar & PUNB0473700</p>");
                html.Append("</td>");
                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0;'>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='border: 1px solid #333; border-top: 0; border-bottom: 0; border-right: 0; padding: 0 15px;'>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='6'>");
                html.Append("<tbody><tr><td style='font-size: 7pt; text-align: left; line-height: 30px;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 7pt; text-align: left; line-height: 30px;' colspan='2'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left;'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr><tr><td colspan=4 style='font-size: 7pt; text-align: left;'>If any changes in INVOICE will be done within 15 days.After 15 days changes will not be done</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");
                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                lstSB.Add(html.ToString());
            });
            var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDF_GodownDnd(DataSet ds, string InvoiceModuleName)
        {
            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstCargoDetail = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            //List<dynamic> lstReassesment = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[8]);
            //List<dynamic> lstReassesbulk = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[10]);
            List<string> lstSB = new List<string>();
            int cargotype = 0;
            string Container = "";
            string dt = "";
            string dttype = "Date of Seal Cutting";

            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td colspan='10' width='90%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0; text-transform:uppercase;'> " + objCompany[0].CompanyName + " </h1>");
                html.Append("<label style='display: block; font-size: 7pt;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 7pt; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span><br />");
                html.Append("<span style='font-size: 7pt; padding-bottom: 10px;'><b>Phone No:</b> 022-27243271/72</span><br />");
                html.Append("<span style='font-size: 7pt; padding-bottom: 10px;'><b>Email:</b> drt@concorindia.com</span>");
                html.Append("<br/><label style='font-size: 7pt; font-weight:bold;'>ASSESSMENT SHEET LCL</label>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='12' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center; margin: 0; padding: 0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom: 1px solid #000; padding-bottom: 5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom: 1px solid #000; padding-bottom: 5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th style='text-align: left; font-size: 7pt; margin-top: 0;'><b>Assessment No :" + item.StuffingReqNo + "</b> ");
                html.Append("<br/><b>Container / CBT Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt;' cellspacing='0' cellpadding='8'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>Container / CBT No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:6%;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>Date of Arrival</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>Date of Destuffing</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>Date of Delivery</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>No of Days</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>No of Week</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + dttype + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align: center; width:8%;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    if (dt != "")
                    {
                        elem.SealCuttingDt = dt;
                    }
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:5%;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:10%;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:6%;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + item.DestuffingDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width:8%;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + ((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.SealCuttingDt)).TotalDays + 1).ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + Math.Ceiling(((((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.SealCuttingDt)).TotalDays + 1)) / 7)).ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.SealCuttingDt.ToString() + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><td>");
                html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                html.Append("<td colspan='6' width='50%' style='border-right: 1px solid #000;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line</td><td>:</td><td colspan='6' width='70%'>" + item.ShippingLineName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line No.</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>OBL/HBL No.</td><td>:</td><td colspan='6' width='70%'>" + lstCargoDetail.Where(x => x.InvoiceId == item.InvoiceId).Select(x => x.OBLNo).FirstOrDefault() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Godown Name</td><td>:</td><td colspan='6' width='70%'>" + lstCargoDetail.Where(x => x.InvoiceId == item.InvoiceId).Select(x => x.GodownName).FirstOrDefault() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Item No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer.Where(x => x.InvoiceId == item.InvoiceId).Count().ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOE No.</td><td>:</td><td colspan='6' width='70%'>" + lstCargoDetail.Where(x => x.InvoiceId == item.InvoiceId).Select(x => x.BOENo).FirstOrDefault() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOE Date</td><td>:</td><td colspan='6' width='70%'>" + lstCargoDetail.Where(x => x.InvoiceId == item.InvoiceId).Select(x => x.BOEDate).FirstOrDefault() + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Importer</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Value</td><td>:</td><td colspan='6' width='70%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>CHA Name</td><td>:</td><td colspan='6' width='70%'>" + item.CHAName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>No Of Pkg</td><td>:</td><td colspan='6' width='70%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalSpaceOccupied.ToString("0.000") + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("</tr></tbody></table>");


                html.Append("</td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin-top: 0;'>Container / CBT Charges :</h3> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 150px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border:1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.00") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='text-align: center; width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border:1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 170px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='text-align: center; width: 24%;'></th>");
                html.Append("<th rowspan='2' style='text-align: center; width: 100px;'></th>");
                html.Append("<th rowspan='2' style='text-align: center; width: 80px;'></th>");
                html.Append("<th rowspan='2' style='text-align: center; width: 130px;'></th>");
                html.Append("<th colspan='2' style='text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='text-align: center; width: 200px;'></th>");
                html.Append("<th colspan='2' style='text-align: center; width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='text-align: center; width: 50px;'></th>");
                html.Append("<th style='text-align: center; width: 50px;'></th>");
                html.Append("<th style='text-align: center; width: 50px;'></th>");
                html.Append("<th style='text-align: center; width: 50px;'></th>");
                html.Append("<th style='text-align: center; width: 50px;'></th>");
                html.Append("<th style='text-align: center; width: 50px;'></th></tr>");

                html.Append("<tr>");
                html.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td cellpadding='5' style='font-size: 7pt; text-align: left; width: 50%; vertical-align: bottom;'>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> Punjab National Bank</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> 4737002100000318</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span> Balanagar & PUNB0473700</p>");
                html.Append("</td>");
                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0;'>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='border: 1px solid #333; border-top: 0; border-bottom: 0; border-right: 0; padding: 0 15px;'>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left;' colspan='8' width='75%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 7pt; text-align: left;' colspan='3' width='25%'>Payee Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left;' colspan='8' width='75%'>Payee Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left;' colspan='4' width='33.33333333333333%'><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;' colspan='4' width='33.33333333333333%'><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;' colspan='4' width='33.33333333333333%'><br/>For Central Warehousing Corporation<br/><br/><br/>(Authorized Signatories)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());

            });
            //if (All != "All")
            //{
            FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            //}
            //else
            //{
            //FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            //location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
            //if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
            //{
            //    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
            //}
            //}

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforReMovementCont(DataSet ds, string InvoiceModuleName, string All)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='3'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><span style='font-size:7pt;'>(A Govt. of India Undertaking)</span><br/><span style='font-size: 7pt;'>Container Freight Station,</span><br /><span style='font-size:7pt;'>" + objCompany[0].CompanyAddress + "</span><br/><span style='font-size: 7pt;'><b>Phone No:</b> " + objCompany[0].PhoneNo + " </span><br /><span style='font-size: 7pt;'><b>Email:</b> " + objCompany[0].EmailAddress + " </span><br/><label style='font-size: 7pt; font-weight:bold;'>RE-MOVEMENT</label></td>");
                //html.Append("<td valign='top'><img align='right' src='SWACHBHARAT' width='100'/></td></tr>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='3' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='3'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; text-align: center; margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + "</h2> </td></tr>");

                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='7' width='70%'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td colspan='3' width='30%'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td colspan='7' width='70%'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td colspan='3' width='30%'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td colspan='7' width='70%'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td colspan='3' width='30%'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td colspan='7' width='70%' style='border-bottom:1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td colspan='3' width='30%' style='border-bottom:1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Payee Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin: 0;'>Assessment No :</b> <span style='font-size:11px;'>" + item.StuffingReqNo + "</span></th></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin: 0;'>Container/Cargo Details :</b> </th></tr>");

                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size: 6pt; text-align: center;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Date of Arrival</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Date of Delivery</th>");
                html.Append("<th style='border-bottom: 1px solid #000;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 13px;margin-top: 20px;'>Container/Cargo Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 170px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td cellpadding='5' style='font-size: 7pt; text-align: left; width: 50%; vertical-align: bottom;'>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> Punjab National Bank</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> 4737002100000318</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span> Balanagar & PUNB0473700</p>");
                html.Append("</td>");
                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0; border-left: 1px solid #333;'>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='padding: 0 15px;'>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody><tr><td style='font-size: 7pt; text-align: left;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 7pt; text-align: left;' colspan='2'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left;'><br/><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("SWACHBHARAT", Server.MapPath("~/Content/Images/SwachhBharat-Logo.png"));
                lstSB.Add(html.ToString());
            });
            var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforEmptyContainer(DataSet ds, string InvoiceModuleName, string All)
        {
            var FileName = "";
            var location = "";
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstCargoDetail = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();
            //List<dynamic> lstReassesmentec = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[9]);
            // List<dynamic> lstReassesmentecbulk = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[9]);
            string Container = "";
            string cfscode = "";

            int flagfordate = 0;
            lstInvoice.ToList().ForEach(item =>
            {
                Container = "";
                flagfordate = 0;

                string dt = "";
                string dttype = "Date of Destuffing";
                //lstReassesmentec.ForEach(itemm =>
                //{
                //    if ((itemm.cfscode != "") && itemm.invoiceid == item.InvoiceId)
                //    {
                //        Container = "(Re-Assessment)";

                //        Dnd_ReportRepository repp = new Dnd_ReportRepository();
                //        dt = repp.GetPreviousInvDate(itemm.cfscode);
                //        dttype = "Previous Delivery Date";


                //    }

                //});


                //lstReassesmentecbulk.ForEach(data =>
                //{
                //    if (data.invoiceid == item.InvoiceId)
                //    {
                //        Container = "(Re-Assessment)";
                //        Dnd_ReportRepository repp = new Dnd_ReportRepository();
                //        dt = repp.GetPreviousInvDate(data.cfscode);
                //        dttype = "Previous Delivery Date";
                //        flagfordate = 1;

                //    }
                //});


                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td colspan='10' width='90%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 7pt;'>(A Govt. of India Undertaking) </label><br/><span style='font-size: 7pt;'>Container Freight Station,</span><br/>");
                html.Append("<span style='font-size: 7pt;'>" + objCompany[0].CompanyAddress + "</span><br/><span style='font-size: 7pt;'><b>Phone No:</b> " + objCompany[0].PhoneNo + " </span><br /><span style='font-size: 7pt;'><b>Email:</b> " + objCompany[0].EmailAddress + " </span>");
                html.Append("<br /><label style='font-size: 7pt; font-weight:bold;'>EMPTY CONTAINER PAYMENT SHEET</label>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='12' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='12'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size:13px; text-align:center; margin:0; padding:0;'>" + item.InvoiceType + " Invoice</h2> </td></tr>");

                html.Append("<tr><td>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");
                html.Append("<td colspan='5' width='50%' style='border-bottom:1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='30%'>Invoice No</th><th>:</th><td colspan='6' width='70%'>" + item.InvoiceNo + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Name</th><th>:</th><td colspan='6' width='70%'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party Address</th><th>:</th><td colspan='6' width='70%'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><th colspan='6' width='30%'>Party GST</th><th>:</th><td colspan='6' width='70%'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='40%' style='border-bottom:1px solid #000; padding-bottom:5px;'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Date</th><th>:</th><td colspan='6' width='50%'>" + item.InvoiceDate + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State</th><th>:</th><td colspan='6' width='50%'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>State Code</th><th>:</th><td colspan='6' width='50%'>" + item.PartyStateCode + "</td></tr>");
                html.Append("<tr><th colspan='6' width='50%'>Invoice Generated By</th><th>:</th><td colspan='6' width='50%'>" + item.PaymentMode + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                //html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                //html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                //html.Append("<span>" + item.PartyName + "</span></td>");
                //html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                //html.Append("Party Address :</label> <span>" + item.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                //html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                //html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                //html.Append("Party GST :</label> <span>" + item.PartyGSTNo + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                //html.Append("<label style='font-weight: bold;'>Invoice Generated By :</label> <span>" + item.PaymentMode + "</span></td></tr>");                
                //html.Append("</tbody> ");
                //html.Append("</table></td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt; margin: 0;'>Assessment No :" + item.StuffingReqNo + "</b> ");
                html.Append("<br /><b style='text-align: left; font-size: 7pt; margin: 0;'>Container Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:100%; font-size:6pt;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>ICD Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>Date of Arrival</th>");
                //  html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Date of Carting</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + dttype + "</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>Date of Delivery</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>No of Days</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>No of Week</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>Date of Seal Cutting</th>");
                html.Append("<th style='border-bottom: 1px solid #000; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    if (dt != "")
                    {
                        elem.DestuffingEntryDate = dt;
                    }
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + i.ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.CFSCode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.ArrivalDate + "</td>");
                    // html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + item.CartingDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.DestuffingEntryDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + item.DeliveryDate + "</td>");
                    if (flagfordate == 0)
                    {
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + ((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.DestuffingEntryDate)).TotalDays + 1).ToString() + "</td>");
                    }
                    if (flagfordate == 1)
                    {
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + ((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.DestuffingEntryDate)).TotalDays).ToString() + "</td>");
                    }
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + Math.Ceiling(((((Convert.ToDateTime(item.DeliveryDate) - Convert.ToDateTime(elem.DestuffingEntryDate)).TotalDays + 1)) / 7)).ToString() + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center;'>" + elem.SealCuttingDt.ToString() + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><td>");
                html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:7pt; border-right: 1px solid #000;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line</td><td>:</td><td colspan='6' width='70%'>" + item.ShippingLineName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line No.</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>OBL/HBL No.</td><td>:</td><td colspan='6' width='70%'>" + lstCargoDetail.Where(x => x.InvoiceId == item.InvoiceId).Select(x => x.OBLNo).FirstOrDefault() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Godown Name</td><td>:</td><td colspan='6' width='70%'>" + lstCargoDetail.Where(x => x.InvoiceId == item.InvoiceId).Select(x => x.GodownName).FirstOrDefault() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Item No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer.Where(x => x.InvoiceId == item.InvoiceId).Count().ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOE No.</td><td>:</td><td colspan='6' width='70%'>" + item.BOENo + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>BOE Date</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Importer</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Value</td><td>:</td><td colspan='6' width='70%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>CHA Name</td><td>:</td><td colspan='6' width='70%'>" + item.CHAName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>No Of Pkg</td><td>:</td><td colspan='6' width='70%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalSpaceOccupied.ToString("0.000") + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("</tr></tbody></table>");

                //html.Append("<table style=' border: 1px solid #000; width:100%;' cellspacing='0' cellpadding='5'>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='5'>Shipping Line : " + item.ShippingLineName + " </td></tr>");
                //html.Append("<tr><td style='font-size: 12px;'>Shipping Line No.:  </td>");
                //html.Append("<td style='font-size: 12px;'>OBL No : " + lstCargoDetail.Where(x => x.InvoiceId == item.InvoiceId).Select(x => x.OBLNo).FirstOrDefault() + " </td>");
                //html.Append("<td style='font-size: 12px;'>Item No. : " + lstContainer.Where(x => x.InoviceId == item.InvoiceId).Count().ToString() + "</td>");
                //html.Append("<td style='font-size: 12px;'>BOE No : " + item.BOENo + " </td>");
                //html.Append("<td style='font-size: 12px;'>BOE Date : " + item.BOEDate + " </td>");
                //html.Append("</tr>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='3'>Importer : " + item.ExporterImporterName + " </td>");
                //html.Append("<td style='font-size: 12px;' colspan='2'>VALUE : " + (lstContainer.Where(m => m.InoviceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InoviceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InoviceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InoviceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                //html.Append("<tr><td style='font-size: 12px;' colspan='3'>CHA Name : " + item.CHAName + " </td><td style='font-size: 12px;' colspan='2'>Godown No. : " + lstCargoDetail.Where(x => x.InvoiceId == item.InvoiceId).Select(x => x.GodownName).FirstOrDefault() + " </td></tr>");
                //html.Append("<tr><td style='font-size: 12px;'>No Of Pkg : " + item.TotalNoOfPackages.ToString() + " </td>");
                //html.Append("<td style='font-size: 12px;'>Total Gr.Wt (In Kg) : " + item.TotalGrossWt.ToString("0.000") + " </td>");
                //html.Append("<td style='font-size: 12px;'>Total Area (In Sqr Mtr) :" + item.TotalSpaceOccupied.ToString("0.000") + " </td>");
                //html.Append("<td></td>");
                //html.Append("<td></td>");
                //html.Append("</tr>");
                //html.Append("</table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt; margin: 0;'>Container Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 140px;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0.##") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.##") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>" + data.Total.ToString("0.##") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");


                html.Append("<table style='border: 1px solid #000; border-top: 0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.##") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.##") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.##") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 140px;'></th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0.##")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; margin-bottom:3px;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td cellpadding='5' style='font-size: 7pt; text-align: left; width: 50%; vertical-align: bottom;'>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span>" + objCompany[0].BankName + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span>" + objCompany[0].AccountNo + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span>" + objCompany[0].Branch + " & " + objCompany[0].IFSC + "</p>");
                html.Append("</td>");
                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0;'>");
                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='border: 1px solid #333; border-top: 0; border-bottom: 0; border-right: 0; padding: 0 15px;'>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 7pt; text-align: left; line-height: 30px;' colspan='4' width='20%'>Payee Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left; line-height: 30px;' colspan='8' width='80%'>Payee Name:<label style='font-weight: bold;'>" + item.PayeeName.ToString() + "</label></td></tr>");
                // html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;' colspan='4' width='20%'>SD Balance:<label style='font-weight: bold;'>" + objSDBalance.SDBalance.ToString() + "</label></td></tr>");

                //html.Append("<tr><td style='font-size: 12px; text-align: left; line-height: 30px;'colspan='2'></td>");
                //html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;' colspan='2'>SD Balance:<label style='font-weight: bold;'>" + objSDBalance.SDBalance.ToString() + "</label></td></tr>");

                html.Append("<tr><td style='font-size: 7pt; text-align: left;' colspan='3' width='25%'><br/><br/><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;' colspan='3' width='25%'><br/><br/><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;' colspan='3' width='25%'><br/><br/><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;' colspan='3' width='25%'><br/><br/><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 7pt; text-align: left;' colspan='12' width='100%'><br/><br/>THIS IS A COMPUTER-GENERATED TAX INVOICE AND IT DOES NOT REQUIRE A SIGNATURE</td>");
                html.Append("</tr>");
                html.Append("</tbody></table>");

                html.Append("</td></tr></tbody></table>");
                /***************/

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
                Container = "";
                dt = "";
            });
            if (All != "All")
            {
                FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
                }
            }
            else
            {
                FileName = InvoiceModuleName + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
                location = Server.MapPath("~/Docs/All/") + Session.SessionID + "/" + FileName;
                if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/All/") + Session.SessionID))
                {
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/All/") + Session.SessionID);
                }
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingBulkPDFforExportITP(DataSet ds, string InvoiceModuleName, string All)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<string> lstSB = new List<string>();
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                html.Append("<tr><td colspan='3'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1><span style='font-size:7pt;'>(A Govt. of India Undertaking)</span><br/><span style='font-size: 7pt;'>Container Freight Station,</span><br /><span style='font-size:7pt;'>" + objCompany[0].CompanyAddress + "</span><br/><span style='font-size: 7pt;'><b>Phone No:</b> " + objCompany[0].PhoneNo + " </span><br /><span style='font-size: 7pt;'><b>Email:</b> " + objCompany[0].EmailAddress + " </span><br/><label style='font-size: 7pt; font-weight:bold;'>ITP EXPORT PAYMENT SHEET</label></td>");
                //html.Append("<td valign='top'><img align='right' src='SWACHBHARAT' width='100'/></td></tr>");
                html.Append("</tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='3' style='text-align: right;'><span style='display: block; font-size: 7pt; text-transform: uppercase;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");

                html.Append("<tr><td colspan='3'><table style='border: 1px solid #000; width:100%;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 13px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>" + (item.InvoiceType == "Tax" ? "Tax Invoice" : "Bill Invoice") + "</h2> </td></tr>");

                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px; font-size: 7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td colspan='8' width='70%'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                html.Append("<td colspan='4' width='30%'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td colspan='8' width='70%' style='border-bottom:1px solid #000; padding-bottom: 5px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("<td colspan='4' width='30%' style='border-bottom:1px solid #000; padding-bottom: 5px;'><label style='font-weight: bold;'>Payee Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                html.Append("</tbody>");
                html.Append("</table></td></tr>");


                //html.Append("<tr><td><table style='width:100%;font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                //html.Append("<tr><td colspan='6' width='50%'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                //html.Append("<td colspan='6' width='50%'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                //html.Append("<tr><td colspan='6' width='50%'><label style='font-weight: bold;'>Party Name : </label><span>" + item.PartyName + "</span></td>");
                //html.Append("<td colspan='6' width='50%'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                //html.Append("<tr><td colspan='6' width='50%'><label style='font-weight: bold;'>Party Address :</label> <span>" + item.PartyAddress + "</span></td>");
                //html.Append("<td colspan='6' width='50%'><label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                //html.Append("<tr><td colspan='6' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                //html.Append("<td colspan='6' width='50%' style='border-bottom: 1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Payee Name :</label> <span>" + item.PayeeName + "</span></td></tr>");
                //html.Append("</tbody>");
                //html.Append("</table></td></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt;'>Assessment No :</b> <span style='font-size:7pt;'> " + item.StuffingReqNo + " </span></th></tr>");

                html.Append("<tr><th><b style='text-align: left; font-size: 7pt;'>Container/Cargo Details :</b> </th></tr>");

                html.Append("<tr><td><table style='border: 1px solid #000; border-bottom: 0; width:100%; font-size: 7pt; text-align: center;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Date of Arrival</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>Date of Delivery</th>");
                html.Append("<th style='border-bottom: 1px solid #000;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                /*************/
                /*Container Bind*/
                int i = 1;
                Decimal totamt = 0;
                lstContainer.Where(x => x.InvoiceId == item.InvoiceId).ToList().ForEach(elem =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + i + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ContainerNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.Size + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + elem.ArrivalDate + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000;'>" + item.DeliveryDate + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                    html.Append("</tr>");
                    i = i + 1;
                });
                /***************/
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><td>");
                html.Append("<table style='border:1px solid #000; width:100%;' cellspacing='0' cellpadding='0'><tbody><tr>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line</td><td>:</td><td colspan='6' width='70%'>" + item.ShippingLineName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Line No.</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>OBL No.</td><td>:</td><td colspan='6' width='70%'></td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>Item No.</td><td>:</td><td colspan='6' width='70%'>" + lstContainer.Where(x => x.InvoiceId == item.InvoiceId).Count().ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Bill / ITP OBL No.</td><td>:</td><td colspan='6' width='70%'>" + item.BOENo + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Shipping Bill / ITP OBL Date</td><td>:</td><td colspan='6' width='70%'>" + item.BOEDate + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table style='border-left: 1px solid #000; width:100%; font-size:7pt;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='6' width='30%'>Exporter</td><td>:</td><td colspan='6' width='70%'>" + item.ExporterImporterName + "</td></tr>");
                //html.Append("<tr><td colspan='6' width='30%'>FOB Value</td><td>:</td><td colspan='6' width='70%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + " + DUTY : " + (lstContainer.Where(z => z.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + " = " + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.CIFValue) + lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(z => (decimal)z.Duty)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>FOB Value</td><td>:</td><td colspan='6' width='70%'>" + (lstContainer.Where(m => m.InvoiceId == item.InvoiceId).Sum(m => (decimal)m.CIFValue)).ToString("0.00") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>CHA Name</td><td>:</td><td colspan='6' width='70%'>" + item.CHAName + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>No Of Pkg</td><td>:</td><td colspan='6' width='70%'>" + item.TotalNoOfPackages.ToString() + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Gr.Wt (In Kg)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalGrossWt.ToString("0.000") + "</td></tr>");
                html.Append("<tr><td colspan='6' width='30%'>Total Area (In Sqr Mtr)</td><td>:</td><td colspan='6' width='70%'>" + item.TotalSpaceOccupied.ToString("0.000") + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("</tr></tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><th><h3 style='text-align: left; font-size: 7pt;'>Container/Cargo Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                /*Charges Bind*/

                lstCharges.Where(y => y.InvoiceId == item.InvoiceId).ToList().ForEach(data =>
                {
                    if (data.Taxable > 0)
                    {

                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 24%;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 100px;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 130px;'>" + data.Taxable.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.CGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.SGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: center; width: 50px;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 50px;'>" + data.IGSTAmt.ToString("0.00") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 6pt; text-align: right; width: 150px;'>" + data.Total.ToString("0.00") + "</td></tr>");
                        i = i + 1;
                        totamt = totamt + data.Taxable;
                    }
                });
                html.Append("</tbody>");
                html.Append("</table></td></tr></tbody></table>");

                html.Append("<table style='border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 100px;'>Total :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 130px;'>" + totamt.ToString("0.00") + "</th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.AllTotal.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalCGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalSGST.ToString("0.00") + "</th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='font-size: 6pt; text-align: right; width: 50px;'>" + item.TotalIGST.ToString("0.00") + "</th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");
                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 150px;'>Round Up :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.RoundUp.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style=' border: 1px solid #000; border-top:0; width:100%;'cellspacing='0' cellpadding='5'> ");
                html.Append("<tbody>");

                html.Append("<tr><th rowspan='2' style='font-size: 6pt; text-align: left; width: 170px;'>Total Invoice :</th>");
                html.Append("<th rowspan='2' style='width: 24%;'></th>");
                html.Append("<th rowspan='2' style='width: 100px;'></th>");
                html.Append("<th rowspan='2' style='width: 80px;'></th>");
                html.Append("<th rowspan='2' style='width: 130px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th colspan='2' style='width: 200px;'></th>");
                html.Append("<th rowspan='2' style='font-size: 6pt; text-align: right; width: 100px;'>" + item.InvoiceAmt.ToString("0.00") + "</th></tr><tr>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th>");
                html.Append("<th style='width: 50px;'></th></tr>");


                html.Append("<tr>");
                html.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; font-size: 6pt; text-align: left; padding: 5px;' colspan='13'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 6pt; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #333; border-top:0; margin-bottom:3px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 7pt; text-align: left; width: 50%; vertical-align: top;'>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0;'>Company's Bank Details</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Bank Name:</span> " + objCompany[0].BankName + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>A/c No:</span> " + objCompany[0].AccountNo + "</p>");
                html.Append("<p style='display: block; font-size: 7pt; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px; font-weight: normal;'>Branch & IFS Code:</span>" + objCompany[0].Branch + " & " + objCompany[0].IFSC + "</p>");
                html.Append("</td>");

                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0; border-left: 1px solid #000;'>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0; font-weight: bold;'>for Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; font-size: 7pt; margin:0;'>Authorised Signatory</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");



                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody><tr><td style='font-size: 7pt; text-align: left;'colspan='2'>Receipt No.: <label style='font-weight: bold;'></label></td><");
                html.Append("td style='font-size: 7pt; text-align: left;' colspan='2'>Party Code:<label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td></tr>");
                html.Append("<tr><td style='font-size: 7pt; text-align: left;'><br/><br/>Signature CHA / Importer</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>Assistant <br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>SAM/AM Accounts<br/>(Signature)</td>");
                html.Append("<td style='font-size: 7pt; text-align: left;'><br/><br/>SAM/SIO <br/>(Signature)</td>");
                html.Append("</tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                /***************/
                html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                html.Replace("SWACHBHARAT", Server.MapPath("~/Content/Images/SwachhBharat-Logo.png"));
                lstSB.Add(html.ToString());
            });
            var FileName = "BulkReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 20f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        #endregion

        #region Daily Pda Activity Report
        [HttpGet]
        public ActionResult DailyPdaActivityReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetDailyPdaActivityReport(DailyPdaActivityReport ObjDailyPdaActivityReport, bool Active)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            List<DailyPdaActivityReport> LstDailyPdaActivityReport = new List<DailyPdaActivityReport>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.DailyPdaActivity(ObjDailyPdaActivityReport, Active);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstDailyPdaActivityReport = (List<DailyPdaActivityReport>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }
        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateDailyPdaActivityReportPDF(FormCollection fc)
        {
            try
            {

                string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                var Pages = new string[1];
                var FileName = "DailySdActivityReport.pdf";
                Pages[0] = fc["Page"].ToString();

                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/DailySdActivityReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/DailySdActivityReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }
        #endregion

        #region SD Summary
        [HttpGet]
        public ActionResult PDASummaryUtilizationReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetPdSummaryUtilizationReport(PdSummary ObjPdSummary, int drpType)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            List<PdSummary> LstPdSummary = new List<PdSummary>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.PdSummaryUtilizationReport(ObjPdSummary, drpType);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstPdSummary = (List<PdSummary>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GeneratePdSummaryUtilizationPDF(FormCollection fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "SdSummary.pdf";
                Pages[0] = fc["Page"].ToString();
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/SdSummary/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/SdSummary/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }
        #endregion

        #region SD A/c Statement

        [HttpGet]
        public ActionResult SDStatement()
        {
            var Months = new Dictionary<int, string>();
            for (Int16 i = 1; i <= 12; i++)
            {
                Months.Add(i, System.Globalization.DateTimeFormatInfo.InvariantInfo.MonthNames[i - 1]);
            }
            ViewBag.Months = new SelectList((IEnumerable)Months, "Key", "Value", DateTime.Today.Month);
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetSDStatement(SDStatement ObjSDStatement)
        {
            if (ModelState.IsValid)
            {
                Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
                ObjRR.GetPDAStatement(ObjSDStatement.Month, ObjSDStatement.Year);
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GeneratePDFForPDAStatement(FormCollection Fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "SDStatement.pdf";
                Pages[0] = Fc["Page"].ToString();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report/SDStatement/";
                Pages[0] = Pages[0].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                //using (var Rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f))
                //{
                //    Rh.GeneratePDF(LocalDirectory + FileName, Pages);
                //}
                return Json(new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/SDStatement/" + FileName });
            }
            catch
            {
                return Json(new { Status = 0, Message = "Error" });
            }
        }

        #endregion

        #region Party Wise SD Statement

        public ActionResult SDDetailsReport()
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetAllPartyForSDDet("", 0);
            if (ObjRR.DBResponse.Data != null)
            {
                var Jobj = Newtonsoft.Json.JsonConvert.SerializeObject(ObjRR.DBResponse.Data);
                var Jobject = Newtonsoft.Json.Linq.JObject.Parse(Jobj);
                ViewBag.LstParty = Jobject["LstParty"];
                ViewBag.State = Jobject["State"];
            }
            return PartialView();
        }


        [HttpGet]
        public JsonResult SearchParty(string PartyCode)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetAllPartyForSDDet(PartyCode, 0);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpGet]
        public JsonResult LoadParty(string PartyCode, int Page)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetAllPartyForSDDet(PartyCode, Page);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetSDDetReport(string FromDate, string ToDate, int PartyId)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();

            string Fdt = Convert.ToDateTime(FromDate).ToString("yyyy-MM-dd");
            string Tdt = Convert.ToDateTime(ToDate).ToString("yyyy-MM-dd");

            ObjRR.GetSDDetStatement(PartyId, Fdt, Tdt);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                PpgSDDetailsStatement SDData = new PpgSDDetailsStatement();
                SDData = (PpgSDDetailsStatement)ObjRR.DBResponse.Data;

                Path = GeneratePDFSDDetReport(SDData, FromDate, ToDate);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }


        [NonAction]
        public string GeneratePDFSDDetReport(PpgSDDetailsStatement SDData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "SdReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                //***************************************************************************************

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>CFS Dronagiri</span><br/><label style='font-size: 14px; font-weight:bold;'>SD STATEMENT</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append(" </td></tr>");
                Pages.Append("</thead>");

                Pages.Append(" <tbody>");
                Pages.Append("<tr><td colspan='12' style='font-size:12px;'><b>Party :</b>" + SDData.PartyName + "</td></tr>");
                Pages.Append(" <tr><td colspan='12' style='font-size:12px;'><b>Folio No :</b> " + SDData.PartyCode + "</td></tr>");
                Pages.Append("<tr><td colspan='12' style='font-size:12px;'><b>CWC GST No :</b> " + SDData.CompanyGst + "</td></tr>");
                Pages.Append("<tr><td colspan='12' style='font-size:12px;'><b>Party GST No :</b> " + SDData.PartyGst + "</td></tr>");
                Pages.Append("<tr><td colspan='12' style='font-size:12px;'><b>Period :</b> " + FromDate + " - " + ToDate + "</td></tr>");
                Pages.Append("</tbody></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; font-size:8pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>Sl. No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;text-align:center;'>Invoice No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>Invoice Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:11%;text-align:center;'>Receipt No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>Receipt Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>Pay Receipt</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>Transaction Type</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:12%;'>Transaction Amount</th></tr></thead>");
                Pages.Append("<tbody>");
                SDData.lstInvc.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:3%;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;text-align:center;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>" + item.InvoiceDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:11%;text-align:center;'>" + item.ReceiptNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>" + item.ReceiptDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:right;'>" + item.ReceiptAmt.ToString() + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;text-align:center;'>" + item.TranType + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;width:12%;text-align:right;'>" + item.TranAmt.ToString() + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });
                Pages.Append("<tr>");
                Pages.Append("<th colspan='7' style='border-right:1px solid #000;width:8%;text-align:right;'>Invoice Utilization Balance :</th>");
                Pages.Append("<th style='width:12%;text-align:right;'>" + SDData.UtilizationAmount + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse;font-size:9pt;'><tbody>");
                Pages.Append("<tr><td><span><br/><br/></span></td></tr>");
                Pages.Append("<tr><td colspan='12'><p><b>N.B :</b> This is a computer generated statement. Doesn't require any signature.</p></td></tr>");
                Pages.Append("</tbody></table>");

                //***************************************************************************************
                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region SD Summary Details Report
        [HttpGet]
        public ActionResult SDSumryDlyReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetSDSumryDly(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.SDSummary(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                List<Dnd_SDSummary> lstData = new List<Dnd_SDSummary>();
                lstData = (List<Dnd_SDSummary>)ObjRR.DBResponse.Data;
                Path = GeneratePDFSDSumryDly(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }


            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFSDSumryDly(List<Dnd_SDSummary> lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "SDSumryDlyReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>CFS Dronagiri</span><br/><span style='font-size:12px;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 14px; font-weight:bold;'>SD SUMMARY DAILY REPORT</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:6pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Invoice No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Invoice Type</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Party Name</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Payee Name</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Mode Of Payment(PDA)</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>GEN SPACE</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>STO</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>INS</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>GRE</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>GRL</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Others</th>");
                // Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>ENT CHRG</th>");
                // Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>FUM</th>");
                //  Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>OT CHRG</th>");
                // Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>MISC</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>BILL</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CGST</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>SGST</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>IGST</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Round Up</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:13%;'>TOTAL PDA</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>TDS</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>CR.TDS</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;text-align:right;'>Remarks</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Date + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InvoiceNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Module + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.EximTraderName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.PayeeName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.PaymentType + "</td>");
                    //Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GEN + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.STO + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.INS + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GRE + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GRL + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MFCHRG + "</td>");
                    // Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ENT + "</td>");
                    //  Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.FUM + "</td>");
                    //   Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.OT + "</td>");
                    //  Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MISC + "</td>");
                    //Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.BILL + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CGST + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.SGST + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.IGST + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.RoundUp + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Total + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.TDS + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CRTDS + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;width:10%'>" + item.Remarks + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });

                Pages.Append("<tr>");
                Pages.Append("<th colspan='7' style='border-right:1px solid #000;text-align:left;'>Total :</th>");
                //Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GEN + "</td>");
                Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.STO) + "</th>");
                //Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.INS + "</td>");
                Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.INS) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.GRE) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.GRL) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.MFCHRG) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.CGST) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.SGST) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.IGST) + "</th>");
                //Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.BILL + "</td>");
                Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.RoundUp) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.Total) + "</th>");
                // Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.TDS) + "</th>");
                // Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.CRTDS) + "</th>");
                //Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.Total) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => Convert.ToDecimal(x.TDS)) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;'>" + lstData.Sum(x => x.CRTDS) + "</th>");
                Pages.Append("<th></th>");
                Pages.Append("</tr>");


                //Pages.Append("<tr>");
                //Pages.Append("<th style='border-bottom:1px solid #000;width:5%;'></th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;width:20%;'></th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;width:5%;'></th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;width:9%;'></th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;width:9%;'></th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:15%; '></th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.STO) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.GRE) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.GRL) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.MFCHRG) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>" + lstData.Sum(x => x.ENT) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.FUM) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.OT) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.MISC) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.CGST) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.SGST) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.IGST) + "</th>");
                //Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.RoundUp) + "</td>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.Total) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>" + lstData.Sum(x => Convert.ToDecimal(x.TDS)) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>" + lstData.Sum(x => x.CRTDS) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'></th>");
                //Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Party Wise Invoice and Receipt Ledger
        public ActionResult CashReceiptInvoiceLedgerReport()
        {
            /*AccessRightsRepository ACCR = new AccessRightsRepository();
            ACCR.GetMenuWiseAccessRight(Convert.ToInt32(Session["MenuId"]), ((Login)Session["LoginUser"]).Role.RoleId, Convert.ToInt32(Session["ModuleId"]),
                Convert.ToInt32(Session["BranchId"]));
            ViewBag.RightsList = JsonConvert.SerializeObject(ACCR.DBResponse.Data);*/

            ImportRepository objImport = new ImportRepository();
            objImport.GetPaymentParty();
            if (objImport.DBResponse.Status > 0)
                ViewBag.PaymentParty = JsonConvert.SerializeObject(objImport.DBResponse.Data);
            else
                ViewBag.PaymentParty = null;


            return PartialView();
        }

        [HttpPost]
        public JsonResult GetCashReceiptInvoiceLedgerReport(int partyId, string fromdate, string todate)
        {
            try
            {
                Dnd_ReportRepository Repo = new Dnd_ReportRepository();
                Repo.GetCrInvLedgerReport(partyId, Convert.ToDateTime(fromdate).ToString("yyyy-MM-dd"), Convert.ToDateTime(todate).ToString("yyyy-MM-dd"), ZonalOffice, ZOAddress);
                object obj = Repo.DBResponse;
                return Json(obj, JsonRequestBehavior.AllowGet);
            }
            catch (Exception ex)
            {
                return Json(new { Status = 0, Data = "", Message = ex.Message.ToString() }, JsonRequestBehavior.AllowGet);
            }

        }
        #endregion

        #region Bill Cum SD Ledger
        public ActionResult BillCumSDLedger()
        {
            /*AccessRightsRepository ACCR = new AccessRightsRepository();
            ACCR.GetMenuWiseAccessRight(Convert.ToInt32(Session["MenuId"]), ((Login)Session["LoginUser"]).Role.RoleId, Convert.ToInt32(Session["ModuleId"]),
                Convert.ToInt32(Session["BranchId"]));
            ViewBag.RightsList = JsonConvert.SerializeObject(ACCR.DBResponse.Data);*/

            ImportRepository objImport = new ImportRepository();
            objImport.GetPaymentParty();
            if (objImport.DBResponse.Status > 0)
                ViewBag.PaymentParty = JsonConvert.SerializeObject(objImport.DBResponse.Data);
            else
                ViewBag.PaymentParty = null;

            return PartialView();
        }
        [HttpPost]
        public JsonResult GetBillCumSDLedgerReport(int partyId, string fromdate, string todate)
        {
            try
            {
                Dnd_ReportRepository Repo = new Dnd_ReportRepository();
                Repo.GetBillCumSDLedgerReport(partyId, Convert.ToDateTime(fromdate).ToString("yyyy-MM-dd"), Convert.ToDateTime(todate).ToString("yyyy-MM-dd"), ZonalOffice, ZOAddress);
                object obj = Repo.DBResponse;
                return Json(obj, JsonRequestBehavior.AllowGet);
            }
            catch (Exception ex)
            {
                return Json(new { Status = 0, Data = "", Message = ex.Message.ToString() }, JsonRequestBehavior.AllowGet);
            }

        }
        #endregion

        #region DailyCashBookReport
        [HttpGet]
        public ActionResult DailyCashBookReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetDailyCashBookReport(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            List<Dnd_DailyCashbook> LstDailyCashBook = new List<Dnd_DailyCashbook>();
            ObjRR.DailyCashBook(PeriodFrom, PeriodTo);
            if (ObjRR.DBResponse.Data != null)
            {
                LstDailyCashBook = (List<Dnd_DailyCashbook>)ObjRR.DBResponse.Data;
                LstDailyCashBook.Add(new Dnd_DailyCashbook()
                {
                    Sr = "Total",
                    ReceiptNo = "",
                    ReceiptDate = "",
                    PartyName = "",
                    ModeOfPay = "",
                    ENT = LstDailyCashBook.Sum(x => x.ENT),
                    GRE = LstDailyCashBook.Sum(x => x.GRE),
                    GRL = LstDailyCashBook.Sum(x => x.GRL),
                    Reefer = LstDailyCashBook.Sum(x => x.Reefer),
                    Monitoring = LstDailyCashBook.Sum(x => x.Monitoring),
                    STO = LstDailyCashBook.Sum(x => x.STO),
                    INS = LstDailyCashBook.Sum(x => x.INS),
                    WHT = LstDailyCashBook.Sum(x => x.WHT),
                    OTH = LstDailyCashBook.Sum(x => x.OTH),
                    HT = LstDailyCashBook.Sum(x => x.HT),
                    IGST = LstDailyCashBook.Sum(x => x.IGST),
                    CGST = LstDailyCashBook.Sum(x => x.CGST),
                    SGST = LstDailyCashBook.Sum(x => x.SGST),
                    RoundUp = LstDailyCashBook.Sum(x => x.RoundUp),
                    CHQNo = "",
                    TotalCASH = LstDailyCashBook.Sum(x => x.TotalCASH),
                    TotalCHQ = LstDailyCashBook.Sum(x => x.TotalCHQ),
                    Others = LstDailyCashBook.Sum(x => x.Others),
                    Remarks = ""
                });
                ObjRR.DBResponse.Data = LstDailyCashBook;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }
        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateDailyCashBookReportPDF(FormCollection fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "DailyCashBookReport.pdf";
                Pages[0] = fc["Page"].ToString().Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/DailyCashBookReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 20f, 20f, 20f, 20f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/DailyCashBookReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }
        #endregion

        #region Daily Transaction Report
        public ActionResult DailyTransactionReport()
        {

            GodownRepository ObjGR = new GodownRepository();
            ObjGR.GetAllGodown();
            List<CwcExim.Models.Godown> LstGodown = new List<CwcExim.Models.Godown>();
            if (ObjGR.DBResponse.Data != null)
            {
                LstGodown = (List<CwcExim.Models.Godown>)ObjGR.DBResponse.Data;
            }
            return PartialView(LstGodown);
        }

        [HttpPost]
        public JsonResult GetDailyTransactioReport(string DTRDate, string Module, string GodownName, int GodownId = 0)
        {
            if (GodownId > 0)
            {
                Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
                Login objLogin = (Login)Session["LoginUser"];
                string FilePath = "";
                string dt = Convert.ToDateTime(DTRDate).ToString("yyyy-MM-dd");

                if (Module == "Import")
                {
                    ObjRR.DTRForPrint(dt, GodownId);//, objLogin.Uid
                    if (ObjRR.DBResponse.Status == 1)
                    {
                        DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                        FilePath = GeneratingPDFforDTR(ds, Convert.ToDateTime(dt).ToString("dd-MMM-yy"));
                        return Json(new { Status = 1, Data = FilePath });
                    }
                    else
                        return Json(new { Status = -1, Data = "No Record Found." });
                }
                else
                {
                    ObjRR.DTRForExport(dt, GodownId);//, objLogin.Uid
                    if (ObjRR.DBResponse.Status == 1)
                    {
                        FilePath = GeneratingPDFForDTRExp((DndDTRExp)ObjRR.DBResponse.Data, Convert.ToDateTime(dt).ToString("dd-MMM-yy"), GodownName);
                        return Json(new { Status = 1, Data = FilePath });
                    }
                    else
                        return Json(new { Status = -1, Data = "No Record Found." });
                }
            }
            else
            {
                return Json(new { Status = -1, Data = "Select Godown" });
            }
        }

        [NonAction]
        public string GeneratingPDFforDTR(DataSet ds, string dt)
        {
            List<dynamic> lstCont = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstCargo = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();
            String Shed = "";
            lstCont.Select(x => new { Shed = x.Shed }).Distinct().ToList().ForEach(item =>
            {
                if (Shed == "")
                    Shed = item.Shed;
                else
                    Shed += "," + item.Shed;
            });

            var sumobl = lstCont.AsEnumerable()
                        .Sum(r => r.NoObl);

            var sumNoPkg = lstCont.AsEnumerable()
                        .Sum(r => r.NoPkg);

            var sumGrWt = lstCont.AsEnumerable()
                        .Sum(r => (decimal)r.GrWt);

            var sumNoBoe = lstCont.AsEnumerable()
                        .Sum(r => r.NoBoe);

            var sumArea = lstCont.AsEnumerable()
                        .Sum(r => (decimal)r.Area);


            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

            html.Append("<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>CFS Dronagiri</label><br/><label style='font-size: 12px;'>For Workslip</label><br/><label style='font-size: 14px; font-weight:bold;'>Daily Transaction Report</label></td></tr>");

            html.Append("<tr><td><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12' style='font-size:13px;'><b>SHED :<span>&nbsp;</span></b>" + Shed + "</td></tr>");
            html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin:0;'><tbody>");
            html.Append("<tr><th style='font-size:13px; text-align:left;' width='30%'>Daily Transaction Report (Import Unit) as on date :</th><td style='font-size:12px;' width='57%'>" + dt + "</td>");
            html.Append("<th style='font-size:13px; text-align:right;'>Date : <span>&nbsp;</span></th><td style='font-size:12px;'>" + dt + "</td></tr></tbody></table></td></tr>");

            //html.Append("<tr><td colspan='12' style='font-size:13px;'><b>Daily Transaction Report (Import Unit) as on date :</b> " + dt + "</td></tr>");

            html.Append("<tr><td><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12' style='font-size:13px;'>DESTUFFING OF CONTAINERS :</td></tr>");

            html.Append("<tr><td colspan='12'><table style='border:1px solid #000;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            html.Append("<thead><tr>");
            html.Append("<th style='text-align:left;padding:10px;border-bottom:1px solid #000;width:3%;'>SL No</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:12%;'>Container No.</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:5%;'>Ct Sz</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:12%;'>ICD Code</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>In Date</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Sla Cd</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Origin</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>No Ob</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>No Pkg</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Gr Wt</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>No Boe</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:11%;'>Shed</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Area</th>");
            html.Append("<th style='text-align:center;padding:10px;border-bottom:1px solid #000;width:10%;'>Seal Cut.Date</th>");
            html.Append("</tr></thead>");
            html.Append("<tbody>");

            lstCont.ForEach(item =>
            {
                html.Append("<tr>");
                html.Append("<td style='text-align:left;padding:10px;width:3%;'>" + item.SlNo + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:12%;'>" + item.ContainerNo + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:5%;'>" + item.Size + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:12%;'>" + item.CFSCode + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.InDate + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.SlaCd + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.Origin + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.NoObl + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.NoPkg + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.GrWt + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.NoBoe + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:11%;'>" + item.Shed + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.Area + "</td>");
                html.Append("<td style='text-align:center;padding:10px;width:10%;'>" + item.SealCuttingDate + "</td>");
                html.Append("</tr>");
            });
            html.Append("<tr><th colspan='7' style='border-top:1px solid #000;text-align:left;padding:10px;'>Total :-</th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;width:10%;'>" + sumobl + "</th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;width:10%;'>" + sumNoPkg + "</th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;width:10%;'>" + sumGrWt + "</th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;width:10%;'>" + sumNoBoe + "</th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;'></th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;width:10%;'>" + sumArea + "</th>");
            html.Append("<th style='border-top:1px solid #000;text-align:center;padding:10px;'></th></tr>");
            html.Append("</tbody>");
            html.Append("</table></td></tr>");

            html.Append("<tr><td><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12' style='font-size:13px;'>CARGO DELIVERED FROM THE GODOWN :</td></tr>");

            html.Append("<tr><td colspan='12'><table style='border:1px solid #000;border-bottom:none;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            html.Append("<thead><tr>");
            html.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>No of Boe</th>");
            html.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>No of Pkg</th>");
            html.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Gr Weight</th>");
            html.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Area</th>");
            html.Append("</tr></thead>");
            html.Append("<tbody><tr>");

            int cargoNoBoe = 0;
            int cargoNoPkg = 0;
            decimal cargoGrWt = 0;
            decimal cargoArea = 0;
            lstCargo.ForEach(item =>
            {
                cargoNoBoe = item.NoBoe;
                cargoNoPkg = item.NoPkg;
                cargoGrWt = item.GrWt;
                cargoArea = item.Area;
                html.Append("<td style='text-align:left;padding:10px;border-right:1px solid #000;'>" + item.NoBoe + "</td>");
                html.Append("<td style='text-align:center;padding:10px;border-right:1px solid #000;'>" + item.NoPkg + "</td>");
                html.Append("<td style='text-align:center;padding:10px;border-right:1px solid #000;'>" + item.GrWt + "</td>");
                html.Append("<td style='text-align:center;padding:10px;'>" + item.Area + "</td>");

            });
            html.Append("</tr></tbody>");
            html.Append("</table></td></tr>");

            html.Append("<tr><td><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12' style='font-size:13px;'>SUMMARY</td></tr>");

            html.Append("<tr><td colspan='12'>");
            html.Append("<table style='border:1px solid #000;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");

            html.Append("<td colspan='3' width='25%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            html.Append("<thead><tr><th colspan='12' width='100%' style='font-size:14px;text-align:center;border-bottom:1px solid #000;padding:10px;'>OPENING BALANCE</th></tr>");
            html.Append("<tr><td colspan='12' style='padding:0;border-bottom:1px solid #000;'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Obl</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>No Pkg</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Weight</th>");
            html.Append("<th width='10%' style='text-align:center;padding:10px;'>Area</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></thead>");
            html.Append("<tbody><tr><td colspan='12'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
            html.Append("<td width='10%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'></td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></tbody>");
            html.Append("</table></td>");

            html.Append("<td colspan='3' width='25%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            html.Append("<thead><tr><th colspan='12' width='100%' style='font-size:14px;text-align:center;border-bottom:1px solid #000;padding:10px;'>RECEIPT</th></tr>");
            html.Append("<tr><td colspan='12' style='padding:0;border-bottom:1px solid #000;'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Obl</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>No Pkg</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Weight</th>");
            html.Append("<th width='10%' style='text-align:center;padding:10px;'>Area</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></thead>");
            html.Append("<tbody><tr><td colspan='12'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + sumobl + "</td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + sumNoPkg + "</td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + sumGrWt + "</td>");
            html.Append("<td width='10%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'>" + sumArea + "</td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></tbody>");
            html.Append("</table></td>");

            html.Append("<td colspan='3' width='25%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            html.Append("<thead><tr><th colspan='12' width='100%' style='font-size:14px;text-align:center;border-bottom:1px solid #000;padding:10px;'>ISSUE</th></tr>");
            html.Append("<tr><td colspan='12' style='padding:0;border-bottom:1px solid #000;'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Obl</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>No Pkg</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Weight</th>");
            html.Append("<th width='10%' style='text-align:center;padding:10px;'>Area</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></thead>");
            html.Append("<tbody><tr><td colspan='12'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + cargoNoBoe + "</td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + cargoNoPkg + "</td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + cargoGrWt + "</td>");
            html.Append("<td width='10%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'>" + cargoArea + "</td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></tbody>");
            html.Append("</table></td>");

            html.Append("<td colspan='3' width='25%' valign='top' style='padding:0;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            html.Append("<thead><tr><th colspan='12' width='100%' style='font-size:14px;text-align:center;border-bottom:1px solid #000;padding:10px;'>CLOSING BALANCE</th></tr>");
            html.Append("<tr><td colspan='12' style='padding:0;border-bottom:1px solid #000;'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Obl</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>No Pkg</th> ");
            html.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Weight</th>");
            html.Append("<th width='10%' style='text-align:center;padding:10px;'>Area</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></thead>");
            html.Append("<tbody><tr><td colspan='12'>");
            html.Append("<table cellspacing='0' style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
            html.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
            html.Append("<td width='10%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'></td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr></tbody>");
            html.Append("</table></td>");

            html.Append("</tr></tbody></table>");
            html.Append("</td></tr>");

            html.Append("<tr><td><br/><br/><br/><br/><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
            html.Append("<tr><th colspan='3' width='25%' style='text-align:center;padding:10px;'>WA/JS/TA</th> ");
            html.Append("<th colspan='1' width='8.333333333333333%'></th>");
            html.Append("<th colspan='3' width='25%' style='text-align:center;padding:10px;'>SIO/SUPTD</th>");
            html.Append("<th colspan='1' width='8.333333333333333%'></th>");
            html.Append("<th colspan='3' width='25%' style='text-align:center;padding:10px;'>SAM(IMPORT)</th></tr>");
            html.Append("</tbody></table></td></tr>");

            html.Append("</tbody></table>");
            lstSB.Add(html.ToString());

            var FileName = "DTR" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4Landscape, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }

        [NonAction]
        public string GeneratingPDFForDTRExp(DndDTRExp obj, string dt, string GodownName)
        {
            StringBuilder sb = new StringBuilder();

            sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
            sb.Append("<tr><td colspan='12'>");
            sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
            sb.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
            sb.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>CFS Dronagiri</span><br/><label style='font-size: 14px; font-weight:bold;'>STOCK REGISTER CUM DAILY TRANSACTION REPORT</label></td></tr>");
            sb.Append("</tbody></table>");
            sb.Append("</td></tr>");
            sb.Append("<tr><td colspan='12'><br/><br/></td></tr>");
            sb.Append("<tr><td colspan='12'>");
            sb.Append("<table cellspacing='0' cellpadding='0' style='font-size:12px; width:100%;'><tbody>");
            sb.Append("<tr><td colspan='4' width='33.33333333333333%'><b>Shed No :</b> " + GodownName + " </td>  <td colspan='4' width='33.33333333333333%' style='text-align:center;'><b>DATE :</b> " + dt + " </td>  <td colspan='4' width='33.33333333333333%' style='text-align:right;'><b>PRINTED ON :</b> " + DateTime.Now.ToString("dd/MM/yyyy HH:mm") + " </td></tr>");
            sb.Append("</tbody></table>");
            sb.Append("</td></tr>");
            sb.Append("<tr><td colspan='12'><br/></td></tr>");
            sb.Append("</thead></table>");

            sb.Append("<table cellspacing='0' cellpadding='0' style='font-size:8pt; border:1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif;'><tbody>");
            //LOOP Start//Carting Details
            /*
            obj.lstCartingDetails.Select(a => new { ShippingLineId = a.ShippingLineId, ShippingLineName = a.ShippingLineName, SLA = a.SLA }).Distinct().ToList().ForEach(item =>
            {
                sb.Append("<tr><td colspan='12'>");
                sb.Append("<table cellspacing='0' cellpadding='10' style='font-size:8pt; width:100%;'><tbody>");
                sb.Append("<tr><th width='8%'>Sla</th><th width='8%'>" + item.SLA + "</th><th colspan='10'>" + item.ShippingLineName + "</th></tr>");

                sb.Append("<tr><th width='8%' style='border-bottom: 1px solid #000;'>Entry No</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Sb No</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Sb Date</th>");
                sb.Append("<th width='11%' style='border-bottom: 1px solid #000;'>Exporter</th>");
                sb.Append("<th width='11%' style='border-bottom: 1px solid #000;'>Cargo</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>No PKG</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Gr Wt</th>");
                sb.Append("<th width='11%' style='border-bottom: 1px solid #000;'>Fob</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Slot</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>G/R</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Area</th>");
                sb.Append("<th width='10%' style='border-bottom: 1px solid #000;'>Remarks</th></tr>");

                //LOOP Start//
                obj.lstCartingDetails.Where(m => m.ShippingLineId == item.ShippingLineId).ToList().ForEach(elem =>
                {
                    sb.Append("<tr><td width='8%' style='border-bottom: 1px solid #000;'>" + elem.CFSCode + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ShippingBillNo + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ShippingBillDate + "</td>");
                    sb.Append("<td width='11%' style='border-bottom: 1px solid #000;'>" + elem.ExporterName + "</td>");
                    sb.Append("<td width='11%' style='border-bottom: 1px solid #000;'>" + elem.CargoDescription + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ActualQty + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ActualWeight + "</td>");
                    sb.Append("<td width='11%' style='border-bottom: 1px solid #000;'>" + elem.FobValue + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.Slot + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.GR + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.Area + "</td>");
                    sb.Append("<td width='10%' style='border-bottom: 1px solid #000;'>" + elem.Remarks + "</td></tr>");
                });
                //LOOP End//

                sb.Append("<tr><th width='8%' valign='bottom'>Sub Total :</th>");
                sb.Append("<td width='8%' valign='bottom'></td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='11%'></td>");
                sb.Append("<td width='11%'></td>");
                sb.Append("<td width='8%' valign='bottom'>" + obj.lstCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Sum(y => y.ActualQty) + "</td>");
                sb.Append("<td width='8%' valign='bottom'>" + obj.lstCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Sum(y => y.ActualWeight) + "</td>");
                sb.Append("<td width='11%' valign='bottom'>" + obj.lstCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Sum(y => y.FobValue) + "</td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='10%'></td></tr>");

                sb.Append("<tr><th width='8%' style='border-bottom: 1px solid #000;'>Sub Count :</th>");
                sb.Append("<td colspan='11' style='border-bottom: 1px solid #000;'>" + obj.lstCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Count() + "</td></tr>");

                sb.Append("</tbody></table>");
                sb.Append("</td></tr>");
            });*/
            //LOOP End//

            //LOOP Start//Short Cargo Details
            obj.lstShortCartingDetails.Select(a => new { ShippingLineId = a.ShippingLineId, ShippingLineName = a.ShippingLineName, SLA = a.SLA }).Distinct().ToList().ForEach(item =>
            {
                sb.Append("<tr><td colspan='12'>");
                sb.Append("<table cellspacing='0' cellpadding='10' style='font-size:8pt; width:100%;'><tbody>");
                sb.Append("<tr><th width='8%'>Sla</th><th width='8%'>" + item.SLA + "</th><th colspan='10'>" + item.ShippingLineName + "</th></tr>");

                sb.Append("<tr><th width='8%' style='border-bottom: 1px solid #000;'>Entry No</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Sb No</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Sb Date</th>");
                sb.Append("<th width='11%' style='border-bottom: 1px solid #000;'>Exporter</th>");
                sb.Append("<th width='11%' style='border-bottom: 1px solid #000;'>Cargo</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>No PKG</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Gr Wt</th>");
                sb.Append("<th width='11%' style='border-bottom: 1px solid #000;'>Fob</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Slot</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>G/R</th>");
                sb.Append("<th width='8%' style='border-bottom: 1px solid #000;'>Area</th>");
                sb.Append("<th width='10%' style='border-bottom: 1px solid #000;'>Remarks</th></tr>");

                //LOOP Start//
                obj.lstShortCartingDetails.Where(m => m.ShippingLineId == item.ShippingLineId).ToList().ForEach(elem =>
                {
                    sb.Append("<tr><td width='8%' style='border-bottom: 1px solid #000;'>" + elem.CFSCode + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ShippingBillNo + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ShippingBillDate + "</td>");
                    sb.Append("<td width='11%' style='border-bottom: 1px solid #000;'>" + elem.ExporterName + "</td>");
                    sb.Append("<td width='11%' style='border-bottom: 1px solid #000;'>" + elem.CargoDescription + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ActualQty + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.ActualWeight + "</td>");
                    sb.Append("<td width='11%' style='border-bottom: 1px solid #000;'>" + elem.FobValue + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.Slot + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.GR + "</td>");
                    sb.Append("<td width='8%' style='border-bottom: 1px solid #000;'>" + elem.Area + "</td>");
                    sb.Append("<td width='10%' style='border-bottom: 1px solid #000;'>" + elem.Remarks + "</td></tr>");
                });
                //LOOP End//

                sb.Append("<tr><th width='8%' valign='bottom'>Sub Total :</th>");
                sb.Append("<td width='8%' valign='bottom'></td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='11%'></td>");
                sb.Append("<td width='11%'></td>");
                sb.Append("<td width='8%' valign='bottom'>" + obj.lstShortCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Sum(y => y.ActualQty) + "</td>");
                sb.Append("<td width='8%' valign='bottom'>" + obj.lstShortCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Sum(y => y.ActualWeight) + "</td>");
                sb.Append("<td width='11%' valign='bottom'>" + obj.lstShortCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Sum(y => y.FobValue) + "</td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='8%'></td>");
                sb.Append("<td width='10%'></td></tr>");

                sb.Append("<tr><th width='8%' style='border-bottom: 1px solid #000;'>Sub Count :</th>");
                sb.Append("<td colspan='11' style='border-bottom: 1px solid #000;'>" + obj.lstShortCartingDetails.Where(x => x.ShippingLineId == item.ShippingLineId).Count() + "</td></tr>");

                sb.Append("</tbody></table>");
                sb.Append("</td></tr>");
            });
            //LOOP End//

            sb.Append("<tr cellpadding='10'><th width='8%' valign='bottom' style='font-size:9pt;'>Grand :</th>");
            sb.Append("<th width='8%' valign='bottom' style='font-size:9pt;'>" + obj.lstCartingDetails.Count() + "</th>");
            sb.Append("<th width='8%'></th>");
            sb.Append("<th width='11%'></th>");
            sb.Append("<th width='11%'></th>");
            sb.Append("<th width='8%' valign='bottom' style='font-size:9pt;'>" + (/*obj.lstCartingDetails.Sum(m => m.ActualQty) +*/ obj.lstShortCartingDetails.Sum(x => x.ActualQty)) + "</th>");
            sb.Append("<th width='8%' valign='bottom' style='font-size:9pt;'>" + (/*obj.lstCartingDetails.Sum(m => m.ActualWeight) +*/ obj.lstShortCartingDetails.Sum(x => x.ActualWeight)) + "</th>");
            sb.Append("<th width='11%' valign='bottom' style='font-size:9pt;'>" + (/*obj.lstCartingDetails.Sum(m => m.FobValue) +*/ obj.lstShortCartingDetails.Sum(x => x.FobValue)) + "</th>");
            sb.Append("<th width='8%'></th>");
            sb.Append("<th width='8%'></th>");
            sb.Append("<th width='8%'></th>");
            sb.Append("<th width='10%'></th></tr>");
            sb.Append("</tbody></table>");

            //CARGO SHIFTING DETAIL//
            sb.Append("<table cellspacing='0' cellpadding='10' style='margin-top:20px; font-size:8pt; border:1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif;'><tbody>");
            sb.Append("<tr><th colspan='15' style='text-align:center; font-size:10pt;'>CARGO SHIFTING DETAIL</th></tr>");
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Entry No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Sb No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Sb Date</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Exporter</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Cargo</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>No PKG</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Gr Wt</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Fob</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Slot</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>G/R</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Area</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>F-Shed</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>T-Shed</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>F-Sla</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000;'>T-Sla</th></tr>");
            //LOOP Start//
            obj.lstCargoShifting.ToList().ForEach(item =>
            {
                sb.Append("<tr><td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CFSCode + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillNo + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillDate + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ExporterName + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CargoDescription + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ActualQty + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ActualWeight + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.FobValue + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000;border-right: 1px solid #000;'>" + item.LocationName + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.GR + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.SQM + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.FromGodown + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ToGodown + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.FromShippingLine + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000;'>" + item.ToShippingLine + "</td></tr>");
            });
            //LOOP End//
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Total :</th>");
            sb.Append("<th colspan='4' width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstCargoShifting.Count() + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstCargoShifting.Sum(y => y.ActualQty) + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstCargoShifting.Sum(y => y.ActualWeight) + "</th>");
            sb.Append("<th colspan='8' width='11%' style='border-top: 1px solid #000;'>" + obj.lstCargoShifting.Sum(y => y.FobValue) + "</th></tr>");
            sb.Append("</tbody></table>");


            //CARGO ACCEPTING DETAIL//
            sb.Append("<table cellspacing='0' cellpadding='10' style='margin-top:20px; font-size:8pt; border:1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif;'><tbody>");
            sb.Append("<tr><th colspan='15' style='text-align:center; font-size:10pt;'>CARGO ACCEPTING DETAIL</th></tr>");
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Entry No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Sb No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Sb Date</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Exporter</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Cargo</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>No PKG</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Gr Wt</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Fob</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Slot</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>G/R</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Area</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>F-Shed</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>T-Shed</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>F-Sla</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000;'>T-Sla</th></tr>");
            //LOOP Start//
            obj.lstCargoAccepting.ToList().ForEach(item =>
            {
                sb.Append("<tr><td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CFSCode + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillNo + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillDate + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ExporterName + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CargoDescription + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ActualQty + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ActualWeight + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.FobValue + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.LocationName + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.GR + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.SQM + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.FromGodown + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ToGodown + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.FromShippingLine + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000;'>" + item.ToShippingLine + "</td></tr>");
            });
            //LOOP End//
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Total :</th>");
            sb.Append("<th colspan='4' width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstCargoAccepting.Count() + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstCargoAccepting.Sum(y => y.ActualQty) + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstCargoAccepting.Sum(y => y.ActualWeight) + "</th>");
            sb.Append("<th colspan='8' width='11%' style='border-top: 1px solid #000;'>" + obj.lstCargoAccepting.Sum(y => y.FobValue) + "</th></tr>");
            sb.Append("</tbody></table>");


            //BACK TO TOWN DETAIL//
            sb.Append("<table cellspacing='0' cellpadding='10' style='margin-top:20px; font-size:8pt; border:1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif;'><tbody>");
            sb.Append("<tr><th colspan='11' style='text-align:center; font-size:10pt;'>BACK TO TOWN DETAIL</th></tr>");
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Entry No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Sb No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Sb Date</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Exporter</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Cargo</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>No PKG</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Gr Wt</th>");
            sb.Append("<th width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Fob</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Slot</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>G/R</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000;'>Area</th></tr>");
            //LOOP Start//
            obj.lstBTTDetails.ToList().ForEach(item =>
            {
                sb.Append("<tr><td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CFSCode + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillNo + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillDate + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ExporterName + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CargoDescription + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.BTTQuantity + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.BTTWeight + "</td>");
                sb.Append("<td width='11%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.Fob + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.LocationName + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.GR + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000;'>Dynamic</td></tr>");
            });
            //LOOP End//
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Total :</th>");
            sb.Append("<th width='8%' colspan='4' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstBTTDetails.Count() + "</th>");
            sb.Append("<th  width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstBTTDetails.Sum(a => a.BTTQuantity) + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstBTTDetails.Sum(a => a.BTTWeight) + "</th>");
            sb.Append("<th width='8%' colspan='4' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstBTTDetails.Sum(a => a.Fob) + "</th></tr>");
            //sb.Append("<th colspan='4' width='11%' style='border-top: 1px solid #000;'>Dynamic</th>");
            sb.Append("</tbody></table>");


            //STUFFING DETAIL//
            sb.Append("<table cellspacing='0' cellpadding='10' style='margin-top:20px; font-size:8pt; border:1px solid #000; width:100%; font-family: Arial, Helvetica, sans-serif;'><tbody>");
            sb.Append("<tr><th colspan='11' style='text-align:center; font-size:10pt;'>STUFFING DETAIL</th></tr>");
            sb.Append("<tr><th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>S.R. No</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>S.R. Date</th>");
            sb.Append("<th width='9%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>ICD Code</th>");
            sb.Append("<th width='9%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Container No</th>");
            sb.Append("<th width='5%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Size</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>SLA</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>In Date</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>No SB</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>No of Unit</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Gr Wt</th>");
            sb.Append("<th width='12%' style='border-top: 1px solid #000;'>FOB</th></tr>");
            //LOOP Start//
            obj.lstStuffingDetails.ToList().ForEach(item =>
            {
                sb.Append("<tr><td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.StuffingNo + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.StuffingDate + "</td>");
                sb.Append("<td width='9%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.CFSCode + "</td>");
                sb.Append("<td width='9%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ContainerNo + "</td>");
                sb.Append("<td width='5%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.Size + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.SLA + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.EntryDateTime + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.ShippingBillNo + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.StuffQuantity + "</td>");
                sb.Append("<td width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + item.StuffWeight + "</td>");
                sb.Append("<td width='12%' style='border-top: 1px solid #000;'>" + item.Fob + "</td></tr>");
            });

            //LOOP End//
            sb.Append("<tr><th colspan='7' width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>Total :</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstStuffingDetails.Sum(z => z.ShippingBillNo) + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstStuffingDetails.Sum(z => z.StuffQuantity) + "</th>");
            sb.Append("<th width='8%' style='border-top: 1px solid #000; border-right: 1px solid #000;'>" + obj.lstStuffingDetails.Sum(z => z.StuffWeight) + "</th>");
            sb.Append("<th width='12%' style='border-top: 1px solid #000;'>" + obj.lstStuffingDetails.Sum(z => z.Fob) + "</th></tr>");
            sb.Append("</tbody></table>");


            sb.Append("<table cellspacing='0' cellpadding='10' style='margin-top:20px; font-size:8pt;width:100%;'><tbody><tr>");
            sb.Append("<td colspan='6' width='60%' valign='top'>");
            sb.Append("<table cellspacing='0' cellpadding='10' style='font-size:8pt; width:100%;'><tbody>");
            sb.Append("<tr><th colspan='5' style='text-align:center; font-size:10pt;'>SUMMARY</th></tr>");
            sb.Append("<tr><th width='10%' style='border: 1px solid #000; border-right: 0;'>DESC</th>");
            sb.Append("<th width='8%' style='border: 1px solid #000;'>SBS</th>");
            sb.Append("<th width='9%' style='border: 1px solid #000; border-left: 0;'>PKGS</th>");
            sb.Append("<th width='9%' style='border: 1px solid #000; border-left: 0;'>WT</th>");
            sb.Append("<th width='12%' style='border: 1px solid #000; border-left: 0;'>FOB</th></tr>");
            //LOOP Start//
            sb.Append("<tr><td width='10%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>CARGO CARTED</td>");
            sb.Append("<td width='8%' style='border: 1px solid #000; border-top: 0;'>" + obj.lstCartingDetails.Count() + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + (/*obj.lstCartingDetails.Sum(x => x.ActualQty) +*/ obj.lstShortCartingDetails.Sum(x => x.ActualQty)) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + (/*obj.lstCartingDetails.Sum(x => x.ActualWeight) +*/ obj.lstShortCartingDetails.Sum(x => x.ActualWeight)) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + (/*obj.lstCartingDetails.Sum(x => x.FobValue) +*/ obj.lstShortCartingDetails.Sum(x => x.FobValue)) + "</td></tr>");

            sb.Append("<tr><td width='10%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>CARGO SHIFTED</td>");
            sb.Append("<td width='8%' style='border: 1px solid #000; border-top: 0;'>" + obj.lstCargoShifting.Count() + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstCargoShifting.Sum(x => x.ActualQty) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstCargoShifting.Sum(x => x.ActualWeight) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstCargoShifting.Sum(x => x.FobValue) + "</td></tr>");

            sb.Append("<tr><td width='10%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>CARGO ACCEPTED</td>");
            sb.Append("<td width='8%' style='border: 1px solid #000; border-top: 0;'>" + obj.lstCargoAccepting.Count() + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstCargoAccepting.Sum(x => x.ActualQty) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstCargoAccepting.Sum(x => x.ActualWeight) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstCargoAccepting.Sum(x => x.FobValue) + "</td></tr>");

            sb.Append("<tr><td width='10%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>CARGO BTT</td>");
            sb.Append("<td width='8%' style='border: 1px solid #000; border-top: 0;'>" + obj.lstBTTDetails.Count() + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstBTTDetails.Sum(x => x.BTTQuantity) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstBTTDetails.Sum(x => x.BTTWeight) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstBTTDetails.Sum(x => x.BTTQuantity) + "</td></tr>");

            sb.Append("<tr><td width='10%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>CARGO STUFFED</td>");
            sb.Append("<td width='8%' style='border: 1px solid #000; border-top: 0;'>" + obj.lstStuffingDetails.Sum(x => x.ShippingBillNo) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstStuffingDetails.Sum(x => x.StuffQuantity) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstStuffingDetails.Sum(x => x.StuffWeight) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.lstStuffingDetails.Sum(x => x.Fob) + "</td></tr>");
            //LOOP End//
            sb.Append("</tbody></table>");
            sb.Append("</td>");

            sb.Append("<td colspan='6' width='40%'>");
            sb.Append("<table cellspacing='0' cellpadding='10' style='font-size:8pt; width:100%;'><tbody>");
            sb.Append("<tr><th colspan='4' style='text-align:center; font-size:10pt;'>OPENING BALANCE</th></tr>");
            sb.Append("<tr><th width='8%' style='border: 1px solid #000;border-right: 0;'>SBS</th>");
            sb.Append("<th width='9%' style='border: 1px solid #000;'>PKGS</th>");
            sb.Append("<th width='9%' style='border: 1px solid #000; border-left: 0;'>WT</th>");
            sb.Append("<th width='12%' style='border: 1px solid #000; border-left: 0;'>FOB</th></tr>");
            //LOOP Start//
            sb.Append("<tr><td width='8%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>" + obj.StockOpening.Count() + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-top: 0;'>" + obj.StockOpening.Sum(x => x.Units) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.StockOpening.Sum(x => x.Weight) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.StockOpening.Sum(x => x.Fob) + "</td></tr>");
            //LOOP End//

            sb.Append("<tr><th colspan='4' style='text-align:center; font-size:10pt;'>CLOSING BALANCE</th></tr>");
            sb.Append("<tr><th width='8%' style='border: 1px solid #000;border-right: 0;'>SBS</th>");
            sb.Append("<th width='9%' style='border: 1px solid #000;'>PKGS</th>");
            sb.Append("<th width='9%' style='border: 1px solid #000; border-left: 0;'>WT</th>");
            sb.Append("<th width='12%' style='border: 1px solid #000; border-left: 0;'>FOB</th></tr>");

            //LOOP Start//
            sb.Append("<tr><td width='8%' style='border: 1px solid #000; border-right: 0; border-top: 0;'>" + obj.StockClosing.Count() + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-top: 0;'>" + obj.StockClosing.Sum(x => x.Units) + "</td>");
            sb.Append("<td width='9%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.StockClosing.Sum(x => x.Weight) + "</td>");
            sb.Append("<td width='12%' style='border: 1px solid #000; border-left: 0; border-top: 0;'>" + obj.StockClosing.Sum(x => x.Fob) + "</td></tr>");
            //LOOP End//
            sb.Append("</tbody></table>");
            sb.Append("</td>");
            sb.Append("</tr></tbody></table>");

            sb.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            var FileName = "DTR" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/
            using (var rp = new ReportingHelper(PdfPageSize.A4Landscape, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, sb.ToString());
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }


        #endregion

        #region Gate Entry Seal Cutting

        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult PrintSealCutting(int EntryId, string CBTContainer, string OperationType, string GateInNo, string ContainerType, string StuffType)

        {
            Dnd_EntryThroughGateRepository ObjGR = new Dnd_EntryThroughGateRepository();

            ObjGR.GetPrintSealCutting(EntryId, OperationType, ContainerType, StuffType);
            if (ObjGR.DBResponse.Data != null)
            {
                List<Dnd_GateEntrySealCutting> LstSeal = new List<Dnd_GateEntrySealCutting>();
                LstSeal = (List<Dnd_GateEntrySealCutting>)ObjGR.DBResponse.Data;
                string Path = GeneratePdfForSealCut(LstSeal, EntryId, CBTContainer, OperationType, GateInNo, ContainerType);
                return Json(new { Status = 1, Message = Path });
            }
            else
            {
                return Json(new { Status = 1, Message = "Error" });
            }
        }

        [NonAction]
        public string GeneratePdfForSealCut(List<Dnd_GateEntrySealCutting> LstSeal, int EntryId, string CBTContainer, string OperationType, string GateInNo, string ContainerType)
        {
            string Path = Server.MapPath("~/Docs/") + Session.SessionID + "/SealCutting" + EntryId + ".pdf";
            string ContainerNo = "", Size = "", SealNo = "", BLNo = "", Importer = "", LCLFCL = "", ArrivalDate = "", CHA = "", Purpose = "", EntryDate = "";
            string CargoDescription = "", NoOfUnits = "", SACNo = "", SACDate = "", AWBNo = "", AWBDate = "", GodownNo = "", CompanyAddress = "", CompanyEmail = "", CBTFrom = "";
            int Index = 1;
            string hdrCont = "";
            StringBuilder Html = new StringBuilder();
            if (OperationType == "Import")
            {
                LstSeal.Select(x => new { ContainerNo = x.ContainerNo }).Distinct().ToList().ForEach(item =>
                {
                    if (ContainerNo == "")
                        ContainerNo = item.ContainerNo;
                    else
                        ContainerNo += "<br/>" + item.ContainerNo;
                });
                LstSeal.Select(x => new { Size = x.Size }).Distinct().ToList().ForEach(item =>
                {
                    if (Size == "")
                        Size = item.Size;
                    else
                        Size += "<br/>" + item.Size;
                });
                LstSeal.Select(x => new { SealNo = x.SealNo }).Distinct().ToList().ForEach(item =>
                {
                    if (SealNo == "")
                        SealNo = item.SealNo;
                    else
                        SealNo += "<br/>" + item.SealNo;
                });
                LstSeal.Select(x => new { BLNo = x.BLNo }).Distinct().ToList().ForEach(item =>
                {
                    if (BLNo == "")
                        BLNo = item.BLNo;
                    else
                        BLNo += "<br/>" + item.BLNo;
                });
                LstSeal.Select(x => new { Importer = x.Importer }).Distinct().ToList().ForEach(item =>
                {
                    if (Importer == "")
                        Importer = item.Importer;
                    else
                        Importer += "<br/>" + item.Importer;
                });

                LstSeal.Select(x => new { LCLFCL = x.LCLFCL }).Distinct().ToList().ForEach(item =>
                {
                    if (LCLFCL == "")
                        LCLFCL = item.LCLFCL;
                    else
                        LCLFCL += "<br/>" + item.LCLFCL;
                });
                LstSeal.Select(x => new { ArrivalDate = x.ArrivalDate }).Distinct().ToList().ForEach(item =>
                {
                    if (ArrivalDate == "")
                        ArrivalDate = item.ArrivalDate;
                    else
                        ArrivalDate += "<br/>" + item.ArrivalDate;
                });
                LstSeal.Select(x => new { CBTFrom = x.CBTFrom }).Distinct().ToList().ForEach(item =>
                {
                    if (CBTFrom == "")
                        CBTFrom = item.CBTFrom;
                    else
                        CBTFrom += "<br/>" + item.CBTFrom;
                });


            }
            else if (OperationType == "Bond")
            {
                LstSeal.Select(x => new { ContainerNo = x.ContainerNo }).Distinct().ToList().ForEach(item =>
                {
                    if (ContainerNo == "")
                        ContainerNo = item.ContainerNo;
                    else
                        ContainerNo += "<br/>" + item.ContainerNo;
                });
                LstSeal.Select(x => new { Size = x.Size }).Distinct().ToList().ForEach(item =>
                {
                    if (Size == "")
                        Size = item.Size;
                    else
                        Size += "<br/>" + item.Size;
                });
                LstSeal.Select(x => new { SealNo = x.SealNo }).Distinct().ToList().ForEach(item =>
                {
                    if (SealNo == "")
                        SealNo = item.SealNo;
                    else
                        SealNo += "<br/>" + item.SealNo;
                });
                LstSeal.Select(x => new { BLNo = x.BLNo }).Distinct().ToList().ForEach(item =>
                {
                    if (BLNo == "")
                        BLNo = item.BLNo;
                    else
                        BLNo += "<br/>" + item.BLNo;
                });
                LstSeal.Select(x => new { Importer = x.Importer }).Distinct().ToList().ForEach(item =>
                {
                    if (Importer == "")
                        Importer = item.Importer;
                    else
                        Importer += "<br/>" + item.Importer;
                });
                LstSeal.Select(x => new { CHA = x.CHA }).Distinct().ToList().ForEach(item =>
                {
                    if (CHA == "")
                        CHA = item.CHA;
                    else
                        CHA += "<br/>" + item.CHA;
                });
                LstSeal.Select(x => new { CargoDescription = x.CargoDescription }).Distinct().ToList().ForEach(item =>
                {
                    if (CargoDescription == "")
                        CargoDescription = item.CargoDescription;
                    else
                        CargoDescription += "<br/>" + item.CargoDescription;
                });
                LstSeal.Select(x => new { NoOfUnits = x.NoOfUnits }).Distinct().ToList().ForEach(item =>
                {
                    if (NoOfUnits == "")
                        NoOfUnits = item.NoOfUnits;
                    else
                        NoOfUnits += "<br/>" + item.NoOfUnits;
                });
                LstSeal.Select(x => new { SACNo = x.SACNo }).Distinct().ToList().ForEach(item =>
                {
                    if (SACNo == "")
                        SACNo = item.SACNo;
                    else
                        SACNo += "<br/>" + item.SACNo;
                });
                LstSeal.Select(x => new { SACDate = x.SACDate }).Distinct().ToList().ForEach(item =>
                {
                    if (SACDate == "")
                        SACDate = item.SACDate;
                    else
                        SACDate += "<br/>" + item.SACDate;
                });
                LstSeal.Select(x => new { AWBNo = x.AWBNo }).Distinct().ToList().ForEach(item =>
                {
                    if (AWBNo == "")
                        AWBNo = item.AWBNo;
                    else
                        AWBNo += "<br/>" + item.AWBNo;
                });
                LstSeal.Select(x => new { AWBDate = x.AWBDate }).Distinct().ToList().ForEach(item =>
                {
                    if (AWBDate == "")
                        AWBDate = item.AWBDate;
                    else
                        AWBDate += "<br/>" + item.AWBDate;
                });
                LstSeal.Select(x => new { GodownNo = x.GodownNo }).Distinct().ToList().ForEach(item =>
                {
                    if (GodownNo == "")
                        GodownNo = item.GodownNo;
                    else
                        GodownNo += "<br/>" + item.GodownNo;
                });
                LstSeal.Select(x => new { CompanyAddress = x.CompanyAddress }).Distinct().ToList().ForEach(item =>
                {
                    if (CompanyAddress == "")
                        CompanyAddress = item.CompanyAddress;
                    else
                        CompanyAddress += "<br/>" + item.CompanyAddress;
                });
                LstSeal.Select(x => new { CompanyEmail = x.CompanyEmail }).Distinct().ToList().ForEach(item =>
                {
                    if (CompanyEmail == "")
                        CompanyEmail = item.CompanyEmail;
                    else
                        CompanyEmail += "<br/>" + item.CompanyEmail;
                });
                LstSeal.Select(x => new { LCLFCL = x.LCLFCL }).Distinct().ToList().ForEach(item =>
                {
                    if (LCLFCL == "")
                        LCLFCL = item.LCLFCL;
                    else
                        LCLFCL += "<br/>" + item.LCLFCL;
                });
                LstSeal.Select(x => new { ArrivalDate = x.ArrivalDate }).Distinct().ToList().ForEach(item =>
                {
                    if (ArrivalDate == "")
                        ArrivalDate = item.ArrivalDate;
                    else
                        ArrivalDate += "<br/>" + item.ArrivalDate;
                });


            }
            else if (OperationType == "Export" && ContainerType == "Empty" | OperationType == "Empty")
            {
                LstSeal.Select(x => new { ContainerNo = x.ContainerNo }).Distinct().ToList().ForEach(item =>
                {
                    if (ContainerNo == "")
                        ContainerNo = item.ContainerNo;
                    else
                        ContainerNo += "<br/>" + item.ContainerNo;
                });
                LstSeal.Select(x => new { Size = x.Size }).Distinct().ToList().ForEach(item =>
                {
                    if (Size == "")
                        Size = item.Size;
                    else
                        Size += "<br/>" + item.Size;
                });
                LstSeal.Select(x => new { SealNo = x.SealNo }).Distinct().ToList().ForEach(item =>
                {
                    if (SealNo == "")
                        SealNo = item.SealNo;
                    else
                        SealNo += "<br/>" + item.SealNo;
                });
                LstSeal.Select(x => new { BLNo = x.BLNo }).Distinct().ToList().ForEach(item =>
                {
                    if (BLNo == "")
                        BLNo = item.BLNo;
                    else
                        BLNo += "<br/>" + item.BLNo;
                });
                LstSeal.Select(x => new { Importer = x.Importer }).Distinct().ToList().ForEach(item =>
                {
                    if (Importer == "")
                        Importer = item.Importer;
                    else
                        Importer += "<br/>" + item.Importer;
                });

                LstSeal.Select(x => new { LCLFCL = x.LCLFCL }).Distinct().ToList().ForEach(item =>
                {
                    if (LCLFCL == "")
                        LCLFCL = item.LCLFCL;
                    else
                        LCLFCL += "<br/>" + item.LCLFCL;
                });
                LstSeal.Select(x => new { ArrivalDate = x.ArrivalDate }).Distinct().ToList().ForEach(item =>
                {
                    if (ArrivalDate == "")
                        ArrivalDate = item.ArrivalDate;
                    else
                        ArrivalDate += "<br/>" + item.ArrivalDate;
                });
                LstSeal.Select(x => new { Purpose = x.Purpose }).Distinct().ToList().ForEach(item =>
                {
                    if (Purpose == "")
                        Purpose = item.Purpose;
                    else
                        Purpose += " ," + item.Purpose;
                });
                LstSeal.Select(x => new { EntryDate = x.EntryDate }).Distinct().ToList().ForEach(item =>
                {
                    if (EntryDate == "")
                        EntryDate = item.EntryDate;
                    else
                        EntryDate += "<br/>" + item.EntryDate;
                });
                LstSeal.Select(x => new { CHA = x.CHA }).Distinct().ToList().ForEach(item =>
                {
                    if (CHA == "")
                        CHA = item.CHA;
                    else
                        CHA += " ," + item.CHA;
                });
            }
            else
            {
                LstSeal.Select(x => new { CHA = x.CHA }).Distinct().ToList().ForEach(item =>
                {
                    if (CHA == "")
                        CHA = item.CHA;
                    else
                        CHA += " ," + item.CHA;
                });
                LstSeal.Select(x => new { Purpose = x.Purpose }).Distinct().ToList().ForEach(item =>
                {
                    if (Purpose == "")
                        Purpose = item.Purpose;
                    else
                        Purpose += " ," + item.Purpose;
                });
                LstSeal.Select(x => new { ContainerNo = x.ContainerNo }).Distinct().ToList().ForEach(item =>
                {
                    if (ContainerNo == "")
                        ContainerNo = item.ContainerNo;
                    else
                        ContainerNo += "<br/>" + item.ContainerNo;
                });
                LstSeal.Select(x => new { EntryDate = x.EntryDate }).Distinct().ToList().ForEach(item =>
                {
                    if (EntryDate == "")
                        EntryDate = item.EntryDate;
                    else
                        EntryDate += "<br/>" + item.EntryDate;
                });
                LstSeal.Select(x => new { Size = x.Size }).Distinct().ToList().ForEach(item =>
                {
                    if (Size == "")
                        Size = item.Size;
                    else
                        Size += "<br/>" + item.Size;
                });

            }
            if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }

            if (OperationType == "Bond")
            {
                hdrCont = "Bond " + LCLFCL;
                //Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody> <tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td><td width='60%' valign='top' align='center'><h1 style='font-size: 22px; line-height: 30px;margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Government of India Undertaking)</label> </td><td valign='top'><img align='right' src='ISO' width='100'/></td></tr>           <tr><td colspan='12'><table width='100%'><tbody><tr> <th colspan='6' width='50%'><h6 style='margin:0;'>Manager - CFS/The Superintendent(Customs)</h6><h6 style='margin:0;'>Container Freight Station, Kukatpally</h6><h6 style='margin:0;'>IDPL Road, Hyderabad - 37</h6><h6 style='margin:0;'>Email - cwccfs@gmail.com</h6></th> <td colspan='6' width='50%' align='right' style='font-size:12px;'><b>Date:</b>" + DateTime.Now.ToString("dd/MM/yyyy") + "</td> </tr></tbody></table></td></tr>                   <tr><td><span><br/></span></td></tr> <tr><td colspan='3' style='text-align: center;'><h2 style='font-size: 16px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Sub : Request for Seal Cutting of " + hdrCont + " " + CBTContainer + " - Reg.</h2></td></tr> <tr><td colspan='3'><table style='width:100%;'cellspacing='0' cellpadding='0'><tbody><tr><td><p style='font-size:12px; margin-bottom:0;'><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> With reference to the above cited subject kindly arrange the following " + hdrCont + " " + CBTContainer + " for the Customs Examinations for Factory de-stuffing/CFS de-stuffing into godown/direct loading into truck.</p></td></tr><tr><td><table style='margin:5px 0 0; border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='10'><thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width:80px;'>S.No.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 200px;'>" + CBTContainer + " </th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 70px;'>Size</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 150px;'>Seal No.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 150px;'>BL No.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 250px;'>Name of the importer</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 250px;'>Arrival Date</th></tr></thead><tbody>");                
                //  foreach (GateEntrySealCutting item in LstSeal)
                // {
                //Html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width:80px;'>" + Index + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 200px;'>" + ContainerNo + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 70px;'>" + Size + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 150px;'>" + SealNo + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 150px;'>" + BLNo + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 250px;'>" + Importer + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 250px;'>" + ArrivalDate + "</td></tr>");
                // Index++;
                // }
                //Html.Append("</tbody></table></td></tr></tbody></table><p style='font-size: 13px; margin: 0;'>No Objection for seal cutting & destuffing obtained from IS/liner is enclosed.</p><br/><br/><br/><table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr><td><h6 style='font-size: 13px; margin:0; font-weight: normal;'>Permitted</h6><h3 style='font-size: 15px; margin:0;'>Signature of Customs Official</h3></td><td><h3 style='font-size: 15px; margin:0;font-weight: normal; text-align:right;'>Yours faithfully,</h3></td></tr></tbody></table></td></tr></tbody></table>");


                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table width='100%'><tbody><tr>");
                Html.Append("<td valign='top'><img align='right' src='IMGSRC' width='90'/></td><td width='70%' valign='top' align='center'><h1 style='font-size: 22px; line-height: 30px;margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Government of India Undertaking)</label> </td><td valign='top'><img align='right' src='ISO' width='100'/></td>");
                Html.Append("</tr></tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table width='100%'><tbody><tr>");
                Html.Append("<th colspan='6' width='50%'><h6 style='margin:0;'>Manager - CFS/The Superintendent(Customs)</h6><h6 style='margin:0;'>Container Freight Station,</h6><h6 style='margin:0;'>" + CompanyAddress + "</h6><h6 style='margin:0;'>" + CompanyEmail + "</h6></th>");
                Html.Append("<td colspan='6' width='50%' align='right' style='font-size:12px;'><b>Date:</b>" + ArrivalDate + "</td>");
                Html.Append("</tr></tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table width='100%'><tbody><tr>");
                Html.Append("<td style='text-align: center;'><h2 style='font-size: 16px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Sub : Request for Seal Cutting of Bond " + CBTContainer + " - Reg.</h2></td>");
                Html.Append("</tr></tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellpadding='5' width='100%' style='font-size:12px; border: 1px solid #000;'><tbody>");
                Html.Append("<tr><td width='15%'><b>" + CBTContainer + " No</b></td><td>:</td><td width='80%'>" + ContainerNo + "</td></tr>");
                Html.Append("<tr><td width='15%'><b>Importer Name</b></td><td>:</td><td width='80%'>" + Importer + "</td></tr>");
                Html.Append("<tr><td width='15%'><b>CHA Name</b></td><td>:</td><td width='80%'>" + CHA + "</td></tr>");
                Html.Append("<tr><td width='15%'><b>Cargo Description</b></td><td>:</td><td width='80%'>" + CargoDescription + "</td></tr>");
                Html.Append("<tr><td width='15%'><b>No. of Units</b></td><td>:</td><td width='80%'>" + NoOfUnits + "<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <b>Seal No :</b> " + SealNo + "</td></tr>");
                Html.Append("<tr><td width='15%'><b>SAC No</b></td><td>:</td><td width='80%'>" + SACNo + "<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <b>SAC Date :</b> " + SACDate + "</td></tr>");
                Html.Append("<tr><td width='15%'><b>AWB No</b></td><td>:</td><td width='80%'>" + AWBNo + "<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <b>AWB Date :</b> " + AWBDate + "</td></tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table width='100%' style='font-size:12px;'><tbody>");
                Html.Append("<tr><td colspan='12'>Please receive the cargo as detailed above and as per the Into B/E enclosed in godown no <u>" + GodownNo + "</u> on branded weight basis / after undertaking weighment.</td></tr>");
                Html.Append("<tr><td colspan='12'><span><br/><br/><br/></span></td></tr>");
                Html.Append("<tr><th colspan='6' width='50%'>Gate I/C</th> <th colspan='6' width='50%' style='text-align:right;'>Office Assistant</th></tr>");
                Html.Append("<tr><td colspan='12'><span><br/></span></td></tr>");
                Html.Append("<tr><td colspan='12'></td></tr>");
                Html.Append("<tr><td colspan='12' style='border-top: 1px solid #000; padding-top:20px;'><p>With reference to the above cited subject kindly arrange the above Bond " + CBTContainer + " for Customs Examination for warehouse de-stuffing.</p></td></tr>");
                Html.Append("<tr><td colspan='12'><p>No Objection for seal cutting & destuffing into warehouse.</p></td></tr>");
                Html.Append("<tr><td colspan='12'><span><br/><br/><br/><br/></span></td></tr>");
                Html.Append("<tr><td colspan='6' width='50%'><h6 style='font-size: 12px; margin:0; font-weight: normal;'>Permitted</h6><h3 style='font-size: 13px; margin:0;'>Signature of Customs Official</h3></td> <td colspan='6' width='50%'><h3 style='font-size: 13px; margin:0;font-weight: normal; text-align:right;'>Yours faithfully,</h3></td></tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");


                Html.Append("</tbody></table>");
            }
            else if (OperationType == "Import")
            {
                hdrCont = "Import " + LCLFCL;
                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody> <tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td><td width='60%' valign='top' align='center'><h1 style='font-size: 22px; line-height: 30px;margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Government of India Undertaking)</label> </td><td valign='top'><img align='right' src='ISO' width='100'/></td></tr>           <tr><td colspan='12'><table width='100%'><tbody><tr> <th colspan='6' width='50%'><h6 style='margin:0;'>Manager - CFS/The Superintendent(Customs)</h6><h6 style='margin:0;'>Container Freight Station, Kukatpally</h6><h6 style='margin:0;'>IDPL Road, Hyderabad - 37</h6><h6 style='margin:0;'>Email - cwccfs@gmail.com</h6></th> <td colspan='6' width='50%' align='right' style='font-size:12px;'><b>Date:</b>" + DateTime.Now.ToString("dd/MM/yyyy") + "</td> </tr></tbody></table></td></tr>                   <tr><td><span><br/></span></td></tr> <tr><td colspan='3' style='text-align: center;'><h2 style='font-size: 16px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Sub : Request for Seal Cutting of " + hdrCont + " " + CBTContainer + " - Reg.</h2></td></tr> <tr><td colspan='3'><table style='width:100%;'cellspacing='0' cellpadding='0'><tbody><tr><td><p style='font-size:12px; margin-bottom:0;'><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> With reference to the above cited subject kindly arrange the following " + hdrCont + " " + CBTContainer + " for the Customs Examinations for Factory de-stuffing/CFS de-stuffing into godown/direct loading into truck.</p></td></tr><tr><td><table style='margin:5px 0 0; border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='10'><thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width:80px;'>S.No.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 200px;'>" + CBTContainer + " </th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 70px;'>Size</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 150px;'>Seal No.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 150px;'>BL No.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 250px;'>Name of the importer</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 250px;'>Arrival Date</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 250px;'>Container/CBT From</th></tr></thead><tbody>");
                //  foreach (GateEntrySealCutting item in LstSeal)
                // {
                Html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width:80px;'>" + Index + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 200px;'>" + ContainerNo + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 70px;'>" + Size + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 150px;'>" + SealNo + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 150px;'>" + BLNo + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 250px;'>" + Importer + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 250px;'>" + ArrivalDate + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 250px;'>" + CBTFrom + "</td></tr>");
                // Index++;
                // }
                Html.Append("</tbody></table></td></tr></tbody></table><p style='font-size: 13px; margin: 0;'>No Objection for seal cutting & destuffing obtained from IS/liner is enclosed.</p><br/><br/><br/><table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr><td><h6 style='font-size: 13px; margin:0; font-weight: normal;'>Permitted</h6><h3 style='font-size: 15px; margin:0;'>Signature of Customs Official</h3></td><td><h3 style='font-size: 15px; margin:0;font-weight: normal; text-align:right;'>Yours faithfully,</h3></td></tr></tbody></table></td></tr></tbody></table>");

            }
            else if (OperationType == "Empty")
            {
                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                Html.Append("<tr><td width='65%' style='font-size: 10px;'>'Warehousing for every one'</td>");
                Html.Append("<td width='10%' align='right'>");
                Html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                Html.Append("<tr><td style='border:1px solid #333;'>");
                Html.Append("<div style='padding: 5px 0; font-size: 12px; text-align: center;'>F/CD/CFS/01</div>");
                Html.Append("</td></tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Html.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>Container Freight Station, Kukatpally<br/> IDPL Road, Hyderabad - 37</span><br/><label style='font-size: 12px;'>Email - cwccfs@gmail.com</label><br/><label style='font-size: 14px; font-weight:bold;'>TRUCK SLIP</label></td>");
                Html.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td></tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody><tr>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Html.Append("<tr><th style='text-align:left; font-size:12px; width:25%;'>SL.No. :</th><td style='font-size:12px;'>" + GateInNo + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><th style='font-size:12px; width:20%;'>Date :</th><td style='font-size:12px;'>" + DateTime.Now.ToString("dd/MM/yyyy") + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><th style='font-size:12px; text-align:right; width:40%;'>Entry Date :</th><td style='font-size:12px;'>" + LstSeal[0].ArrivalDate + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("</tr></tbody></table>");
                Html.Append("</td></tr>");


                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody><tr>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Html.Append("<tr><th style='text-align:left; font-size:12px; width:30%;'>Truck No. :</th><td style='font-size:12px;'>" + LstSeal[0].VehicleNo + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><th style='font-size:12px;width:50%;'>Container/CBT No. :</th><td style='font-size:12px;'>" + ContainerNo + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><th style='font-size:12px; text-align:right; width:30%;'>Size :</th><td style='font-size:12px; width:21%;'>" + Size + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("</tr></tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'><span style='font-size:12px;padding:0 5px;'>Purpose <u>" + Purpose + "</u></span></td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table style='border: 1px solid #000; width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                Html.Append("<td colspan='6' width='50%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%; font-size:8pt; font-family:Verdana,Arial,San-serif; border-collapse:collapse;'>");
                Html.Append("<thead><tr><th colspan='12' style='border-bottom: 1px solid #000; font-size:14px; text-align:center; padding:10px;'>TO BE FILLED BY AGENT</th></tr>");
                Html.Append("<tr><th colspan='2' width='16.66666667%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Sl. No.</th>");
                Html.Append("<th colspan='4' width='33.3%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Sub No./ Carting PNR No.</th>");
                Html.Append("<th colspan='4' width='33.3%;' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Cargo</th>");
                Html.Append("<th colspan='2' width='16.66666667%' style='font-size:7pt;border-bottom:1px solid #000;text-align:center;padding:10px;'>No. of Units</th></tr></thead>");
                Html.Append("<tbody>");
                foreach (Dnd_GateEntrySealCutting item in LstSeal)
                {
                    Html.Append("<tr><td colspan='2' width='16.66666667%' style='border-right:1px solid #000;font-size:7pt; text-align:center; padding:10px;'>" + Index + "</td> ");
                    Html.Append("<td colspan='4' width='33.3%' style='border-right:1px solid #000;font-size:7pt; text-align:center; padding:10px;'>" + item.ReferenceNo + "</td>");
                    Html.Append("<td colspan='4' width='33.3%' style='border-right:1px solid #000;font-size:7pt; text-align:center; padding:10px;'>" + item.CargoDescription + "</td>");
                    Html.Append("<td colspan='2' width='16.66666667%' style='font-size:7pt; text-align:center; padding:10px;'>" + item.NoOfUnits + "</td></tr>");
                    Index++;
                }
                Html.Append("</tbody>");
                Html.Append("</table></td>");

                Html.Append("<td colspan='6' width='50%' valign='top' style='padding:0;'><table style='border-bottom:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                Html.Append("<thead><tr><th colspan='12' style='font-size:14px;text-align:center;padding:10px;border-bottom:1px solid #000;'>TO BE FILLED BY CFS</th></tr>");
                Html.Append("<tr><th colspan='2' width='16.66666667%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Godown No.</th> ");
                Html.Append("<th colspan='3' width='25%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>No. of Units</th>");
                Html.Append("<th colspan='3' width='25%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Gate Pass No.</th>");
                Html.Append("<th colspan='4' width='33.3%' style='font-size:7pt;border-bottom:1px solid #000;text-align:center;padding:10px;'>Signature of Shed Incharge</th></tr></thead>");
                Html.Append("<tbody>");
                foreach (Dnd_GateEntrySealCutting item in LstSeal)
                {
                    Html.Append("<tr><td colspan='2' width='16.66666667%' style='border-right:1px solid #000;font-size:7pt; text-align:center; padding:10px;'>" + item.GodownNo + "</td>");
                    Html.Append("<td colspan='3' width='25%' style='border-right:1px solid #000;font-size:7pt;text-align:center;padding:10px;'>" + item.NoOfUnits + "</td> ");
                    Html.Append("<td colspan='3' width='25%' style='border-right:1px solid #000;font-size:7pt; text-align:center;padding:10px;'>" + string.Empty + "</td>");
                    Html.Append("<td colspan='4' width='33.3%' style='font-size:7pt; text-align:center;padding:10px;'></td></tr>");
                }
                Html.Append("</tbody>");
                Html.Append("</table></td>");
                Html.Append("</tr></tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'><span style='font-size:13px;'>Name of the Importer/Exporter : " + LstSeal[0].Exporter + "</span></td></tr>");
                Html.Append("<tr><td colspan='12'><span style='font-size:13px;'>Name and Signature of CHA : " + CHA + "</span></td></tr>");
                Html.Append("<tr><th colspan='12' style='text-align: center;font-size: 15px;'><u>AT GATE</u></th></tr>");
                Html.Append("<tr><th colspan='6' style='text-align: center;font-size: 15px;'>ALLOWED IN</th><th colspan='6' style='text-align: center;font-size: 15px;'>ALLOWED OUT</th></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellspacing='0' cellpadding='0'  style='border:1px solid #000;width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                Html.Append("<tr>");
                Html.Append("<td colspan='6' width='50%' valign='top'><table cellpadding='5' style='width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Truck in time</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Date</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Seal No.</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='12'><span><br/><br/></span></td></tr>");
                Html.Append("<tr><th colspan='12' style='text-align: center;font-size: 13px;'>Signature of Gate I/C</th></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='6' width='50%' valign='top'><table cellpadding='5' style='width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Truck out time</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Date</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Seal No.</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='12'><span><br/><br/></span></td></tr>");
                Html.Append("<tr><th colspan='12' style='text-align: center;font-size: 13px;'>Signature of Gate I/C</th></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("</tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");
                Html.Append("</tbody></table>");

            }
            else if (OperationType == "Export" && ContainerType == "Empty")
            {
                string strDateTime = EntryDate;
                string[] dateTimeArray = strDateTime.Split(' ');
                string strDtae = dateTimeArray[0];

                string strTime = dateTimeArray[1];

                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                Html.Append("<tr><td width='65%' style='font-size: 10px;'>'Warehousing for every one'</td>");
                Html.Append("<td width='10%' align='right'>");
                Html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                Html.Append("<tr><td style='border:1px solid #333;'>");
                Html.Append("<div style='padding: 5px 0; font-size: 12px; text-align: center;'>F/CD/CFS/01</div>");
                Html.Append("</td></tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Html.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>Container Freight Station, Kukatpally<br/> IDPL Road, Hyderabad - 37</span><br/><label style='font-size: 12px;'>Email - cwccfs@gmail.com</label><br/><label style='font-size: 14px; font-weight:bold;'>TRUCK SLIP</label></td>");
                Html.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td></tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody><tr>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Html.Append("<tr><th style='text-align:left; font-size:12px; width:25%;'>SL.No. :</th><td style='font-size:12px;'>" + GateInNo + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><th style='font-size:12px; width:20%;'>Date :</th><td style='font-size:12px;'>" + DateTime.Now.ToString("dd/MM/yyyy") + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><th style='font-size:12px; text-align:right; width:40%;'>Entry Date :</th><td style='font-size:12px;'>" + LstSeal[0].ArrivalDate + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("</tr></tbody></table>");
                Html.Append("</td></tr>");


                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody><tr>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Html.Append("<tr><th style='text-align:left; font-size:12px; width:30%;'>Truck No. :</th><td style='font-size:12px;'>" + LstSeal[0].VehicleNo + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><th style='font-size:12px;width:50%;'>Container/CBT No. :</th><td style='font-size:12px;'>" + ContainerNo + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><th style='font-size:12px; text-align:right; width:30%;'>Size :</th><td style='font-size:12px; width:21%;'>" + Size + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("</tr></tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'><span style='font-size:12px;padding:0 5px;'>Purpose <u>" + Purpose + "</u></span></td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table style='border: 1px solid #000; width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                Html.Append("<td colspan='6' width='50%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%; font-size:8pt; font-family:Verdana,Arial,San-serif; border-collapse:collapse;'>");
                Html.Append("<thead><tr><th colspan='12' style='border-bottom: 1px solid #000; font-size:14px; text-align:center; padding:10px;'>TO BE FILLED BY AGENT</th></tr>");
                Html.Append("<tr><th colspan='2' width='16.66666667%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Sl. No.</th>");
                Html.Append("<th colspan='4' width='33.3%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Sub No./ Carting PNR No.</th>");
                Html.Append("<th colspan='4' width='33.3%;' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Cargo</th>");
                Html.Append("<th colspan='2' width='16.66666667%' style='font-size:7pt;border-bottom:1px solid #000;text-align:center;padding:10px;'>No. of Units</th></tr></thead>");
                Html.Append("<tbody>");
                foreach (Dnd_GateEntrySealCutting item in LstSeal)
                {
                    Html.Append("<tr><td colspan='2' width='16.66666667%' style='border-right:1px solid #000;font-size:7pt; text-align:center; padding:10px;'>" + Index + "</td> ");
                    Html.Append("<td colspan='4' width='33.3%' style='border-right:1px solid #000;font-size:7pt; text-align:center; padding:10px;'>" + item.ReferenceNo + "</td>");
                    Html.Append("<td colspan='4' width='33.3%' style='border-right:1px solid #000;font-size:7pt; text-align:center; padding:10px;'>" + item.CargoDescription + "</td>");
                    Html.Append("<td colspan='2' width='16.66666667%' style='font-size:7pt; text-align:center; padding:10px;'>" + item.NoOfUnits + "</td></tr>");
                    Index++;
                }
                Html.Append("</tbody>");
                Html.Append("</table></td>");

                Html.Append("<td colspan='6' width='50%' valign='top' style='padding:0;'><table style='border-bottom:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                Html.Append("<thead><tr><th colspan='12' style='font-size:14px;text-align:center;padding:10px;border-bottom:1px solid #000;'>TO BE FILLED BY CFS</th></tr>");
                Html.Append("<tr><th colspan='2' width='16.66666667%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Godown No.</th> ");
                Html.Append("<th colspan='3' width='25%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>No. of Units</th>");
                Html.Append("<th colspan='3' width='25%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Gate Pass No.</th>");
                Html.Append("<th colspan='4' width='33.3%' style='font-size:7pt;border-bottom:1px solid #000;text-align:center;padding:10px;'>Signature of Shed Incharge</th></tr></thead>");
                Html.Append("<tbody>");
                foreach (Dnd_GateEntrySealCutting item in LstSeal)
                {
                    Html.Append("<tr><td colspan='2' width='16.66666667%' style='border-right:1px solid #000;font-size:7pt; text-align:center; padding:10px;'>" + item.GodownNo + "</td>");
                    Html.Append("<td colspan='3' width='25%' style='border-right:1px solid #000;font-size:7pt;text-align:center;padding:10px;'>" + item.NoOfUnits + "</td> ");
                    Html.Append("<td colspan='3' width='25%' style='border-right:1px solid #000;font-size:7pt; text-align:center;padding:10px;'>" + string.Empty + "</td>");
                    Html.Append("<td colspan='4' width='33.3%' style='font-size:7pt; text-align:center;padding:10px;'></td></tr>");
                }
                Html.Append("</tbody>");
                Html.Append("</table></td>");
                Html.Append("</tr></tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'><span style='font-size:13px;'>Name of the Exporter : " + LstSeal[0].Exporter + "</span></td></tr>");
                Html.Append("<tr><td colspan='12'><span style='font-size:13px;'>Name and Signature of CHA : " + CHA + "</span></td></tr>");
                Html.Append("<tr><th colspan='12' style='text-align: center;font-size: 15px;'><u>AT GATE</u></th></tr>");
                Html.Append("<tr><th colspan='6' style='text-align: center;font-size: 15px;'>ALLOWED IN</th><th colspan='6' style='text-align: center;font-size: 15px;'>ALLOWED OUT</th></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellspacing='0' cellpadding='0'  style='border:1px solid #000;width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                Html.Append("<tr>");
                Html.Append("<td colspan='6' width='50%' valign='top'><table cellpadding='5' style='width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Truck in time</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'>" + strTime + "</td></tr>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Date</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'>" + LstSeal[0].ArrivalDate + "</td></tr>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Seal No.</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='12'><span><br/><br/></span></td></tr>");
                Html.Append("<tr><th colspan='12' style='text-align: center;font-size: 13px;'>Signature of Gate I/C</th></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='6' width='50%' valign='top'><table cellpadding='5' style='width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Truck out time</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Date</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Seal No.</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='12'><span><br/><br/></span></td></tr>");
                Html.Append("<tr><th colspan='12' style='text-align: center;font-size: 13px;'>Signature of Gate I/C</th></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("</tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");
                Html.Append("</tbody></table>");

            }
            else if (OperationType == "Export")

            {
                string strDateTime = EntryDate;
                string[] dateTimeArray = strDateTime.Split(' ');
                string strDtae = dateTimeArray[0];

                string strTime = dateTimeArray[1];

                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                Html.Append("<tr><td width='65%' style='font-size: 10px;'>'Warehousing for every one'</td>");
                Html.Append("<td width='10%' align='right'>");
                Html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                Html.Append("<tr><td style='border:1px solid #333;'>");
                Html.Append("<div style='padding: 5px 0; font-size: 12px; text-align: center;'>F/CD/CFS/01</div>");
                Html.Append("</td></tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Html.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>Container Freight Station, Kukatpally<br/> IDPL Road, Hyderabad - 37</span><br/><label style='font-size: 12px;'>Email - cwccfs@gmail.com</label><br/><label style='font-size: 14px; font-weight:bold;'>TRUCK SLIP</label></td>");
                Html.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td></tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody><tr>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Html.Append("<tr><th style='text-align:left; font-size:12px; width:25%;'>SL.No. :</th><td style='font-size:12px;'>" + GateInNo + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><th style='font-size:12px; width:20%;'>Date :</th><td style='font-size:12px;'>" + DateTime.Now.ToString("dd/MM/yyyy") + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><th style='font-size:12px; text-align:right; width:40%;'>Entry Date :</th><td style='font-size:12px;'>" + LstSeal[0].ArrivalDate + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("</tr></tbody></table>");
                Html.Append("</td></tr>");


                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody><tr>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Html.Append("<tr><th style='text-align:left; font-size:12px; width:30%;'>Truck No. :</th><td style='font-size:12px;'>" + LstSeal[0].VehicleNo + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><th style='font-size:12px;width:50%;'>Container/CBT No. :</th><td style='font-size:12px;'>" + ContainerNo + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='4' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                Html.Append("<tr><th style='font-size:12px; text-align:right; width:30%;'>Size :</th><td style='font-size:12px; width:21%;'>" + Size + "</td></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("</tr></tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'><span style='font-size:12px;padding:0 5px;'>Purpose " + Purpose + "</span></td></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table style='border: 1px solid #000; width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                Html.Append("<td colspan='6' width='50%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%; font-size:8pt; font-family:Verdana,Arial,San-serif; border-collapse:collapse;'>");
                Html.Append("<thead><tr><th colspan='12' style='border-bottom: 1px solid #000; font-size:14px; text-align:center; padding:10px;'>TO BE FILLED BY AGENT</th></tr>");
                Html.Append("<tr><th colspan='2' width='16.66666667%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Sl. No.</th>");
                Html.Append("<th colspan='4' width='33.3%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Sub No./ Carting PNR No.</th>");
                Html.Append("<th colspan='4' width='33.3%;' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Cargo</th>");
                Html.Append("<th colspan='2' width='16.66666667%' style='font-size:7pt;border-bottom:1px solid #000;text-align:center;padding:10px;'>No. of Units</th></tr></thead>");
                Html.Append("<tbody>");
                foreach (Dnd_GateEntrySealCutting item in LstSeal)
                {
                    Html.Append("<tr><td colspan='2' width='16.66666667%' style='border-right:1px solid #000;font-size:7pt; text-align:center; padding:10px;'>" + Index + "</td> ");
                    Html.Append("<td colspan='4' width='33.3%' style='border-right:1px solid #000;font-size:7pt; text-align:center; padding:10px;'>" + item.ReferenceNo + "</td>");
                    Html.Append("<td colspan='4' width='33.3%' style='border-right:1px solid #000;font-size:7pt; text-align:center; padding:10px;'>" + item.CargoDescription + "</td>");
                    Html.Append("<td colspan='2' width='16.66666667%' style='font-size:7pt; text-align:center; padding:10px;'>" + item.NoOfUnits + "</td></tr>");
                    Index++;
                }
                Html.Append("</tbody>");
                Html.Append("</table></td>");

                Html.Append("<td colspan='6' width='50%' valign='top' style='padding:0;'><table style='border-bottom:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                Html.Append("<thead><tr><th colspan='12' style='font-size:14px;text-align:center;padding:10px;border-bottom:1px solid #000;'>TO BE FILLED BY CFS</th></tr>");
                Html.Append("<tr><th colspan='2' width='16.66666667%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Godown No.</th> ");
                Html.Append("<th colspan='3' width='25%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>No. of Units</th>");
                Html.Append("<th colspan='3' width='25%' style='font-size:7pt;border-right:1px solid #000;border-bottom:1px solid #000;text-align:center;padding:10px;'>Gate Pass No.</th>");
                Html.Append("<th colspan='4' width='33.3%' style='font-size:7pt;border-bottom:1px solid #000;text-align:center;padding:10px;'>Signature of Shed Incharge</th></tr></thead>");
                Html.Append("<tbody>");
                foreach (Dnd_GateEntrySealCutting item in LstSeal)
                {
                    Html.Append("<tr><td colspan='2' width='16.66666667%' style='border-right:1px solid #000;font-size:7pt; text-align:center; padding:10px;'>" + item.GodownNo + "</td>");
                    Html.Append("<td colspan='3' width='25%' style='border-right:1px solid #000;font-size:7pt;text-align:center;padding:10px;'>" + item.NoOfUnits + "</td> ");
                    Html.Append("<td colspan='3' width='25%' style='border-right:1px solid #000;font-size:7pt; text-align:center;padding:10px;'>" + string.Empty + "</td>");
                    Html.Append("<td colspan='4' width='33.3%' style='font-size:7pt; text-align:center;padding:10px;'></td></tr>");
                }
                Html.Append("</tbody>");
                Html.Append("</table></td>");
                Html.Append("</tr></tbody></table>");
                Html.Append("</td></tr>");

                Html.Append("<tr><td colspan='12'><span style='font-size:13px;'>Name of the Exporter : " + LstSeal[0].Exporter + "</span></td></tr>");
                Html.Append("<tr><td colspan='12'><span style='font-size:13px;'>Name and Signature of CHA : " + CHA + "</span></td></tr>");
                Html.Append("<tr><th colspan='12' style='text-align: center;font-size: 15px;'><u>AT GATE</u></th></tr>");
                Html.Append("<tr><th colspan='6' style='text-align: center;font-size: 15px;'>ALLOWED IN</th><th colspan='6' style='text-align: center;font-size: 15px;'>ALLOWED OUT</th></tr>");

                Html.Append("<tr><td colspan='12'>");
                Html.Append("<table cellspacing='0' cellpadding='0'  style='border:1px solid #000;width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                Html.Append("<tr>");
                Html.Append("<td colspan='6' width='50%' valign='top'><table cellpadding='5' style='width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Truck in time</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'>" + strTime + "</td></tr>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Date</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'>" + LstSeal[0].ArrivalDate + "</td></tr>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Seal No.</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='12'><span><br/><br/></span></td></tr>");
                Html.Append("<tr><th colspan='12' style='text-align: center;font-size: 13px;'>Signature of Gate I/C</th></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("<td colspan='6' width='50%' valign='top'><table cellpadding='5' style='width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Truck out time</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Date</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='1' style='font-size:12px;' width='50%' valign='top'>Seal No.</td><td>:</td><td colspan='2' style='font-size:12px;' width='40%' valign='top'></td></tr>");
                Html.Append("<tr><td colspan='12'><span><br/><br/></span></td></tr>");
                Html.Append("<tr><th colspan='12' style='text-align: center;font-size: 13px;'>Signature of Gate I/C</th></tr>");
                Html.Append("</tbody></table></td>");
                Html.Append("</tr>");
                Html.Append("</tbody></table>");
                Html.Append("</td></tr>");
                Html.Append("</tbody></table>");






                //Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                //Html.Append("<tr><td colspan='12'>");
                //Html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                //Html.Append("<tr><td width='65%' style='font-size: 10px;'>'Warehousing for every one'</td>");
                //Html.Append("<td width='10%' align='right'>");
                //Html.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                //Html.Append("<tr><td style='border:1px solid #333;'>");
                //Html.Append("<div style='padding: 5px 0; font-size: 12px; text-align: center;'>F/CD/CFS/01</div>");
                //Html.Append("</td></tr>");
                //Html.Append("</tbody></table>");
                //Html.Append("</td></tr>");
                //Html.Append("</tbody></table>");
                //Html.Append("</td></tr>");
                //Html.Append("<tr><td colspan='12'>");
                //Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                //Html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                //Html.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>Container Freight Station, Kukatpally<br/> IDPL Road, Hyderabad - 37</span><br/><label style='font-size: 12px;'>Email - cwccfs@gmail.com</label><br/><label style='font-size: 14px; font-weight:bold;'>TRUCK SLIP</label></td>");
                //Html.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td></tr>");
                //Html.Append("</tbody></table>");
                //Html.Append("</td></tr>");
                //Html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody><tr><th style='font-size:13px;'>SL.No.</th>");
                //Html.Append("<td style='font-size:12px;'><u></u></td><th style='font-size:13px; text-align:right;'>Date</th>");
                //Html.Append("<td style='font-size:12px; width:10%;'><u></u></td></tr></tbody></table></td></tr>");
                //Html.Append("<tr><td colspan='12'>");
                //Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");               
                //Html.Append("<tr>");
                //Html.Append("<td colspan='3' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin:0; padding: 5px;'><tbody>");
                //Html.Append("<tr><th style='font-size:13px;'>Truck No.</th><td style='font-size:12px;'></td></tr>");
                //Html.Append("</tbody></table></td>");
                //Html.Append("<td colspan='3' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin:0; padding: 5px;'><tbody>");
                //Html.Append("<tr><th style='font-size:13px;'>Container No.</th><td style='font-size:12px;'>"+ContainerNo+"</td></tr>");
                //Html.Append("</tbody></table></td>");
                //Html.Append("<td colspan='3' width='33.3%'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin:0; padding: 5px;'><tbody>");
                //Html.Append("<tr><th style='font-size:13px; text-align:right;'>Size</th><td style='font-size:12px; width:21%;'>"+Size+"</td></tr>");
                //Html.Append("</tbody></table></td>");
                //Html.Append("</tr>");
                //Html.Append("</tbody></table>");
                //Html.Append("</td></tr>");
                //Html.Append("<tr><td colspan='12'><span style='font-size:14px;'>Purpose <u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u></span></td></tr>");
                //Html.Append("<tr><td colspan ='12'>");
                //Html.Append("<table style='border:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                //Html.Append("<td colspan='6' width='50%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%; font-size:8pt; font-family:Verdana,Arial,San-serif; border-collapse:collapse;'>");
                //Html.Append("<thead><tr><th colspan='12' style='font-size:14px; text-align:center; border-bottom:1px solid #000;padding:10px;'>TO BE FILLED BY AGENT</th></tr>");
                //Html.Append("<tr><th style='font-weight:600; text-align:center; border: 1px solid #000;border-left:none;padding:10px;'>Sl. No.</th> ");
                //Html.Append("<th style='font-weight:600; text-align:center; border: 1px solid #000;padding:10px;'>Sub No./ Carting <br/> PNR No.</th>");
                //Html.Append("<th style='font-weight:600; text-align:center; border: 1px solid #000;padding:10px;'>Cargo</th>");
                //Html.Append("<th style='font-weight:600; text-align:center; border: 1px solid #000;padding:10px;border-right:none;'>No. of Units</th></tr></thead>");
                //Html.Append("<tbody>");
                //foreach (GateEntrySealCutting item in LstSeal)
                //{
                //    Html.Append("<tr><td style='text-align:center; border: 1px solid #000;border-left:none;border-bottom:none;padding:10px;'>" + Index + "</td> ");
                //    Html.Append("<td style='text-align:center; border: 1px solid #000;border-bottom:none;padding:10px;'>" + item.ReferenceNo + "</td>");
                //    Html.Append("<td style='text-align:center; border: 1px solid #000;border-bottom:none;padding:10px;'>"+item.CargoDescription+"</td>");
                //    Html.Append("<td style='text-align:center; border: 1px solid #000;border-bottom:none;border-right:none;padding:10px;'>"+item.NoOfUnits+"</td></tr>");
                //    Index++;
                //}
                //Html.Append("</tbody>");
                //Html.Append("</table></td>");
                //Html.Append("<td colspan='6' width='50%' valign='top' style='padding:0;'><table style='width:100%; font-size:8pt; font-family:Verdana,Arial,San-serif; border-collapse:collapse;'>");
                //Html.Append("<thead><tr><th colspan='12' style='font-size:14px; text-align:center; border-bottom:1px solid #000;padding:10px;'>TO BE FILLED BY CFS</th></tr>");
                //Html.Append("<tr><th style='font-weight:600; text-align:center; border: 1px solid #000;border-left:none;padding:10px;'>Godown No.</th>");
                //Html.Append("<th style='font-weight:600; text-align:center; border: 1px solid #000;padding:10px;'>No Of units</th>");
                //Html.Append("<th style='font-weight:600; text-align:center; border: 1px solid #000;padding:10px;'>Gate Pass No.</th>");
                //Html.Append("<th style='font-weight:600; text-align:center; border: 1px solid #000;padding:10px;border-right:none;'>Signature of <br/> Shed Incharge</th></tr></thead><tbody>");
                //foreach(GateEntrySealCutting item in LstSeal)
                //{
                //    Html.Append("<tr><td style='text-align:center; border: 1px solid #000;border-bottom:none;border-left:none;padding:10px;'>"+ string.Empty +"</td>");
                //    Html.Append("<td style='text-align:center; border: 1px solid #000;border-bottom:none;padding:10px;'>"+item.NoOfUnits+"</td> ");
                //    Html.Append("<td style='text-align:center; border: 1px solid #000;border-bottom:none;padding:10px;'>"+string.Empty+"</td>");
                //    Html.Append("<td style='text-align:center; border: 1px solid #000;border-bottom:none;border-right:none;padding:10px;'></td></tr>");
                //}

                //Html.Append("</tbody></table></td>");
                //Html.Append("</tr></tbody></table>");
                //Html.Append("</td></tr>");
                //Html.Append("<tr><td colspan='12'><span style='font-size:14px;'>Name of the Importer/Exporter : "+LstSeal[0].Exporter+"</span></td></tr>");
                //Html.Append("<tr><td colspan='12'><span style='font-size:14px;'>Name and Signature of CHA : "+ CHA +"</span></td></tr>");
                //Html.Append("<tr><th colspan='12' style='text-align: center; font-size:15px;'><u>AT GATE</u></th></tr>");
                //Html.Append("<tr><th colspan='6' style='text-align: center; font-size: 15px;'>ALLOWED IN</th><th colspan='6' style='text-align:center; font-size: 15px; '>ALLOWED OUT</th></tr>");
                //Html.Append("<tr><td colspan='12'>");
                //Html.Append("<table cellspacing='0' cellpadding='5'  style='border: 1px solid #000;width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                //Html.Append("<tr>");
                //Html.Append("<td colspan='6' width='50%' valign='top'><table style='width:100%; font-family:Verdana,Arial,San-serif; border-collapse:collapse;'><tbody>");
                //Html.Append("<tr><td colspan='1' style='font-size:13px;' width='50% ' valign='top'>Truck in time</td><td>:</td><td colspan='2' style='font-size:13px;' width='40% ' valign='top'></td></tr>");
                //Html.Append("<tr><td colspan='1' style='font-size:13px;' width='50% ' valign='top'>Date</td><td>:</td><td colspan='2' style='font-size:13px;' width='40% ' valign='top'></td></tr>");
                //Html.Append("<tr><td colspan='1' style='font-size:13px; ' width='50% ' valign='top'>Seal No.</td><td>:</td><td colspan='2' style='font-size:13px; ' width='40% ' valign='top'></td></tr>");
                //Html.Append("</tbody></table></td>");
                //Html.Append("<td colspan='6' width='50%' valign='top'><table style='width: 100%; font-family:Verdana,Arial,San-serif; border-collapse:collapse;'><tbody>");
                //Html.Append("<tr><td colspan='1' style='font-size:13px; ' width='50%' valign='top'>Truck out time</td><td>:</td><td colspan='2' style='font-size:13px;' width='40% ' valign='top'></td></tr>");
                //Html.Append("<tr><td colspan='1' style='font-size:13px; ' width='50% ' valign='top'>Date</td><td>:</td><td colspan='2' style='font-size:13px;' width='40% ' valign='top'></td></tr>");
                //Html.Append("<tr><td colspan='1' style='font-size:13px; ' width='50% ' valign='top'>Seal No.</td><td>:</td><td colspan='2' style='font-size:13px;' width='40% ' valign='top'></td></tr>");
                //Html.Append("</tbody></table></td>");
                //Html.Append("</tr>");
                //Html.Append("<tr><td colspan='12'><span><br/><br/></span></td></tr>");
                //Html.Append("<tr><th colspan='6' style='text-align: center; font-size: 13px;'>Signature of Gate I/C</th><th colspan='6' style='text-align: center; font-size: 13px;'>Signature of Gate I/C</th></tr>");
                //Html.Append("</tbody></table>");
                //Html.Append("</td></tr>");
                //Html.Append("</tbody></table>");

            }

            else
            {
                Html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody> <tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td><td width='60%' valign='top' align='center'><h1 style='font-size: 22px; line-height: 30px;margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Government of India Undertaking)</label> </td><td valign='top'><img align='right' src='ISO' width='100'/></td></tr>           <tr><td colspan='12'><table width='100%'><tbody><tr> <th colspan='6' width='50%'><h6 style='margin:0;'>Manager - CFS/The Superintendent(Customs)</h6><h6 style='margin:0;'>Container Freight Station, Kukatpally</h6><h6 style='margin:0;'>IDPL Road, Hyderabad - 37</h6><h6 style='margin:0;'>Email - cwccfs@gmail.com</h6></th> <td colspan='6' width='50%' align='right' style='font-size:12px;'><b>Date:</b>" + DateTime.Now.ToString("dd/MM/yyyy") + "</td> </tr></tbody></table></td></tr>                   <tr><td><span><br/></span></td></tr> <tr><td colspan='3' style='text-align: center;'><h2 style='font-size: 16px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Sub : Request for Seal Cutting of " + hdrCont + " " + CBTContainer + " - Reg.</h2></td></tr> <tr><td colspan='3'><table style='width:100%;'cellspacing='0' cellpadding='0'><tbody><tr><td><p style='font-size:12px; margin-bottom:0;'><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> With reference to the above cited subject kindly arrange the following " + hdrCont + " " + CBTContainer + " for the Customs Examinations for Factory de-stuffing/CFS de-stuffing into godown/direct loading into truck.</p></td></tr><tr><td><table style='margin:5px 0 0; border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='10'><thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width:80px;'>S.No.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 200px;'>" + CBTContainer + " </th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 70px;'>Size</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 150px;'>Seal No.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 150px;'>BL No.</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 250px;'>Name of the importer</th><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 11px; text-align: center; width: 250px;'>Arrival Date</th></tr></thead><tbody>");
                //  foreach (GateEntrySealCutting item in LstSeal)
                // {
                Html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width:80px;'>" + Index + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 200px;'>" + ContainerNo + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 70px;'>" + Size + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 150px;'>" + SealNo + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 150px;'>" + BLNo + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 250px;'>" + Importer + "</td><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 250px;'>" + ArrivalDate + "</td></tr>");
                // Index++;
                // }
                Html.Append("</tbody></table></td></tr></tbody></table><p style='font-size: 13px; margin: 0;'>No Objection for seal cutting & destuffing obtained from IS/liner is enclosed.</p><br/><br/><br/><table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr><td><h6 style='font-size: 13px; margin:0; font-weight: normal;'>Permitted</h6><h3 style='font-size: 15px; margin:0;'>Signature of Customs Official</h3></td><td><h3 style='font-size: 15px; margin:0;font-weight: normal; text-align:right;'>Yours faithfully,</h3></td></tr></tbody></table></td></tr></tbody></table>");
            }

            Html = Html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
            Html = Html.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
            using (var Rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                Rh.HeadOffice = this.HeadOffice;
                Rh.HOAddress = this.HOAddress;
                Rh.ZonalOffice = this.ZonalOffice;
                Rh.ZOAddress = this.ZOAddress;
                Rh.GeneratePDF(Path, Html.ToString());
            }
            return "/Docs/" + Session.SessionID + "/SealCutting" + EntryId + ".pdf";
        }
        #endregion

        #region TDS Report

        [HttpGet]
        public ActionResult TDSReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Kdl_ReportRepository ObjReport = new Kdl_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            List<PartyLedgerList> LstParty = new List<PartyLedgerList>();
            ObjRR.GetEximTraderForPartyLedger();
            if (ObjRR.DBResponse.Data != null)
            {
                ViewBag.PartyList = new SelectList((List<PartyLedgerList>)ObjRR.DBResponse.Data, "PartyId", "PartyName");
            }
            else
            {
                ViewBag.PartyList = null;
            }
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetTDSReport(Dnd_TDSReport ObjTDSReport)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            Dnd_TDSMain LstITDSMain = new Dnd_TDSMain();
            //  Login objLogin = (Login)Session["LoginUser"];
            ObjRR.TdsReport(ObjTDSReport);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstITDSMain = (Dnd_TDSMain)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateTDSReportPDF(FormCollection fc)
        {
            try
            {

                string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "TDSReport.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/TDSReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/TDSReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion

        #region Bulk Receipt  Report
        [HttpGet]
        public ActionResult BulkReceiptReport()
        {
            return PartialView();
        }
        [HttpPost]
        //[ValidateAntiForgeryToken]
        public JsonResult GetBulkReceiptReport(Dnd_BulkReceiptReport ObjBulkReceiptReport)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetBulkCashreceipt(ObjBulkReceiptReport.PeriodFrom, ObjBulkReceiptReport.PeriodTo, ObjBulkReceiptReport.ReceiptNumber);
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                string Path = GenerateBulkReceiptReport(ds);
                return Json(new { Status = 1, Message = Path });
            }
            return Json(new { Status = 0, Message = "No Data Found" });
        }

        [HttpPost]
        //[ValidateAntiForgeryToken]
        public JsonResult GetTDSDepositReport(Dnd_BulkReceiptReport ObjBulkReceiptReport)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetBulkCashreceipt(ObjBulkReceiptReport.PeriodFrom, ObjBulkReceiptReport.PeriodTo, ObjBulkReceiptReport.ReceiptNumber);
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                string Path = GenerateTDSDepositReport(ds);
                return Json(new { Status = 1, Message = Path });
            }
            return Json(new { Status = 0, Message = "No Data Found" });
        }

        [HttpPost]
        //[ValidateAntiForgeryToken]
        public JsonResult GetBulkSDReceiptReport(Dnd_BulkReceiptReport ObjBulkReceiptReport)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetBulkCashreceipt(ObjBulkReceiptReport.PeriodFrom, ObjBulkReceiptReport.PeriodTo, ObjBulkReceiptReport.ReceiptNumber);
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                string Path = GenerateBulkSDReceiptReport(ds);
                return Json(new { Status = 1, Message = Path });
            }
            return Json(new { Status = 0, Message = "No Data Found" });
        }
        [NonAction]
        public string GenerateBulkReceiptReport(DataSet ds)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> objBank = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);



            // List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<dynamic> lstMode = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();

            int i = 0;
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                /*
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Patparganj-Delhi</span>");
                html.Append("</td></tr>");
                html.Append("<tr><td style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Tax Invoice</h2> </td></tr>");
                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Receipt No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Receipt Date : </label> <span>" + item.ReceiptDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                html.Append("<span>" + item.PartyName + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                html.Append("Party Address :</label> <span>" + item.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("</tr></tbody> ");
                html.Append("</table></td></tr><tr><td><hr /></td></tr><tr><th><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>CFS Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>To Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                */
                /*************/
                /*Container Bind*/
                /*
                int i = 1;
                var InvoceIds = item.InvoiceId.Split(',');
                foreach (var InvId in InvoceIds)
                {
                    lstContainer.Where(x => x.InoviceId == Convert.ToInt32(InvId)).ToList().ForEach(elem =>
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.CFSCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ContainerNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.Size + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.FromDate + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ToDate + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                        html.Append("</tr>");
                        i = i + 1;
                    });
                }
                */
                /***************/
                /*
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 60px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                */
                /*Charges Bind*/
                /*
                foreach (var InvId in InvoceIds)
                {
                    lstCharges.Where(y => y.InoviceId == Convert.ToInt32(InvId)).ToList().ForEach(data =>
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Rate.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.CGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.IGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Total.ToString("0") + "</td></tr>");
                        i = i + 1;
                    });
                }
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; width: 120px;'>Total :</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; center; width: 144px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 90px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 160px;'>" + item.TotalTaxable.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 10px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalCGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalSGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalIGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 10px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 120px;'>" + item.InvoiceAmt.ToString("0") + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;' colspan='12'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;'>SAM(A/C)</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("</td></tr></tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Mode</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Drawee Bank</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Instrument No</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Amount</th>");
                html.Append("</tr>");
                html.Append("</thead>");
                html.Append("<tbody>");
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.Amount + "</td>");
                    html.Append("</tr>");
                });
                html.Append("</tbody></table>");
                */
                /***************/



                //Page Header
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");

                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='150%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'>CASH RECEIPT</label>");
                html.Append("</td></tr>");

                //html.Append("<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                //html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br/>");
                //html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Patparganj-Delhi</span>");
                //html.Append("<h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Cash Receipt</h2> </td></tr>");

                //Header
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'><tbody>");

                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='9' width='80%' style='font-size: 13px; line-height: 26px; border-bottom: 1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td colspan='3' width='20%' style='font-size: 13px; line-height: 26px; float:right; border-bottom: 1px solid #000; padding-bottom:5px;'><label style='font-weight: bold;'>Date : </label> <span>" + item.ReceiptDate + "</span></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td><table cellpadding='0' cellspacing='0' style='width:100%;'><tbody><tr>");

                html.Append("<td colspan='6' width='50%' valign='top'>");
                html.Append("<table cellpadding='0' cellspacing='0' style='table-layout: fixed; width:100%; border:1px solid #000; border-bottom:0; border-right:0; font-size:9pt; font-family:Verdana,Arial,San-serif;'><tbody>");
                html.Append("<tr><th cellpadding='10' align='center' colspan='12'>Details Of Service Provider</th></tr>");
                html.Append("</tbody></table>");
                html.Append("<table cellpadding='0' cellspacing='0' style='table-layout: fixed; width:100%; border:1px solid #000; border-right:0; border-bottom:0; font-size:8pt; font-family:Verdana,Arial,San-serif;'><tbody>");
                html.Append("<tr><td cellpadding='10' align='left' colspan='2' width='20%' style='overflow:hidden; word-wrap:break-word; border-right:1px solid #000; border-bottom:1px solid #000;'>Name :</td>");
                html.Append("<td cellpadding='10' align='left' colspan='8' width='80%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000;'>" + objCompany[0].CompanyName + "</td></tr>");
                html.Append("<tr><td cellpadding='10' align='left' colspan='2' width='20%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000; border-right:1px solid #000;'>State :</td>");
                html.Append("<td cellpadding='10' align='left' colspan='8' width='80%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000;'>" + objCompany[0].StateCode + "</td></tr>");
                html.Append("<tr><td cellpadding='10' align='left' colspan='2' width='20%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000; border-right:1px solid #000;'>Gstin no :</td>");
                html.Append("<td cellpadding='10' align='left' colspan='8' width='80%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000;'>" + objCompany[0].GstIn + "</td></tr>");
                html.Append("<tr><td cellpadding='10' align='left' colspan='2' width='20%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000; border-right:1px solid #000;'>Pan No</td>");
                html.Append("<td cellpadding='10' align='left' colspan='8' width='80%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000;'>" + objCompany[0].Pan + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("<td colspan='6' width='50%'>");
                html.Append("<table cellpadding='0' cellspacing='0' style='table-layout: fixed; width:100%; border:1px solid #000; border-bottom:0; font-size:9pt; font-family:Verdana,Arial,San-serif;'><tbody>");
                html.Append("<tr><th cellpadding='10' align='center' colspan='12'>Details Of Service Receiver</th></tr>");
                html.Append("</tbody></table>");
                html.Append("<table cellpadding='0' cellspacing='0' style='table-layout: fixed; width:100%; border:1px solid #000; font-size:8pt; border-bottom:0; font-family:Verdana,Arial,San-serif;'><tbody>");
                html.Append("<tr><td cellpadding='10' align='left' colspan='2' width='20%' style='overflow:hidden; word-wrap:break-word; border-right:1px solid #000; border-bottom:1px solid #000;'>Name :</td>");
                html.Append("<td cellpadding='10' align='left' colspan='8' width='80%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000;'>" + item.PartyName + "</td></tr>");
                html.Append("<tr><td cellpadding='10' align='left' colspan='2' width='20%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000; border-right:1px solid #000;'>Address :</td>");
                html.Append("<td cellpadding='10' align='left' colspan='8' width='80%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000;'>" + item.PartyAddress + "</td></tr>");
                html.Append("<tr><td cellpadding='10' align='left' colspan='2' width='20%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000; border-right:1px solid #000;'>State :</td>");
                html.Append("<td cellpadding='10' align='left' colspan='8' width='80%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000;'>" + item.PartyState + "</td></tr>");
                html.Append("<tr><td cellpadding='10' align='left' colspan='2' width='20%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000; border-right:1px solid #000;'>Gstin No</td>");
                html.Append("<td cellpadding='10' align='left' colspan='8' width='80%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000;'>" + item.PartyGSTNo + "</td></tr>");
                html.Append("<tr><td cellpadding='10' align='left' colspan='2' width='20%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000; border-right:1px solid #000;'>Party Code</td>");
                html.Append("<td cellpadding='10' align='left' colspan='8' width='80%' style='overflow:hidden; word-wrap:break-word; border-bottom:1px solid #000;'>" + item.PartyStateCode + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td>");

                html.Append("</tr></tbody></table></td></tr>");

                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td colspan='7' width='70%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>By : </label><span>" + item.PartyName + "</span></td><td colspan='3' width='30%' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Folio No : </label><span>" + item.PartyCode + "</span></td></tr>");
                html.Append("<tr><td colspan='12' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Address : </label><span>" + item.PartyAddress + "</span></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td><hr/></td></tr>");

                html.Append("<tr><td>");
                //Invoice Nos and Amounts
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:50%;' align='center' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Invoice No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Amount</th>");
                html.Append("</tr></thead><tbody>");

                //Loop
                if (item.InvoiceNo.ToString() != "")
                {
                    var InvoiceIds = item.InvoiceId.Split(',');
                    var InvoiceNos = item.InvoiceNo.Split(',');
                    var InvoiceAmts = item.Amt.Split(',');
                    i = 0;
                    foreach (var Invoice in InvoiceNos)
                    {
                        html.Append("<tr>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceNos[i] + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceAmts[i] + "</td>");
                        html.Append("</tr>");

                        i = i + 1;
                    }
                }


                html.Append("</tbody></table></td></tr>");

                //Banks
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:70%;' align='center' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Mode</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 140px;'>Drawee Bank</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Instrument</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Amount</th>");
                html.Append("</tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 80px;'>No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Date</th>");
                html.Append("</tr></thead><tbody>");

                //loop
                decimal totalpaymentreceiptAmt = 0;
                i = 1;
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Amount + "</td>");
                    html.Append("</tr>");
                    totalpaymentreceiptAmt = totalpaymentreceiptAmt + data.Amount;

                    i = i + 1;

                });

                //TDS
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>TDS</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TdsAmount.ToString() + "</td></tr>");


                //Total
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>Total Payment Receipt Amount</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + totalpaymentreceiptAmt + "</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'>In Words : " + objCurr.changeCurrencyToWords(totalpaymentreceiptAmt.ToString("0")) + "</th></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><td width='10%' valign='top' align='right' style='font-size:13px;'><b>Remarks : </b></td><td colspan='2' width='85%' style='font-size:12px; line-height:22px;'>" + item.Remarks + "</td></tr>");
                //html.Append("<td style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'><b>Remarks : </b> " + item.Remarks + "</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width:100%; margin-bottom:3px;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 9pt; text-align: left; width: 50%; vertical-align: bottom;'>");
                html.Append("<p style='display: block; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px;'>Name Of the Bank:</span>" + objBank[0].BankName + "</p>");
                html.Append("<p style='display: block; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px;'>Branch:</span>" + objBank[0].Branch + "</p>");
                html.Append("<p style='display: block; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px;'>Bank A/c No:</span>" + objBank[0].AccountNo + "</p>");
                html.Append("<p style='display: block; margin:0; font-weight: bold;'><span style='display: inline-block; width: 150px;'>IFS Code:</span>" + objBank[0].IFSC + "</p>");
                html.Append("</td>");
                html.Append("<td style='width: 50%; padding-right: 0; padding-bottom: 0;'>");
                html.Append("<table style='width:100%; font-size: 9pt;' cellspacing='0' cellpadding='0'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='padding: 0 15px; text-align: center;'>");
                html.Append("<p style='text-align: right; margin:0; font-weight: bold;'>For Central Warehousing Corporation.</p>");
                html.Append("<span><br/><br/></span>");
                html.Append("<p style='text-align: right; margin:0;'>Cashier</p>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                //html.Append("<table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr>");
                //html.Append("<th style='width:60%;'></th>");
                //html.Append("<th style='border-top: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>For Central Warehousing Corporation</th>");
                //html.Append("</tr></tbody></table>");

                html.Append("</td></tr></tbody></table>");

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            var type = "bulkreport";
            var id = "BulkReceipt" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
            var fileName = id + ".pdf";
            string PdfDirectory = Server.MapPath("~/Docs") + "/" + type + "/";
            if (!Directory.Exists(PdfDirectory))
                Directory.CreateDirectory(PdfDirectory);
            using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                rh.HeadOffice = "";
                rh.HOAddress = "";
                rh.ZonalOffice = "";
                rh.ZOAddress = "";
                rh.GeneratePDF(PdfDirectory + fileName, lstSB);
            }
            return "/Docs/" + type + "/" + fileName;
        }

        [NonAction]
        public string GenerateTDSDepositReport(DataSet ds)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            // List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstMode = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();

            int i = 0;
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                /*
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Patparganj-Delhi</span>");
                html.Append("</td></tr>");
                html.Append("<tr><td style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Tax Invoice</h2> </td></tr>");
                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Receipt No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Receipt Date : </label> <span>" + item.ReceiptDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                html.Append("<span>" + item.PartyName + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                html.Append("Party Address :</label> <span>" + item.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("</tr></tbody> ");
                html.Append("</table></td></tr><tr><td><hr /></td></tr><tr><th><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>CFS Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>To Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                */
                /*************/
                /*Container Bind*/
                /*
                int i = 1;
                var InvoceIds = item.InvoiceId.Split(',');
                foreach (var InvId in InvoceIds)
                {
                    lstContainer.Where(x => x.InoviceId == Convert.ToInt32(InvId)).ToList().ForEach(elem =>
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.CFSCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ContainerNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.Size + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.FromDate + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ToDate + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                        html.Append("</tr>");
                        i = i + 1;
                    });
                }
                */
                /***************/
                /*
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 60px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                */
                /*Charges Bind*/
                /*
                foreach (var InvId in InvoceIds)
                {
                    lstCharges.Where(y => y.InoviceId == Convert.ToInt32(InvId)).ToList().ForEach(data =>
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Rate.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.CGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.IGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Total.ToString("0") + "</td></tr>");
                        i = i + 1;
                    });
                }
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; width: 120px;'>Total :</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; center; width: 144px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 90px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 160px;'>" + item.TotalTaxable.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 10px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalCGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalSGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalIGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 10px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 120px;'>" + item.InvoiceAmt.ToString("0") + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;' colspan='12'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;'>SAM(A/C)</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("</td></tr></tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Mode</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Drawee Bank</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Instrument No</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Amount</th>");
                html.Append("</tr>");
                html.Append("</thead>");
                html.Append("<tbody>");
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.Amount + "</td>");
                    html.Append("</tr>");
                });
                html.Append("</tbody></table>");
                */
                /***************/



                //Page Header
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");

                html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td width='150%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'>CASH RECEIPT</label>");
                html.Append("</td></tr>");

                //html.Append("<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                //html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br/>");
                //html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Patparganj-Delhi</span>");
                //html.Append("<h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Cash Receipt</h2> </td></tr>");

                //Header
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='9' width='80%' style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td colspan='3' width='20%' style='font-size: 13px; line-height: 26px; float:right;'><label style='font-weight: bold;'>Date : </label> <span>" + item.ReceiptDate + "</span></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>By : </label><span>" + item.PartyName + "</span></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr><tr><td><hr/></td></tr><tr><td>");

                //Invoice Nos and Amounts
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:50%;' align='center' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Invoice No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Amount</th>");
                html.Append("</tr></thead><tbody>");

                //Loop
                if (item.InvoiceNo.ToString() != "")
                {
                    var InvoiceIds = item.InvoiceId.Split(',');
                    var InvoiceNos = item.InvoiceNo.Split(',');
                    var InvoiceAmts = item.Amt.Split(',');
                    i = 0;
                    foreach (var Invoice in InvoiceNos)
                    {
                        html.Append("<tr>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceNos[i] + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceAmts[i] + "</td>");
                        html.Append("</tr>");

                        i = i + 1;
                    }
                }


                html.Append("</tbody></table></td></tr>");

                //Banks
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:70%;' align='center' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Mode</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 140px;'>Drawee Bank</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Certificate No.</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Amount</th>");
                html.Append("</tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 80px;'>No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Date</th>");
                html.Append("</tr></thead><tbody>");

                //loop
                decimal totalpaymentreceiptAmt = 0;
                i = 1;
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Amount + "</td>");
                    html.Append("</tr>");
                    totalpaymentreceiptAmt = totalpaymentreceiptAmt + data.Amount;

                    i = i + 1;

                });

                //TDS
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>TDS</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TdsAmount.ToString() + "</td></tr>");


                //Total
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>Total Payment Receipt Amount</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + totalpaymentreceiptAmt + "</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'>In Words : " + objCurr.changeCurrencyToWords(totalpaymentreceiptAmt.ToString("0")) + "</th></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 80px;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><td width='10%' valign='top' align='right' style='font-size:13px;'><b>Remarks : </b></td><td colspan='2' width='85%' style='font-size:12px; line-height:22px;'>" + item.Remarks + "</td></tr>");
                //html.Append("<td style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'><b>Remarks : </b> " + item.Remarks + "</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr>");
                html.Append("<th style='width:60%;'></th>");
                html.Append("<th style='border-top: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>For Central Warehousing Corporation</th>");
                html.Append("</tr></tbody></table></td></tr></tbody></table>");

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            var type = "bulkreport";
            var id = "BulkReceipt" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
            var fileName = id + ".pdf";
            string PdfDirectory = Server.MapPath("~/Docs") + "/" + type + "/";
            if (!Directory.Exists(PdfDirectory))
                Directory.CreateDirectory(PdfDirectory);
            using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                rh.HeadOffice = "";
                rh.HOAddress = "";
                rh.ZonalOffice = "";
                rh.ZOAddress = "";
                rh.GeneratePDF(PdfDirectory + fileName, lstSB);
            }
            return "/Docs/" + type + "/" + fileName;
        }

        [NonAction]
        public string GenerateBulkSDReceiptReport(DataSet ds)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstMode = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();

            int i = 0;
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                /*
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Patparganj-Delhi</span>");
                html.Append("</td></tr>");
                html.Append("<tr><td style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Tax Invoice</h2> </td></tr>");
                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Receipt No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Receipt Date : </label> <span>" + item.ReceiptDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                html.Append("<span>" + item.PartyName + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                html.Append("Party Address :</label> <span>" + item.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("</tr></tbody> ");
                html.Append("</table></td></tr><tr><td><hr /></td></tr><tr><th><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>CFS Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>To Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                */
                /*************/
                /*Container Bind*/
                /*
                int i = 1;
                var InvoceIds = item.InvoiceId.Split(',');
                foreach (var InvId in InvoceIds)
                {
                    lstContainer.Where(x => x.InoviceId == Convert.ToInt32(InvId)).ToList().ForEach(elem =>
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.CFSCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ContainerNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.Size + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.FromDate + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ToDate + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                        html.Append("</tr>");
                        i = i + 1;
                    });
                }
                */
                /***************/
                /*
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 60px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                */
                /*Charges Bind*/
                /*
                foreach (var InvId in InvoceIds)
                {
                    lstCharges.Where(y => y.InoviceId == Convert.ToInt32(InvId)).ToList().ForEach(data =>
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Rate.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.CGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.IGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Total.ToString("0") + "</td></tr>");
                        i = i + 1;
                    });
                }
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; width: 120px;'>Total :</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; center; width: 144px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 90px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 160px;'>" + item.TotalTaxable.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 10px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalCGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalSGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalIGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 10px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 120px;'>" + item.InvoiceAmt.ToString("0") + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;' colspan='12'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;'>SAM(A/C)</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("</td></tr></tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Mode</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Drawee Bank</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Instrument No</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Amount</th>");
                html.Append("</tr>");
                html.Append("</thead>");
                html.Append("<tbody>");
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.Amount + "</td>");
                    html.Append("</tr>");
                });
                html.Append("</tbody></table>");
                */
                /***************/



                //Page Header
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");

                html.Append("<tr><td colspan='1' width='10%' valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                html.Append("<td colspan='8' width='90%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + objCompany[0].CompanyAddress + "</span>");
                html.Append("<br /><label style='font-size: 14px; font-weight:bold;'>SD RECEIPT</label>");
                html.Append("</td></tr>");

                //html.Append("<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                //html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br/>");
                //html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Patparganj-Delhi</span>");
                //html.Append("<h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Cash Receipt</h2> </td></tr>");

                //Header
                html.Append("<tr><td colspan='12'><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td colspan='9' width='80%' style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td colspan='3' width='20%' style='font-size: 13px; line-height: 26px; float:right;'><label style='font-weight: bold;'>Date : </label> <span>" + item.ReceiptDate + "</span></td>");
                html.Append("</tr>");
                html.Append("<tr><td colspan='12' style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>By : </label><span>" + item.PartyName + "</span></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr><tr><td><hr/></td></tr><tr><td>");

                //Invoice Nos and Amounts
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:50%;' align='center' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Invoice No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Amount</th>");
                html.Append("</tr></thead><tbody>");

                //Loop
                if (item.InvoiceNo.ToString() != "")
                {
                    var InvoiceIds = item.InvoiceId.Split(',');
                    var InvoiceNos = item.InvoiceNo.Split(',');
                    var InvoiceAmts = item.Amt.Split(',');
                    i = 0;
                    foreach (var Invoice in InvoiceNos)
                    {
                        html.Append("<tr>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceNos[i] + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceAmts[i] + "</td>");
                        html.Append("</tr>");

                        i = i + 1;
                    }
                }


                html.Append("</tbody></table></td></tr>");

                //Banks
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:70%;' align='center' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Mode</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 140px;'>Drawee Bank</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Instrument</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Amount</th>");
                html.Append("</tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 80px;'>No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 100px;'>Date</th>");
                html.Append("</tr></thead><tbody>");

                //loop
                decimal totalpaymentreceiptAmt = 0;
                i = 1;
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Amount + "</td>");
                    html.Append("</tr>");
                    totalpaymentreceiptAmt = totalpaymentreceiptAmt + data.Amount;

                    i = i + 1;

                });

                //TDS
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>SD Balance</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TdsAmount.ToString() + "</td></tr>");


                //Total
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>Total Payment Receipt Amount</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + totalpaymentreceiptAmt + "</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'>In Words : " + objCurr.changeCurrencyToWords(totalpaymentreceiptAmt.ToString("0")) + "</th></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 80px;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr><td width='10%' valign='top' align='right' style='font-size:13px;'><b>Remarks : </b></td><td colspan='2' width='85%' style='font-size:12px; line-height:22px;'>" + item.Remarks + "</td></tr>");
                //html.Append("<td style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'><b>Remarks : </b> " + item.Remarks + "</td></tr>");
                html.Append("</tbody></table>");

                html.Append("<table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr>");
                html.Append("<th style='width:60%;'></th>");
                html.Append("<th style='border-top: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>For Central Warehousing Corporation</th>");
                html.Append("</tr></tbody></table></td></tr></tbody></table>");

                html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                lstSB.Add(html.ToString());
            });
            var type = "bulkreport";
            var id = "BulkReceipt" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
            var fileName = id + ".pdf";
            string PdfDirectory = Server.MapPath("~/Docs") + "/" + type + "/";
            if (!Directory.Exists(PdfDirectory))
                Directory.CreateDirectory(PdfDirectory);
            using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                rh.HeadOffice = "";
                rh.HOAddress = "";
                rh.ZonalOffice = "";
                rh.ZOAddress = "";
                rh.GeneratePDF(PdfDirectory + fileName, lstSB);
            }
            return "/Docs/" + type + "/" + fileName;
        }

        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult GetChequeBounceReceiptReport(String ReceiptNo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetChequeBounceCashreceipt(ReceiptNo);
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                string Path = GenerateBulk(ds);
                return Json(new { Status = 1, Message = Path });
            }
            return Json(new { Status = 0, Message = "No Data Found" });
        }


        [NonAction]
        public string GenerateBulk(DataSet ds)
        {
            CurrencyToWordINR objCurr = new CurrencyToWordINR();
            List<dynamic> objCompany = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<dynamic> lstInvoice = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[1]);
            List<dynamic> lstContainer = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[2]);
            List<dynamic> lstCharges = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[3]);
            List<dynamic> lstMode = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[4]);
            List<string> lstSB = new List<string>();

            int i = 0;
            lstInvoice.ToList().ForEach(item =>
            {
                StringBuilder html = new StringBuilder();
                /*Header Part*/
                /*
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                html.Append("<tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br />");
                html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Patparganj-Delhi</span>");
                html.Append("</td></tr>");
                html.Append("<tr><td style='text-align: right;'><span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>");
                html.Append("CWC GST No. <label>" + objCompany[0].GstIn + "</label></span></td></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Tax Invoice</h2> </td></tr>");
                html.Append("<tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'><tbody>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Receipt No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Receipt Date : </label> <span>" + item.ReceiptDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice No.</label> <span>" + item.InvoiceNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Invoice Date : </label> <span>" + item.InvoiceDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Party Name : </label>");
                html.Append("<span>" + item.PartyName + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>State :</label> <span>" + item.PartyState + "</span> </td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>");
                html.Append("Party Address :</label> <span>" + item.PartyAddress + "</span></td><td style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>State Code :</label> <span>" + item.PartyStateCode + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;' colspan='2'><label style='font-weight: bold;'>Party GST :</label> <span>" + item.PartyGSTNo + "</span></td>");
                html.Append("</tr></tbody> ");
                html.Append("</table></td></tr><tr><td><hr /></td></tr><tr><th><b style='text-align: left; font-size: 14px;margin-top: 10px;'>Container Details :</b> </th></tr>");
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:90%;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr><th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>SR No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>CFS Code</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Container No.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Size</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>From Date</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>To Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>Cargo Type</th>");
                html.Append("</tr></thead><tbody>");
                */
                /*************/
                /*Container Bind*/
                /*
                int i = 1;
                var InvoceIds = item.InvoiceId.Split(',');
                foreach (var InvId in InvoceIds)
                {
                    lstContainer.Where(x => x.InoviceId == Convert.ToInt32(InvId)).ToList().ForEach(elem =>
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.CFSCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ContainerNo + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.Size + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.FromDate + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + elem.ToDate + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + (elem.CargoType == 0 ? "" : (elem.CargoType == 1 ? "Haz" : "Non-Haz")) + "</td>");
                        html.Append("</tr>");
                        i = i + 1;
                    });
                }
                */
                /***************/
                /*
                html.Append("</tbody></table></td></tr>");
                html.Append("<tr><th><h3 style='text-align: left; font-size: 14px;margin-top: 20px;'>Container Charges :</h3> </th></tr><tr><td>");
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:100%;' cellspacing='0' cellpadding='5'>");
                html.Append("<thead><tr>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 60px;'>SR No.</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 140px;'>Charge Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'>Description</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>HSN Code</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 80px;'>Rate</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 130px;'>Taxable Amt.</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>CGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>SGST</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 200px;'>IGST</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 100px;'>Total</th></tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Rate</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>Amt.</th></tr></thead>");
                html.Append("<tbody>");
                i = 1;
                */
                /*Charges Bind*/
                /*
                foreach (var InvId in InvoceIds)
                {
                    lstCharges.Where(y => y.InoviceId == Convert.ToInt32(InvId)).ToList().ForEach(data =>
                    {
                        html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + i.ToString() + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.OperationSDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.OperationDesc + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SACCode + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Rate.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Taxable.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.CGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.CGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.SGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.IGSTPer.ToString("0") + "</td>");
                        html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.IGSTAmt.ToString("0") + "</td>");
                        html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Total.ToString("0") + "</td></tr>");
                        i = i + 1;
                    });
                }
                html.Append("</tbody>");
                html.Append("</table>");
                html.Append("</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 10px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: left; width: 120px;'>Total :</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; center; width: 144px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 24%;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 90px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 160px;'>" + item.TotalTaxable.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 10px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalCGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalSGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 210px;'>" + item.TotalIGST.ToString("0") + "</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 10px;'></th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 11px; text-align: right; width: 120px;'>" + item.InvoiceAmt.ToString("0") + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;' colspan='12'>Total Invoice (In Word) : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='7'>Amount of Tax Subject of Reverse : 0</th>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;'>Receipt No.: <label style='font-weight: bold;'></label></td>");
                html.Append("<td style='font-size: 12px; text-align: left; line-height: 30px;'>Party Code: <label style='font-weight: bold;'>" + item.PartyCode.ToString() + "</label></td>");
                html.Append("</tr>");
                html.Append("<tr>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;'>*Cheques are subject to realisation</td>");
                html.Append("<td style='font-size: 11px; text-align: left; line-height: 30px;'>SAM(A/C)</td>");
                html.Append("</tr>");
                html.Append("</tbody>");
                html.Append("</table>");

                html.Append("</td></tr></tbody>");
                html.Append("</table>");

                html.Append("<table style='width:100%; border: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<thead>");
                html.Append("<tr>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Mode</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Drawee Bank</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Instrument No</th>");
                html.Append("<th style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Date</th>");
                html.Append("<th style='border-bottom: 1px solid #000; font-size: 12px; text-align: left; padding: 5px;'>Amount</th>");
                html.Append("</tr>");
                html.Append("</thead>");
                html.Append("<tbody>");
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; border-right: 1px solid #000; font-size: 12px; text-align: left; line-height: 15px;'>" + data.Amount + "</td>");
                    html.Append("</tr>");
                });
                html.Append("</tbody></table>");
                */
                /***************/



                //Page Header
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '>");
                html.Append("<tbody><tr><td style='text-align: center;'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>" + objCompany[0].CompanyName + "</h1>");
                html.Append("<label style='display: block; font-size: 13px; line-height: 22px;'>(A Govt. of India Undertaking) </label><br/>");
                html.Append("<span style='display: block; font-size: 13px; line-height: 22px; text-transform: uppercase; padding-bottom: 10px;'>ICD Patparganj-Delhi</span>");
                html.Append("<h2 style='font-size: 18px; padding-bottom: 10px; text-align: center;margin: 0; padding: 0;'>Cash Receipt</h2> </td></tr>");

                //Header
                html.Append("<tr><td><table style=' border: 1px solid #000; padding: 10px; width:100%; margin-bottom: 10px;'cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td><table style='width:100%; margin-bottom: 10px;' cellspacing='0' cellpadding='5'>");
                html.Append("<tbody><tr><td style='font-size: 13px; line-height: 26px;'>");
                html.Append("<label style='font-weight: bold;'>No.</label> <span>" + item.ReceiptNo + "</span></td>");
                html.Append("<td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>Date : </label> <span>" + item.ReceiptDate + "</span></td></tr>");
                html.Append("<tr><td style='font-size: 13px; line-height: 26px;'><label style='font-weight: bold;'>By : </label><span>" + item.PartyName + "</span></td></tr></tbody></table>");
                html.Append("</td></tr><tr><td><hr/></td></tr><tr><td>");

                //Invoice Nos and Amounts
                html.Append("<table style=' border: 1px solid #000; border-bottom: 0; width:50%;' align='center' cellspacing='0' cellpadding='10'>");
                html.Append("<thead><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Invoice No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>Amount</th>");
                html.Append("</tr></thead><tbody>");

                //Loop
                var InvoiceIds = item.InvoiceId.Split(',');
                var InvoiceNos = item.InvoiceNo.Split(',');
                var InvoiceAmts = item.Amt.Split(',');
                i = 0;
                foreach (var Invoice in InvoiceNos)
                {
                    html.Append("<tr>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceNos[i] + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center;'>" + InvoiceAmts[i] + "</td>");
                    html.Append("</tr>");

                    i = i + 1;
                }

                html.Append("</tbody></table></td></tr>");

                //Banks
                html.Append("<tr><td><table style=' border: 1px solid #000; border-bottom: 0; width:70%;' align='center' cellspacing='0' cellpadding='5'>");
                html.Append("<thead>");
                html.Append("<tr><th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Mode</th>");
                html.Append("<th rowspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 140px;'>Drawee Bank</th>");
                html.Append("<th colspan='2' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 60px;'>Instrument</th>");
                html.Append("<th rowspan='2' style='border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Amount</th>");
                html.Append("</tr><tr>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>No</th>");
                html.Append("<th style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: center; width: 50px;'>Date</th>");
                html.Append("</tr></thead><tbody>");

                //loop

                i = 1;
                lstMode.Where(z => z.CashReceiptId == item.CashReceiptId).ToList().ForEach(data =>
                {
                    html.Append("<tr><td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.PayMode + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.DraweeBank + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.InstrumentNo + "</td>");
                    html.Append("<td style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Date + "</td>");
                    html.Append("<td style='border-bottom: 1px solid #000; font-size: 10px; text-align: center;'>" + data.Amount + "</td>");
                    html.Append("</tr>");

                    i = i + 1;
                });

                //TDS
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>TDS</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.TdsAmount.ToString() + "</td></tr>");


                //Total
                html.Append("<tr>");
                html.Append("<td colspan='4' style='border-right: 1px solid #000; border-bottom: 1px solid #000; font-size: 12px; text-align: right; font-weight: bold;'>Total</td>");
                html.Append("<td colspan='1' style='border-bottom: 1px solid #000; font-size: 10px; text-align: center; width: 50px;'>" + item.InvoiceAmt.ToString() + "</td></tr></tbody></table>");
                html.Append("</td></tr></tbody></table>");
                html.Append("<table style='border-top: 1px solid #000; border-left: 1px solid #000; width: 100%; margin-bottom: 80px; border-right: 1px solid #000; border-bottom: 1px solid #000;' cellspacing='0' cellpadding='10'>");
                html.Append("<tbody><tr>");
                html.Append("<th style='font-size: 12px; text-align: left; padding: 5px;' colspan='12'>In Words : " + objCurr.changeCurrencyToWords(item.InvoiceAmt.ToString("0")) + "</th></tr>");
                html.Append("</tbody></table>");
                html.Append("<table style='width: 100%; margin-bottom: 10px;' cellspacing='0' cellpadding='10'><tbody><tr>");
                html.Append("<th style='width:60%;'></th>");
                html.Append("<th style='border-top: 1px solid #000; font-size: 12px; text-align: center; padding: 5px;'>For Central Warehousing Corporation</th>");
                html.Append("</tr></tbody></table></td></tr></tbody></table>");


                lstSB.Add(html.ToString());
            });
            var type = "bulkreport";
            var id = "BulkReceipt" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
            var fileName = id + ".pdf";
            string PdfDirectory = Server.MapPath("~/Docs") + "/" + type + "/";
            if (!Directory.Exists(PdfDirectory))
                Directory.CreateDirectory(PdfDirectory);
            using (var rh = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                rh.HeadOffice = "";
                rh.HOAddress = "";
                rh.ZonalOffice = "";
                rh.ZOAddress = "";
                rh.GeneratePDF(PdfDirectory + fileName, lstSB);
            }
            return "/Docs/" + type + "/" + fileName;
        }
        [HttpGet]
        [CustomValidateAntiForgeryToken]
        public ActionResult ListOfReceiptDateWise(string FromDate, string ToDate)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetReceiptList(FromDate, ToDate);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }
        #endregion

        #region MonthlyCashBookReport

        //same model used for daily and monthly cashbook in patparganj

        /*Invoice Report Detai;s Section-06.11.2017*/
        [HttpGet]
        public ActionResult MonthlyCashBookReport()
        {
            //Login ObjLogin = (Login)Session["LoginUser"];
            //ViewBag.DistList = null;
            //Ppg_ReportRepository ObjReport = new Ppg_ReportRepository();
            //ObjReport.GetDistricts(ObjLogin.Uid);
            //if (ObjReport.DBResponse.Data != null)
            //{
            //    var JObj = JObject.Parse(JsonConvert.SerializeObject(ObjReport.DBResponse.Data));
            //    ViewBag.DistList = new SelectList(JObj["Dist"], "DistrictId", "DistrictName");
            //}

            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetMonthlyCashBookReport(DailyCashBookPpg ObjMonthlyCashBook)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            List<Dnd_DailyCashbook> LstMonthlyCashBook = new List<Dnd_DailyCashbook>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.MonthlyCashBook(ObjMonthlyCashBook);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstMonthlyCashBook = (List<Dnd_DailyCashbook>)ObjRR.DBResponse.Data;
                LstMonthlyCashBook.Add(new Dnd_DailyCashbook()
                {
                    ReceiptDate = "<strong>Total</strong>",

                    //    GenSpace = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.GenSpace)).ToString(),
                    //    StorageCharge = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.StorageCharge)).ToString(),
                    //    Insurance = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Insurance)).ToString(),
                    //    GroundRentEmpty = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.GroundRentEmpty)).ToString(),
                    //    GroundRentLoaded = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.GroundRentLoaded)).ToString(),
                    //    MfCharge = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.MfCharge)).ToString(),
                    //    EntryCharge = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.EntryCharge)).ToString(),
                    //    Fumigation = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Fumigation)).ToString(),
                    //    OtherCharge = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.OtherCharge)).ToString(),
                    //    Cgst = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Cgst)).ToString(),
                    //    Sgst = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Sgst)).ToString(),
                    //    Igst = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Igst)).ToString(),
                    //    Misc = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Misc)).ToString(),
                    //    MiscExcess = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.MiscExcess)).ToString(),
                    //    TotalCash = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalCash)).ToString(),
                    //    TotalCheque = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalCheque)).ToString(),
                    //    TotalOthers = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalOthers)).ToString(),
                    //    TotalPDA = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.TotalPDA)).ToString(),
                    //    Tds = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.Tds)).ToString(),
                    //    CrTds = LstMonthlyCashBook.ToList().Sum(o => Convert.ToDecimal(o.CrTds)).ToString()
                    Sr = "Total",
                    ReceiptNo = "",
                    // ReceiptDate = "",
                    PartyName = "",
                    ModeOfPay = "",
                    ENT = LstMonthlyCashBook.Sum(x => x.ENT),
                    GRE = LstMonthlyCashBook.Sum(x => x.GRE),
                    GRL = LstMonthlyCashBook.Sum(x => x.GRL),
                    Reefer = LstMonthlyCashBook.Sum(x => x.Reefer),
                    Monitoring = LstMonthlyCashBook.Sum(x => x.Monitoring),
                    STO = LstMonthlyCashBook.Sum(x => x.STO),
                    INS = LstMonthlyCashBook.Sum(x => x.INS),
                    WHT = LstMonthlyCashBook.Sum(x => x.WHT),
                    OTH = LstMonthlyCashBook.Sum(x => x.OTH),
                    HT = LstMonthlyCashBook.Sum(x => x.HT),
                    IGST = LstMonthlyCashBook.Sum(x => x.IGST),
                    CGST = LstMonthlyCashBook.Sum(x => x.CGST),
                    SGST = LstMonthlyCashBook.Sum(x => x.SGST),
                    RoundUp = LstMonthlyCashBook.Sum(x => x.RoundUp),
                    CHQNo = "",
                    TotalCASH = LstMonthlyCashBook.Sum(x => x.TotalCASH),
                    TotalCHQ = LstMonthlyCashBook.Sum(x => x.TotalCHQ),
                    Others = LstMonthlyCashBook.Sum(x => x.Others),
                    TotalPDA = LstMonthlyCashBook.Sum(x => x.TotalPDA),
                    Tds = LstMonthlyCashBook.Sum(x => x.Tds),
                    CrTds = LstMonthlyCashBook.Sum(x => x.CrTds),
                    Remarks = ""
                });
                ObjRR.DBResponse.Data = LstMonthlyCashBook;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateMonthlyCashBookPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "MonthlyCashBookReport.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/MonthlyCashBookReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/MonthlyCashBookReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion

        #region Job Order by Road Print
        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult JobOrderPrint(int JobOrderId)
        {
            Dnd_ImportRepository objIR = new Dnd_ImportRepository();
            objIR.JobOrderPrintDetails(JobOrderId);
            string Path = "";
            int Status = 0;
            if (objIR.DBResponse.Data != null)
            {
                Dnd_JobOrderPrint lstPV = new Dnd_JobOrderPrint();
                lstPV = (Dnd_JobOrderPrint)objIR.DBResponse.Data;
                Path = JobOrderBind(lstPV, JobOrderId);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
                //  Status = 1;
                // Path = JobOrderBind(lstPV, JobOrderId);
                //return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
            //    Status = 1;
            //    Path = JobOrderBind((List<dynamic>)objIR.DBResponse.Data, JobOrderId);
            //}
            //return Json(new { Message = Path, Status = Status });
        }

        [NonAction]
        public string JobOrderBind(Dnd_JobOrderPrint lstPV, int JobOrderId)
        {
            StringBuilder sb = new StringBuilder();
            sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
            //sb.Append("<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>ICD Patparganj-Delhi</label><br/><label style='font-size: 14px; font-weight:bold;'>JOB ORDER</label></td></tr>");

            sb.Append("<tr><td colspan='12'>");
            sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            sb.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
            sb.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>" + lstPV.mstcompany + "</span><br/><label style='font-size: 14px; font-weight:bold;'>JOB ORDER</label></td></tr>");
            sb.Append("</tbody></table>");
            sb.Append("</td></tr>");
            int i = 1; int total20; int total40; int total45; total20 = 0; string FormOneDate = "";
            total40 = 0;
            total45 = 0;
            lstPV.LstTotal.Select(x => new { FormOneDate = x.FormOneDate }).Distinct().ToList().ForEach(item =>
            {
                if (FormOneDate == "")
                    FormOneDate = item.FormOneDate;
                else
                    FormOneDate += "," + item.FormOneDate;
            });
            sb.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-size:8pt; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
            sb.Append("<tr><td width='50%'> <b>To</b> <br/> <b>The Sr. Manager(OPERATIONS)</b> <br/> JNPT, SHEVA, Navi Mumbai - 400707 </td>");
            sb.Append("<td width='50%' style='text-align:right;'>" + FormOneDate + "</td></tr></tbody></table></td></tr>");
            sb.Append("<tr><td colspan='12' style='font-size:8pt;'>Sir,</td></tr>");
            sb.Append("<tr><td colspan='12' style='font-size:8pt;'>You are requested to kindly arrange to deliver the following IMPORT containers to CWC CFS Dronagiri Node, Navi Mumbai</td></tr>");
            sb.Append("<tr><td colspan='12'>");
            sb.Append("<table style='border:1px solid #000;width:100%;text-align:center;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            sb.Append("<thead>");
            sb.Append("<tr>");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>Sr No.</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>Job No.</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>Container/CBT No.</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>Size</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>SA CODE</th>");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>Vessel Name</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>Via</th> ");
            sb.Append("<th style='text-align:center;padding:10px;'>F/L</th> ");
            // sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Via No</th> ");
            sb.Append("</tr>");
            sb.Append("</thead>");
            sb.Append("<tbody>");

            lstPV.LstTotal.ForEach(item =>
            {
                sb.Append("<tr>");
                sb.Append("<td style='border-top:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                sb.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;padding:10px;'>" + item.FormOneNo + "</td>");
                sb.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;padding:10px;'>" + item.ContainerNo + "</td>");
                sb.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;padding:10px;'>" + item.ContainerSize + "</td> ");
                sb.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;padding:10px;'>" + item.ShippingLineName + "</td> ");
                sb.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;padding:10px;'>" + item.VesselName + "</td> ");
                sb.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;padding:10px;'>" + item.ViaNo + "</td> ");
                sb.Append("<td style='border-top:1px solid #000;padding:10px;'>" + item.LCLFCL + "</td> ");
                //sb.Append("<td style='text-align:center;border-right:1px solid #000;padding:10px;'>" + item.ViaN + "</td> ");
                sb.Append("</tr>");
                if (item.ContainerSize.Equals("20"))
                {
                    total20 = total20 + 1;
                }
                else if (item.ContainerSize.Equals("40"))
                {
                    total40 = total40 + 1;
                }
                else if (item.ContainerSize.Equals("45"))
                {
                    total45 = total45 + 1;
                }
                i++;
            });
            sb.Append("</tbody>");
            sb.Append("</table>");
            sb.Append("</td></tr>");

            sb.Append("<tr><th width='10%' valign='top' align='right' style='font-size:8pt;'>NOTE :</th><td colspan='2' width='75%' style='font-size:7pt; line-height:22px;'>THE FOLLOWING CONTAINERS ARE REQUESTED TO BE SCANNED BEFORE ITS DELIVERY FROM THE PORT AS DESIRED BY THE CUSTOM SCANNING DIVISION.</td></tr>");
            sb.Append("<tr><td colspan='12' style='font-size:8pt;'>Copy to,</td></tr>");
            sb.Append("<tr><td colspan='12' width='90%' style='font-size:8pt;'><span>&nbsp;&nbsp;&nbsp;&nbsp;</span> M/S Yash Forklift Hiring Services-for arranging movement of the containers from JNPT/NSICT/GTI/JNPCT/NSIGT with in three days</td></tr>");
            sb.Append("<tr><td colspan='12' width='90%' style='font-size:8pt;'><span>&nbsp;&nbsp;&nbsp;&nbsp;</span> Following which dwell time charges as per procedure will be debited to your account as per claim receive from line.</td></tr>");
            sb.Append("<tr><td colspan='12' width='90%' style='font-size:8pt;'><span>&nbsp;&nbsp;&nbsp;&nbsp;</span> The Preventive Officer,Customs,CT Gate,JNPT</td></tr>");
            sb.Append("<tr><td colspan='12' width='90%' style='font-size:8pt;'><span>&nbsp;&nbsp;&nbsp;&nbsp;</span> The Preventive Officer,Customs,CWC Dronagiri Node</td></tr>");
            sb.Append("</tbody></table>");


            sb = sb.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID;
            string FileName = "JobOrderByRoad" + JobOrderId + ".pdf";
            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }
            using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                ObjPdf.HeadOffice = this.HeadOffice;
                ObjPdf.HOAddress = this.HOAddress;
                ObjPdf.ZonalOffice = this.ZonalOffice;
                ObjPdf.ZOAddress = this.ZOAddress;
                ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, sb.ToString());

            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        #region SBill Query
        [HttpGet]
        public ActionResult SBQuery()
        {
            var ObjRR = new Dnd_ReportRepository();
            ObjRR.GetAllSB();

            if (ObjRR.DBResponse.Data != null)
            {
                ViewBag.ListOfSB = new SelectList((List<DND_SBQuery>)ObjRR.DBResponse.Data, "Id", "SBNO");
            }
            return PartialView();
        }

        // [HttpPost, ValidateAntiForgeryToken]
        public JsonResult GetApplicationDetForSBQuery(string Id, string sbno)
        {
            int id = Convert.ToInt32(Id);
            string SBNO = Convert.ToString(sbno);
            DND_SBQuery objCR = new DND_SBQuery();
            Dnd_ReportRepository objRR = new Dnd_ReportRepository();
            objRR.SBQueryReport(id, SBNO);
            if (objRR.DBResponse.Data != null)
            {
                objCR = (DND_SBQuery)objRR.DBResponse.Data;
                return Json(objCR, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(new { Status = -1, Message = "No Data" });
            }
        }


        #endregion

        #region Track Your Container
        [HttpGet]
        public ActionResult LoadContainerStatusForPpg()
        {
            /*bool ShippingLine;*/
            //ContainerStatus ObjContainer = new ContainerStatus();
            //ReportRepository ObjRR = new ReportRepository();
            // ExportRepository ObjER = new ExportRepository();
            /*ShippingLine = ((Login)Session["LoginUser"]).ShippingLine;
             if(ShippingLine == true)
            {
                ObjContainer.ShippingLineName = ((Login)Session["LoginUser"]).Name;
                ObjContainer.ShippingLineId = ((Login)Session["LoginUser"]).EximTraderId;
                List<ShippingLineList> LstShippingLine = new List<ShippingLineList>();
                LstShippingLine.Add(new ShippingLineList
                {
                    ShippingLineName = ((Login)Session["LoginUser"]).Name,
                    ShippingLineId = ((Login)Session["LoginUser"]).EximTraderId
                });
                ViewBag.ShippingLineList = new SelectList(LstShippingLine, "ShippingLineId", "ShippingLineName");
                ObjRR.GetContainerNoForContStatus(ObjContainer.ShippingLineId);
                if (ObjRR.DBResponse.Data != null)
                    ViewBag.ContainerList = new SelectList((List<ContainerList>)ObjRR.DBResponse.Data, "ContainerNo", "ContainerNo");
                else
                    ViewBag.ContainerList = null;
            }
            else
            {*/
            //ViewBag.ContainerList = null;
            //    ObjER.GetShippingLine();
            //    if (ObjER.DBResponse.Data != null)
            //        ViewBag.ShippingLineList = new SelectList((List<Areas.Export.Models.ShippingLine>)ObjER.DBResponse.Data, "ShippingLineId", "ShippingLineName");
            //    else
            //        ViewBag.ShippingLineList = null;
            /*}*/

            return PartialView(/*ObjContainer*/);
        }

        [HttpGet]
        public ActionResult LoadContainerStatus()
        {

            Dnd_ReportRepository ObjER = new Dnd_ReportRepository();

            ViewBag.ContainerList = null;
            ObjER.GetShippingLine();
            if (ObjER.DBResponse.Data != null)
                ViewBag.ShippingLineList = new SelectList((List<Areas.Report.Models.DND_ShippingLineList>)ObjER.DBResponse.Data, "ShippingLineId", "ShippingLineName");
            else
                ViewBag.ShippingLineList = null;

            ObjER.GetContainerForContTracking("");
            if (ObjER.DBResponse.Data != null)
                ViewBag.ContainerList = new SelectList((List<DND_TrackContainer>)ObjER.DBResponse.Data, "ContainerNo", "ContainerNo");
            else
                ViewBag.ContainerList = null;


            return PartialView();
        }


        [HttpGet]
        public JsonResult GetContainerNoListForPpg()
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetContainerNoForTrackContStatus();
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpGet]
        public JsonResult GetContWiseICDList(string ContainerNo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetContWiseICDList(ContainerNo);
            if (ObjRR.DBResponse.Status > 0)
            {
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(null, JsonRequestBehavior.AllowGet);
            }
        }

        [HttpGet]
        public JsonResult GetContWiseLatestICD(string ContainerNo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetContWiseLatestICD(ContainerNo);
            if (ObjRR.DBResponse.Status > 0)
            {
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(null, JsonRequestBehavior.AllowGet);
            }
        }


        [HttpGet]
        public JsonResult GetContainerStatusDetailForPpg(string ICDCode)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetContainerDetForTrackContStatus(ICDCode);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpGet]
        public JsonResult GetContainerNoList(int ShippingLineId)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetContainerNoForContStatus(ShippingLineId);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpGet]
        public JsonResult GetContainerStatusDetail(int ShippingLineId, string ContainerNo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            if (ShippingLineId != 0)
            {
                ObjRR.GetContainerDetForContStatus(ShippingLineId, ContainerNo);
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
            else
            {
                ObjRR.GetContainerDetForContTracking(ContainerNo);
                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
            }
        }

        #endregion

        #region Total Container Report
        [HttpGet]
        public ActionResult TotalContainerReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetTotalContainerReportPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.TotalContainerReportPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFTotalContainer(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFTotalContainer(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "TotalContainerInReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Total Container In Report</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:15%;'>In Date & Time</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>S/Line</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Origin</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Status</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container Class</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Vehicle No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Remarks</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Out Date</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1; int total20; int total40; int total45; int emptytotal20; int emptytotal40; int emptytotal45; int total; int loadedtotal20;
                int loadedtotal40; int loadedtotal45; int hubtotal20;
                int hubtotal40; int hubtotal45;

                total20 = 0;
                total40 = 0;
                total45 = 0;
                emptytotal20 = 0;
                emptytotal40 = 0;
                emptytotal45 = 0;
                loadedtotal20 = 0;
                loadedtotal40 = 0;
                loadedtotal45 = 0;
                hubtotal20 = 0;
                hubtotal40 = 0;
                hubtotal45 = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Status + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContClass + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.VehicleNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Remarks + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.OutDate + "</td>");
                    Pages.Append("</tr>");


                    if (item.Status.Equals("E"))
                    {
                        if (item.Size.Equals("20"))
                        {
                            emptytotal20 = emptytotal20 + 1;
                        }
                        else if (item.Size.Equals("40"))
                        {
                            emptytotal40 = emptytotal40 + 1;
                        }
                        else if (item.Size.Equals("45"))
                        {
                            emptytotal45 = emptytotal45 + 1;
                        }
                    }
                    if (item.Size.Equals("20"))
                    {
                        total20 = total20 + 1;
                    }
                    else if (item.Size.Equals("40"))
                    {
                        total40 = total40 + 1;
                    }
                    else if (item.Size.Equals("45"))
                    {
                        total45 = total45 + 1;
                    }
                    if (item.Status.Equals("L"))
                    {
                        if (item.Size.Equals("20"))
                        {
                            loadedtotal20 = loadedtotal20 + 1;
                        }
                        else if (item.Size.Equals("40"))
                        {
                            loadedtotal40 = loadedtotal40 + 1;
                        }
                        else if (item.Size.Equals("45"))
                        {
                            loadedtotal45 = loadedtotal45 + 1;
                        }
                    }
                    if (item.ContainerType.Equals("H"))
                    {
                        if (item.Size.Equals("20"))
                        {
                            hubtotal20 = hubtotal20 + 1;
                        }
                        else if (item.Size.Equals("40"))
                        {
                            hubtotal40 = hubtotal40 + 1;
                        }
                        else if (item.Size.Equals("45"))
                        {
                            hubtotal45 = hubtotal45 + 1;
                        }
                    }
                    //if (item.POL.Equals("GTIL"))
                    //{
                    //    if (item.ContainerSize.Equals("20"))
                    //    {
                    //        GTIL20 = GTIL20 + 1;
                    //    }
                    //    else
                    //    {
                    //        GTIL40 = GTIL40 + 1;
                    //    }
                    //}

                    //if (item.POL.Equals("NSICT"))
                    //{
                    //    if (item.ContainerSize.Equals("20"))
                    //    {
                    //        NSICT20 = NSICT20 + 1;
                    //    }
                    //    else
                    //    {
                    //        NSICT40 = NSICT40 + 1;
                    //    }
                    //}

                    //if (item.POL.Equals("MND"))
                    //{
                    //    if (item.ContainerSize.Equals("20"))
                    //    {
                    //        MND20 = MND20 + 1;
                    //    }
                    //    else
                    //    {
                    //        MND40 = MND40 + 1;
                    //    }
                    //}

                    //if (item.POL.Equals("PBR"))
                    //{
                    //    if (item.ContainerSize.Equals("20"))
                    //    {
                    //        PBR20 = PBR20 + 1;
                    //    }
                    //    else
                    //    {
                    //        PBR40 = PBR40 + 1;
                    //    }
                    //}
                    i++;
                });
                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                emptytotal20 = emptytotal20;
                emptytotal40 = emptytotal40;
                emptytotal45 = emptytotal45;
                loadedtotal20 = loadedtotal20;
                loadedtotal40 = loadedtotal40;
                loadedtotal45 = loadedtotal45;
                hubtotal20 = hubtotal20;
                hubtotal40 = hubtotal40;
                hubtotal45 = hubtotal45;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; text-align: center; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 300px;'>Total</th>");
                Pages.Append("<th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 300px;'>Empty In</th>");
                Pages.Append("<th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 300px;'>Loaded In</th>");
                Pages.Append("<th colspan='3' style='border-bottom: 1px solid #000; width: 300px;'>Hub In</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>45 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>45 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>45 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='width: 100px;'>45 FT</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + emptytotal20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + emptytotal40 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + emptytotal45 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + loadedtotal20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + loadedtotal40 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + loadedtotal45 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + hubtotal20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + hubtotal40 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'> " + hubtotal45 + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 30f, 30f, 30f, 30f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Total Container Loaded Report
        [HttpGet]
        public ActionResult TotalContainerLoadedReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetTotalContainerLoadedReportPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.TotalLoadedReportPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFTotalLoadedContainer(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFTotalLoadedContainer(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "LoadedContainerInReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Loaded Container In Register</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>In Date & Time</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>S/Line</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Origin</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Status</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container Class</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Vehicle No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:13%;'>Remarks</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Out Date</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1; int total20; int total40; int total45; int emptytotal20; int emptytotal40; int emptytotal45; int total; int loadedtotal20;
                int loadedtotal40; int loadedtotal45; int hubtotal20;
                int hubtotal40; int hubtotal45;

                total20 = 0;
                total40 = 0;
                total45 = 0;
                emptytotal20 = 0;
                emptytotal40 = 0;
                emptytotal45 = 0;
                loadedtotal20 = 0;
                loadedtotal40 = 0;
                loadedtotal45 = 0;
                hubtotal20 = 0;
                hubtotal40 = 0;
                hubtotal45 = 0;

                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Status + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContClass + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.VehicleNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Remarks + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.OutDate + "</td>");
                    Pages.Append("</tr>");
                    if (item.Status.Equals("L"))
                    {
                        if (item.Size.Equals("20"))
                        {
                            loadedtotal20 = loadedtotal20 + 1;
                        }
                        else if (item.Size.Equals("40"))
                        {
                            loadedtotal40 = loadedtotal40 + 1;
                        }
                        else if (item.Size.Equals("45"))
                        {
                            loadedtotal45 = loadedtotal45 + 1;
                        }
                    }
                    i++;

                });
                loadedtotal20 = loadedtotal20;
                loadedtotal40 = loadedtotal40;
                loadedtotal45 = loadedtotal45;
                total = loadedtotal20 + loadedtotal40 + loadedtotal45;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='width: 100px;'>45 FT</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + loadedtotal20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + loadedtotal40 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + loadedtotal45 + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Total Container Empty Report
        [HttpGet]
        public ActionResult TotalContainerEmptyReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetTotalContainerEmptyReportPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.TotalEmptyContainerReportPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFTotalEmptyContainer(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFTotalEmptyContainer(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "EmptyContainerInReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Empty Container In Report</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>In Date & Time</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>S/Line</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Origin</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Status</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container Class</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Vehicle No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:13%;'>Remarks</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Out Date</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1; int total20; int total40; int total45; int emptytotal20; int emptytotal40; int emptytotal45; int total; int loadedtotal20;
                int loadedtotal40; int loadedtotal45; int hubtotal20;
                int hubtotal40; int hubtotal45;

                total20 = 0;
                total40 = 0;
                total45 = 0;
                emptytotal20 = 0;
                emptytotal40 = 0;
                emptytotal45 = 0;
                loadedtotal20 = 0;
                loadedtotal40 = 0;
                loadedtotal45 = 0;
                hubtotal20 = 0;
                hubtotal40 = 0;
                hubtotal45 = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Status + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContClass + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.VehicleNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Remarks + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.OutDate + "</td>");
                    Pages.Append("</tr>");

                    if (item.Status.Equals("E"))
                    {
                        if (item.Size.Equals("20"))
                        {
                            emptytotal20 = emptytotal20 + 1;
                        }
                        else if (item.Size.Equals("40"))
                        {
                            emptytotal40 = emptytotal40 + 1;
                        }
                        else if (item.Size.Equals("45"))
                        {
                            emptytotal45 = emptytotal45 + 1;
                        }
                    }
                    i++;
                });
                emptytotal20 = emptytotal20;
                emptytotal40 = emptytotal40;
                emptytotal45 = emptytotal45;
                total = emptytotal20 + emptytotal40 + emptytotal45;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='width: 100px;'>45 FT</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + emptytotal20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + emptytotal40 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + emptytotal45 + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Total Container Hub Report
        [HttpGet]
        public ActionResult TotalContainerHubReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetTotalContainerHubReportPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.TotalHubReportPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFTotalHubContainer(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }


            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFTotalHubContainer(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "HubContainerInReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>LCL Hub Container In Register</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>In Date & Time</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>S/Line</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Origin</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Status</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container Class</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Vehicle No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Remarks</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Out Date</th></tr></thead>");
                Pages.Append("<tbody>");
                //int i = 1; int total20; int total40;
                //total20 = 0;
                //total40 = 0;
                int i = 1; int total20; int total40; int total45; int emptytotal20; int emptytotal40; int emptytotal45; int total; int loadedtotal20;
                int loadedtotal40; int loadedtotal45; int hubtotal20; int tues;
                int hubtotal40; int hubtotal45;

                total20 = 0;
                total40 = 0;
                total45 = 0;
                emptytotal20 = 0;
                emptytotal40 = 0;
                emptytotal45 = 0;
                loadedtotal20 = 0;
                loadedtotal40 = 0;
                loadedtotal45 = 0;
                hubtotal20 = 0;
                hubtotal40 = 0;
                hubtotal45 = 0;
                tues = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Status + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContClass + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.VehicleNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Remarks + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.OutDate + "</td>");
                    Pages.Append("</tr>");
                    if (item.ContainerType.Equals("H"))
                    {
                        if (item.Size.Equals("20"))
                        {
                            hubtotal20 = hubtotal20 + 1;
                        }
                        else if (item.Size.Equals("40"))
                        {
                            hubtotal40 = hubtotal40 + 1;
                        }
                        else if (item.Size.Equals("45"))
                        {
                            hubtotal45 = hubtotal45 + 1;
                        }
                    }
                    i++;

                });
                hubtotal20 = hubtotal20;
                hubtotal40 = hubtotal40;
                hubtotal45 = hubtotal45;
                total = hubtotal20 + hubtotal40 + hubtotal45;
                tues = hubtotal20 + hubtotal40 * 2 + hubtotal45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='11' style='font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='0' style='width:100%; border-collapse:collapse; margin-top:20px;'><tbody>");
                Pages.Append("<tr>");
                Pages.Append("<td colspan='4' width='40%'><table cellspacing='0' cellpadding='5' style='text-align: center; width:100%; border:1px solid #000; font-size:7pt;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='width: 100px;'>45 FT</th></tr>");
                Pages.Append("</thead>");
                Pages.Append("<tbody>");
                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + hubtotal20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + hubtotal40 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + hubtotal45 + "</td></tr>");
                Pages.Append("</tbody>");
                Pages.Append("</table></td>");

                Pages.Append("<td colspan='2' width='10%'></td>");

                Pages.Append("<td colspan='6' width='50%' align='right'><table cellspacing='0' cellpadding='5' style='text-align: center; width:100%; border:1px solid #000; font-size:7pt;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>SLA</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>TOTAL</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>45 FT</th>");
                Pages.Append("<th style='width: 100px;'>TUES</th></tr>");
                Pages.Append("</thead>");
                Pages.Append("<tbody>");
                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'></td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + hubtotal20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + hubtotal40 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + hubtotal45 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + tues + "</td></tr>");
                Pages.Append("</tbody>");
                Pages.Append("</table></td>");


                Pages.Append("</tr>");


                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }

            catch (Exception ex)
            {
                return "";
            }

        }
        #endregion

        #region Total Container OnWheel Report
        [HttpGet]
        public ActionResult TotalContainerWheelReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetTotalContainerWheelReportPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.TotalWheelReportPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFTotalWheelContainer(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFTotalWheelContainer(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "OnWheelInReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>On Wheel Report</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Entry No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Sla Cd</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Cont Type</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Cont Class</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Cust Seal No</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1; int total45; int emptytotal20; int emptytotal40; int emptytotal45; int total; int loadedtotal20;
                int loadedtotal40; int loadedtotal45; int wheeltotal20; int teus;
                int wheeltotal40; int wheeltotal45;


                emptytotal20 = 0;
                emptytotal40 = 0;
                emptytotal45 = 0;
                loadedtotal20 = 0;
                loadedtotal40 = 0;
                loadedtotal45 = 0;
                wheeltotal20 = 0;
                wheeltotal40 = 0;
                wheeltotal45 = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerType + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContClass + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.CustomSealNo + "</td>");
                    Pages.Append("</tr>");
                    if (item.ContainerType.Equals("W"))
                    {
                        if (item.Size.Equals("20"))
                        {
                            wheeltotal20 = wheeltotal20 + 1;
                        }
                        else if (item.Size.Equals("40"))
                        {
                            wheeltotal40 = wheeltotal40 + 1;
                        }
                        else if (item.Size.Equals("45"))
                        {
                            wheeltotal45 = wheeltotal45 + 1;
                        }
                    }
                    i++;

                });
                wheeltotal20 = wheeltotal20;
                wheeltotal40 = wheeltotal40;
                wheeltotal45 = wheeltotal45;
                total = wheeltotal20 + wheeltotal40 + wheeltotal45;
                teus = wheeltotal20 + wheeltotal40 * 2 + wheeltotal45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='8' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; border-collapse:collapse; text-align: center; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; text-align: center; border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th>");
                //Pages.Append("<th rowspan='2' style='text-align: center; width: 100px;'>Tues</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>45 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>Total</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>Tues</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");
                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + wheeltotal20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + wheeltotal40 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + wheeltotal45 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + teus + "</td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Empty Container Out Report
        [HttpGet]
        public ActionResult EmptyContainerOutReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetEmptyContainerOutPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.EmptyContainerOutPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFEmptyContainerOut(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFEmptyContainerOut(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "EmptyContainerOutReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Empty Container Out Report</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Out Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Sla Cd</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Ecy</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Despatch To</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Gate Pass No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>DO Date</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;

                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.OutDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.DestuffingDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GatePassNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.ExitDateTime + "</td>");
                    Pages.Append("</tr>");

                    if (item.Size.Equals("20"))
                    {
                        total20 = total20 + 1;
                    }
                    else if (item.Size.Equals("40"))
                    {
                        total40 = total40 + 1;
                    }
                    else if (item.Size.Equals("45"))
                    {
                        total45 = total45 + 1;
                    }


                    i++;

                });
                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; border-collapse:collapse; border:1px solid #000; text-align: center; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 300px;'>Total</th>");
                //Pages.Append("<th rowspan='2' style='border-right: 1px solid #000; width: 100px;'>Total Container</th>");
                //Pages.Append("<th rowspan='2' style='text-align: center; width: 100px;'>Teus</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>45 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>Total</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>Teus</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align: center; width: 100px;'>" + total + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + totalteus + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Fresh Movement Received

        public ActionResult FreshMovReceived()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetFreshMovReceived(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.FreshMovReceived(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFFreshMovReceived(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFFreshMovReceived(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "Fresh_Movement_Received.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Fresh Movement Received</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>S/Line</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Move No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Move Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Out Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Via No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Vessel Name</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1; int total20; int total40; int total45;
                total20 = 0;
                total40 = 0;
                total45 = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.OutDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ViaNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Vessel + "</td>");
                    Pages.Append("</tr>");
                    i++;
                    if (item.Size.Equals("20"))
                    {
                        total20 = total20 + 1;
                    }
                    else if (item.Size.Equals("40"))
                    {
                        total40 = total40 + 1;
                    }
                    else if (item.Size.Equals("45"))
                    {
                        total45 = total45 + 1;
                    }
                });
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + (total20 + total40 + total45) + " </th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; border-collapse:collapse; text-align: center; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 30px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 30px;'>40 FT</th>");
                Pages.Append("<th style='width: 30px;'>45 FT</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + total45 + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }

        #endregion

        #region Export Container Out Report
        [HttpGet]
        public ActionResult LoadedContainerOutReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult LoadedContainerOutPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.ExportContainerOutPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFLoadedContainerOut(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFLoadedContainerOut(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "LoadedContainerOutReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Export Container Out Report</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:13%;'>In Date Lcy</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Sla Cd</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Custom Seal No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>POD</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Vessel</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Movement No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Gate Pass No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Vehicle No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:13%;'>Out Date</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;

                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CustomSealNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.POD + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Vessel + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GatePassNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.VehicleNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.ExitDateTime + "</td>");
                    Pages.Append("</tr>");

                    if (item.Size.Equals("20"))
                    {
                        total20 = total20 + 1;
                    }
                    else if (item.Size.Equals("40"))
                    {
                        total40 = total40 + 1;
                    }
                    else if (item.Size.Equals("45"))
                    {
                        total45 = total45 + 1;
                    }


                    i++;

                });
                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                //Pages.Append("<tr>");
                //Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                //Pages.Append("<th colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + total20 + " +" + total40 + "+" + total45 + "</th>");
                //Pages.Append("</tr>");
                //Pages.Append("</tbody></table>");


                //Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                //Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

                //Pages.Append("<tr><th style='border-right: 1px solid #000; text-align: center; width: 100px;'>20 FT</th>");
                //Pages.Append("<th style='border-right: 1px solid #000; text-align: center; width: 100px;'>40 FT</th>");
                //Pages.Append("<th style='border-right: 1px solid #000; text-align: center; width: 100px;'>45 FT</th>");
                //Pages.Append("<th style='border-right: 1px solid #000; text-align: center; width: 100px;'>Total</th>");
                //Pages.Append("<th style='border-right: 1px solid #000; text-align: center; width: 100px;'>Teus</th></tr>");
                //Pages.Append("</thead>");

                //Pages.Append("<tbody>");

                //Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                //Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                //Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
                //Pages.Append("<td style='border-right: 1px solid #000; text-align: center; width: 100px;'>" + total + "</td>");
                //Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + totalteus + "</td></tr>");


                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:7%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='12' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; border-collapse:collapse; text-align: center; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>45 FT</th>");
                Pages.Append("<th style='width: 100px;'>Teus</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + totalteus + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Loaded Container Out Report
        [HttpGet]
        public ActionResult TotalLoadedContainerOutReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult TotalLoadedContainerOutPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.LoadedContainerOutPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFTotalLoadedContainerOut(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFTotalLoadedContainerOut(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "LoadedContainerOutReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Loaded Container Out Report</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:13%;'>In Date Lcy</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Sla Cd</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Custom Seal No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>POD</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Vessel</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Movement Ord No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Gate Pass No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Vehicle No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:13%;'>Out Date</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;

                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CustomSealNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.POD + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Vessel + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GatePassNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.VehicleNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.ExitDateTime + "</td>");
                    Pages.Append("</tr>");

                    if (item.Size.Equals("20"))
                    {
                        total20 = total20 + 1;
                    }
                    else if (item.Size.Equals("40"))
                    {
                        total40 = total40 + 1;
                    }
                    else if (item.Size.Equals("45"))
                    {
                        total45 = total45 + 1;
                    }


                    i++;

                });
                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                //Pages.Append("<tr>");
                //Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                //Pages.Append("<th colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + total20 + " +" + total40 + "+" + total45 + "</th>");
                //Pages.Append("</tr>");
                //Pages.Append("</tbody></table>");


                //Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                //Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

                //Pages.Append("<tr><th style='border-right: 1px solid #000; text-align: center; width: 100px;'>20 FT</th>");
                //Pages.Append("<th style='border-right: 1px solid #000; text-align: center; width: 100px;'>40 FT</th>");
                //Pages.Append("<th style='border-right: 1px solid #000; text-align: center; width: 100px;'>45 FT</th>");
                //Pages.Append("<th style='border-right: 1px solid #000; text-align: center; width: 100px;'>Total</th>");
                //Pages.Append("<th style='border-right: 1px solid #000; text-align: center; width: 100px;'>Teus</th></tr>");
                //Pages.Append("</thead>");

                //Pages.Append("<tbody>");

                //Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                //Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                //Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
                //Pages.Append("<td style='border-right: 1px solid #000; text-align: center; width: 100px;'>" + total + "</td>");
                //Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + totalteus + "</td></tr>");


                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:7%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='12' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; border-collapse:collapse; text-align: center; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>45 FT</th>");
                Pages.Append("<th style='width: 100px;'>Teus</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + totalteus + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Private Movement Detail Report
        [HttpGet]
        public ActionResult PrivateMovementDetailReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult PrivateMovementDetailPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.PrivateMovementDetailPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFPrivateMovementDetail(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFPrivateMovementDetail(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "PrivateMovementDetailReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Private Movement Detail Report</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>S/Line</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Out Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>POL</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Movement No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Movement Order Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Gate Pass No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Via No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Vessel</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;

                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ExitDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.POL + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GatePassNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ViaNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Vessel + "</td>");
                    Pages.Append("</tr>");

                    if (item.Size.Equals("20"))
                    {
                        total20 = total20 + 1;
                    }
                    else if (item.Size.Equals("40"))
                    {
                        total40 = total40 + 1;
                    }
                    else if (item.Size.Equals("45"))
                    {
                        total45 = total45 + 1;
                    }


                    i++;

                });
                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; border-collapse:collapse; text-align: center; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>45 FT</th>");
                Pages.Append("<th style='width: 100px;'>Teus</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + totalteus + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Vessel Wise fresh Moment Received
        public ActionResult VesselWiseFreshMovReceived()
        {
            return PartialView("FreshMovReceivedVesselWise");
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetVesselWiseFreshMovReceived(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.VesselWiseFreshMovReceived(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFVesselWiseFreshMovReceived(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFVesselWiseFreshMovReceived(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "Fresh_Movement_Received.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Fresh Movement Received</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='0' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Via No</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Vessel Name</th>");
                Pages.Append("<th cellspacing='0' cellpadding='0'><table cellspacing='0' cellpadding='0' style='width:100%; font-size:7pt;'><thead><tr>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Size</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>S/Line</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Move No</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Move Date</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;width:10%;'>Out Date</th>");
                Pages.Append("</tr></thead></table></th>");
                Pages.Append("</tr></thead>");

                Pages.Append("<tbody>");
                int i = 1; int total20; int total40; int total45;
                total20 = 0;
                total40 = 0;
                total45 = 0;
                lstData.LstTotal.Select(x => new { x.ViaNo, x.Vessel }).Distinct().ToList().ForEach(item =>
                    {
                        Pages.Append("<tr>");
                        Pages.Append("<td cellpadding='7' valign='top' style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'>" + i + "</td>");
                        Pages.Append("<td cellpadding='7' valign='top' style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'>" + item.ViaNo + "</td>");
                        Pages.Append("<td cellpadding='7' valign='top' style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'>" + item.Vessel + "</td>");
                        Pages.Append("<td cellspacing='0' cellpadding='0' style='width:75%;'><table cellspacing='0' cellpadding='0' style='width:100%;font-size:7pt;'><tbody>");
                        lstData.LstTotal.Where(x => x.ViaNo == item.ViaNo && x.Vessel == item.Vessel).ToList().ForEach(elem =>
                        {
                            Pages.Append("<tr>");
                            Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.CFSCode + "</td>");
                            Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.ContainerNo + "</td>");
                            Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%'>" + elem.Size + "</td>");
                            Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.ShippingLine + "</td>");
                            Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.MovementNo + "</td>");
                            Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.MovementDate + "</td>");
                            Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>" + elem.OutDate + "</td>");
                            if (elem.Size.Equals("20"))
                            {
                                total20 = total20 + 1;
                            }
                            else if (elem.Size.Equals("40"))
                            {
                                total40 = total40 + 1;
                            }
                            else if (elem.Size.Equals("45"))
                            {
                                total45 = total45 + 1;
                            }
                            Pages.Append("</tr>");
                        });
                        Pages.Append("</tbody></table></td>");
                        Pages.Append("</tr>");
                        i++;

                    });
                Pages.Append("<tr>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th cellpadding='7' colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + (total20 + total40 + total45) + " </th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='text-align: center; width:50%; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 30px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 30px;'>40 FT</th>");
                Pages.Append("<th style='width: 30px;'>45 FT</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + total45 + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region  Pendency Report
        [HttpGet]
        public ActionResult PendencyReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult PendencyReportPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.PendencyReportPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFPendencyReport(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFPendencyReport(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "PendencyReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Pendency Report</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:4%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>S/Line</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Movement No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Movement Order Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Via No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Vessel</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ViaNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Vessel + "</td>");
                    Pages.Append("</tr>");

                    if (item.Size.Equals("20"))
                    {
                        total20 = total20 + 1;
                    }
                    else if (item.Size.Equals("40"))
                    {
                        total40 = total40 + 1;
                    }
                    else if (item.Size.Equals("45"))
                    {
                        total45 = total45 + 1;
                    }


                    i++;

                });
                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='8' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; border-collapse:collapse; text-align: center; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='width: 100px;'>45 FT</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + total45 + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Vessel Wise Pendency Report
        [HttpGet]
        public ActionResult VesselWisePendencyReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult VesselWisePendencyReportPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.VesselWisePendencyReportPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFVesselWisePendencyReport(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFVesselWisePendencyReport(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "VesselWisePendency.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>Run Date </b> " + DateTime.Now + " </span><br/><label style='font-size: 7pt; font-weight:bold;'>Vessel Wise Pendency Report</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='0' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Via No</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Vessel Name</th>");

                Pages.Append("<th cellspacing='0' cellpadding='0'><table cellspacing='0' cellpadding='0' style='width:100%; font-size:7pt;'><thead><tr>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Size</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>S/Line</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Move No</th>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;width:10%;'>Move Date</th>");
                Pages.Append("</tr></thead></table></th>");
                Pages.Append("</tr></thead>");

                Pages.Append("<tbody>");
                int i = 1; int total20; int total40; int total45; int Teus; int total;
                total20 = 0;
                total40 = 0;
                total45 = 0;
                lstData.LstTotal.Select(x => new { x.ViaNo, x.Vessel }).Distinct().ToList().ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td cellpadding='7' valign='top' style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'>" + i + "</td>");
                    Pages.Append("<td cellpadding='7' valign='top' style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'>" + item.ViaNo + "</td>");
                    Pages.Append("<td cellpadding='7' valign='top' style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'>" + item.Vessel + "</td>");
                    Pages.Append("<td cellspacing='0' cellpadding='0' style='width:75%;'><table cellspacing='0' cellpadding='0' style='width:100%;font-size:7pt;'><tbody>");
                    lstData.LstTotal.Where(x => x.ViaNo == item.ViaNo && x.Vessel == item.Vessel).ToList().ForEach(elem =>
                    {
                        Pages.Append("<tr>");
                        Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.CFSCode + "</td>");
                        Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.ContainerNo + "</td>");
                        Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%'>" + elem.Size + "</td>");
                        Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.ShippingLine + "</td>");
                        Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.MovementNo + "</td>");
                        Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>" + elem.MovementDate + "</td>");
                        if (elem.Size.Equals("20"))
                        {
                            total20 = total20 + 1;
                        }
                        else if (elem.Size.Equals("40"))
                        {
                            total40 = total40 + 1;
                        }
                        else if (elem.Size.Equals("45"))
                        {
                            total45 = total45 + 1;
                        }
                        Pages.Append("</tr>");
                    });
                    //total = total20 + total40 + total45;
                    //Teus = total20 + total40 * 2 + total45 * 2;
                    //Pages.Append("<tr>");
                    //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>" + total + "</td>");
                    //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>0</td>");
                    //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:5%'>+</td>");
                    //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>3</td>");
                    //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + Teus + "</td>");
                    //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'></td>");
                    //Pages.Append("</tr>");

                    Pages.Append("</tbody></table></td>");
                    Pages.Append("</tr>");
                    i++;

                });
                Teus = total20 + total40 * 2 + total45 * 2;
                total = total20 + total40 + total45;
                Pages.Append("<tr>");
                Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th cellpadding='7' colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + " </th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='text-align: center; width:50%; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 30px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 30px;'>40 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 30px;'>45 FT</th>");
                Pages.Append("<th style='width: 30px;'>Teus</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");
                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + Teus + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Pendency Query 
        [HttpGet]
        public ActionResult PendencyQuery()
        {
            Dnd_ReportRepository ImpRep = new Dnd_ReportRepository();
            ViewBag.LstVia = null;
            ImpRep.GetAllVia();
            if (ImpRep.DBResponse.Data != null)
            {
                ViewBag.LstVia = ImpRep.DBResponse.Data;
            }
            return PartialView();
        }
        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult PendencyQueryPrint(string ViaId)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.VesselWisePendencyPrint(ViaId);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFPendencyQuery(lstData);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFPendencyQuery(Dnd_TotalContainerReport lstData)
        {
            try
            {
                var FileName = "PendencyQuery.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>Run Date </b> " + DateTime.Now + " </span><br/><label style='font-size: 7pt; font-weight:bold;'>Pendency Query</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>S/Line</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Movement No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Movement Order Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Via No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Vessel</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;

                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ViaNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Vessel + "</td>");
                    Pages.Append("</tr>");

                    if (item.Size.Equals("20"))
                    {
                        total20 = total20 + 1;
                    }
                    else if (item.Size.Equals("40"))
                    {
                        total40 = total40 + 1;
                    }
                    else if (item.Size.Equals("45"))
                    {
                        total45 = total45 + 1;
                    }


                    i++;

                });
                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='8' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; border-collapse:collapse; text-align: center; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='width: 100px;'>45 FT</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + total45 + "</td></tr>");


                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Back To Town Cargo Report 
        [HttpGet]
        public ActionResult BackToTownCargoReport()
        {


            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult BackToTownCargoPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.BackToTownCargoPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFBackToTownCargo(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFBackToTownCargo(Dnd_TotalContainerReport lstData, string PeriodFrom, string PeriodTo)
        {
            try
            {
                var FileName = "BackToTownCargoReport.pdf";
                StringBuilder Pages = new StringBuilder();
                var GatePassDate = "";
                lstData.LstTotal.Select(x => new { GatePassDate = x.GatePassDate }).Distinct().ToList().ForEach(item =>
                {
                    if (GatePassDate == "")
                        GatePassDate = item.GatePassDate;
                    else
                        GatePassDate += "," + item.GatePassDate;
                });
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>Run Date </b> " + DateTime.Now + " </span><br/><br><label style='font-size: 7pt; font-weight:bold;'>Back To Town Cargo Report At Gate</label></br><span style='font-size:7pt;'><b>From </b> " + PeriodFrom + " <b>To </b>" + PeriodTo + "</span></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                //Loop Start
                lstData.LstTotal.Select(x => new { GatePassDate = x.GatePassDate }).Distinct().ToList().ForEach(x =>
                {
                    Pages.Append("<tr><td colspan='12'>");
                    Pages.Append("<table style='border:1px solid #000;width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                    Pages.Append("<tr><th cellpadding='5' colspan='12' style='border-bottom:1px solid #000;text-align:left;font-size:6pt;'>Out Date <span style='font-weight: normal;'>" + x.GatePassDate + "</span></th></tr>");

                    Pages.Append("<tr><td colspan='12'>");
                    Pages.Append("<table cellpadding='5' style='width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                    Pages.Append("<thead><tr>");
                    Pages.Append("<th style='border-right:1px solid #000;text-align:left;width:8%;'>Gate Pass No</th>");
                    Pages.Append("<th style='border-right:1px solid #000;text-align:left;width:8%;'>Gate Pass Date</th>");
                    Pages.Append("<th style='border-right:1px solid #000;text-align:left;width:8%;'>Entry No</th>");
                    Pages.Append("<th style='border-right:1px solid #000;text-align:left;width:8%;'>In Date</th>");
                    Pages.Append("<th style='border-right:1px solid #000;text-align:left;width:8%;'>Sb No</th>");
                    Pages.Append("<th style='border-right:1px solid #000;text-align:left;width:7%;'>Sb Date</th>");
                    Pages.Append("<th style='border-right:1px solid #000;text-align:left;width:9%;'>S/Line</th>");
                    Pages.Append("<th style='border-right:1px solid #000;text-align:left;width:8%;'>No Pkg</th>");
                    Pages.Append("<th style='border-right:1px solid #000;text-align:left;width:8%;'>Gr Wt</th>");
                    Pages.Append("<th style='border-right:1px solid #000;text-align:left;width:12%;'>Fob</th>");
                    Pages.Append("<th style='border-right:1px solid #000;text-align:left;width:12%;'>File No</th>");
                    Pages.Append("<th style='border-right:1px solid #000;text-align:left;width:8%;'>Vehicle No</th>");
                    Pages.Append("<th style='text-align:left;width:8%;'>Shed No</th>");
                    Pages.Append("</tr></thead>");
                    Pages.Append("<tbody>");
                    //loop start
                    int i = 1;
                    lstData.LstTotal.Where(y => y.GatePassDate == x.GatePassDate).ToList().ForEach(y =>
                    {
                        Pages.Append("<tr>");
                        Pages.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;text-align:left;'>" + y.GatePassNo + "</td>");
                        Pages.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;text-align:left;'>" + y.GatePassDate + "</td> ");
                        Pages.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;text-align:left;'>" + y.CFSCode + "</td> ");
                        Pages.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;text-align:left;'>" + y.InDateTime + "</td> ");
                        Pages.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;text-align:left;'>" + y.ShippingBillNo + "</td>");
                        Pages.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;text-align:left;'>" + y.ShippingBillDate + "</td> ");
                        Pages.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;text-align:left;'>" + y.ShippingLine + "</td>");
                        Pages.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;text-align:left;'>" + y.NoOfPkg + "</td>");
                        Pages.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;text-align:left;'>" + y.GrossWeight + "</td>");
                        Pages.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;text-align:left;'>" + y.Fob + "</td>");
                        Pages.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;text-align:left;'>" + y.Remarks + "</td>");
                        Pages.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;text-align:left;'>" + y.VehicleNo + "</td>");
                        Pages.Append("<td style='border-top:1px solid #000;text-align:left;'>" + y.ShedNo + "</td>");
                        Pages.Append("</tr>");
                        i++;
                    });

                    Pages.Append("<tr>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'>Total :</th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'></th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'>" + lstData.LstTotal.Where(z => z.GatePassDate == x.GatePassDate).Count() + "</th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'></th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'></th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'></th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'></th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'>" + lstData.LstTotal.Where(z => z.GatePassDate == x.GatePassDate).Sum(z => z.NoOfPkg).ToString("0.00") + "</th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'>" + lstData.LstTotal.Where(z => z.GatePassDate == x.GatePassDate).Sum(z => z.GrossWeight).ToString("0.00") + "</th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'>" + lstData.LstTotal.Where(z => z.GatePassDate == x.GatePassDate).Sum(z => z.Fob).ToString("0.00") + "</th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'></th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'></th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;'></th>");
                    Pages.Append("</tr>");

                    Pages.Append("</tbody>");
                    Pages.Append("</table>");
                    Pages.Append("</td></tr>");

                    Pages.Append("</tbody></table>");
                    Pages.Append("</td></tr>");
                });

                // All Total
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellpadding='5' style='border:1px solid #000;width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;width:8.5%;'>Total :</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;width:4%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;'></th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;width:8%;'>" + lstData.LstTotal.Count() + "</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;width:7%;'></th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;width:9%;'></th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;width:8%;'>" + lstData.LstTotal.Sum(x => x.NoOfPkg).ToString("0.00") + "</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;width:8%;'>" + lstData.LstTotal.Sum(x => x.GrossWeight).ToString("0.00") + "</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;width:12%;'>" + lstData.LstTotal.Sum(x => x.Fob).ToString("0.00") + "</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;'></th>");
                Pages.Append("<th style='text-align:left;width:8%;'></th>");
                Pages.Append("</tr>");
                Pages.Append("</thead>");
                Pages.Append("</table>");
                Pages.Append("</td></tr>");


                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region  Buffer Out Report
        [HttpGet]
        public ActionResult BufferOutReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult BufferOutReportPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.BufferContainerOutReportPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFBufferOutReport(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFBufferOutReport(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "BufferOutReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>BUFFER CONTAINER OUT REPORT</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Entry No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Sla</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>In Date Lcy</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Cust Seal No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Sla Seal No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Move No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Move Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Gate Pass No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Out Date Lcy</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CustomSealNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.SlaSealNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GatePassNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.OutDate + "</td>");
                    Pages.Append("</tr>");

                    if (item.Size.Equals("20"))
                    {
                        total20 = total20 + 1;
                    }
                    else if (item.Size.Equals("40"))
                    {
                        total40 = total40 + 1;
                    }
                    else if (item.Size.Equals("45"))
                    {
                        total45 = total45 + 1;
                    }


                    i++;

                });
                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>45 FT</th>");
                Pages.Append("<th style='width: 100px;'>TUES</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");
                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + totalteus + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region  OnWheel Out Report
        [HttpGet]
        public ActionResult OnWheelOutReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult OnWheelOutReportPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.OnWheelOutReportPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFOnWheelOutReport(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFOnWheelOutReport(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "OnWheelOutReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>ONWHEEL OUT REPORT</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Container No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Sla cd</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Gate Pass No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Gate Pass Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Vehicle No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Out Date</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GatePassNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GatePassDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.VehicleNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.OutDate + "</td>");
                    Pages.Append("</tr>");

                    if (item.Size.Equals("20"))
                    {
                        total20 = total20 + 1;
                    }
                    else if (item.Size.Equals("40"))
                    {
                        total40 = total40 + 1;
                    }
                    else if (item.Size.Equals("45"))
                    {
                        total45 = total45 + 1;
                    }


                    i++;

                });
                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='8' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>45 FT</th>");
                Pages.Append("<th style='width: 100px;'>Tues</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + totalteus + "</td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Daily Gate Summary report

        public ActionResult DailyGateSummaryReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult DailyGateSummaryPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.DailyGateSummary(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_GateSummaryReport lstData = new Dnd_GateSummaryReport();
                lstData = (Dnd_GateSummaryReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFDailyGateSummaryReport(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFDailyGateSummaryReport(Dnd_GateSummaryReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "DailyGateSummary.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                var EmptyIn20 = ""; var EmptyIn40 = ""; var EmptyIn45 = ""; var EmptyInTeus = ""; var EmptyInTotal = "";
                var EmptyOut20 = ""; var EmptyOut40 = ""; var EmptyOut45 = ""; var EmptyOutTeus = ""; var EmptyOutTotal = "";
                var ShutOut20 = ""; var ShutOut40 = ""; var ShutOut45 = ""; var ShutOutTeus = ""; var ShutOutTotal = "";
                var Hub20 = ""; var Hub40 = ""; var Hub45 = ""; var HubTeus = ""; var HubTotal = "";
                var Others20 = ""; var Others40 = ""; var Others45 = ""; var OthersTeus = ""; var OthersTotal = "";
                var Htc20 = ""; var Htc40 = ""; var Htc45 = ""; var HtcTeus = ""; var HtcTotal = "";
                var Pvt20 = ""; var Pvt40 = ""; var Pvt45 = ""; var PvtTeus = ""; var PvtTotal = "";
                var CargoIn20 = ""; var CargoIn40 = ""; var CargoIn45 = ""; var CargoInTeus = ""; var CargoInTotal = "";
                var CargoOut20 = ""; var CargoOut40 = ""; var CargoOut45 = ""; var CargoOutTeus = ""; var CargoOutTotal = "";
                var TotalSB = ""; var TotalPkg = ""; var TotalWeight = ""; var TotalFOB = "";
                lstData.LstEmptyIn.Select(x => new { EmptyIn20 = x.EmptyIn20 }).Distinct().ToList().ForEach(item =>
                {
                    if (EmptyIn20 == "")
                        EmptyIn20 = item.EmptyIn20;
                    else
                        EmptyIn20 = item.EmptyIn20;
                });

                lstData.LstEmptyIn.Select(x => new { EmptyIn40 = x.EmptyIn40 }).Distinct().ToList().ForEach(item =>
                {
                    if (EmptyIn40 == "")
                        EmptyIn40 = item.EmptyIn40;
                    else
                        EmptyIn40 = item.EmptyIn40;
                });
                lstData.LstEmptyIn.Select(x => new { EmptyIn45 = x.EmptyIn45 }).Distinct().ToList().ForEach(item =>
                {
                    if (EmptyIn45 == "")
                        EmptyIn45 = item.EmptyIn45;
                    else
                        EmptyIn45 = item.EmptyIn45;
                });
                lstData.LstEmptyIn.Select(x => new { EmptyInTeus = x.EmptyInTeus }).Distinct().ToList().ForEach(item =>
                {
                    if (EmptyInTeus == "")
                        EmptyInTeus = item.EmptyInTeus;
                    else
                        EmptyInTeus = item.EmptyInTeus;
                });
                lstData.LstEmptyIn.Select(x => new { EmptyInTotal = x.EmptyInTotal }).Distinct().ToList().ForEach(item =>
                {
                    if (EmptyInTotal == "")
                        EmptyInTotal = item.EmptyInTotal;
                    else
                        EmptyInTotal = item.EmptyInTotal;
                });
                lstData.LstEmptyOut.Select(x => new { EmptyOut20 = x.EmptyOut20 }).Distinct().ToList().ForEach(item =>
                {
                    if (EmptyOut20 == "")
                        EmptyOut20 = item.EmptyOut20;
                    else
                        EmptyOut20 = item.EmptyOut20;
                });
                lstData.LstEmptyOut.Select(x => new { EmptyOut40 = x.EmptyOut40 }).Distinct().ToList().ForEach(item =>
                {
                    if (EmptyOut40 == "")
                        EmptyOut40 = item.EmptyOut40;
                    else
                        EmptyOut40 = item.EmptyOut40;
                });
                lstData.LstEmptyOut.Select(x => new { EmptyOut45 = x.EmptyOut45 }).Distinct().ToList().ForEach(item =>
                {
                    if (EmptyOut45 == "")
                        EmptyOut45 = item.EmptyOut45;
                    else
                        EmptyOut45 = item.EmptyOut45;
                });
                lstData.LstEmptyOut.Select(x => new { EmptyOutTeus = x.EmptyOutTeus }).Distinct().ToList().ForEach(item =>
                {
                    if (EmptyOutTeus == "")
                        EmptyOutTeus = item.EmptyOutTeus;
                    else
                        EmptyOutTeus = item.EmptyOutTeus;
                });
                lstData.LstEmptyOut.Select(x => new { EmptyOutTotal = x.EmptyOutTotal }).Distinct().ToList().ForEach(item =>
                {
                    if (EmptyOutTotal == "")
                        EmptyOutTotal = item.EmptyOutTotal;
                    else
                        EmptyOutTotal = item.EmptyOutTotal;
                });
                lstData.LstShutOut.Select(x => new { ShutOut20 = x.ShutOut20 }).Distinct().ToList().ForEach(item =>
                {
                    if (ShutOut20 == "")
                        ShutOut20 = item.ShutOut20;
                    else
                        ShutOut20 = item.ShutOut20;
                });
                lstData.LstShutOut.Select(x => new { ShutOut40 = x.ShutOut40 }).Distinct().ToList().ForEach(item =>
                {
                    if (ShutOut40 == "")
                        ShutOut40 = item.ShutOut40;
                    else
                        ShutOut40 = item.ShutOut40;
                });
                lstData.LstShutOut.Select(x => new { ShutOut45 = x.ShutOut45 }).Distinct().ToList().ForEach(item =>
                {
                    if (ShutOut45 == "")
                        ShutOut45 = item.ShutOut45;
                    else
                        ShutOut45 = item.ShutOut45;
                });
                lstData.LstShutOut.Select(x => new { ShutOutTeus = x.ShutOutTeus }).Distinct().ToList().ForEach(item =>
                {
                    if (ShutOutTeus == "")
                        ShutOutTeus = item.ShutOutTeus;
                    else
                        ShutOutTeus = item.ShutOutTeus;
                });
                lstData.LstShutOut.Select(x => new { ShutOutTotal = x.ShutOutTotal }).Distinct().ToList().ForEach(item =>
                {
                    if (ShutOutTotal == "")
                        ShutOutTotal = item.ShutOutTotal;
                    else
                        ShutOutTotal = item.ShutOutTotal;
                });
                lstData.LstHub.Select(x => new { Hub20 = x.Hub20 }).Distinct().ToList().ForEach(item =>
                {
                    if (Hub20 == "")
                        Hub20 = item.Hub20;
                    else
                        Hub20 = item.Hub20;
                });
                lstData.LstHub.Select(x => new { Hub40 = x.Hub40 }).Distinct().ToList().ForEach(item =>
                {
                    if (Hub40 == "")
                        Hub40 = item.Hub40;
                    else
                        Hub40 = item.Hub40;
                });
                lstData.LstHub.Select(x => new { Hub45 = x.Hub45 }).Distinct().ToList().ForEach(item =>
                {
                    if (Hub45 == "")
                        Hub45 = item.Hub45;
                    else
                        Hub45 = item.Hub45;
                });
                lstData.LstHub.Select(x => new { HubTeus = x.HubTeus }).Distinct().ToList().ForEach(item =>
                {
                    if (HubTeus == "")
                        HubTeus = item.HubTeus;
                    else
                        HubTeus = item.HubTeus;
                });
                lstData.LstHub.Select(x => new { HubTotal = x.HubTotal }).Distinct().ToList().ForEach(item =>
                {
                    if (HubTotal == "")
                        HubTotal = item.HubTotal;
                    else
                        HubTotal = item.HubTotal;
                });
                lstData.LstOthers.Select(x => new { Others20 = x.Others20 }).Distinct().ToList().ForEach(item =>
                {
                    if (Others20 == "")
                        Others20 = item.Others20;
                    else
                        Others20 = item.Others20;
                });
                lstData.LstOthers.Select(x => new { Others40 = x.Others40 }).Distinct().ToList().ForEach(item =>
                {
                    if (Others40 == "")
                        Others40 = item.Others40;
                    else
                        Others40 = item.Others40;
                });
                lstData.LstOthers.Select(x => new { Others45 = x.Others45 }).Distinct().ToList().ForEach(item =>
                {
                    if (Others45 == "")
                        Others45 = item.Others45;
                    else
                        Others45 = item.Others45;
                });
                lstData.LstOthers.Select(x => new { OthersTeus = x.OthersTeus }).Distinct().ToList().ForEach(item =>
                {
                    if (OthersTeus == "")
                        OthersTeus = item.OthersTeus;
                    else
                        OthersTeus = item.OthersTeus;
                });
                lstData.LstOthers.Select(x => new { OthersTotal = x.OthersTotal }).Distinct().ToList().ForEach(item =>
                {
                    if (OthersTotal == "")
                        OthersTotal = item.OthersTotal;
                    else
                        OthersTotal = item.OthersTotal;
                });
                lstData.LstHtc.Select(x => new { Htc20 = x.Htc20 }).Distinct().ToList().ForEach(item =>
                {
                    if (Htc20 == "")
                        Htc20 = item.Htc20;
                    else
                        Htc20 = item.Htc20;
                });
                lstData.LstHtc.Select(x => new { Htc40 = x.Htc40 }).Distinct().ToList().ForEach(item =>
                {
                    if (Htc40 == "")
                        Htc40 = item.Htc40;
                    else
                        Htc40 = item.Htc40;
                });
                lstData.LstHtc.Select(x => new { Htc45 = x.Htc45 }).Distinct().ToList().ForEach(item =>
                {
                    if (Htc45 == "")
                        Htc45 = item.Htc45;
                    else
                        Htc45 = item.Htc45;
                });
                lstData.LstHtc.Select(x => new { HtcTeus = x.HtcTeus }).Distinct().ToList().ForEach(item =>
                {
                    if (HtcTeus == "")
                        HtcTeus = item.HtcTeus;
                    else
                        HtcTeus = item.HtcTeus;
                });
                lstData.LstHtc.Select(x => new { HtcTotal = x.HtcTotal }).Distinct().ToList().ForEach(item =>
                {
                    if (HtcTotal == "")
                        HtcTotal = item.HtcTotal;
                    else
                        HtcTotal = item.HtcTotal;
                });
                lstData.LstPvt.Select(x => new { Pvt20 = x.Pvt20 }).Distinct().ToList().ForEach(item =>
                {
                    if (Pvt20 == "")
                        Pvt20 = item.Pvt20;
                    else
                        Pvt20 = item.Pvt20;
                });
                lstData.LstPvt.Select(x => new { Pvt40 = x.Pvt40 }).Distinct().ToList().ForEach(item =>
                {
                    if (Pvt40 == "")
                        Pvt40 = item.Pvt40;
                    else
                        Pvt40 = item.Pvt40;
                });
                lstData.LstPvt.Select(x => new { Pvt45 = x.Pvt45 }).Distinct().ToList().ForEach(item =>
                {
                    if (Pvt45 == "")
                        Pvt45 = item.Pvt45;
                    else
                        Pvt45 = item.Pvt45;
                });
                lstData.LstPvt.Select(x => new { PvtTeus = x.PvtTeus }).Distinct().ToList().ForEach(item =>
                {
                    if (PvtTeus == "")
                        PvtTeus = item.PvtTeus;
                    else
                        PvtTeus = item.PvtTeus;
                });
                lstData.LstPvt.Select(x => new { PvtTotal = x.PvtTotal }).Distinct().ToList().ForEach(item =>
                {
                    if (PvtTotal == "")
                        PvtTotal = item.PvtTotal;
                    else
                        PvtTotal = item.PvtTotal;
                });
                lstData.LstCargoIn.Select(x => new { CargoIn20 = x.CargoIn20 }).Distinct().ToList().ForEach(item =>
                {
                    if (CargoIn20 == "")
                        CargoIn20 = item.CargoIn20;
                    else
                        CargoIn20 = item.CargoIn20;
                });
                lstData.LstCargoIn.Select(x => new { CargoIn40 = x.CargoIn40 }).Distinct().ToList().ForEach(item =>
                {
                    if (CargoIn40 == "")
                        CargoIn40 = item.CargoIn40;
                    else
                        CargoIn40 = item.CargoIn40;
                });
                lstData.LstCargoIn.Select(x => new { CargoIn45 = x.CargoIn45 }).Distinct().ToList().ForEach(item =>
                {
                    if (CargoIn45 == "")
                        CargoIn45 = item.CargoIn45;
                    else
                        CargoIn45 = item.CargoIn45;
                });
                lstData.LstCargoIn.Select(x => new { CargoInTeus = x.CargoInTeus }).Distinct().ToList().ForEach(item =>
                {
                    if (CargoInTeus == "")
                        CargoInTeus = item.CargoInTeus;
                    else
                        CargoInTeus = item.CargoInTeus;
                });
                lstData.LstCargoIn.Select(x => new { CargoInTotal = x.CargoInTotal }).Distinct().ToList().ForEach(item =>
                {
                    if (CargoInTotal == "")
                        CargoInTotal = item.CargoInTotal;
                    else
                        CargoInTotal = item.CargoInTotal;
                });
                lstData.LstCargoOut.Select(x => new { CargoOut20 = x.CargoOut20 }).Distinct().ToList().ForEach(item =>
                {
                    if (CargoOut20 == "")
                        CargoOut20 = item.CargoOut20;
                    else
                        CargoOut20 = item.CargoOut20;
                });
                lstData.LstCargoOut.Select(x => new { CargoOut40 = x.CargoOut40 }).Distinct().ToList().ForEach(item =>
                {
                    if (CargoOut40 == "")
                        CargoOut40 = item.CargoOut40;
                    else
                        CargoOut40 = item.CargoOut40;
                });
                lstData.LstCargoOut.Select(x => new { CargoOut45 = x.CargoOut45 }).Distinct().ToList().ForEach(item =>
                {
                    if (CargoOut45 == "")
                        CargoOut45 = item.CargoOut45;
                    else
                        CargoOut45 = item.CargoOut45;
                });
                lstData.LstCargoOut.Select(x => new { CargoOutTeus = x.CargoOutTeus }).Distinct().ToList().ForEach(item =>
                {
                    if (CargoOutTeus == "")
                        CargoOutTeus = item.CargoOutTeus;
                    else
                        CargoOutTeus = item.CargoOutTeus;
                });
                lstData.LstCargoOut.Select(x => new { CargoOutTotal = x.CargoOutTotal }).Distinct().ToList().ForEach(item =>
                {
                    if (CargoOutTotal == "")
                        CargoOutTotal = item.CargoOutTotal;
                    else
                        CargoOutTotal = item.CargoOutTotal;
                });
                lstData.LstSB.Select(x => new { TotalSB = x.TotalSB }).Distinct().ToList().ForEach(item =>
                {
                    if (TotalSB == "")
                        TotalSB = item.TotalSB;
                    else
                        TotalSB = item.TotalSB;
                });
                lstData.LstSB.Select(x => new { TotalPkg = x.TotalPkg }).Distinct().ToList().ForEach(item =>
                 {
                     if (TotalPkg == "")
                         TotalPkg = item.TotalPkg;
                     else
                         TotalPkg = item.TotalPkg;
                 });
                lstData.LstSB.Select(x => new { TotalWeight = x.TotalWeight }).Distinct().ToList().ForEach(item =>
                 {
                     if (TotalWeight == "")
                         TotalWeight = item.TotalWeight;
                     else
                         TotalWeight = item.TotalWeight;
                 });
                lstData.LstSB.Select(x => new { TotalFOB = x.TotalFOB }).Distinct().ToList().ForEach(item =>
                {
                    if (TotalFOB == "")
                        TotalFOB = item.TotalFOB;
                    else
                        TotalFOB = item.TotalFOB;
                });

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>Run Date </b> " + DateTime.Now + " </span><br/><label style='font-size: 7pt; font-weight:bold;'>Daily Gate Summary</label><br/><span style='font-size:7pt;'><b>Between </b> " + FromDate + " <b>And </b>" + ToDate + "</span><br/></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; border-right:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:25%;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:15%;'>20 FT</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:15%;'>40 FT</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:15%;'>45 FT</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:15%;'>Total</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:15%;'>No of Tues</th></tr></thead>");

                Pages.Append("<tbody>");
                Pages.Append("<tr>");

                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'><div style='width:100px; float:left;'>A. <u>Empty Container</u></div> <div style='float:left;'>(I) IN:</div></th>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + EmptyIn20 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + EmptyIn40 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + EmptyIn45 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + EmptyInTotal + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + EmptyInTeus + "</td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'><div style='width:100px; visibility:hidden; float:left;'></div> <div style='float:left;'> (II) OUT:</div></th>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + EmptyOut20 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + EmptyOut40 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + EmptyOut45 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + EmptyOutTotal + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + EmptyOutTeus + "</td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'><div style='width:100px; float:left;'>B. <u>Loaded Container</u></div> <div style='float:left;'> (I) IN:</div></th>");
                Pages.Append("<td colspan='5' style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'><div style='width:50px; visibility:hidden; float:left;'></div> <div style='float:left;'> (1) PORT SHUTOUT:</div></th>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + ShutOut20 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + ShutOut40 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + ShutOut45 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + ShutOutTotal + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + ShutOutTeus + "</td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'><div style='width:50px; visibility:hidden; float:left;'></div> <div style='float:left;'> (2) LCL HUB:</div></th>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + Hub20 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + Hub40 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + Hub45 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + HubTotal + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + HubTeus + "</td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'><div style='width:50px; visibility:hidden; float:left;'></div> <div style='float:left;'> (3) OTHERS:</div></th>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + Others20 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + Others40 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + Others45 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + OthersTotal + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + OthersTeus + "</td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'><div style='width:100px; visibility:hidden; float:left;'></div> <div style='float:left;'> (II) OUT:</div></th>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'><div style='width:110px; visibility:hidden; float:left;'></div> <div style='float:left;'> (1) HTC</div></th>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + Htc20 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + Htc40 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + Htc45 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + HtcTotal + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + HtcTeus + "</td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'><div style='width:110px; visibility:hidden; float:left;'></div> <div style='float:left;'> (2) Pvt.</div></th>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + Pvt20 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + Pvt40 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + Pvt45 + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + PvtTotal + "</td>");
                Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + PvtTeus + "</td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'><u>Cargo Details :</u></th>");
                Pages.Append("<td colspan='5'></td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'><div style='width:90px; float:left;'> Total Cargo Truck</div> <div style='float:left;'>(I) IN:</div></th>");
                Pages.Append("<td>" + CargoIn20 + "</td>");
                ////Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + CargoIn40 + "</td>");
                ////Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + CargoIn45 + "</td>");
                ////Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + CargoInTotal + "</td>");
                //Pages.Append("<td style='border-bottom:1px solid #000;'>" + CargoInTeus + "</td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'><div style='width:90px; visibility:hidden; float:left;'></div> <div style='float:left;'> (II) OUT</div></th>");
                Pages.Append("<td>" + CargoOut20 + "</td>");
                //Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + CargoOut40 + "</td>");
                //Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + CargoOut45 + "</td>");
                //Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + CargoOutTotal + "</td>");
                //Pages.Append("<td style='border-bottom:1px solid #000;'>" + CargoOutTeus + "</td>");
                Pages.Append("</tr>");

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'><div style='width:90px; visibility:hidden; float:left;'></div> <div style='float:left;'> (III) PENDING</div></th>");
                Pages.Append("<td></td>");
                Pages.Append("<td></td>");
                Pages.Append("<td></td>");
                Pages.Append("<td></td>");
                Pages.Append("<td colspan='5'></td>");
                Pages.Append("</tr>");

                //Pages.Append("<tr>");
                //Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                //Pages.Append("<th colspan='8' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + "</th>");
                //Pages.Append("</tr>");
                Pages.Append("</tbody></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:60%; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'></th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px; text-align:right;'>On Date</th>");
                Pages.Append("<th style='width: 100px; text-align:center;'>Progressive of The Month</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");
                Pages.Append("<tr><th style='border-right: 1px solid #000; border-top: 1px solid #000;'>No of SB's</th>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align:right;'>" + TotalSB + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000; text-align:center;'></td></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Total Pkgs.</th>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align:right;'>" + TotalPkg + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000; text-align:center;'></td></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Total Wts. (M.T)</th>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align:right;'>" + TotalWeight + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000; text-align:center;'></td></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; border-top: 1px solid #000;'>Total FOB(LacsRs.)</th>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000; text-align:right;'>" + TotalFOB + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000; text-align:center;'></td></tr>");
                Pages.Append("</tbody></table>");


                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region Job Order by Road Print
        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult JobOrderAmendmentPrint(int JobOrderId)
        {
            Dnd_ImportRepository objIR = new Dnd_ImportRepository();
            objIR.JobOrderPrintDetails(JobOrderId);
            string Path = "";
            int Status = 0;
            if (objIR.DBResponse.Data != null)
            {
                Dnd_JobOrderPrint lstPV = new Dnd_JobOrderPrint();
                lstPV = (Dnd_JobOrderPrint)objIR.DBResponse.Data;
                Path = JobOrderAmendmentBind(lstPV, JobOrderId);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
                //  Status = 1;
                // Path = JobOrderBind(lstPV, JobOrderId);
                //return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
            //    Status = 1;
            //    Path = JobOrderBind((List<dynamic>)objIR.DBResponse.Data, JobOrderId);
            //}
            //return Json(new { Message = Path, Status = Status });
        }

        [NonAction]
        public string JobOrderAmendmentBind(Dnd_JobOrderPrint lstPV, int JobOrderId)
        {
            StringBuilder sb = new StringBuilder();
            sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
            //sb.Append("<tr><td colspan='12' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>ICD Patparganj-Delhi</label><br/><label style='font-size: 14px; font-weight:bold;'>JOB ORDER</label></td></tr>");

            sb.Append("<tr><td colspan='12'>");
            sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            sb.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
            sb.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>" + lstPV.mstcompany + "</span><br/><label style='font-size: 14px; font-weight:bold;'>JOB ORDER Amendment</label></td></tr>");
            sb.Append("</tbody></table>");
            sb.Append("</td></tr>");
            int i = 1; int total20; int total40; int total45; total20 = 0; string FormOneDate = "";
            total40 = 0;
            total45 = 0;
            lstPV.LstTotal.Select(x => new { FormOneDate = x.FormOneDate }).Distinct().ToList().ForEach(item =>
            {
                if (FormOneDate == "")
                    FormOneDate = item.FormOneDate;
                else
                    FormOneDate += "," + item.FormOneDate;
            });
            sb.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-size:8pt; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
            sb.Append("<tr><td width='50%'> <b>To</b> <br/> <b>The Sr. Manager(OPERATIONS)</b> <br/> JNPT, SHEVA, Navi Mumbai - 400707 </td>");
            sb.Append("<td width='50%' style='text-align:right;'>" + FormOneDate + "</td></tr></tbody></table></td></tr>");
            sb.Append("<tr><td colspan='12' style='font-size:8pt;'>Sir,</td></tr>");
            sb.Append("<tr><td colspan='12' style='font-size:8pt;'>You are requested to kindly arrange to deliver the following IMPORT containers to CWC CFS Dronagiri Node, Navi Mumbai</td></tr>");
            sb.Append("<tr><td colspan='12'>");
            sb.Append("<table style='border:1px solid #000;width:100%;text-align:center;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
            sb.Append("<thead>");
            sb.Append("<tr>");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>Sr No.</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>Job No.</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>Container/CBT No.</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>Size</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>SA CODE</th>");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>Vessel Name</th> ");
            sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;'>Via</th> ");
            sb.Append("<th style='text-align:center;padding:10px;'>F/L</th> ");
            // sb.Append("<th style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>Via No</th> ");
            sb.Append("</tr>");
            sb.Append("</thead>");
            sb.Append("<tbody>");

            lstPV.LstTotal.ForEach(item =>
            {
                sb.Append("<tr>");
                sb.Append("<td style='border-top:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                sb.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;padding:10px;'>" + item.FormOneNo + "</td>");
                sb.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;padding:10px;'>" + item.ContainerNo + "</td>");
                sb.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;padding:10px;'>" + item.ContainerSize + "</td> ");
                sb.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;padding:10px;'>" + item.ShippingLineName + "</td> ");
                sb.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;padding:10px;'>" + item.VesselName + "</td> ");
                sb.Append("<td style='border-right:1px solid #000;border-top:1px solid #000;padding:10px;'>" + item.ViaNo + "</td> ");
                sb.Append("<td style='border-top:1px solid #000;padding:10px;'>" + item.LCLFCL + "</td> ");
                //sb.Append("<td style='text-align:center;border-right:1px solid #000;padding:10px;'>" + item.ViaN + "</td> ");
                sb.Append("</tr>");
                if (item.ContainerSize.Equals("20"))
                {
                    total20 = total20 + 1;
                }
                else if (item.ContainerSize.Equals("40"))
                {
                    total40 = total40 + 1;
                }
                else if (item.ContainerSize.Equals("45"))
                {
                    total45 = total45 + 1;
                }
                i++;
            });
            sb.Append("</tbody>");
            sb.Append("</table>");
            sb.Append("</td></tr>");

            sb.Append("<tr><td width='5%' valign='top' align='right' style='font-size:8pt;'>NOTE</td><td colspan='2' width='85%' style='font-size:7pt; line-height:22px;'>THE FOLLOWING CONTAINERS ARE REQUESTED TO BE SCANNED BEFORE ITS DELIVERY FROM THE PORT AS DESIRED BY THE CUSTOM SCANNING DIVISION.</td></tr>");
            sb.Append("<tr><td colspan='12' style='font-size:8pt;'>Copy to,</td></tr>");
            sb.Append("<tr><td width='5%'></td><td colspan='2' width='85%' style='font-size:7pt; line-height:22px;'>M/S Yash Forklift Hiring Services-for arranging movement of the containers from JNPT/NSICT/GTI/JNPCT/NSIGT with in three days</td></tr>");
            sb.Append("<tr><td width='5%'></td><td colspan='2' width='85%' style='font-size:7pt; line-height:22px;'>Following which dwell time charges as per procedure will be debited to your account as per claim receive from line.</td></tr>");
            sb.Append("<tr><td width='5%'></td><td colspan='2' width='85%' style='font-size:7pt; line-height:22px;'>The Preventive Officer,Customs,CT Gate,JNPT</td></tr>");
            sb.Append("<tr><td width='5%'></td><td colspan='2' width='85%' style='font-size:7pt; line-height:22px;'>The Preventive Officer,Customs,CWC Dronagiri Node</td></tr>");
            sb.Append("</tbody></table>");


            sb = sb.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID;
            string FileName = "JobOrderByRoad" + JobOrderId + ".pdf";
            if (!Directory.Exists(LocalDirectory))
            {
                Directory.CreateDirectory(LocalDirectory);
            }
            if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
            {
                System.IO.File.Delete(LocalDirectory + "/" + FileName);
            }
            using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
            {
                ObjPdf.HeadOffice = this.HeadOffice;
                ObjPdf.HOAddress = this.HOAddress;
                ObjPdf.ZonalOffice = this.ZonalOffice;
                ObjPdf.ZOAddress = this.ZOAddress;
                ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, sb.ToString());

            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        #region Stuffing Request Reprint
        [HttpGet]
        public ActionResult StuffingRequestReprint()
        {
            Dnd_ReportRepository ImpRep = new Dnd_ReportRepository();
            //ViewBag.LstStuff = null;
            //ImpRep.GetAllStuff();
            //if (ImpRep.DBResponse.Data != null)
            //{
            //    ViewBag.LstStuff = ImpRep.DBResponse.Data;

            //}
            return PartialView();



        }
        [HttpGet]
        public ActionResult GetStuffList()
        {
            Dnd_ReportRepository ImpRep = new Dnd_ReportRepository();
            ImpRep.GetAllStuff();
            if (ImpRep.DBResponse.Status > 0)
                return Json(ImpRep.DBResponse, JsonRequestBehavior.AllowGet);
            else
                return Json(null, JsonRequestBehavior.AllowGet);
        }

        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult PrintContainerStuffingReprint(int ContainerStuffingId)
        {
            Dnd_ExportRepository ObjER = new Dnd_ExportRepository();
            Dnd_ContainerStuffing ObjStuffing = new Dnd_ContainerStuffing();
            ObjER.GetContainerStuffForPrint(ContainerStuffingId);
            if (ObjER.DBResponse.Data != null)
            {
                ObjStuffing = (Dnd_ContainerStuffing)ObjER.DBResponse.Data;
                string Path = GeneratePdfForContainerStuff(ObjStuffing, ContainerStuffingId);
                return Json(new { Status = 1, Message = Path });
            }
            else
            {
                return Json(new { Status = 0, Message = "Error" });
            }

        }
        [NonAction]
        public string GeneratePdfForContainerStuff(Dnd_ContainerStuffing ObjStuffing, int ContainerStuffingId)
        {
            string Path = Server.MapPath("~/Docs/") + Session.SessionID + "/ContainerStuffing" + ContainerStuffingId + ".pdf";
            string Html = "";
            string ShippingBillNo = "", ShippingDate = "", StuffWeight = "", Exporter = "", ShippingLine = "", Fob = "", CHA = "",
            StuffQuantity = "", SLNo = "", CFSCode = "", ContainerNo = "", CustomSeal = "", Commodity = "", EntryNo = "", InDate = "",
            Area = "", PortName = "", PortDestination = "", Remarks = "", CargoType = "", PortDischarge;

            String Consignee = ""; int SerialNo = 1;
            if (ObjStuffing.LstStuffing.Count() > 0)
            {
                ObjStuffing.LstStuffing.Select(x => new { ShippingBillNo = x.ShippingBillNo }).Distinct().ToList().ForEach(item =>
                {
                    ShippingBillNo = (ShippingBillNo == "" ? ((item.ShippingBillNo) + " ") : (item.ShippingBillNo + "<br/>" + item.ShippingBillNo + " "));
                    /*   if (ShippingBillNo == "")
                           ShippingBillNo = item.ShippingBillNo + " ";
                       else
                           ShippingBillNo += "," + item.ShippingBillNo; */
                });

                ObjStuffing.LstStuffing.Select(x => new { ShippingDate = x.ShippingDate }).Distinct().ToList().ForEach(item =>
                {

                    ShippingDate = (ShippingDate == "" ? (item.ShippingDate) : (item.ShippingDate));
                    /*  if (ShippingDate == "")
                          ShippingDate = item.ShippingDate;
                      else
                          ShippingDate += "," + item.ShippingDate;*/
                });
                ObjStuffing.LstStuffing.Select(x => new { EntryNo = x.EntryNo }).Distinct().ToList().ForEach(item =>
                {

                    EntryNo = (EntryNo == "" ? (item.EntryNo) : (item.EntryNo));
                    /*  if (ShippingDate == "")
                          ShippingDate = item.ShippingDate;
                      else
                          ShippingDate += "," + item.ShippingDate;*/
                });
                ObjStuffing.LstStuffing.Select(x => new { InDate = x.InDate }).Distinct().ToList().ForEach(item =>
                {

                    InDate = (InDate == "" ? (item.InDate) : (item.InDate));
                    /*  if (ShippingDate == "")
                          ShippingDate = item.ShippingDate;
                      else
                          ShippingDate += "," + item.ShippingDate;*/
                });
                ObjStuffing.LstStuffing.Select(x => new { Exporter = x.Exporter }).Distinct().ToList().ForEach(item =>
                {
                    if (Exporter == "")
                        Exporter = item.Exporter;
                    else
                        Exporter += "," + item.Exporter;
                });
                ObjStuffing.LstStuffing.Select(x => new { PortName = x.PortName }).Distinct().ToList().ForEach(item =>
                {
                    if (PortName == "")
                        PortName = item.PortName;
                    else
                        PortName += "," + item.PortName;
                });
                ObjStuffing.LstStuffing.Select(x => new { PortDestination = x.PortDestination }).Distinct().ToList().ForEach(item =>
                {
                    if (PortDestination == "")
                        PortDestination = item.PortDestination;
                    else
                        PortDestination += "," + item.PortDestination;
                });


                ObjStuffing.LstStuffing.Select(x => new { PortDestination = x.PortDestination }).Distinct().ToList().ForEach(item =>
                {
                    if (PortDestination == "")
                        PortDestination = item.PortDestination;
                    else
                        PortDestination += "," + item.PortDestination;
                });
                ObjStuffing.LstStuffing.Select(x => new { Consignee = x.Consignee }).Distinct().ToList().ForEach(item =>
                {
                    if (Consignee == "")
                        Consignee = item.Consignee;
                    else
                        Consignee += "," + item.Consignee;
                });

                ObjStuffing.LstStuffing.Select(x => new { ShippingLine = x.ShippingLine }).Distinct().ToList().ForEach(item =>
                {

                    if (ShippingLine == "")
                        ShippingLine = item.ShippingLine;
                    else
                        ShippingLine += "," + item.ShippingLine;
                });

                ObjStuffing.LstStuffing.Select(x => new { Remarks = x.Remarks }).Distinct().ToList().ForEach(item =>
                {

                    if (Remarks == "")
                        Remarks = item.Remarks;
                    else
                        Remarks += "," + item.Remarks;
                });
                ObjStuffing.LstStuffing.Select(x => new { CHA = x.CHA }).Distinct().ToList().ForEach(item =>
                {
                    if (CHA == "")
                        CHA = item.CHA;
                    else
                        CHA += "," + item.CHA;
                });

                //StuffWeight = (ObjStuffing.LstStuffingDtl.Sum(x => x.StuffWeight) > 0) ? (ObjStuffing.LstStuffingDtl.Sum(x => x.StuffWeight)).ToString() : "";
                //Fob = (ObjStuffing.LstStuffingDtl.Sum(x => x.Fob) > 0) ? (ObjStuffing.LstStuffingDtl.Sum(x => x.Fob)).ToString() : "";
                StuffQuantity = (ObjStuffing.LstStuffing.Sum(x => x.StuffQuantity) > 0) ? (ObjStuffing.LstStuffing.Sum(x => x.StuffQuantity)).ToString() : "";

                ObjStuffing.LstStuffing.ToList().ForEach(item =>
                {

                    Commodity = (Commodity == "" ? (item.CommodityName) : Commodity == item.CommodityName ? Commodity : (Commodity + "<br/>" + item.CommodityName));

                });

                ObjStuffing.LstCont.ToList().ForEach(item =>
                {
                    //SLNo = SLNo + SerialNo + "<br/>";
                    CFSCode = (CFSCode == "" ? (item.CFSCode) : CFSCode == item.CFSCode ? CFSCode : (CFSCode + "<br/>" + item.CFSCode));
                    ContainerNo = (ContainerNo == "" ? (item.ContainerNo) : ContainerNo == item.ContainerNo ? ContainerNo : (ContainerNo + "<br/>" + item.ContainerNo));
                    CargoType = (CargoType == "" ? (item.CargoType) : (CargoType + "<br/>" + item.CargoType));
                    //SerialNo++;
                });


                ObjStuffing.LstStuffing.Select(x => new { CustomSeal = x.CustomSeal }).Distinct().ToList().ForEach(item =>
                {

                    if (CustomSeal == "")
                        CustomSeal = item.CustomSeal;
                    else
                        CustomSeal += "<br/>" + item.CustomSeal;
                });


                Html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'>";

                Html += "<thead>";

                Html += "<tr><td colspan='4'>";
                Html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>";
                Html += "<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>";
                Html += "<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><span style='font-size:12px;'>(A Govt. of India Undertaking)</span><br/><span style='font-size:12px;'>" + ObjStuffing.CompanyAddress + "</span><br/><label style='font-size: 14px; font-weight:bold;'>CONTAINER STUFFING SHEET</label><br/><label style='font-size: 14px;'> <b>Shed No :</b> " + ObjStuffing.GodownName + "</label></td>";
                Html += "<td width='12%' align='right' valign='top'>";
                Html += "<table style='width:100%;' cellspacing='0' cellpadding='0' valign='top'><tbody>";
                Html += "<tr><td style='border:1px solid #333;' valign='top'>";
                Html += "<div valign='top' style='padding: 5px 0; font-size: 12px; text-align: center;'>F/D'NODE/07</div>";
                Html += "</td></tr>";
                Html += "</tbody></table>";
                Html += "</td></tr>";
                Html += "</tbody></table>";
                Html += "</td></tr>";
                Html += "</thead>";

                Html += "<tbody>";
                //Html += "<tr><td colspan='4'><table style='width:100%;font-size:8.5pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr> <td><b>CWC PAN NO:</b> AAACC1206D</td></tr>  <tr><td><span><br/></span></td></tr> <tr><td><b>CWC STX REG NO:</b> AAACC1206DST005</td></tr>  </tbody></table></td></tr>";
                Html += "<tr><td colspan='4'><table style='width:100%;font-size:8.5pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr> <th colspan='1' width='8%' style='padding:3px;text-align:left;'>Stuff Req No :</th><td colspan='10' width='8%' style='padding:3px;text-align:left;'>" + ObjStuffing.StuffingNo + "</td><th colspan='10' width='8%'></th><th colspan='10' width='40%' style='padding:3px;text-align:right;'>Stuffing Date :</th><td colspan='1' width='8%' style='padding:3px;text-align:right;'>" + ObjStuffing.StuffingDate + "</td></tr></tbody></table></td></tr>";
                Html += "<tr><td colspan='4'><table style='width:100%;font-size:8.5pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr> <td colspan='3' width='25%' style='margin:0 0 10px;'><b>Container No. :</b> <u>" + ContainerNo + "</u></td> <td colspan='3' width='25%' style='margin:0 0 10px;'><b>CFS Code No. :</b> <u>" + CFSCode + "</u></td>  <td colspan='3' width='15%' style='margin:0 0 10px;'><b>Size :</b> <u>" + ObjStuffing.Size + "</u></td>  <td colspan='3' width='35%' style='margin:0 0 10px; text-align: right;'><b>Forwarder Name :</b> <u>" + ObjStuffing.ForwarderName + "</u></td> </tr>  </tbody></table></td></tr>";
                Html += "<tr><td colspan='4'><table style='width:100%;font-size:8.5pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr> <td colspan='3' width='25%' style='margin:0 0 10px;'><b>POL :</b> <u>" + PortName + "</u></td>  <td colspan='3' width='25%' style='margin:0 0 10px;'><b>Port Of Destination :</b> <u>" + ObjStuffing.POD + "</u></td> <td colspan='3' width='25%' style='margin:0 0 10px;'><b>Port Of Discharge :</b> <u>" + ObjStuffing.PODischarge + "</u></td> <td colspan='3' width='25%' style='margin:0 0 10px;'></td> </tr></tbody></table> </td></tr>";
                Html += "<tr><td colspan='4'><table style='width:100%;font-size:8.5pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr> <td colspan='3' width='25%' style='margin:0 0 10px;'><b>Sla Seal No :</b> <u>" + ObjStuffing.ShippingLineNo + "</u></td>  <td colspan='3' width='25%' style='margin:0 0 10px;'><b>Custom Seal No</b> <u>" + CustomSeal + "</u></td> <td colspan='3' width='25%' style='margin:0 0 10px;'><b>Cont Type</b> <u>" + CargoType + "</u></td> <td colspan='3' width='25%' style='margin:0 0 10px; text-align: right;'><b>Main Line </b> <u>" + ShippingLine + "</u></td>  </tr></tbody></table> </td></tr>";

                Html += "<tr><td colspan='4' style='padding-top:20pt;'>";
                Html += "<table cellspacing='0' cellpadding='8' style='border:1px solid #000;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>";
                Html += "<thead>";
                Html += "<tr><th style='border-bottom:1px solid #000;padding:3px;text-align:center;width:5%;'>S. No.</th>";
                Html += "<th style='border-bottom:1px solid #000;padding:3px;text-align:left;width:8%;'>Entry No</th>";
                Html += "<th style='border-bottom:1px solid #000;padding:3px;text-align:left;width:8%;'>InDate</th>";
                Html += "<th style='border-bottom:1px solid #000;padding:3px;text-align:left;width:8%;'>Sb No</th>";
                Html += "<th style='border-bottom:1px solid #000;padding:3px;text-align:left;width:8%;'>Sb Date</th>";
                Html += "<th style='border-bottom:1px solid #000;padding:3px;text-align:left;width:15%;'>Exporter</th>";
                Html += "<th style='border-bottom:1px solid #000;padding:3px;text-align:left;width:10%;'>Consignee</th>";
                Html += "<th style='border-bottom:1px solid #000;padding:3px;text-align:left;width:15%;'>Comdty</th>";
                Html += "<th style='border-bottom:1px solid #000;padding:3px;text-align:left;width:10%;'>Pkts</th>";
                Html += "<th style='border-bottom:1px solid #000;padding:3px;text-align:left;width:10%;'>Gr Wt</th>";
                Html += "<th style='border-bottom:1px solid #000;padding:3px;text-align:left;width:10%;'>FOB</th>";
                Html += "<th style='border-bottom:1px solid #000;padding:3px;text-align:left;width:10%;'>Remarks</th></tr>";
                Html += "</thead>";
                Html += "<tbody>";

                //LOOP START
                ObjStuffing.LstStuffing.ToList().ForEach(item =>
                {
                    Html += "<tr><td style='border-bottom:1px solid #000;padding:3px;text-align:center;width:5%;'>" + SerialNo++ + "</td>";
                    Html += "<td style='border-bottom:1px solid #000;padding:3px;text-align:left;width:8%;'>" + item.EntryNo + "</td>";
                    Html += "<td style='border-bottom:1px solid #000;padding:3px;text-align:left;width:8%;'>" + item.InDate + "</td>";
                    Html += "<td style='border-bottom:1px solid #000;padding:3px;text-align:left;width:8%;'>" + item.ShippingBillNo + "</td>";
                    Html += "<td style='border-bottom:1px solid #000;padding:3px;text-align:left;width:8%;'>" + item.ShippingDate + "</td>";
                    Html += "<td style='border-bottom:1px solid #000;padding:3px;text-align:left;width:15%;'>" + item.Exporter + "</td>";
                    Html += "<td style='border-bottom:1px solid #000;padding:3px;text-align:left;width:10%;'>" + item.Consignee + "</td>";
                    Html += "<td style='border-bottom:1px solid #000;padding:3px;text-align:left;width:15%;'>" + item.CommodityName + "</td>";
                    Html += "<td style='border-bottom:1px solid #000;padding:3px;text-align:left;width:10%;'>" + item.StuffQuantity + "</td>";
                    Html += "<td style='border-bottom:1px solid #000;padding:3px;text-align:left;width:10%;'>" + item.StuffWeight + "</td>";
                    Html += "<td style='border-bottom:1px solid #000;padding:3px;text-align:left;width:10%;'>" + item.Fob + "</td>";
                    Html += "<td style='border-bottom:1px solid #000;padding:3px;text-align:left;width:10%;'>" + item.Remarks + "</td></tr>";
                });
                //LOOP END

                Html += "<tr><th style='padding:3px;text-align:center;width:5%;'>Total :</th>";
                Html += "<td style='padding:3px;text-align:left;width:8%;'></td>";
                Html += "<td style='padding:3px;text-align:left;width:8%;'></td>";
                Html += "<td style='padding:3px;text-align:left;width:8%;'></td>";
                Html += "<td style='padding:3px;text-align:left;width:8%;'></td>";
                Html += "<td style='padding:3px;text-align:left;width:15%;'></td>";
                Html += "<td style='padding:3px;text-align:left;width:15%;'></td>";
                Html += "<td style='padding:3px;text-align:left;width:10%;'></td>";
                Html += "<th style='padding:3px;text-align:left;width:10%;'>" + ObjStuffing.LstStuffing.AsEnumerable().Sum(item => item.StuffQuantity) + "</th>";
                Html += "<th style='padding:3px;text-align:left;width:10%;'>" + ObjStuffing.LstStuffing.AsEnumerable().Sum(item => item.StuffWeight) + "</th>";
                Html += "<th style='padding:3px;text-align:left;width:10%;'>" + ObjStuffing.LstStuffing.AsEnumerable().Sum(item => item.Fob) + "</th>";
                Html += "<th style='padding:3px;text-align:left;width:10%;'></th></tr>";

                Html += "</tbody></table>";
                Html += "</td></tr>";

                Html += "<tr><td colspan='4'><span><br/><br/></span></td></tr>";

                Html += "<tr><td colspan='4' style='padding-top:20pt;'>";
                Html += "<table style='width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>";
                Html += "<tr><td colspan='3' width='25%' style='padding:3px;text-align:left;font-size:11px;' valign='top'>Signature and designation</td>";
                Html += "<td colspan='5' width='41.66666666666667%' style='padding:3px;text-align:left;'>";
                Html += "<table style='width:100%;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>";
                Html += "<tr><td width='3%' valign='top' align='right' style='font-size:10px;'>1</td><td colspan='2' width='85%' style='font-size:11px;'>All activities including those at incomming and in process stages have been satisfactorily completed.</td></tr>";
                Html += "<tr><td width='3%' valign='top' align='right' style='font-size:10px;'>2</td><td colspan='2' width='85%' style='font-size:11px;'>All the necessary records have been completed and verified with Date and seal.</td></tr>";
                Html += "<tr><td width='3%' valign='top' align='right' style='font-size:10px;'>3</td><td colspan='2' width='85%' style='font-size:11px;'>Cargo/Containers delivered in good condition.</td></tr>";
                Html += "</tbody></table>";
                Html += "</td>";
                Html += "<td colspan='1' width='8.333333333333333%'></td>";
                Html += "<td colspan='4' width='33.33333333333333%' style='padding:3px;text-align:left;font-size:11px;' valign='top'>The container is allowed to be sent to Jawaharlal Nehru Port Officer on behalf of Jawahar Custom's House</td></tr>";
                Html += "</tbody></table>";
                Html += "</td></tr>";

                Html += "<tr><td colspan='4'><span><br/><br/><br/></span></td></tr>";

                Html += "<tr><td colspan='4' style='padding-top:100pt;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr><td style='text-align:left;'>Representative/Surveyor <br/> of Shipping Agent/Line</td><td style='text-align:center;'>Representative/Surveyor <br/> of H&T contractor</td><td style='text-align:left;'>Shed Asst. <br/> CFS Dronagiri</td><td style='text-align:left;'>Shed I/C <br/>CWC-CFS,D-NODE</td><td style='text-align:center;'>(On behalf of Jawahar Custom's House)</td></tr></tbody></table></td></tr>";
                Html += "</tbody></table>";


            }

            if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }

            // if (Convert.ToInt32(Session["BranchId"]) == 1)
            // {
            //Html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>";

            //Html += "<tr><td colspan='4'>";
            //Html += "<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>";
            //Html += "<tr><td width='65%' style='font-size: 10px;'>'Warehousing for every one'</td>";
            //Html += "<td width='8%' align='right'>";
            //Html += "<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>";
            //Html += "<tr><td style='border:1px solid #333;'>";
            //Html += "<div style='padding: 5px 0; font-size: 12px; text-align: center;'>F/CD/CFS/15</div>";
            //Html += "</td></tr>";
            //Html += "</tbody></table>";
            //Html += "</td></tr>";
            //Html += "</tbody></table>";
            //Html += "</td></tr>";

            //Html += "<tr><td colspan='4'>";
            //Html += "<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>";
            //Html += "<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>";
            //Html += "<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><span style='font-size:12px;'>(A Govt. of India Undertaking)</span><br/><span style='font-size:12px;'>Container Freight Station, Kukatpally<br/> IDPL Road, Hyderabad - 37</span><br/><label style='font-size: 14px;'>Email - cwccfs@gmail.com</label><br/><label style='font-size: 14px; font-weight:bold;'>CONTAINER STUFFING SHEET(FCL/LCL)</label></td>";
            //Html += "<td valign='top'><img align='right' src='ISO' width='100'/></td></tr>";
            //Html += "</tbody></table>";
            //Html += "</td></tr>";

            //Html += "</thead>";
            //Html += "<tbody>  <tr><td colspan='4'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr><th colspan='1' width='3%' style='padding:3px;text-align:left;'>Sl.No</th><td colspan='10' width='5%' style='padding:3px;text-align:left;'>" + ObjStuffing.StuffingNo + "</td><th colspan='10' width='8%'></th><th colspan='10' width='40%' style='padding:3px;text-align:right;'>Date</th><td colspan='1' width='8%' style='padding:3px;text-align:right;'>" + DateTime.Now.ToString("dd/MM/yyyy") + "</td></tr></tbody></table></td></tr>   <tr><td colspan='4'><p style='font-size:9pt; margin:0 0 10px;'><b>Container No.</b> <u>" + ContainerNo + "</u> <b>CFS Code No.</b> <u>" + CFSCode + "</u> <b>Godown No / Bay No.</b> <u>" + ObjStuffing.GodownName + "</u> </p></td></tr>      <tr><td colspan='4'><p style='font-size:9pt; margin:0 0 10px;'><b>Shhiping Agent</b> <u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u> <b>Shipping Line</b> <u>" + ShippingLine + "</u> <b>Size</b> <u>" + ObjStuffing.Size + "</u> <b>Shipping Line Seal No.</b> <u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u> </p></td></tr>      <tr><td colspan='4'><p style='font-size:9pt; margin:0 0 10px;'><b>Vessel</b> <u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u> <b>Country of Origin</b> <u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u> <b>VIA No.</b> <u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u> <b>Voyage</b> <u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u> <b>Customs Seal No.</b> <u>" + CustomSeal + "" + "</u> </p></td></tr>  <tr><td colspan='4' style='padding-top:20pt;'><table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><thead><tr><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>S. No.</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Shipping Bill No. and Date</th> <th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Exporter</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Consignee</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Name Of Goods</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Carting No.</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>No.of Pkgs Stuffed</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Gross Weight in Mts</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Value as per S/B INR(in lacs)</th><th colspan='10' style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Tally</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Total</th></tr></thead><tbody><tr><td style='border:1px solid #000;padding:3px;text-align:center;'>" + SLNo + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ShippingBillNo + ShippingDate + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Exporter + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Consignee + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Commodity + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>Carting No - [DATA]</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + StuffQuantity + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + StuffWeight + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Fob + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:center;'>-</td><td style='border:1px solid #000;padding:3px;text-align:center;'>-</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td></tr><tr><td colspan='20' style='border:1px solid #000;'><table cellspacing='0' cellpadding='5' style='width:100%; margin: 0; padding: 5px; font-size:8pt;'><tbody><tr><td colspan='16' width='80%'></td><th style='border-right:1px solid #000;padding:3px;text-align:right;'>Grand Total</th><td style='padding:3px;text-align:right;'>" + StuffQuantity + "</td></tr></tbody></table></td></tr><tr><td colspan='12' style='border:1px solid #000;padding:3px;text-align:left;'>Variation observed if Any</td></tr> <tr><td colspan='12'><span><br/></span></td></tr><tr><td colspan='12' style='padding:3px;text-align:left;'>Signature and designation <br/> with date & Seal</td></tr></tbody></table></td></tr><tr><td colspan='4' style='padding-top:100pt;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr><td style='text-align:left;'>Representative/Surveyor <br/> Shipping Agent/Line/CHA</td><td style='text-align:left;'>Shed Asst. <br/> CWC.CFS</td><td style='text-align:left;'>Shed I/c <br/> CWC.CFS</td><td style='text-align:center;'>Rep/Surveyor of Handling & <br/> Transport Contractor</td><td style='text-align:center;'>Preventive Officer of Customs</td></tr></tbody></table></td></tr></tbody></table>";
            //// }
            //// else
            //// {
            ////    Html += "<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><thead><tr><th style='width:20%;text-align:right;'><img src='IMGSRC' style='width:50%;' /></th><th style='width:60%;font-weight:600;text-align:center;'><span style='font-size:10pt;'>CENTRAL WAREHOUSING CORPORATION</span><br/>(A Govt. of India Undertaking)</th><th style='text-align:center;'>Container Freight Station<br/><br/>_____________________</th></tr></thead><tbody><tr><td colspan='3'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>S.No</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ObjStuffing.StuffingNo + "</td><td rowspan='2' style='width:60%;font-weight:600;text-align:center;'>FORMAT FOR STUFFING SHEET(FCL/LCL)<br/><span style='border-bottom:1px solid #000;'>CONTAINER STUFFING SHEET</span></td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Date</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + DateTime.Now.ToString("dd/MM/yyyy") + "</td></tr><tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Size</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ObjStuffing.Size + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Godown</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ObjStuffing.GodownName + "</td></tr></tbody></table></td></tr><tr><td colspan='3'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Shipping Bill No.</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ShippingBillNo + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Shipping Bill Date:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ShippingDate + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Gross Weight:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + StuffWeight + "</td></tr><tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Exporter:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Exporter + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Shipping Line:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ShippingLine + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>FOBValue(INR):</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Fob + "</td></tr>			<tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Consignee/CHA:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + CHA + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Destination:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>No. of Packages Stuffed:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + StuffQuantity + "</td></tr></tbody></table></td></tr><tr><td colspan='3' style='padding-top:20pt;'><table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><thead><tr><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>S. No.</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>CFS Code</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Container No.</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Commodity</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Customs Seal</th><th colspan='10' style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Tally</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Total</th></tr></thead><tbody><tr><td style='border:1px solid #000;padding:3px;text-align:center;'>" + SLNo + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + CFSCode + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ContainerNo + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Commodity + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + CustomSeal + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:center;'>-</td><td style='border:1px solid #000;padding:3px;text-align:center;'>-</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td></tr><tr><td colspan='10'></td><td colspan='4' style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Grand Total</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + StuffQuantity + "</td></tr><tr><td colspan='15' style='padding:3px;text-align:left;'>Variation observed if Any</td></tr></tbody></table></td></tr><tr><td colspan='3' style='padding-top:100pt;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr><td style='text-align:center;'>Signature & <br/>Designation with<br/>Date and Seal</td><td style='text-align:center;'>Rep./Surveyor/S.<br/>Agent/Line/CHA</td><td style='text-align:center;'>Shed I/C CWC-CFS</td><td style='text-align:center;'>Rep./Surveyor of H & T<br/>Contractor</td><td style='text-align:center;'>Preventive Officer of Customs</td></tr></tbody></table></td></tr></tbody></table>";
            ////}
            //// Html += "<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><thead><tr><th style='width:20%;text-align:right;'><img src='IMGSRC' style='width:50%;' /></th><th style='width:60%;font-weight:600;text-align:center;'><span style='font-size:10pt;'>CENTRAL WAREHOUSING CORPORATION</span><br/>(A Govt. of India Undertaking)</th><th style='text-align:center;'>Container Freight Station<br/><br/>_____________________</th></tr></thead><tbody><tr><td colspan='3'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>S.No</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ObjStuffing.StuffingNo + "</td><td rowspan='2' style='width:60%;font-weight:600;text-align:center;'>FORMAT FOR STUFFING SHEET(FCL/LCL)<br/><span style='border-bottom:1px solid #000;'>CONTAINER STUFFING SHEET</span></td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Date</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + DateTime.Now.ToString("dd/MM/yyyy") + "</td></tr><tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Size</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ObjStuffing.Size + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Godown</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ObjStuffing.GodownName + "</td></tr></tbody></table></td></tr><tr><td colspan='3'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Shipping Bill No.</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ShippingBillNo + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Shipping Bill Date:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ShippingDate + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Gross Weight:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + StuffWeight + "</td></tr><tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Exporter:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Exporter + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Shipping Line:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ShippingLine + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>FOBValue(INR):</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Fob + "</td></tr>			<tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Consignee/CHA:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + CHA + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Destination:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>No. of Packages Stuffed:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + StuffQuantity + "</td></tr></tbody></table></td></tr><tr><td colspan='3' style='padding-top:20pt;'><table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><thead><tr><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>S. No.</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>CFS Code</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Container No.</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Commodity</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Customs Seal</th><th colspan='10' style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Tally</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Total</th></tr></thead><tbody><tr><td style='border:1px solid #000;padding:3px;text-align:center;'>" + SLNo + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + CFSCode + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ContainerNo + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Commodity + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + CustomSeal + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:center;'>-</td><td style='border:1px solid #000;padding:3px;text-align:center;'>-</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td></tr><tr><td colspan='10'></td><td colspan='4' style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Grand Total</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + StuffQuantity + "</td></tr><tr><td colspan='15' style='padding:3px;text-align:left;'>Variation observed if Any</td></tr></tbody></table></td></tr><tr><td colspan='3' style='padding-top:100pt;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr><td style='text-align:center;'>Signature & <br/>Designation with<br/>Date and Seal</td><td style='text-align:center;'>Rep./Surveyor/S.<br/>Agent/Line/CHA</td><td style='text-align:center;'>Shed I/C CWC-CFS</td><td style='text-align:center;'>Rep./Surveyor of H & T<br/>Contractor</td><td style='text-align:center;'>Preventive Officer of Customs</td></tr></tbody></table></td></tr></tbody></table>";
            Html = Html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            using (var Rh = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
            {

                Rh.GeneratePDF(Path, Html);
            }
            return "/Docs/" + Session.SessionID + "/ContainerStuffing" + ContainerStuffingId + ".pdf";
        }
        //[NonAction]
        //public string GeneratePdfForContainerStuff(Chn_ContainerStuffing ObjStuffing, int ContainerStuffingId)
        //{
        //    string Path = Server.MapPath("~/Docs/") + Session.SessionID + "/ContainerStuffing" + ContainerStuffingId + ".pdf";
        //    string Html = "";
        //    string ShippingBillNo = "", ShippingDate = "", StuffWeight = "", Exporter = "", ShippingLine = "", Fob = "", CHA = "",
        //    StuffQuantity = "", SLNo = "", CFSCode = "", ContainerNo = "", CustomSeal = "", Commodity = "";
        //    int SerialNo = 1;
        //    if (ObjStuffing.LstStuffingDtl.Count() > 0)
        //    {
        //        ObjStuffing.LstStuffingDtl.Select(x => new { ShippingBillNo = x.ShippingBillNo }).Distinct().ToList().ForEach(item =>
        //        {
        //            if (ShippingBillNo == "")
        //                ShippingBillNo = item.ShippingBillNo;
        //            else
        //                ShippingBillNo += "," + item.ShippingBillNo;
        //        });

        //        ObjStuffing.LstStuffingDtl.Select(x => new { ShippingDate = x.ShippingDate }).Distinct().ToList().ForEach(item =>
        //        {
        //            if (ShippingDate == "")
        //                ShippingDate = item.ShippingDate;
        //            else
        //                ShippingDate += "," + item.ShippingDate;
        //        });

        //        ObjStuffing.LstStuffingDtl.Select(x => new { Exporter = x.Exporter }).Distinct().ToList().ForEach(item =>
        //        {
        //            if (Exporter == "")
        //                Exporter = item.Exporter;
        //            else
        //                Exporter += "," + item.Exporter;
        //        });
        //        ObjStuffing.LstStuffingDtl.Select(x => new { ShippingLine = x.ShippingLine }).Distinct().ToList().ForEach(item =>
        //        {
        //            if (ShippingLine == "")
        //                ShippingLine = item.ShippingLine;
        //            else
        //                ShippingLine += "," + item.ShippingLine;
        //        });
        //        ObjStuffing.LstStuffingDtl.Select(x => new { CHA = x.CHA }).Distinct().ToList().ForEach(item =>
        //        {
        //            if (CHA == "")
        //                CHA = item.CHA;
        //            else
        //                CHA += "," + item.CHA;
        //        });

        //        StuffWeight = (ObjStuffing.LstStuffingDtl.Sum(x => x.StuffWeight) > 0) ? (ObjStuffing.LstStuffingDtl.Sum(x => x.StuffWeight)).ToString() : "";
        //        Fob = (ObjStuffing.LstStuffingDtl.Sum(x => x.Fob) > 0) ? (ObjStuffing.LstStuffingDtl.Sum(x => x.Fob)).ToString() : "";
        //        StuffQuantity = (ObjStuffing.LstStuffingDtl.Sum(x => x.StuffQuantity) > 0) ? (ObjStuffing.LstStuffingDtl.Sum(x => x.StuffQuantity)).ToString() : "";
        //        ObjStuffing.LstStuffingDtl.ToList().ForEach(item =>
        //        {
        //            SLNo = SLNo + SerialNo + "<br/>";
        //            CFSCode = (CFSCode == "" ? (item.CFSCode) : (CFSCode + "<br/>" + item.CFSCode));
        //            ContainerNo = (ContainerNo == "" ? (item.ContainerNo) : (ContainerNo + "<br/>" + item.ContainerNo));
        //            CustomSeal = (CustomSeal == "" ? (item.CustomSeal) : (CustomSeal + "<br/>" + item.CustomSeal));
        //            Commodity = (Commodity == "" ? (item.CommodityName) : (Commodity + "<br/>" + item.CommodityName));
        //            SerialNo++;
        //        });
        //        SLNo.Remove(SLNo.Length - 1);
        //    }

        //    if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
        //    {
        //        Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
        //    }

        //    Html += "<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><thead><tr><th style='width:20%;text-align:right;'><img src='IMGSRC' style='width:50%;' /></th><th style='width:60%;font-weight:600;text-align:center;'><span style='font-size:10pt;'>CENTRAL WAREHOUSING CORPORATION</span><br/>(A Govt. of India Undertaking)</th><th style='text-align:center;'>ICD Patparganj-Delhi<br/><br/>_____________________</th></tr></thead><tbody><tr><td colspan='3'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>S.No</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ObjStuffing.StuffingNo + "</td><td rowspan='2' style='width:60%;font-weight:600;text-align:center;'><span style='border-bottom:1px solid #000;'>CONTAINER STUFFING SHEET</span></td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Date</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + DateTime.Now.ToString("dd/MM/yyyy") + "</td></tr><tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Size</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ObjStuffing.Size + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Godown</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ObjStuffing.GodownName + "</td></tr></tbody></table></td></tr><tr><td colspan='3'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Shipping Bill No.</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ShippingBillNo + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Shipping Bill Date:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ShippingDate + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Gross Weight:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + StuffWeight + "</td></tr><tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Exporter:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Exporter + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Shipping Line:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ShippingLine + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>FOBValue(INR):</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Fob + "</td></tr>			<tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Consignee/CHA:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + CHA + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Destination:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>No. of Packages Stuffed:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + StuffQuantity + "</td></tr>   <tr><td style='border:1px solid #000;padding:3px;text-align:left;font-weight:600;'>Via:</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ObjStuffing.ContVia + "</td></tr>  </tbody></table></td></tr><tr><td colspan='3' style='padding-top:20pt;'><table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><thead><tr><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>S. No.</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>ICD Code</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Container / CBT No.</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Commodity</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Customs Seal</th><th colspan='10' style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Tally</th><th style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Total</th></tr></thead><tbody><tr><td style='border:1px solid #000;padding:3px;text-align:center;'>" + SLNo + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + CFSCode + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + ContainerNo + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + Commodity + "</td><td style='border:1px solid #000;padding:3px;text-align:left;'>" + CustomSeal + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td><td style='border:1px solid #000;padding:3px;text-align:center;'>-</td><td style='border:1px solid #000;padding:3px;text-align:center;'>-</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + "" + "</td></tr><tr><td colspan='10'></td><td colspan='4' style='border:1px solid #000;padding:3px;text-align:center;font-weight:600;'>Grand Total</td><td style='border:1px solid #000;padding:3px;text-align:right;'>" + StuffQuantity + "</td></tr><tr><td colspan='15' style='padding:3px;text-align:left;'>Variation observed if Any</td></tr></tbody></table></td></tr><tr><td colspan='3' style='padding-top:100pt;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr><td style='text-align:center;'>Signature & <br/>Designation with<br/>Date and Seal</td><td style='text-align:center;'>Rep./Surveyor/S.<br/>Agent/Line/CHA</td><td style='text-align:center;'>Shed I/C CWC-ICD</td><td style='text-align:center;'>Rep./Surveyor of H & T<br/>Contractor</td><td style='text-align:center;'>Preventive Officer of Customs</td></tr></tbody></table></td></tr></tbody></table>";
        //    Html = Html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
        //    using (var Rh = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
        //    {
        //        Rh.GeneratePDF(Path, Html);
        //    }
        //    return "/Docs/" + Session.SessionID + "/ContainerStuffing" + ContainerStuffingId + ".pdf";
        //}

        #endregion

        #region Cargo Carting Report
        [HttpGet]
        public ActionResult CargoCartingReport()
        {
            Dnd_ReportRepository ObjGR = new Dnd_ReportRepository();
            ObjGR.GetGodownForCargoCarting();
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult CargoCartingReportPrint(Dnd_TotalContainerReport obj, string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            // Dnd_TotalContainerReport obj= new Dnd_TotalContainerReport();
            ObjRR.CargoCartingRegisterReportPrint(obj, PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFCargoCartingReport(lstData, PeriodFrom, PeriodTo, obj.GodownName);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFCargoCartingReport(Dnd_TotalContainerReport lstData, string PeriodFrom, string PeriodTo, string GodownName)
        {
            try
            {
                var FileName = "CartingRegister.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                Pages.Append("<tr><td width='65%'></td>");
                Pages.Append("<td width='10%' align='right'>");
                Pages.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                Pages.Append("<tr><td style='border:1px solid #333;'>");
                Pages.Append("<div style='padding: 5px 0; font-size: 7pt; text-align: center;'>F/D'NODE/03</div>");
                Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 23px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:8pt;'>Container Freight Station</span><br/><span style='font-size:8pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:8pt;'><b>Shed No-</b> " + GodownName + "</span><br/><span style='font-size:8pt;'><b>Run Date:</b>" + DateTime.Now + "</span><br/><label style='font-size: 8pt; font-weight:bold;'>Carting Register</label><br/><label style='font-size: 8pt;'><b>Between</b>" + PeriodFrom + " And " + PeriodTo + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' style='width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                Pages.Append("<thead><tr><td colspan='12'><table style='border:1px solid #000;border-bottom:0;width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:40px;'>Sr.</th> ");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>Entry No</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:100px;'>Carting Date</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>Sb No</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:100px;'>Sb Date</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>Exp Code</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>CHA</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:95px;'>Commodity</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;text-align:right;'>Total Pkg</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;text-align:right;'>Pkg Recv</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;text-align:right;'>Balance</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;text-align:right;'>Gr Wt</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:100px;text-align:right;'>FOB</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>Slot No</th>");
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>Gen Res</th>");             
                Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>Area</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:80px;'>Remarks</th>");
                Pages.Append("</tr></tbody></table></td></tr></thead>");

                Pages.Append("<tbody>");
                //Loop
                lstData.LstTotal.Select(x => new { ShippingLineId = x.ShippingLineId, ShippingLineName = x.ShippingLineName }).Distinct().ToList().ForEach(x =>
                       {
                           Pages.Append("<tr><td colspan='12' style='padding:0;'>");
                           Pages.Append("<table cellspacing='0' style='margin:0 0 15px;border:1px solid #000;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                           Pages.Append("<tr><td colspan='12'>");
                           Pages.Append("<table style='margin:0;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                           Pages.Append("<th style='text-align:left;padding:10px;width:5.5%;border-right:1px solid #000;'>S/Line</th> ");
                           Pages.Append("<th style='text-align:left;padding:10px;width:90%;'>" + x.ShippingLineName + "</th> ");
                           Pages.Append("</tr></tbody></table>");
                           Pages.Append("</td></tr>");
                           //Loop
                           int i = 1;
                           lstData.LstTotal.Where(y => y.ShippingLineId == x.ShippingLineId).ToList().ForEach(y =>
                                  {
                                      Pages.Append("<tr><td colspan='12'>");
                                      Pages.Append("<table cellspacing='0' style='width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;border-top:1px solid #000;padding:10px;width:40px;'>" + i + "</td> ");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.EntryNo + "</td>");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:100px;'>" + y.CartingDate + "</td> ");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.ShippingBillNo + "</td> ");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:100px;'>" + y.ShippingBillDate + "</td>");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.ExpCode + "</td> ");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.CHA + "</td>");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:95px;'>" + y.Commodity + "</td>");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;text-align:right;'>" + y.TotalPkg.ToString("0.00") + "</td>");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;text-align:right;'>" + y.ReceivedPkg.ToString("0.00") + "</td>");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;text-align:right;'>" + y.Balance.ToString() + "</td>");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;text-align:right;'>" + y.GrossWeight.ToString("0.00") + "</td>");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:100px;text-align:right;'>" + y.Fob.ToString() + "</td>");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.SlotNo + "</td>");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.GenReserved + "</td>");                                     
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.Area.ToString("0.00") + "</td>");
                                      Pages.Append("<td style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'>" + y.Remarks + "</td>");
                                      Pages.Append("</tr></tbody></table>");
                                      Pages.Append("</td></tr>");
                                      i++;
                                  });
                           //loop end

                           Pages.Append("<tr><td colspan='12'>");
                           Pages.Append("<table cellspacing='0' style='width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:53px;'>Total</th> ");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'></th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:100px;'></th> ");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'></th> ");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:100px;'></th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'></th> ");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'></th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:95px;'></th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;text-align:right;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.TotalPkg).ToString("0.00") + "</th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;text-align:right;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.ReceivedPkg).ToString("0.00") + "</th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;text-align:right;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Balance) + "</th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;text-align:right;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.GrossWeight).ToString("0.00") + "</th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:100px;text-align:right;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Fob).ToString("0.00") + "</th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'></th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'></th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'></th>");
                           Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'></th>");
                           Pages.Append("</tr></tbody></table>");
                           Pages.Append("</td></tr>");


                           //Pages.Append("<tr><td colspan='12'>");
                           //Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                           //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:6%;'></th> ");
                           //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:2%;'></th> ");
                           //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'>Total :</th>");
                           //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th> ");
                           //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:10%;'></th> ");
                           //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th>");
                           //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:7%;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.TotalPkg) + "</th> ");
                           //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:9%;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.ReceivedPkg).ToString("0.00") + "</th>");
                           //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:13%;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Balance) + "</th>");
                           //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th>");
                           //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:5%;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.GrossWeight).ToString("0.00") + "</th>");
                           //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th>");
                           //Pages.Append("</tr></tbody></table>");
                           //Pages.Append("</td></tr>");

                           Pages.Append("</tbody></table>");
                           Pages.Append("</td></tr>");
                       });
                //loop  end


                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' style='width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border:1px solid #000;'><tbody><tr>");
                Pages.Append("<th style='text-align:left;padding:10px;width:104px;'>Grand Total</th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:78px;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:78px;'></th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:78px;'></th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:78px;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:78px;'></th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:78px;'></th>");
                Pages.Append("<th style='border-right:1px solid #000;text-align:left;padding:10px;width:80px;'></th>");
                Pages.Append("<th style='border-right:1px solid #000;text-align:left;padding:10px;width:80px;text-align:right;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.TotalPkg) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;text-align:left;padding:10px;width:80px;text-align:right;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.ReceivedPkg).ToString("0.00") + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;text-align:left;padding:10px;width:80px;text-align:right;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.Balance) + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;text-align:left;padding:10px;width:80px;text-align:right;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.GrossWeight).ToString("0.00") + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;text-align:left;padding:10px;width:100px;text-align:right;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.Fob).ToString("0.00") + "</th>");
                Pages.Append("<th style='border-right:1px solid #000;text-align:left;padding:10px;width:80px;'></th>");
                Pages.Append("<th style='border-right:1px solid #000;text-align:left;padding:10px;width:80px;'></th>");
                Pages.Append("<th style='border-right:1px solid #000;text-align:left;padding:10px;width:80px;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:80px;'></th>");
                Pages.Append("</tr></tbody></table>");
                Pages.Append("</td></tr>");



                //Pages.Append("<tr><td colspan='12'>");
                //Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                //Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:6%;'></th>");
                //Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:2%;'></th>");
                //Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'>Total :</th>");
                //Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'>" + lstData.LstTotal.Count() + "</th>");
                //Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:10%;'></th>");
                //Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'></th>");
                //Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:7%;'>" + lstData.LstTotal.Sum(x => x.TotalPkg) + "</th>");
                //Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:9%;'>" + lstData.LstTotal.Sum(x => x.ReceivedPkg).ToString("0.00") + "</th>");
                //Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:13%;'>" + lstData.LstTotal.Sum(x => x.Fob) + "</th>");
                //Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'></th>");
                //Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:5%;'>" + lstData.LstTotal.Sum(x => x.Area).ToString("0.00") + "</th>");
                //Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'></th>");
                //Pages.Append("</tr></tbody></table>");
                //Pages.Append("</td></tr>");

                Pages.Append("</tbody>");
                Pages.Append("</table>");
                Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 30f, 30f, 30f, 30f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        //[NonAction]
        //public string GeneratePDFCargoCartingReport(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        //{
        //    try
        //    {
        //        var FileName = "CargoCarting.pdf";
        //        StringBuilder Pages = new StringBuilder();
        //        string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
        //        Pages.Append("<tr><td colspan='12'>");
        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
        //        Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
        //        Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>Run Date </b> " + DateTime.Now + " </span><br/><label style='font-size: 7pt; font-weight:bold;'>Vessel Wise Pendency Report</label></td></tr>");
        //        Pages.Append("</tbody></table>");
        //        Pages.Append("</td></tr>");
        //        Pages.Append("</thead></table>");

        //        Pages.Append("<table cellspacing='0' cellpadding='0' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
        //        Pages.Append("<thead><tr><th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>S/Line</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Shipping Line Name</th>");

        //        Pages.Append("<th cellspacing='0' cellpadding='0'><table cellspacing='0' cellpadding='0' style='width:100%; font-size:7pt;'><thead><tr>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Entry No</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Carting Date</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Sb No</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Sb Date</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Exp Code</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Cha</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Comdty</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>TotPkg</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>PkgRcvd</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Bal</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Gr Wt</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Fob</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Slot No</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Gen Res</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;width:10%;'>Area</th>");
        //        Pages.Append("</tr></thead></table></th>");
        //        Pages.Append("</tr></thead>");

        //        Pages.Append("<tbody>");
        //        int i = 1; int total20; int total40; int total45; int Teus; int total;
        //        total20 = 0;
        //        total40 = 0;
        //        total45 = 0;
        //        lstData.LstTotal.Select(x => new { x.ShippingLineId, x.ShippingLineName }).Distinct().ToList().ForEach(item =>
        //        {
        //            Pages.Append("<tr>");
        //            Pages.Append("<td cellpadding='7' valign='top' style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'>" + i + "</td>");
        //            Pages.Append("<td cellpadding='7' valign='top' style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'>" + item.ShippingLineName + "</td>");
        //           // Pages.Append("<td cellpadding='7' valign='top' style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'>" + item.Vessel + "</td>");
        //            Pages.Append("<td cellspacing='0' cellpadding='0' style='width:75%;'><table cellspacing='0' cellpadding='0' style='width:100%;font-size:7pt;'><tbody>");
        //            lstData.LstTotal.Where(x => x.ShippingLineId == item.ShippingLineId).ToList().ForEach(elem =>
        //            {
        //                Pages.Append("<tr>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.EntryNo + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.CartingDate + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%'>" + elem.ShippingBillNo + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.ShippingBillDate + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.ExpCode + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.CHA + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%'>" + elem.Commodity + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.TotalPkg + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.ReceivedPkg + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.Balance + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.GrossWeight + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.Fob + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.SlotNo + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.GenReserved + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.Area + "</td>");
        //              //  Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>" + elem.MovementDate + "</td>");
        //                //if (elem.Size.Equals("20"))
        //                //{
        //                //    total20 = total20 + 1;
        //                //}
        //                //else if (elem.Size.Equals("40"))
        //                //{
        //                //    total40 = total40 + 1;
        //                //}
        //                //else if (elem.Size.Equals("45"))
        //                //{
        //                //    total45 = total45 + 1;
        //                //}
        //                Pages.Append("</tr>");
        //            });
        //            //total = total20 + total40 + total45;
        //            //Teus = total20 + total40 * 2 + total45 * 2;
        //            //Pages.Append("<tr>");
        //            //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>" + total + "</td>");
        //            //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>0</td>");
        //            //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:5%'>+</td>");
        //            //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>3</td>");
        //            //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + Teus + "</td>");
        //            //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'></td>");
        //            //Pages.Append("</tr>");

        //            Pages.Append("</tbody></table></td>");
        //            Pages.Append("</tr>");
        //            i++;

        //        });
        //        Teus = total20 + total40 * 2 + total45 * 2;
        //        total = total20 + total40 + total45;
        //        Pages.Append("<tr>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
        //        Pages.Append("<th cellpadding='7' colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + " </th>");
        //        Pages.Append("</tr>");

        //        Pages.Append("</tbody></table>");


        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='text-align: center; width:50%; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
        //        Pages.Append("<thead>");
        //        Pages.Append("<tr><th style='border-right: 1px solid #000; width: 30px;'>20 FT</th>");
        //        Pages.Append("<th style='border-right: 1px solid #000; width: 30px;'>40 FT</th>");
        //        Pages.Append("<th style='border-right: 1px solid #000; width: 30px;'>45 FT</th>");
        //        Pages.Append("<th style='width: 30px;'>Teus</th></tr>");
        //        Pages.Append("</thead>");

        //        Pages.Append("<tbody>");
        //        Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
        //        Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
        //        Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
        //        Pages.Append("<td style='border-top: 1px solid #000;'>" + Teus + "</td></tr>");
        //        Pages.Append("</tbody></table>");

        //        Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

        //        if (!Directory.Exists(LocalDirectory))
        //        {
        //            Directory.CreateDirectory(LocalDirectory);
        //        }
        //        if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
        //        {
        //            System.IO.File.Delete(LocalDirectory + "/" + FileName);
        //        }
        //        //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
        //        //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
        //        using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
        //        {
        //            ObjPdf.HeadOffice = this.HeadOffice;
        //            ObjPdf.HOAddress = this.HOAddress;
        //            ObjPdf.ZonalOffice = this.ZonalOffice;
        //            ObjPdf.ZOAddress = this.ZOAddress;
        //            ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
        //        }
        //        return "/Docs/" + Session.SessionID + "/Report/" + FileName;
        //    }
        //    catch
        //    {
        //        return "";
        //    }
        //}
        #endregion

        #region  Daily Transaction Carting
        [HttpGet]
        public ActionResult DailyTransactionCarting()
        {
            Dnd_ReportRepository ObjGR = new Dnd_ReportRepository();
            ObjGR.GetGodownForCargoCarting();
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult DailyTransactionCartingPrint(Dnd_TotalContainerReport obj, string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.DailyTransactionCartingPrint(obj, PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                if (obj.GodownId == 0)
                {
                    Path = GeneratePDFDailyCartingReportGodownwise(lstData, PeriodFrom, PeriodTo, obj.GodownName);
                }
                else
                {
                    Path = GeneratePDFDailyCartingReport(lstData, PeriodFrom, PeriodTo, obj.GodownName);
                }

                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }


            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFDailyCartingReportGodownwise(Dnd_TotalContainerReport lstData, string FromDate, string ToDate, string GodownName)
        {
            try
            {
                var FileName = "DailyTransactionDiary(Carting).pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                // Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Daily Transaction Diary(Carting)</label></td></tr>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 23px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:8pt;'>Container Freight Station</span><br/><span style='font-size:8pt;'>" + lstData.mstcompany + "</span><br/><label style='font-size: 8pt; font-weight:bold;'>Consolidated Carting Register</label><br/><span style='font-size:8pt;'><b></b> " +""+ "</span><br/><label style='font-size: 8pt;'><b>For the Period </b>" + FromDate + " And " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;width:20px;'>S.No</th>");
                Pages.Append("<th cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Sla Cd</th>");
                Pages.Append("<th cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Shipbills</th>");
                Pages.Append("<th cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>No Pkgs.</th>");
                Pages.Append("<th cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Gross Weight</th>");
                Pages.Append("<th cellpadding='5' style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>FOB</th>");
                Pages.Append("<th cellpadding='5' style='border-bottom:1px solid #000;width:150px;'>Remarks</th></tr></thead>");
                Pages.Append("<tbody>");
                //  int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;

                lstData.LstTotal.Select(x => new { Godown = x.Godown }).Distinct().ToList().ForEach(x =>
                {
                    Pages.Append("<tr><td colspan='7'>");
                    Pages.Append("<table style='margin:0 0 10px;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                    Pages.Append("<tr><td colspan='7'>");
                    Pages.Append("<table style='margin:0;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                    Pages.Append("<td style='text-align:left;padding:10px;width:5.5%;'><b>Shed No :</b>" + x.Godown + "</td> ");
                    //Pages.Append("<th style='text-align:left;padding:10px;width:90%;'>" + x.EximTraderName + "</th> ");
                    Pages.Append("</tr></tbody></table>");
                    Pages.Append("</td></tr>");
                    //Loop
                    // int i = 1;

                    int i = 1;

                    lstData.LstTotal.Where(y => y.Godown == x.Godown).ToList().ForEach(y =>
                    {
                        Pages.Append("<tr>");
                        Pages.Append("<td cellpadding='5' style='border-top:1px solid #000;border-right:1px solid #000;width:20px;'>" + i + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-top:1px solid #000;border-right:1px solid #000;width:100px;'>" + y.ShippingLine + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-top:1px solid #000;border-right:1px solid #000;width:100px;'>" + y.ShippingBillNo + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-top:1px solid #000;border-right:1px solid #000;width:100px;'>" + y.TotalPkg + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-top:1px solid #000;border-right:1px solid #000;width:100px;'>" + y.GrossWeight + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-top:1px solid #000;border-right:1px solid #000;width:100px;'>" + y.Fob + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-top:1px solid #000;width:150px;'>"+ y.Remarks + "</td>");
                        Pages.Append("</tr>");

                        //if (item.Size.Equals("20"))
                        //{
                        //    total20 = total20 + 1;
                        //}
                        //else if (item.Size.Equals("40"))
                        //{
                        //    total40 = total40 + 1;
                        //}
                        //else if (item.Size.Equals("45"))
                        //{
                        //    total45 = total45 + 1;
                        //}


                        i++;

                    });

                    Pages.Append("<tr>");
                    Pages.Append("<th colspan='2' cellpadding='5' style='border:1px solid #000;border-left:0;width:50px;'>Total</th>");
                    Pages.Append("<th cellpadding='5' style='border:1px solid #000;border-left:0;width:100px;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Count() + "</th>");
                    Pages.Append("<th cellpadding='5' style='border:1px solid #000;border-left:0;width:100px;'>"+lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(y=>y.TotalPkg) +"</th>");
                    Pages.Append("<th cellpadding='5' style='border:1px solid #000;border-left:0;width:100px;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.GrossWeight) + "</th>");
                    Pages.Append("<th cellpadding='5' style='border:1px solid #000;border-left:0;width:100px;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.Fob) + "</th>");
                    Pages.Append("<td cellpadding='5' style='border:1px solid #000;border-left:0;border-right:0;width:150px;'></td>");
                    Pages.Append("</tr>");

                    //Pages.Append("<tr><td colspan='6'>");
                    //Pages.Append("<table style='width:100%;font-size:6.5pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border:1px solid #000;'><tbody><tr>");
                    //Pages.Append("<th cellpadding='5' colspan='2' style='text-align:left;padding:10px;width:20px;border-right:1px solid #000;'>Total</th> ");
                    //Pages.Append("<th cellpadding='5' style='text-align:left;padding:10px;width:100px;border-right:1px solid #000;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.NoOfSbs) + "</th>");
                    //Pages.Append("<th cellpadding='5' style='text-align:left;padding:10px;width:100px;border-right:1px solid #000;'></th>");
                    //Pages.Append("<th cellpadding='5' style='text-align:left;padding:10px;width:100px;border-right:1px solid #000;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.GrossWeight) + "</th>");
                    //Pages.Append("<th cellpadding='5' style='text-align:left;padding:10px;width:100px;border-right:1px solid #000;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.Fob) + "</th>");
                    //Pages.Append("</tr></tbody></table>");
                    //Pages.Append("</td></tr>");

                    Pages.Append("</tbody></table>");
                    Pages.Append("</td></tr>");

                });



                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                //Pages.Append("<tr>");
                //Pages.Append("<th colspan='2' style='border-bottom:1px solid #000; border-right:1px solid #000; width:100px; font-size:7pt;'>Total</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt; width:100px;'>" + lstData.LstTotal.Count() + " </th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt; width:100px;'> " + lstData.LstTotal.Sum(x => x.TotalPkg) + " </th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt; width:100px;'> " + lstData.LstTotal.Sum(x => x.GrossWeight) + " </th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt; width:100px;'> " + lstData.LstTotal.Sum(x => x.Fob) + " </th>");
                //Pages.Append("</tr>");

                //Pages.Append("<tr><td colspan='6'>");
                //Pages.Append("<table style='width:100%;font-size:6.5pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border-top:1px solid #000;'><tbody><tr>");
                //Pages.Append("<th cellpadding='5' colspan='2' style='text-align:left;padding:10px;width:20px;'>Total</th> ");
                //Pages.Append("<th cellpadding='5' style='text-align:left;padding:10px;width:100px;'>Dynamic</th>");
                //Pages.Append("<th cellpadding='5' style='text-align:left;padding:10px;width:100px;'></th>");
                //Pages.Append("<th cellpadding='5' style='text-align:left;padding:10px;width:100px;'> " + lstData.LstTotal.Sum(x => x.GrossWeight) + " </th>");
                //Pages.Append("<th cellpadding='5' style='text-align:left;padding:10px;width:100px;'> " + lstData.LstTotal.Sum(x => x.Fob) + " </th>");
                //Pages.Append("</tr></tbody></table>");
                //Pages.Append("</td></tr>");

                Pages.Append("<tr>");
                Pages.Append("<th colspan='2' cellpadding='5' style='border:1px solid #000;border-left:0;width:50px;font-size:7pt;'>Total</th>");
                Pages.Append("<th cellpadding='5' style='border:1px solid #000;border-left:0;width:100px;font-size:7pt;'>"+ lstData.LstTotal.Count() + "</th>");
                Pages.Append("<th cellpadding='5' style='border:1px solid #000;border-left:0;width:100px;font-size:7pt;'>" + lstData.LstTotal.Sum(x => x.TotalPkg) + "</th>");
                Pages.Append("<th cellpadding='5' style='border:1px solid #000;border-left:0;width:100px;font-size:7pt;'> " + lstData.LstTotal.Sum(x => x.GrossWeight) + " </th>");
                Pages.Append("<th cellpadding='5' style='border:1px solid #000;border-left:0;width:100px;font-size:7pt;'> " + lstData.LstTotal.Sum(x => x.Fob) + " </th>");
               // Pages.Append("<td cellpadding='5' style='border:1px solid #000;border-left:0;border-right:0;width:150px;font-size:7pt;'>Dynamic</td>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");


                //Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                //Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

                //Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'></th>");
                //Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'></th>");
                //Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'></th>");
                //Pages.Append("<th style='width: 100px;'></th></tr>");
                //Pages.Append("</thead>");

                //Pages.Append("<tbody>");

                //Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                //Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                //Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
                //Pages.Append("<td style='border-top: 1px solid #000;'>" + totalteus + "</td></tr>");

                //Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }

        public string GeneratePDFDailyCartingReport(Dnd_TotalContainerReport lstData, string FromDate, string ToDate, string GodownName)
        {
            try
            {
                var FileName = "DailyTransactionDiary(Carting).pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                // Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Daily Transaction Diary(Carting)</label></td></tr>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 23px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:8pt;'>Container Freight Station</span><br/><span style='font-size:8pt;'>" + lstData.mstcompany + "</span><br/><label style='font-size: 8pt; font-weight:bold;'>Daily Transaction Diary(Carting)</label><br/><span style='font-size:8pt;'><b>Shed No-</b> " + GodownName + "</span><br/><label style='font-size: 8pt;'><b>For the Period </b>" + FromDate + " And " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:19%;'>Sla Cd</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:19%;'>Shipbills</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:19%;'>No Pkgs.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:19%;'>Gross Weight</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:19%;'>FOB</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:19%;'>Remarks</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLine + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingBillNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.TotalPkg + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GrossWeight + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Fob + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Remarks + "</td>");
                    Pages.Append("</tr>");

                    //if (item.Size.Equals("20"))
                    //{
                    //    total20 = total20 + 1;
                    //}
                    //else if (item.Size.Equals("40"))
                    //{
                    //    total40 = total40 + 1;
                    //}
                    //else if (item.Size.Equals("45"))
                    //{
                    //    total45 = total45 + 1;
                    //}


                    i++;

                });
                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>  </th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>" + lstData.LstTotal.Count() + " </th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'> " + lstData.LstTotal.Sum(x => x.TotalPkg) + " </th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'> " + lstData.LstTotal.Sum(x => x.GrossWeight) + " </th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'> " + lstData.LstTotal.Sum(x => x.Fob) + " </th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'> " +"" + " </th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                //Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                //Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

                //Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'></th>");
                //Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'></th>");
                //Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'></th>");
                //Pages.Append("<th style='width: 100px;'></th></tr>");
                //Pages.Append("</thead>");

                //Pages.Append("<tbody>");

                //Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                //Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                //Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
                //Pages.Append("<td style='border-top: 1px solid #000;'>" + totalteus + "</td></tr>");

                //Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region  Stuffing Request Register

        [HttpGet]
        public ActionResult StuffingRequestRegister()
        {
            Dnd_ReportRepository ObjGR = new Dnd_ReportRepository();
            ObjGR.GetGodownForCargoCarting();
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult StuffingRequestRegisterPrint(Dnd_TotalContainerReport obj, string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.StuffingRequestRegisterPrint(obj, PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                //Path = GeneratePDFStuffingRequestRegister(PeriodFrom, PeriodTo);
                if (obj.GodownId == 0)
                {
                    Path = GeneratePDFStuffingRequestGodown(lstData, PeriodFrom, PeriodTo);

                }
                else
                {
                    Path = GeneratePDFStuffingRequestRegister(lstData, PeriodFrom, PeriodTo, obj.GodownName);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFStuffingRequestRegister(Dnd_TotalContainerReport lstData, string FromDate, string ToDate, string GodownName)
        {
            try
            {
                var FileName = "StuffingRequestRegister.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                Pages.Append("<tr><td width='65%'></td>");
                Pages.Append("<td width='10%' align='right'>");
                Pages.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                Pages.Append("<tr><td style='border:1px solid #333;'>");
                Pages.Append("<div style='padding: 5px 0; font-size: 7pt; text-align: center;'>F/D'NODE/07</div>");
                Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>Container Freight Station</span><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>Run Date:</b>" + DateTime.Now + "</span><br/><label style='font-size: 8pt; font-weight:bold;'>STUFFING REQUEST</label><br/><label style='font-size: 7pt;'><b>Between </b>" + FromDate + " And " + ToDate + "</label> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <span style='font-size:7pt;'><b>Shed No-</b> " + GodownName + "</span></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Stuff Req No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Stuff Req Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Cont No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Cont Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S/Line</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>No Of SbS</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>No Of Units</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Via No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Vessel Name</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.StuffingReqNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.RequestDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLineName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.NoOfSbs + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.NoOfUnits + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Via + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Vessel + "</td>");
                    Pages.Append("</tr>");




                    //if (item.Size.Equals("20"))
                    //{
                    //    total20 = total20 + 1;
                    //}
                    //else if (item.Size.Equals("40"))
                    //{
                    //    total40 = total40 + 1;
                    //}
                    //else if (item.Size.Equals("45"))
                    //{
                    //    total45 = total45 + 1;
                    //}


                    i++;

                });


                total20 = lstData.LstTotal.Select(x => new { CFSCode = x.CFSCode, Size = x.Size }).Distinct().Where(x => x.Size == "20").Count();
                total40 = lstData.LstTotal.Select(x => new { CFSCode = x.CFSCode, Size = x.Size }).Distinct().Where(x => x.Size == "40").Count();
                total45 = lstData.LstTotal.Select(x => new { CFSCode = x.CFSCode, Size = x.Size }).Distinct().Where(x => x.Size == "45").Count();

                //total20 = total20;
                //total40 = total40;
                //total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'> " + lstData.LstTotal.Count() + " </th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; font-size:7pt;'>" + lstData.LstTotal.Sum(x => x.NoOfSbs) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; font-size:7pt;'>" + lstData.LstTotal.Sum(x => x.NoOfUnits) + " </th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>  </th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th colspan='3' style='border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='width: 100px;'>45 FT</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + total45 + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 30f, 30f, 30f, 30f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        [NonAction]
        public string GeneratePDFStuffingRequestGodown(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "StuffingDailyTransaction.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                // Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 28px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 14px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:14px;'>" + lstData.mstcompany + "</span><br/><span style='font-size:14px;'><b>Stock Register of Shed No...</b></span><br/><span style='font-size:14px;'><b>As on Date...</b> </span><br/><label style='font-size: 16px; font-weight:bold;'>DAILY TRANSACTION DIARY STUFFING</label></td></tr>");
                // Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7.5pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7.5pt;'>Container Freight Station</span><br/><span style='font-size:7.5pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7.5pt;'><b>Run Date:</b>" + DateTime.Now + "</span><br/><label style='font-size: 7.5pt; font-weight:bold;'>DAILY TRANSACTION DIARY STUFFING</label><br/><label style='font-size: 7.5pt;'><b>Between </b>" + FromDate + " And " + ToDate + "</label></td></tr>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:8pt;'>Container Freight Station</span><br/><span style='font-size:8pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:8pt;'><b>Run Date:</b>" + DateTime.Now + "</span><br/><label style='font-size: 8pt; font-weight:bold;'>STUFFING REQUEST</label><br/><label style='font-size: 8pt;'><b>Between </b>" + FromDate + " And " + ToDate + "</label> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <span style='font-size:8pt;'><b>Shed No-</b></span></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                Pages.Append("<thead><tr><td colspan='12'><table style='border-top:1px solid #000;border-left:1px solid #000;border-right:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                Pages.Append("<th style='text-align:left;padding:10px;width:3%;'>Sr.</th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Stuff Req No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Stuff Req Date</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Cont No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:7%;'>Size</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'>S/Line</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'>In Date</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'>No Of SbS</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>No Of Units</th>");
                // Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>GR.Wt</th>");
                //  Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>FOB</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>Via No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>Vessel Name</th>");
                Pages.Append("</tr></tbody></table></td></tr></thead>");

                Pages.Append("<tbody>");
                //Loop

                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;
                total20 = 0;
                total40 = 0;
                total45 = 0;
                lstData.LstTotal.Select(x => new { Godown = x.Godown }).Distinct().ToList().ForEach(x =>
                {
                    Pages.Append("<tr><td colspan='12' style='padding:0;'>");
                    Pages.Append("<table style='margin:0 0 15px;border:1px solid #000;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                    Pages.Append("<tr><td colspan='12'>");
                    Pages.Append("<table style='margin:0;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                    Pages.Append("<td style='text-align:left;padding:10px;width:5.5%;'><b>Shed No :</b>" + x.Godown + "</td> ");
                    //Pages.Append("<th style='text-align:left;padding:10px;width:90%;'>" + x.EximTraderName + "</th> ");
                    Pages.Append("</tr></tbody></table>");
                    Pages.Append("</td></tr>");
                    //Loop
                    // int i = 1;  

                    int i = 1;
                    lstData.LstTotal.Where(y => y.Godown == x.Godown).ToList().ForEach(y =>
                    {
                        Pages.Append("<tr><td colspan='12'>");
                        Pages.Append("<table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:3%;'>" + i + "</td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.StuffingReqNo + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.RequestDate + "</td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:10%;'>" + y.CFSCode + "</td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.ContainerNo + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:7%;'>" + y.Size + "</td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:9%;'>" + y.ShippingLineName + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:9%;'>" + y.InDateTime + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:9%;'>" + y.NoOfSbs + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.NoOfUnits + "</td>");
                        // Pages.Append("<td style='text-align:left;padding:10px;width:5%;'>" + y.GrossWeight.ToString("0.00") + "</td>");
                        //  Pages.Append("<td style='text-align:left;padding:10px;width:5%;'>" + y.Fob.ToString("0.00") + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:5%;'>" + y.Via + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:5%;'>" + y.Vessel + "</td>");
                        Pages.Append("</tr></tbody></table>");
                        Pages.Append("</td></tr>");


                        //if (y.Size.Equals("20"))
                        //{
                        //    total20 = total20 + 1;
                        //}
                        //else if (y.Size.Equals("40"))
                        //{
                        //    total40 = total40 + 1;
                        //}
                        //else if (y.Size.Equals("45"))
                        //{
                        //    total45 = total45 + 1;
                        //}


                        i++;
                    });
                    //loop end



                    Pages.Append("<tr><td colspan='12'>");
                    Pages.Append("<table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border-top:1px solid #000;'><tbody><tr>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:3%;'>Total</th> ");
                    Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Count() + "</th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:8%;'></th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:10%;'></th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:8%;'></th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:7%;'></th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:9%;'></th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:9%;'></th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:9%;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.NoOfSbs) + "</th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.NoOfUnits) + " </th>");
                    //  Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.GrossWeight) + "</th>");
                    //  Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.Fob) + "</th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:5%;'></th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:5%;'></th>");
                    Pages.Append("</tr></tbody></table>");
                    Pages.Append("</td></tr>");

                    Pages.Append("</tbody></table>");
                    Pages.Append("</td></tr>");
                });
                //loop  end

                total20 = lstData.LstTotal.Select(p => new { CFSCode = p.CFSCode, Size = p.Size }).Distinct().Where(p => p.Size == "20").Count();
                total40 = lstData.LstTotal.Select(p => new { CFSCode = p.CFSCode, Size = p.Size }).Distinct().Where(p => p.Size == "40").Count();
                total45 = lstData.LstTotal.Select(p => new { CFSCode = p.CFSCode, Size = p.Size }).Distinct().Where(p => p.Size == "45").Count();

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border-top:1px solid #000;'><tbody><tr>");
                Pages.Append("<th style='text-align:left;padding:10px;width:3%;'>Total</th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>" + lstData.LstTotal.Count() + "</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:7%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'>" + lstData.LstTotal.Sum(x => x.NoOfSbs) + "</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>" + lstData.LstTotal.Sum(x => x.NoOfUnits) + "</th>");
                // Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>" + lstData.LstTotal.Sum(x => x.GrossWeight) + "</th>");
                // Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>" + lstData.LstTotal.Sum(x => x.Fob) + "</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:5%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:5%;'></th>");
                Pages.Append("</tr></tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("</tbody>");
                Pages.Append("</table>");
                Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");


                //Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                //Pages.Append("<thead>");
                //Pages.Append("<tr><th colspan='3' style='border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");
                //Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                //Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                //Pages.Append("<th style='width: 100px;'>45 FT</th></tr>");
                //Pages.Append("</thead>");
                //Pages.Append("<tbody>");
                //Pages.Append("<tr>");
                //Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>" + total20 + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>" + total40 + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>" + total45 + "</th>");
                //Pages.Append("</tr>");
                //Pages.Append("</tbody></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th colspan='3' style='border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='width: 100px;'>45 FT</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'>" + total45 + "</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region  Stuffing Daily Transaction

        [HttpGet]
        public ActionResult StuffingDailyTransaction()
        {
            Dnd_ReportRepository ObjGR = new Dnd_ReportRepository();
            ObjGR.GetGodownForCargoCarting();
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult DailyTransactionStuffingPrint(Dnd_TotalContainerReport obj, string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.StuffingDailyTransactionPrint(obj, PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                //Path = GeneratePDFStuffingRequestRegister(PeriodFrom, PeriodTo);
                if (obj.GodownId == 0)
                {
                    Path = GeneratePDFDailyTransactionGodownStuffing(lstData, PeriodFrom, PeriodTo);

                }
                else
                    Path = GeneratePDFDailyTransactionStuffing(lstData, PeriodFrom, PeriodTo, obj.GodownName);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFDailyTransactionStuffing(Dnd_TotalContainerReport lstData, string FromDate, string ToDate, string GodownName)
        {
            try
            {
                var FileName = "StuffingDailyTransaction.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");

                //Pages.Append("<tr><td colspan='12'>");
                //Pages.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                //Pages.Append("<tr><td width='65%'></td>");
                //Pages.Append("<td width='10%' align='right'>");
                //Pages.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                //Pages.Append("<tr><td style='border:1px solid #333;'>");
                //Pages.Append("<div style='padding: 5px 0; font-size: 7pt; text-align: center;'>F/D'NODE/07</div>");
                //Pages.Append("</td></tr>");
                //Pages.Append("</tbody></table>");
                //Pages.Append("</td></tr>");
                //Pages.Append("</tbody></table>");
                //Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>Container Freight Station</span><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>Run Date:</b>" + DateTime.Now + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>DAILY TRANSACTION DIARY STUFFING</label><br/><label style='font-size: 7pt;'><b>Between </b>" + FromDate + " And " + ToDate + "</label> <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <span style='font-size:7pt;'><b>Shed No-</b> " + GodownName + "</span></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:6pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Stuff Req No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Stuff Req Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Cont No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Size</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>S/Line</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:9%;'>In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:6%;'>No Of SbS</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:7%;'>No Of Units</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>GR.Wt</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>FOB</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Via No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Vessel Name</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.StuffingReqNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.RequestDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ContainerNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Size + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLineName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.NoOfSbs + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.NoOfUnits + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GrossWeight + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Fob + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Via + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Vessel + "</td>");
                    Pages.Append("</tr>");

                    //if (item.Size.Equals("20"))
                    //{
                    //    total20 = total20 + 1;
                    //}
                    //else if (item.Size.Equals("40"))
                    //{
                    //    total40 = total40 + 1;
                    //}
                    //else if (item.Size.Equals("45"))
                    //{
                    //    total45 = total45 + 1;
                    //}


                    i++;

                });
                total20 = lstData.LstTotal.Select(p => new { CFSCode = p.CFSCode, Size = p.Size }).Distinct().Where(p => p.Size == "20").Count();
                total40 = lstData.LstTotal.Select(p => new { CFSCode = p.CFSCode, Size = p.Size }).Distinct().Where(p => p.Size == "40").Count();
                total45 = lstData.LstTotal.Select(p => new { CFSCode = p.CFSCode, Size = p.Size }).Distinct().Where(p => p.Size == "45").Count();

                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%;'>Total</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'>" + lstData.LstTotal.Count() + " </th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'>" + lstData.LstTotal.Sum(x => x.NoOfSbs) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'>" + lstData.LstTotal.Sum(x => x.NoOfUnits) + " </th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'>" + lstData.LstTotal.Sum(x => x.GrossWeight) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'>" + lstData.LstTotal.Sum(x => x.Fob) + " </th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'></th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");


                //Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt; margin-top:20px;'>");
                //Pages.Append("<tbody>");
                //Pages.Append("<tr>");
                //Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>" + total20 + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>+</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>" + total40 + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>+</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>" + total45 + "</th>");
                //Pages.Append("</tr>");
                //Pages.Append("</tbody></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th colspan='3' style='border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");
                Pages.Append("<tr><th style='border-bottom:1px solid #000; border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-bottom:1px solid #000; width: 100px;'>45 FT</th></tr>");
                Pages.Append("</thead>");
                Pages.Append("<tbody>");
                Pages.Append("<tr>");
                Pages.Append("<th style='font-size:7pt;'>" + total20 + "</th>");
                Pages.Append("<th style='font-size:7pt;'>" + total40 + "</th>");
                Pages.Append("<th style='font-size:7pt;'>" + total45 + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 20f, 20f, 20f, 20f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        [NonAction]
        public string GeneratePDFDailyTransactionGodownStuffing(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "StuffingDailyTransaction.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                // Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 28px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 14px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:14px;'>" + lstData.mstcompany + "</span><br/><span style='font-size:14px;'><b>Stock Register of Shed No...</b></span><br/><span style='font-size:14px;'><b>As on Date...</b> </span><br/><label style='font-size: 16px; font-weight:bold;'>DAILY TRANSACTION DIARY STUFFING</label></td></tr>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7.5pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7.5pt;'>Container Freight Station</span><br/><span style='font-size:7.5pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7.5pt;'><b>Run Date:</b>" + DateTime.Now + "</span><br/><label style='font-size: 7.5pt; font-weight:bold;'>DAILY TRANSACTION DIARY STUFFING</label><br/><label style='font-size: 7.5pt;'><b>Between </b>" + FromDate + " And " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                Pages.Append("<thead><tr><td colspan='12'><table style='border-top:1px solid #000;border-left:1px solid #000;border-right:1px solid #000;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>Sr.</th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Stuff Req No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Stuff Req Date</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'>CFS Code</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Cont No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:7%;'>Size</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'>S/Line</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'>In Date</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:4%;'>No Of SbS</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>No Of Units</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'>GR.Wt</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'>FOB</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>Via No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'>Vessel Name</th>");
                Pages.Append("</tr></tbody></table></td></tr></thead>");

                Pages.Append("<tbody>");
                //Loop
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;

                total20 = 0;
                total40 = 0;
                total45 = 0;

                lstData.LstTotal.Select(x => new { Godown = x.Godown }).Distinct().ToList().ForEach(x =>
                 {
                     Pages.Append("<tr><td colspan='12' style='padding:0;'>");
                     Pages.Append("<table style='margin:0 0 15px;border:1px solid #000;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                     Pages.Append("<tr><td colspan='12'>");
                     Pages.Append("<table style='margin:0;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                     Pages.Append("<td style='text-align:left;padding:10px;width:5.5%;'><b>Shed No :</b>" + x.Godown + "</td> ");
                     //Pages.Append("<th style='text-align:left;padding:10px;width:90%;'>" + x.EximTraderName + "</th> ");
                     Pages.Append("</tr></tbody></table>");
                     Pages.Append("</td></tr>");
                     //Loop
                     // int i = 1;

                     int i = 1;
                     lstData.LstTotal.Where(y => y.Godown == x.Godown).ToList().ForEach(y =>
                     {
                         Pages.Append("<tr><td colspan='12'>");
                         Pages.Append("<table style='width:100%;font-size:6.5pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                         Pages.Append("<td style='text-align:left;padding:10px;width:5%;'>" + i + "</td> ");
                         Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.StuffingReqNo + "</td>");
                         Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.RequestDate + "</td> ");
                         Pages.Append("<td style='text-align:left;padding:10px;width:10%;'>" + y.CFSCode + "</td> ");
                         Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.ContainerNo + "</td>");
                         Pages.Append("<td style='text-align:left;padding:10px;width:7%;'>" + y.Size + "</td> ");
                         Pages.Append("<td style='text-align:left;padding:10px;width:9%;'>" + y.ShippingLineName + "</td>");
                         Pages.Append("<td style='text-align:left;padding:10px;width:9%;'>" + y.InDateTime + "</td>");
                         Pages.Append("<td style='text-align:left;padding:10px;width:4%;'>" + y.NoOfSbs + "</td>");
                         Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.NoOfUnits + "</td>");
                         Pages.Append("<td style='text-align:left;padding:10px;width:10%;'>" + y.GrossWeight.ToString("0.00") + "</td>");
                         Pages.Append("<td style='text-align:left;padding:10px;width:10%;'>" + y.Fob.ToString("0.00") + "</td>");
                         Pages.Append("<td style='text-align:left;padding:10px;width:5%;'>" + y.Via + "</td>");
                         Pages.Append("<td style='text-align:left;padding:10px;width:10%;'>" + y.Vessel + "</td>");
                         Pages.Append("</tr></tbody></table>");
                         Pages.Append("</td></tr>");


                         //if (y.Size.Equals("20"))
                         //{
                         //    total20 = total20 + 1;
                         //}
                         //else if (y.Size.Equals("40"))
                         //{
                         //    total40 = total40 + 1;
                         //}
                         //else if (y.Size.Equals("45"))
                         //{
                         //    total45 = total45 + 1;
                         //}


                         i++;
                     });
                     //loop end

                     Pages.Append("<tr><td colspan='12'>");
                     Pages.Append("<table style='width:100%;font-size:6.5pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border-top:1px solid #000;'><tbody><tr>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>Total</th> ");
                     Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Count() + "</th>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:8%;'></th>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:10%;'></th>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:8%;'></th>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:7%;'></th>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:9%;'></th>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:9%;'></th>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:4%;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.NoOfSbs) + "</th>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.NoOfUnits) + " </th>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:10%;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.GrossWeight) + "</th>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:10%;'>" + lstData.LstTotal.Where(z => z.Godown == x.Godown).Sum(z => z.Fob) + "</th>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:5%;'></th>");
                     Pages.Append("<th style='text-align:left;padding:10px;width:10%;'></th>");
                     Pages.Append("</tr></tbody></table>");
                     Pages.Append("</td></tr>");

                     Pages.Append("</tbody></table>");
                     Pages.Append("</td></tr>");
                 });
                //loop  end
                total20 = lstData.LstTotal.Select(p => new { CFSCode = p.CFSCode, Size = p.Size }).Distinct().Where(p => p.Size == "20").Count();
                total40 = lstData.LstTotal.Select(p => new { CFSCode = p.CFSCode, Size = p.Size }).Distinct().Where(p => p.Size == "40").Count();
                total45 = lstData.LstTotal.Select(p => new { CFSCode = p.CFSCode, Size = p.Size }).Distinct().Where(p => p.Size == "45").Count();

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table style='width:100%;font-size:6.5pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border-top:1px solid #000;'><tbody><tr>");
                Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>Total</th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>" + lstData.LstTotal.Count() + "</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:7%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:4%;'>" + lstData.LstTotal.Sum(x => x.NoOfSbs) + "</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>" + lstData.LstTotal.Sum(x => x.NoOfUnits) + "</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'>" + lstData.LstTotal.Sum(x => x.GrossWeight) + "</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'>" + lstData.LstTotal.Sum(x => x.Fob) + "</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:5%;'></th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'></th>");
                Pages.Append("</tr></tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("</tbody>");
                Pages.Append("</table>");
                Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th colspan='3' style='border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");
                Pages.Append("<tr><th style='border-bottom:1px solid #000; border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='border-bottom:1px solid #000; width: 100px;'>45 FT</th></tr>");
                Pages.Append("</thead>");
                Pages.Append("<tbody>");
                Pages.Append("<tr>");
                Pages.Append("<th style='font-size:7pt;'>" + total20 + "</th>");
                Pages.Append("<th style='font-size:7pt;'>" + total40 + "</th>");
                Pages.Append("<th style='font-size:7pt;'>" + total45 + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");

                //Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt; margin-top:20px;'>");
                //Pages.Append("<tbody>");
                //Pages.Append("<tr>");
                //Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>"+lstData.LstTotal.Count(X=>X.Size.Equals("20")) +"</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>+</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>" + lstData.LstTotal.Count(X => X.Size.Equals("40")) + "</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>+</th>");
                //Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>" + lstData.LstTotal.Count(X => X.Size.Equals("45")) + "</th>");
                //Pages.Append("</tr>");
                //Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region PV Report
        [HttpGet]
        public ActionResult PVReport()
        {
            DNODEMasterRepository ObjGR = new DNODEMasterRepository();
            ObjGR.GetAllGodown();
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GetPVReport(Dnd_PV ObjPV)
        {
            if (ModelState.IsValid)
            {
                Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
                if (ObjPV.Module == "Import")
                    ObjRR.GetPVReportImport(ObjPV);
                else if (ObjPV.Module == "ITP")
                    ObjRR.GetPVReportImportITP(ObjPV);
                else if (ObjPV.Module == "Export")
                    ObjRR.GetPVReportExport(ObjPV);
                else
                    ObjRR.GetPVReportBond(ObjPV);
                string Path = "";
                if (ObjRR.DBResponse.Data != null && ObjPV.Module == "Import")
                {
                    List<Dnd_ImpPVReport> lstData = new List<Dnd_ImpPVReport>();
                    lstData = (List<Dnd_ImpPVReport>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFImpPVReport(lstData, ObjPV.AsOnDate, ObjPV.GodownName);
                }
                else if (ObjRR.DBResponse.Data != null && ObjPV.Module == "ITP")
                {
                    List<Dnd_ImpPVReport> lstData = new List<Dnd_ImpPVReport>();
                    lstData = (List<Dnd_ImpPVReport>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFImpPVReportITP(lstData, ObjPV.AsOnDate, ObjPV.GodownName);
                }
                else if (ObjRR.DBResponse.Data != null && ObjPV.Module == "Export")
                {
                    List<Dnd_ExpPVReport> lstData = new List<Dnd_ExpPVReport>();
                    lstData = (List<Dnd_ExpPVReport>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFPExpPVReport(lstData, ObjPV.AsOnDate, ObjPV.GodownName);
                }
                else
                {
                    List<Dnd_BondPVReport> lstData = new List<Dnd_BondPVReport>();
                    lstData = (List<Dnd_BondPVReport>)ObjRR.DBResponse.Data;
                    Path = GeneratePDFBondPVReport(lstData, ObjPV.AsOnDate, ObjPV.GodownName);
                }
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                var ErrorMessage = string.Join(",", ModelState.Values.SelectMany(m => m.Errors).Select(e => e.ErrorMessage));
                return Json(new { Status = 0, Message = ErrorMessage });
            }
        }
        [NonAction]
        public string GeneratePDFImpPVReport(List<Dnd_ImpPVReport> lstData, string Date, string GodownName)
        {
            try
            {
                var FileName = "PVReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>" + lstData[0].CompanyLocation + "-" + lstData[0].CompanyBranch + "</span><br/><span style='font-size:12px;'><b>As On Date - </b> " + Date + "</span><br/><span style='font-size:12px;'><b>Shed Cd - </b>" + GodownName + "</span><br/><label style='font-size: 14px; font-weight:bold;'>Physical Verification Report for Import Cargo</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'><thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>S No</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>OBL No</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Dstf Date</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>ICD Code</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Item No</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>No Pkg</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Rcvd Pkg</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Gr W</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Area</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Slot No</th><th style='border-bottom:1px solid #000;'>Remarks</th></tr></thead><tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.BOLNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.DestuffingEntryDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CommodityAlias + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.NoOfUnits + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.NoOfUnitsRec + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Weight.ToString("0.00") + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Area.ToString("0.00") + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.LocationName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Remarks + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });

                Pages.Append("<tr>");
                Pages.Append("<th colspan='5' style='border-bottom:1px solid #000;text-align:left;'>Total :</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.NoOfUnits) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.NoOfUnitsRec) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Weight).ToString("0.00") + "</th>");
                Pages.Append("<th colspan='3' style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Area).ToString("0.00") + "</th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        [NonAction]
        public string GeneratePDFPExpPVReport(List<Dnd_ExpPVReport> lstData, string Date, string GodownName)
        {
            try
            {
                var FileName = "PVReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 28px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 14px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:14px;'>" + lstData[0].CompanyLocation + "-" + lstData[0].CompanyBranch + "</span><br/><span style='font-size:14px;'><b>Stock Register of Shed No...</b> " + GodownName + "</span><br/><span style='font-size:14px;'><b>As on Date...</b> " + Date + "</span><br/><label style='font-size: 16px; font-weight:bold;'>Physical Verification Report for Export Cargo</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                Pages.Append("<thead><tr><td colspan='12'><table style='border-top:1px solid #000;border-left:1px solid #000;border-right:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                Pages.Append("<th style='text-align:left;padding:10px;width:6%;'>Sla Cd</th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:2%;'>Sr.</th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Sb No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Sb Date</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'>Entry No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Carting Date</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:7%;'>No Pkg</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'>Gr Wt</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:13%;'>Fob</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Slot No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>Area</th>");
                Pages.Append("</tr></tbody></table></td></tr></thead>");

                Pages.Append("<tbody>");
                //Loop
                lstData.Select(x => new { ShippingLineId = x.ShippingLineId, EximTraderName = x.EximTraderName, EximTraderAlias = x.EximTraderAlias }).Distinct().ToList().ForEach(x =>
                {
                    Pages.Append("<tr><td colspan='12' style='padding:0;'>");
                    Pages.Append("<table style='margin:0 0 15px;border:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                    Pages.Append("<tr><td colspan='12'>");
                    Pages.Append("<table style='margin:0;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:5.5%;'>" + x.EximTraderAlias + "</th> ");
                    Pages.Append("<th style='text-align:left;padding:10px;width:90%;'>" + x.EximTraderName + "</th> ");
                    Pages.Append("</tr></tbody></table>");
                    Pages.Append("</td></tr>");
                    //Loop
                    int i = 1;
                    lstData.Where(y => y.ShippingLineId == x.ShippingLineId).ToList().ForEach(y =>
                    {
                        Pages.Append("<tr><td colspan='12'>");
                        Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:6%;'></td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:2%;'>" + i + "</td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.ShippingBillNo + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.ShippingBillDate + "</td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:10%;'>" + y.EntryNo + "</td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.RegisterDate + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:7%;'>" + y.Units + "</td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:9%;'>" + y.Weight.ToString("0.00") + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:13%;'>" + y.Fob + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.LocationName + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:5%;'>" + y.Area.ToString("0.00") + "</td>");
                        Pages.Append("</tr></tbody></table>");
                        Pages.Append("</td></tr>");
                        i++;
                    });
                    //loop end

                    Pages.Append("<tr><td colspan='12'>");
                    Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:6%;'></th> ");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:2%;'></th> ");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'>Total :</th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'>" + lstData.Where(z => z.ShippingLineId == x.ShippingLineId).Count() + "</th> ");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:10%;'></th> ");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:7%;'>" + lstData.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Units) + "</th> ");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:9%;'>" + lstData.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Weight).ToString("0.00") + "</th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:13%;'>" + lstData.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Fob) + "</th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th>");
                    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:5%;'>" + lstData.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Area).ToString("0.00") + "</th>");
                    Pages.Append("</tr></tbody></table>");
                    Pages.Append("</td></tr>");

                    Pages.Append("</tbody></table>");
                    Pages.Append("</td></tr>");
                });
                //loop  end

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:6%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:2%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'>Total :</th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'>" + lstData.Count() + "</th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:10%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:7%;'>" + lstData.Sum(x => x.Units) + "</th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:9%;'>" + lstData.Sum(x => x.Weight).ToString("0.00") + "</th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:13%;'>" + lstData.Sum(x => x.Fob) + "</th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;border-top:1px solid #000;border-bottom:1px solid #333;padding:10px;width:5%;'>" + lstData.Sum(x => x.Area).ToString("0.00") + "</th>");
                Pages.Append("</tr></tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("</tbody>");
                Pages.Append("</table>");
                Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }

        public string GeneratePDFBondPVReport(List<Dnd_BondPVReport> lstData, string Date, string GodownName)
        {
            try
            {
                var FileName = "PVReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                decimal Value = 0, Duty = 0, Total = 0;


                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='70%' valign='top' align='center'><h1 style='font-size: 20px; line-height: 30px;margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1>");
                Pages.Append("<label style='font-size: 12px;'>(A Govt. of India Undertaking) </label><br />");
                Pages.Append("<span style='font-size: 12px; padding-bottom: 10px;'>" + lstData[0].CompAddress + "</span><br/><label style='font-size: 12px;'>Email: -" + lstData[0].CompEmail + "</label><br/><label style='font-size: 12px;'>PV STATEMENT OF LIVE BONDS IN GODOWN NO : " + GodownName + " AS ON " + Date + "</label>");
                Pages.Append("<br /><label style='font-size: 14px; font-weight:bold;'>GODOWN NO : " + GodownName + "</label>");
                Pages.Append("</td>");
                Pages.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'><thead>");
                Pages.Append("<tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>SL. NO</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>BOND NO</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>BOND DATE</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>NAME OF THE IMPORTER</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>DESCRIPTION OF GOODS</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>NO OF PKGS</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>WT.IN. KGS</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>ACCESIBLE VALUE</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>DUTY</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>TOTAL</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>AREA IN SQ. MT</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>CHA</th><th style='border-bottom:1px solid #000;'>Remarks</th></tr>");
                Pages.Append("</thead>");
                Pages.Append("<tbody>");

                lstData.ForEach(item =>
                {

                    Value = item.Value;
                    Duty = item.Duty;
                    Total = Math.Round((Value + Duty), 2);


                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.BondNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.BondDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Importer + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ItemDesc + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Units + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Weight + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Value + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Duty + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + (item.Value + item.Duty) + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Area + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CHA + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'></td>");
                    Pages.Append("</tr>");
                    i++;
                });

                Pages.Append("<tr>");
                Pages.Append("<th colspan='5' style='border-bottom:1px solid #000;text-align:left;'>Total :</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Units) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Weight) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Value) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Duty) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + (lstData.Sum(x => x.Value) + lstData.Sum(x => x.Duty)) + "</th>");
                Pages.Append("<th colspan='3' style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Area) + "</th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }

        [NonAction]
        public string GeneratePDFImpPVReportITP(List<Dnd_ImpPVReport> lstData, string Date, string GodownName)
        {
            try
            {
                var FileName = "PVReport.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>" + lstData[0].CompanyLocation + "-" + lstData[0].CompanyBranch + "</span><br/><span style='font-size:12px;'><b>As On Date - </b> " + Date + "</span><br/><span style='font-size:12px;'><b>Shed Cd - </b>" + GodownName + "</span><br/><label style='font-size: 14px; font-weight:bold;'>Physical Verification Report for ITP Import Cargo</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                int i = 1;
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:none; font-size:8pt;'><thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>S No</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>OBL No</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Dstf Date</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>ICD Code</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Item No</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>No Pkg</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Rcvd Pkg</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Gr W</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Area</th><th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Slot No</th><th style='border-bottom:1px solid #000;'>Remarks</th></tr></thead><tbody>");
                lstData.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.BOLNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.DestuffingEntryDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CFSCode + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CommodityAlias + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.NoOfUnits + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.NoOfUnitsRec + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Weight.ToString("0.00") + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Area.ToString("0.00") + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.LocationName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Remarks + "</td>");
                    Pages.Append("</tr>");
                    i++;
                });

                Pages.Append("<tr>");
                Pages.Append("<th colspan='5' style='border-bottom:1px solid #000;text-align:left;'>Total :</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.NoOfUnits) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.NoOfUnitsRec) + "</th>");
                Pages.Append("<th style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Weight).ToString("0.00") + "</th>");
                Pages.Append("<th colspan='3' style='text-align:left;border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.Sum(x => x.Area).ToString("0.00") + "</th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }

        #endregion

        #region SAC Register
        [HttpGet]
        public ActionResult SACRegister()
        {
            return PartialView("SACReport");
        }
        [HttpPost, ValidateAntiForgeryToken]
        public JsonResult GetSACRegister(Hdb_SAC objSAC)
        {
            Hdb_ReportRepository objRR = new Hdb_ReportRepository();
            objRR.GetSACDetails(objSAC.PeriodFrom, objSAC.PeriodTo);
            string Path = "";
            if (objRR.DBResponse.Data != null)
            {
                List<Hdb_SACRegister> lstSAC = new List<Hdb_SACRegister>();
                lstSAC = (List<Hdb_SACRegister>)objRR.DBResponse.Data;
                Path = GetSACHtml(lstSAC);
                return Json(new { Message = Path, Status = 1 });
            }
            return Json(new { Message = "", Status = 0 });
        }
        [NonAction]
        public string GetSACHtml(List<Hdb_SACRegister> lstSAC)
        {
            StringBuilder sb = new StringBuilder();

            sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
            sb.Append("<tr><td colspan='4'>");
            sb.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
            sb.Append("<tr><td width='65%' style='font-size: 10px;'>'Warehousing for every one'</td>");
            sb.Append("<td width='10%' align='right'>");
            sb.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
            sb.Append("<tr><td style='border:1px solid #333;'>");
            sb.Append("<div style='padding: 5px 0; font-size: 12px; text-align: center;'>Document No.F/CD/CFS/24</div>");
            sb.Append("</td></tr>");
            sb.Append("</tbody></table>");
            sb.Append("</td></tr>");
            sb.Append("</tbody></table>");
            sb.Append("</td></tr>");

            sb.Append("<tr><td colspan='4'>");
            sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            sb.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
            sb.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 28px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><span style='font-size:14px;'>(A Govt. of India Undertaking)</span><br/><span style='font-size:14px;'>Container Freight Station, Kukatpally <br/> IDPL Road, Hyderabad - 37</span><br/><label style='font-size: 14px;'>Email - cwccfs@gmail.com</label><br/><label style='font-size: 16px; font-weight:bold;'>SAC REGISTER</label></td>");
            sb.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td></tr>");
            sb.Append("</tbody></table>");
            sb.Append("</td></tr>");
            sb.Append("</tbody></table>");

            sb.Append("<table cellspacing='0' cellpadding='5' style='border:1px solid #000; border-bottom:none; font-size:8pt; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'>");
            sb.Append("<thead><tr>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>S No.</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>SAC No & Date</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>Date upto which valid</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>Name of the Importer</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>Name of CHA</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>custom Seal No.</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>BOL/AWB No.</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>BOE No. & Date</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>Description of Cargo</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>No of Units</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>Space allotted in sq. mtrs(Gross or Net)</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>Advanced Charges Collected (Rs.)</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>C.R No. & Date</th>");
            sb.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>Signature Of the Office Assisatant</th>");
            sb.Append("<th style='border-bottom:1px solid #000; text-align:center;'>Remarks</th>");
            sb.Append("</tr></thead>");
            sb.Append("<tbody>");
            int i = 1;
            lstSAC.ForEach(item =>
            {
                sb.Append("<tr>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + i + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + item.SacNo + " " + item.SacDate + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + item.ValidUpto + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + item.IMPName + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + item.CHAName + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + item.SealNo + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + item.BOLAWBNo + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + item.BOENo + " " + item.BOEDate + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + item.CargoDescription + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + item.NoOfUnits + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + item.AreaReserved + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + item.InvoiceAmt + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'>" + item.ReceiptNo + " " + item.ReceiptDate + "</td>");
                sb.Append("<td style='border-bottom:1px solid #000; border-right:1px solid #000; text-align:center;'></td>");
                sb.Append("<td style='border-bottom:1px solid #000; text-align:center;'>" + item.Remarks + "</td>");
                sb.Append("</tr>");
                i++;
            });
            sb.Append("</tbody></table>");

            sb.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
            sb.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));

            string FileName = "SacRegister.pdf";
            if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            if (System.IO.File.Exists(Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName))
            {
                System.IO.File.Delete(Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName);
            }
            using (var RH = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
            {
                RH.GeneratePDF(Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName, sb.ToString());
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        #region Bond Register
        [HttpGet]
        public ActionResult BondRegister()
        {
            Hdb_ReportRepository objRR = new Hdb_ReportRepository();
            objRR.GetBondNo();
            if (objRR.DBResponse.Data != null)
                ViewBag.GetBondNo = objRR.DBResponse.Data;
            else
                ViewBag.GetBondNo = null;
            return PartialView();
        }
        [HttpPost]
        [CustomValidateAntiForgeryToken]
        public JsonResult GetBondRegister(int DepositeAppId, string FromDate, string ToDate)
        {
            Hdb_ReportRepository objRR = new Hdb_ReportRepository();
            objRR.GetBondRegister(DepositeAppId, FromDate, ToDate);
            string Path = "";
            if (objRR.DBResponse.Data != null)
            {
                Hdb_BondRegister objBR = new Hdb_BondRegister();
                objBR = (Hdb_BondRegister)objRR.DBResponse.Data;
                Path = GetBondHtml(objBR, DepositeAppId);
                return Json(new { Message = Path, Status = 1 });
            }
            return Json(new { Message = "", Status = 0 });
        }
        [NonAction]
        public string GetBondHtml(Hdb_BondRegister objBR, int DepositeAppId)
        {
            List<string> lstSB = new List<string>();
            objBR.lstSACDetails.ForEach(item =>
            {
                StringBuilder sb = new StringBuilder();

                sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                sb.Append("<tr><td colspan='12'>");
                sb.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                sb.Append("<tr><td width='65%' style='font-size: 10px;'>'Warehousing for every one'</td>");
                sb.Append("<td width='4%' align='right'>");
                sb.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                sb.Append("<tr><td style='border:1px solid #333;'>");
                sb.Append("<div style='padding: 5px 0; font-size: 12px; text-align: center;'>F/CD/26</div>");
                sb.Append("</td></tr>");
                sb.Append("</tbody></table>");
                sb.Append("</td></tr>");
                sb.Append("</tbody></table>");
                sb.Append("</td></tr>");

                sb.Append("<tr><td colspan='12'>");
                sb.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
                sb.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                sb.Append("<td width='160%' valign='top' align='center'><h1 style='font-size: 30px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><span style='font-size:14px;'>(A Govt. of India Undertaking)</span><br/><span style='font-size:14px;'>" + objBR.lstSACDetails[0].CompanyAdd + "<br/>" + objBR.lstSACDetails[0].CompanyEmail + "</span><br/><label style='font-size: 14px; font-weight:bold;'>BOND REGISTER</label></td>");
                sb.Append("<td valign='top'><img align='right' src='ISO' width='100'/></td></tr>");
                sb.Append("</tbody></table>");
                sb.Append("</td></tr>");

                string InvAmt = "", ReceiptNoandDate = "";
                objBR.lstAdvPayment.Where(y => y.SacNo == item.SacNo).ToList().ForEach(i =>
                {
                    if (i.InvoiceAmt > 0)
                    {
                        if (InvAmt == "")
                            InvAmt = i.InvoiceAmt.ToString();
                        else
                            InvAmt += ", " + i.InvoiceAmt.ToString();
                    }
                    if (i.ReceiptNo != "")
                    {
                        if (ReceiptNoandDate == "")
                            ReceiptNoandDate = i.ReceiptNo + " " + i.ReceiptDate;
                        else
                            ReceiptNoandDate += ", " + i.ReceiptNo + " " + i.ReceiptDate;
                    }
                });

                sb.Append("<tr><td colspan='12'>");
                sb.Append("<table cellpadding='0' cellspacing='0' style='width:100%; font-size:9pt; font-family:Verdana,Arial,San-serif;'><tbody>");
                sb.Append("<tr><th cellpadding='5' align='left' colspan='8' width='70%'>Name & Address of Importer <span style='font-weight:normal;'><u>" + item.IMPName + " " + item.IMPAdd + "</u></span></th>");
                sb.Append("<th cellpadding='5' align='left' colspan='4' width='30%'>Godown No. / Stack No. <span style='font-weight:normal;'><u>" + item.GodownName + "</u></span></th></tr>");
                sb.Append("<tr><th cellpadding='5' align='left' colspan='8' width='70%'>Name & Address of CHA <span style='font-weight:normal;'><u>" + item.CHAName + " " + item.CHAdd + "</u></span></th>");
                sb.Append("<th cellpadding='5' align='left' colspan='4' width='30%'>Bond No. & Date <span style='font-weight:normal;'><u>" + item.BondNo + " - " + item.BondDate + "</u></span></th></tr>");
                sb.Append("<tr><th cellpadding='5' align='left' colspan='8' width='70%'>Sac No. & Date <span style='font-weight:normal;'><u>" + item.SacNo + " " + item.SacDate + "</u></span> Area Booked<span style='font-weight:normal;'><u>" + item.AreaReserved + "</u></span></th>");
                sb.Append("<th cellpadding='5' align='left' colspan='4' width='30%'>Expiry date of inital <br/> bond period <span style='font-weight:normal;'><u>" + item.ValidUpto + "</u></span></th></tr>");
                sb.Append("<tr><th cellpadding='5' align='left' colspan='8' width='70%'>Advance charges <br/> received of sac <span style='font-weight:normal;'><u>" + InvAmt + "</u></span>  CR No. & Date <span style='font-weight:normal;'><u>" + ReceiptNoandDate + "</u></span></th>");
                sb.Append("<th cellpadding='5' align='left' colspan='4' width='30%'>In-To Bond B.O.E. No. & Date <span style='font-weight:normal;'><u>" + item.BondBOENo + " " + item.BondBOEDate + "</u></span></th></tr>");
                sb.Append("<tr><th cellpadding='5' align='left' colspan='8' width='70%'></th>");
                sb.Append("<th cellpadding='5' align='left' colspan='4' width='30%'>I.G.M No. & Date <span style='font-weight:normal;'><u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u></span></th></tr>");
                sb.Append("</tbody></table>");
                sb.Append("</td></tr>");

                sb.Append("<tr><td colspan='12'>");
                sb.Append("<table style='border:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");

                sb.Append("<td colspan='4' width='33.33%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                sb.Append("<thead><tr><th colspan='12' style='font-size:14px;text-align:center;border-bottom:1px solid #000;padding:10px;'>RECEIPTS</th></tr>");
                sb.Append("<tr><td colspan='12' style='padding:0;border-bottom:1px solid #000;'>");
                sb.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                sb.Append("<tr><th width='5%' style='text-align:center;padding:10px;border-right:1px solid #000;'>Date</th>");
                sb.Append("<th width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;'>No. of Units</th> ");
                sb.Append("<th width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;'>Weight <br/> (M.T.)</th>");
                sb.Append("<th width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;'>Area in sq. Mtrs. <br/>(Gross or Net)</th>");
                sb.Append("<th width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;'>CIF Value</th>");
                sb.Append("<th width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;'>Duty</th>");
                sb.Append("<th width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;'>Total Value</th>");
                sb.Append("<th width='15%' style='text-align:center;padding:10px;'>Condition of Packages</th></tr>");
                sb.Append("</tbody></table>");
                sb.Append("</td></tr></thead>");
                sb.Append("<tbody><tr><td cellspacing='0' cellpadding='0' colspan='12'>");
                sb.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                if (objBR.lstUnloadingDetails.Where(y => y.DepositappId == item.DepositappId).ToList().Count > 0)
                {
                    objBR.lstUnloadingDetails.Where(y => y.DepositappId == item.DepositappId).ToList().ForEach(data =>
                    {
                        sb.Append("<tr><td width='5%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>" + data.UnloadedDate + "</td> ");
                        sb.Append("<td width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>" + data.UnloadedUnits.ToString() + "</td> ");
                        sb.Append("<td width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>" + (data.UnloadedWeights / 1000).ToString("0.000") + "</td>");
                        sb.Append("<td width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>" + data.AreaOccupied.ToString("0.000") + "</td>");
                        sb.Append("<td width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>" + data.Value.ToString("0.000") + "</td>");
                        sb.Append("<td width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>" + data.Duty.ToString("0.000") + "</td>");
                        sb.Append("<td width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'>" + (data.Value + data.Duty).ToString("0.000") + "</td>");
                        sb.Append("<td width='15%' style='text-align:center;padding:10px;border-bottom:1px solid #000;'>" + data.PackageCondition + "</td></tr>");
                    });
                }
                else
                {
                    sb.Append("<tr><td width='5%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'></td> ");
                    sb.Append("<td width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'></td> ");
                    sb.Append("<td width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'></td>");
                    sb.Append("<td width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'></td>");
                    sb.Append("<td width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'></td>");
                    sb.Append("<td width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'></td>");
                    sb.Append("<td width='10%' style='text-align:center;padding:10px;border-right:1px solid #000;border-bottom:1px solid #000;'></td>");
                    sb.Append("<td width='15%' style='text-align:center;padding:10px;border-bottom:1px solid #000;'></td></tr>");

                }
                sb.Append("</tbody></table>");
                sb.Append("</td></tr></tbody>");
                sb.Append("</table></td>");

                sb.Append("<td colspan='3' width='25%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                sb.Append("<thead><tr><th colspan='12' width='100%' style='font-size:14px;text-align:center;border-bottom:1px solid #000;padding:10px;'>ISSUES</th></tr>");
                sb.Append("<tr><td colspan='12' style='padding:0;border-bottom:1px solid #000;'>");
                sb.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                sb.Append("<tr><th width='20%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Ex-Bond BOE No & Date</th> ");
                sb.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>No. of Units</th> ");
                sb.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Weight <br/> (M.T.)</th>");
                sb.Append("<th width='20%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Area released in sq. Mtrs. <br/>(Gross or Net)</th>");
                sb.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>CIF Value</th>");
                sb.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Duty</th>");
                sb.Append("<th width='10%' style='text-align:center;padding:10px;'>Total Value</th></tr>");
                sb.Append("</tbody></table>");
                sb.Append("</td></tr></thead>");
                sb.Append("<tbody><tr><td colspan='12'>");
                sb.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                if (objBR.lstDeliveryDetails.Where(m => m.DepositappId == item.DepositappId).ToList().Count > 0)
                {
                    objBR.lstDeliveryDetails.Where(m => m.DepositappId == item.DepositappId).ToList().ForEach(j =>
                    {
                        sb.Append("<tr><td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + j.BondBOENo + " - " + j.BondBOEDate + "</td> ");
                        sb.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + j.Units.ToString("") + "</td> ");
                        sb.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + Convert.ToDecimal(j.Weight / 1000).ToString("0.000") + "</td>");
                        sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + j.SQM.ToString("0.000") + "</td>");
                        sb.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + j.Value.ToString("0.000") + "</td>");
                        sb.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + j.Duty.ToString("0.000") + "</td>");
                        sb.Append("<td width='10%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'>" + (j.Value + j.Duty).ToString("0.000") + "</td></tr>");
                    });
                }
                else
                {
                    sb.Append("<tr><td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
                    sb.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
                    sb.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                    sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                    sb.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                    sb.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                    sb.Append("<td width='10%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'></td></tr>");

                }
                sb.Append("</tbody></table>");
                sb.Append("</td></tr></tbody>");
                sb.Append("</table></td>");

                sb.Append("<td colspan='1' width='10%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                sb.Append("<thead><tr><th colspan='12' width='100%' style='font-size:14px;text-align:center;border-bottom:1px solid #000;padding:10px;'>CHARGES REALISED</th></tr>");
                sb.Append("<tr><td colspan='12' style='padding:0;border-bottom:1px solid #000;'>");
                sb.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                sb.Append("<tr><th width='20%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Amount <br/> (Rs.)</th> ");
                sb.Append("<th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Period <br/> Upto</th> ");
                sb.Append("<th width='10%' style='text-align:center;padding:10px;'>CR. No. & Date</th></tr>");
                sb.Append("</tbody></table>");
                sb.Append("</td></tr></thead>");
                sb.Append("<tbody><tr><td colspan='12'>");
                sb.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                if (objBR.lstDeliveryPaymentDet.Where(m => m.DepositappId == item.DepositappId).ToList().Count > 0)
                {
                    objBR.lstDeliveryPaymentDet.Where(m => m.DepositappId == item.DepositappId).ToList().ForEach(i =>
                    {
                        sb.Append("<tr><td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + i.InvoiceAmt.ToString("0.000") + "</td> ");
                        sb.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + i.DeliveryDate + "</td> ");
                        sb.Append("<td width='10%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'>" + i.ReceiptNo + " " + i.ReceiptDate + "</td></tr>");
                    });
                }
                else
                {
                    sb.Append("<tr><td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
                    sb.Append("<td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
                    sb.Append("<td width='10%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'></td></tr>");
                }
                sb.Append("</tbody></table>");
                sb.Append("</td></tr></tbody>");
                sb.Append("</table></td>");

                sb.Append("<td colspan='4' width='33.33333333333333%' valign='top' style='padding:0; border-right: 1px solid #000;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                sb.Append("<thead><tr><th colspan='12' width='100%' style='font-size:14px;text-align:center;border-bottom:1px solid #000;padding:10px;'>CLOSING BALANCE</th></tr>");
                sb.Append("<tr><td colspan='12' style='padding:0;border-bottom:1px solid #000;'>");
                sb.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                sb.Append("<tr><th width='10%' style='text-align:center;border-right:1px solid #000;padding:10px;'>No. of Units</th> ");
                sb.Append("<th width='20%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Qty. <br/> (M.T.)</th> ");
                sb.Append("<th width='20%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Balance area in sq. Mtrs. <br/>(Gross or Net)</th>");
                sb.Append("<th width='15%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Balance Value</th>");
                sb.Append("<th width='15%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Balance Duty</th>");
                sb.Append("<th width='20%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Signature of Custom Officer</th>");
                sb.Append("<th width='20%' style='text-align:center;border-right:1px solid #000;padding:10px;'>Signature of Custom Assistant</th>");
                sb.Append("<th width='20%' style='text-align:center;padding:10px;'>Remarks</th></tr>");
                sb.Append("</tbody></table>");
                sb.Append("</td></tr></thead>");
                sb.Append("<tbody><tr><td colspan='12'>");
                sb.Append("<table cellspacing='0' style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");

                if (objBR.lstDeliveryDetails.Where(n => n.DepositappId == item.DepositappId).ToList().Count > 0)
                {
                    objBR.lstDeliveryDetails.Where(x => x.DepositappId == item.DepositappId).ToList().ForEach(elem =>
                    {
                        int CBUnits = objBR.lstUnloadingDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (int)x.UnloadedUnits) - objBR.lstDeliveryDetails.Where(m => m.DepositappId == item.DepositappId && m.DeliveryOrderDtlId <= elem.DeliveryOrderDtlId).Sum(x => (int)x.Units);
                        decimal CBWeight = (objBR.lstUnloadingDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (decimal)x.UnloadedWeights) - objBR.lstDeliveryDetails.Where(m => m.DepositappId == item.DepositappId && m.DeliveryOrderDtlId <= elem.DeliveryOrderDtlId).Sum(x => (decimal)x.Weight)) / 1000;
                        decimal CBSq = (objBR.lstUnloadingDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (decimal)x.AreaOccupied) - objBR.lstDeliveryDetails.Where(m => m.DepositappId == item.DepositappId && m.DeliveryOrderDtlId <= elem.DeliveryOrderDtlId).Sum(x => (decimal)x.SQM));
                        decimal CBValue = objBR.lstUnloadingDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (decimal)x.Value) - objBR.lstDeliveryDetails.Where(m => m.DepositappId == item.DepositappId && m.DeliveryOrderDtlId <= elem.DeliveryOrderDtlId).Sum(x => (decimal)x.Value);
                        decimal CBDuty = objBR.lstUnloadingDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (decimal)x.Duty) - objBR.lstDeliveryDetails.Where(m => m.DepositappId == item.DepositappId && m.DeliveryOrderDtlId <= elem.DeliveryOrderDtlId).Sum(x => (decimal)x.Duty);

                        sb.Append("<tr><td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + CBUnits.ToString("") + "</td> ");
                        sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + CBWeight.ToString("0.000") + "</td> ");
                        sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + CBSq.ToString("0.000") + "</td>");
                        sb.Append("<td width='15%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + CBValue.ToString("0.000") + "</td>");
                        sb.Append("<td width='15%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + CBDuty.ToString("0.000") + "</td>");
                        sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                        sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                        sb.Append("<td width='20%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'></td></tr>");
                    });
                }
                else
                {
                    sb.Append("<tr><td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
                    sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td> ");
                    sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                    sb.Append("<td width='15%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                    sb.Append("<td width='15%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                    sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                    sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                    sb.Append("<td width='20%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'></td></tr>");
                }
                /*int CBUnits = objBR.lstUnloadingDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (int)x.UnloadedUnits) - objBR.lstDeliveryDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (int)x.Units);
                decimal CBWeight = (objBR.lstUnloadingDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (decimal)x.UnloadedWeights) - objBR.lstDeliveryDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (decimal)x.Weight)) / 1000;
                decimal CBSq = (objBR.lstUnloadingDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (decimal)x.AreaOccupied) - objBR.lstDeliveryDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (decimal)x.SQM));
                decimal CBValue = objBR.lstUnloadingDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (decimal)x.Value) - objBR.lstDeliveryDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (decimal)x.Value);
                decimal CBDuty = objBR.lstUnloadingDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (decimal)x.Duty) - objBR.lstDeliveryDetails.Where(m => m.DepositappId == item.DepositappId).Sum(x => (decimal)x.Duty);

                sb.Append("<tr><td width='10%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + CBUnits.ToString("") + "</td> ");
                sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + CBWeight.ToString("0.000") + "</td> ");
                sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + CBSq.ToString("0.000") + "</td>");
                sb.Append("<td width='15%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + CBValue.ToString("0.000") + "</td>");
                sb.Append("<td width='15%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'>" + CBDuty.ToString("0.000") + "</td>");
                sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                sb.Append("<td width='20%' style='text-align:center;border-right:1px solid #000;border-bottom:1px solid #000;padding:10px;'></td>");
                sb.Append("<td width='20%' style='text-align:center;border-bottom:1px solid #000;padding:10px;'></td></tr>");*/



                sb.Append("</tbody></table>");
                sb.Append("</td></tr></tbody>");
                sb.Append("</table></td>");

                sb.Append("</tr></tbody></table>");
                sb.Append("</td></tr>");
                sb.Append("</tbody></table>");

                sb.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                sb.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                lstSB.Add(sb.ToString());
            });
            string FileName = "BondRegister" + DepositeAppId + ".pdf";
            if (!Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            if (System.IO.File.Exists(Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName))
            {
                System.IO.File.Delete(Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName);
            }
            using (var RH = new ReportingHelper(PdfPageSize.A3Landscape, 40f, 40f, 10f, 10f, false, true))
            {
                RH.GeneratePDF(Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        #region General Space Utilisation Register
        [HttpGet]
        public ActionResult GeneralSpaceUtilisationRegister()
        {
            Dnd_ReportRepository ObjGR = new Dnd_ReportRepository();
            ObjGR.GetGodownForCargoCarting();
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult GeneralSpaceUtilisationReport(Dnd_TotalContainerReport obj, string AsOnDate)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            // Dnd_TotalContainerReport obj= new Dnd_TotalContainerReport();
            ObjRR.GeneralSpaceUtilisationRegister(obj, AsOnDate);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFSpaceUtilisationReport(lstData, AsOnDate, obj.GodownName);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFSpaceUtilisationReport(Dnd_TotalContainerReport lstData, string AsOnDate, string GodownName)
        {
            try
            {
                var FileName = "GeneralSpaceUtilisation.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");

                //Pages.Append("<tr><td colspan='12'>");
                //Pages.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                //Pages.Append("<tr><td width='65%'></td>");
                //Pages.Append("<td width='10%' align='right'>");
                //Pages.Append("<table style='width:100%;' cellspacing='0' cellpadding='0'><tbody>");
                //Pages.Append("<tr><td style='border:1px solid #333;'>");
                //Pages.Append("<div style='padding: 5px 0; font-size: 7pt; text-align: center;'>F/D'NODE/03</div>");
                //Pages.Append("</td></tr>");
                //Pages.Append("</tbody></table>");
                //Pages.Append("</td></tr>");
                //Pages.Append("</tbody></table>");
                //Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>Container Freight Station</span><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>GENERAL SPACE UTILISATION REGISTER</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; font-size:7pt;'><tbody>");
                Pages.Append("<tr><td width='82%'><b>Shed No -</b> " + GodownName + "</td> <td width='18%' style='float:right;'><b>AS ON DATE -</b>" + AsOnDate + "</td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin-bottom: 10px; font-size:7pt; border: 1px solid #000;'><tbody>");
                lstData.LstTotal.Select(x => new { ShippingLineId = x.ShippingLineId, ShippingLineName = x.ShippingLineName, ShippingLineAlias = x.ShippingLineAlias }).Distinct().ToList().ForEach(x =>
                {


                    Pages.Append("<tr><th style='text-align:left; width:80px; border-right:1px solid #000;'>" + x.ShippingLineAlias + "</th> ");
                    Pages.Append("<th style='text-align:left; width:90%;'>" + x.ShippingLineName + "</th></tr>");
                    Pages.Append("</tbody></table>");

                    Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; text-align:center; font-family: Arial, Helvetica, sans-serif; font-size:7pt; margin: 0; border:1px solid #000;'>");
                    Pages.Append("<thead>");
                    Pages.Append("<tr><th style='border-right:1px solid #000;width:80px; text-align:left;'>Sr.</th>");
                    Pages.Append("<th style='border-right:1px solid #000;width:80px;'>SB No</th>");
                    Pages.Append("<th style='border-right:1px solid #000;width:80px;'>SB Date</th>");
                    Pages.Append("<th style='border-right:1px solid #000;width:80px;'>Entry No</th>");
                    Pages.Append("<th style='border-right:1px solid #000;width:80px;'>Cart Date</th>");
                    Pages.Append("<th style='border-right:1px solid #000;width:80px;'>Pkts</th>");
                    Pages.Append("<th style='border-right:1px solid #000;width:80px;'>Gr Wt</th>");
                    Pages.Append("<th style='border-right:1px solid #000;width:80px;'>FOB</th>");
                    Pages.Append("<th style='width:80px;'>Area</th></tr>");
                    Pages.Append("</thead>");

                    Pages.Append("<tbody>");
                    int i = 1;
                    lstData.LstTotal.Where(y => y.ShippingLineId == x.ShippingLineId).ToList().ForEach(y =>
                   {
                       Pages.Append("<tr><td style='border-top:1px solid #000; border-right:1px solid #000; text-align:left;'>" + i + "</td>");
                       Pages.Append("<td style='border-top:1px solid #000; border-right:1px solid #000;'>" + y.ShippingBillNo + "</td>");
                       Pages.Append("<td style='border-top:1px solid #000; border-right:1px solid #000;'>" + y.ShippingBillDate + "</td>");
                       Pages.Append("<td style='border-top:1px solid #000; border-right:1px solid #000;'>" + y.EntryNo + "</td>");
                       Pages.Append("<td style='border-top:1px solid #000; border-right:1px solid #000;'>" + y.CartingDate + "</td>");
                       Pages.Append("<td style='border-top:1px solid #000; border-right:1px solid #000;'>" + y.NoOfUnits + "</td>");
                       Pages.Append("<td style='border-top:1px solid #000; border-right:1px solid #000;'>" + y.GrossWeight.ToString("0.00") + "</td>");
                       Pages.Append("<td style='border-top:1px solid #000; border-right:1px solid #000;'>" + y.Fob.ToString("0.00") + "</td>");
                       Pages.Append("<td style='border-top:1px solid #000;'>" + y.SQM + "</td></tr>");
                       i++;
                   });

                    //TOTAL LOOP
                    Pages.Append("<tr><th style='border-top:1px solid #000; border-right:1px solid #000; text-align:left;'>Total</th>");
                    Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Count() + "</th>");
                    Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'></th>");
                    Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'></th>");
                    Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'></th>");
                    Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.NoOfUnits).ToString("0.00") + "</th>");
                    Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.GrossWeight).ToString("0.00") + "</th>");
                    Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Fob).ToString("0.00") + "</th>");
                    Pages.Append("<th style='border-top:1px solid #000;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.SQM) + "</th></tr>");
                });
                //GRAND LOOP
                Pages.Append("<tr><th style='border-top:1px solid #000; border-right:1px solid #000; text-align:left;'>Grand Total</th>");
                Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'>" + lstData.LstTotal.Count() + "</th>");
                Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.NoOfUnits) + "</th>");
                Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.GrossWeight).ToString("0.00") + "</th>");
                Pages.Append("<th style='border-top:1px solid #000; border-right:1px solid #000;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.Fob) + "</th>");
                Pages.Append("<th style='border-top:1px solid #000;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.SQM) + "</th></tr>");
                Pages.Append("</tbody></table>");

                Pages.Append("</td></tr>");

                //Pages.Append("<tr><td colspan='12'>");

                //Pages.Append("<table style='width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                //Pages.Append("<thead><tr><td colspan='12'><table style='border:1px solid #000;border-bottom:0;width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                //Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:40px;'>Sr.</th> ");
                //Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>SB No</th>");
                //Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>SB Date</th>");
                //Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>Entry No</th>");
                //Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>Cart Date</th>");
                //Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>Pkts</th>");
                //Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>Gr Wt</th>");
                //Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>FOB</th>");
                //Pages.Append("<th style='text-align:left;border-right:1px solid #000;padding:10px;width:80px;'>Area</th>");
                //Pages.Append("</tr></tbody></table></td></tr></thead>");

                //Pages.Append("<tbody>");
                ////Loop
                //lstData.LstTotal.Select(x => new { ShippingLineId = x.ShippingLineId, ShippingLineName = x.ShippingLineName, ShippingLineAlias = x.ShippingLineAlias }).Distinct().ToList().ForEach(x =>
                //{
                //    Pages.Append("<tr><td colspan='12' style='padding:0;'>");
                //    Pages.Append("<table style='margin:0 0 15px;border:1px solid #000;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                //    Pages.Append("<tr><td colspan='12'>");
                //    Pages.Append("<table style='margin:0;width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                //    Pages.Append("<th style='text-align:left;padding:10px;width:5.5%;border-right:1px solid #000;'>" + x.ShippingLineAlias + "</th> ");
                //    Pages.Append("<th style='text-align:left;padding:10px;width:90%;'>" + x.ShippingLineName + "</th> ");
                //    Pages.Append("</tr></tbody></table>");
                //    Pages.Append("</td></tr>");
                //    //Loop
                //    int i = 1;
                //    lstData.LstTotal.Where(y => y.ShippingLineId == x.ShippingLineId).ToList().ForEach(y =>
                //    {
                //        Pages.Append("<tr><td colspan='12'>");
                //        Pages.Append("<table style='width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                //        Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;border-top:1px solid #000;padding:10px;width:40px;'>" + i + "</td> ");
                //        Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.ShippingBillNo + "</td>");
                //        Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.ShippingBillDate + "</td> ");
                //        Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.EntryNo + "</td> ");
                //        Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.CartingDate + "</td>");
                //        Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.NoOfUnits + "</td> ");
                //        Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.GrossWeight.ToString("0.00") + "</td>");
                //        Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.Fob.ToString("0.00") + "</td>");
                //        Pages.Append("<td style='text-align:left;border-top:1px solid #000;border-right:1px solid #000;padding:10px;width:80px;'>" + y.SQM + "</td>");
                //        Pages.Append("</tr></tbody></table>");
                //        Pages.Append("</td></tr>");
                //        i++;
                //    });
                //    //loop end

                //    Pages.Append("<tr><td colspan='12'>");
                //    Pages.Append("<table style='width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                //    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:50px;'>Total</th> ");
                //    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'></th>");
                //    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'></th> ");
                //    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'></th> ");
                //    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'></th>");
                //    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.NoOfUnits).ToString("0.00") + "</th> ");
                //    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.GrossWeight).ToString("0.00") + "</th> ");
                //    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Fob).ToString("0.00") + "</th>");
                //    Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:80px;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.SQM) + "</th> ");
                //    Pages.Append("</tr></tbody></table>");
                //    Pages.Append("</td></tr>");

                //    Pages.Append("</tbody></table>");
                //    Pages.Append("</td></tr>");
                //});
                ////loop  end

                //Pages.Append("<tr><td colspan='12'>");
                //Pages.Append("<table style='width:100%;font-size:6pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                //Pages.Append("<th style='text-align:left;padding:10px;width:50px;'>Grand Total</th> ");
                //Pages.Append("<th style='text-align:left;padding:10px;width:80px;'></th>");
                //Pages.Append("<th style='text-align:left;padding:10px;width:80px;'></th> ");
                //Pages.Append("<th style='text-align:left;padding:10px;width:80px;'></th> ");
                //Pages.Append("<th style='text-align:left;padding:10px;width:80px;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.NoOfUnits) + "</th>");
                //Pages.Append("<th style='text-align:left;padding:10px;width:80px;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.GrossWeight) + "</th> ");
                //Pages.Append("<th style='text-align:left;padding:10px;width:80px;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.Fob) + "</th>");
                //Pages.Append("<th style='text-align:left;padding:10px;width:80px;'>" + lstData.LstTotal.Where(z => z.ShippingLineId == z.ShippingLineId).Sum(z => z.SQM) + "</th>");                
                //Pages.Append("</tr></tbody></table>");
                //Pages.Append("</td></tr>");                

                //Pages.Append("</tbody>");
                //Pages.Append("</table>");
                //Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        //[NonAction]
        //public string GeneratePDFCargoCartingReport(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        //{
        //    try
        //    {
        //        var FileName = "CargoCarting.pdf";
        //        StringBuilder Pages = new StringBuilder();
        //        string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
        //        Pages.Append("<tr><td colspan='12'>");
        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
        //        Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
        //        Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>Run Date </b> " + DateTime.Now + " </span><br/><label style='font-size: 7pt; font-weight:bold;'>Vessel Wise Pendency Report</label></td></tr>");
        //        Pages.Append("</tbody></table>");
        //        Pages.Append("</td></tr>");
        //        Pages.Append("</thead></table>");

        //        Pages.Append("<table cellspacing='0' cellpadding='0' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
        //        Pages.Append("<thead><tr><th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>S/Line</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Shipping Line Name</th>");

        //        Pages.Append("<th cellspacing='0' cellpadding='0'><table cellspacing='0' cellpadding='0' style='width:100%; font-size:7pt;'><thead><tr>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Entry No</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Carting Date</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Sb No</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Sb Date</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Exp Code</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Cha</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Comdty</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>TotPkg</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>PkgRcvd</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Bal</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Gr Wt</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Fob</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Slot No</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Gen Res</th>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000;width:10%;'>Area</th>");
        //        Pages.Append("</tr></thead></table></th>");
        //        Pages.Append("</tr></thead>");

        //        Pages.Append("<tbody>");
        //        int i = 1; int total20; int total40; int total45; int Teus; int total;
        //        total20 = 0;
        //        total40 = 0;
        //        total45 = 0;
        //        lstData.LstTotal.Select(x => new { x.ShippingLineId, x.ShippingLineName }).Distinct().ToList().ForEach(item =>
        //        {
        //            Pages.Append("<tr>");
        //            Pages.Append("<td cellpadding='7' valign='top' style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'>" + i + "</td>");
        //            Pages.Append("<td cellpadding='7' valign='top' style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'>" + item.ShippingLineName + "</td>");
        //           // Pages.Append("<td cellpadding='7' valign='top' style='border-bottom:1px solid #000;border-right:1px solid #000;font-size:8pt;'>" + item.Vessel + "</td>");
        //            Pages.Append("<td cellspacing='0' cellpadding='0' style='width:75%;'><table cellspacing='0' cellpadding='0' style='width:100%;font-size:7pt;'><tbody>");
        //            lstData.LstTotal.Where(x => x.ShippingLineId == item.ShippingLineId).ToList().ForEach(elem =>
        //            {
        //                Pages.Append("<tr>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.EntryNo + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.CartingDate + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%'>" + elem.ShippingBillNo + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.ShippingBillDate + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.ExpCode + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.CHA + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%'>" + elem.Commodity + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.TotalPkg + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.ReceivedPkg + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.Balance + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.GrossWeight + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.Fob + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.SlotNo + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.GenReserved + "</td>");
        //                Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + elem.Area + "</td>");
        //              //  Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>" + elem.MovementDate + "</td>");
        //                //if (elem.Size.Equals("20"))
        //                //{
        //                //    total20 = total20 + 1;
        //                //}
        //                //else if (elem.Size.Equals("40"))
        //                //{
        //                //    total40 = total40 + 1;
        //                //}
        //                //else if (elem.Size.Equals("45"))
        //                //{
        //                //    total45 = total45 + 1;
        //                //}
        //                Pages.Append("</tr>");
        //            });
        //            //total = total20 + total40 + total45;
        //            //Teus = total20 + total40 * 2 + total45 * 2;
        //            //Pages.Append("<tr>");
        //            //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>" + total + "</td>");
        //            //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>0</td>");
        //            //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:5%'>+</td>");
        //            //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'>3</td>");
        //            //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%'>" + Teus + "</td>");
        //            //Pages.Append("<td cellpadding='7' style='border-bottom:1px solid #000;width:10%'></td>");
        //            //Pages.Append("</tr>");

        //            Pages.Append("</tbody></table></td>");
        //            Pages.Append("</tr>");
        //            i++;

        //        });
        //        Teus = total20 + total40 * 2 + total45 * 2;
        //        total = total20 + total40 + total45;
        //        Pages.Append("<tr>");
        //        Pages.Append("<th cellpadding='7' style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
        //        Pages.Append("<th cellpadding='7' colspan='11' style='border-bottom:1px solid #000; font-size:7pt;'>" + total + " </th>");
        //        Pages.Append("</tr>");

        //        Pages.Append("</tbody></table>");


        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='text-align: center; width:50%; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
        //        Pages.Append("<thead>");
        //        Pages.Append("<tr><th style='border-right: 1px solid #000; width: 30px;'>20 FT</th>");
        //        Pages.Append("<th style='border-right: 1px solid #000; width: 30px;'>40 FT</th>");
        //        Pages.Append("<th style='border-right: 1px solid #000; width: 30px;'>45 FT</th>");
        //        Pages.Append("<th style='width: 30px;'>Teus</th></tr>");
        //        Pages.Append("</thead>");

        //        Pages.Append("<tbody>");
        //        Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
        //        Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
        //        Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
        //        Pages.Append("<td style='border-top: 1px solid #000;'>" + Teus + "</td></tr>");
        //        Pages.Append("</tbody></table>");

        //        Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

        //        if (!Directory.Exists(LocalDirectory))
        //        {
        //            Directory.CreateDirectory(LocalDirectory);
        //        }
        //        if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
        //        {
        //            System.IO.File.Delete(LocalDirectory + "/" + FileName);
        //        }
        //        //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
        //        //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
        //        using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
        //        {
        //            ObjPdf.HeadOffice = this.HeadOffice;
        //            ObjPdf.HOAddress = this.HOAddress;
        //            ObjPdf.ZonalOffice = this.ZonalOffice;
        //            ObjPdf.ZOAddress = this.ZOAddress;
        //            ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
        //        }
        //        return "/Docs/" + Session.SessionID + "/Report/" + FileName;
        //    }
        //    catch
        //    {
        //        return "";
        //    }
        //}
        #endregion

        #region  Carting Allow Register
        [HttpGet]
        public ActionResult CartingAllowRegister()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult CartingAllowRegisterPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.CartingAllowRegister(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFCartingAllowRegister(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFCartingAllowRegister(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "ShedAllowRegister.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><span style='font-size:7pt;'><b>Run Date:</b>" + DateTime.Now + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Shed Allow Register</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Truck No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Tot Sbs</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Tot Pkgs</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>SLA Code</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Shed No</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.VehicleNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.TotalSbs + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.TotalPkg + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLineAlias + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShedNo + "</td>");
                    Pages.Append("</tr>");

                    //if (item.Size.Equals("20"))
                    //{
                    //    total20 = total20 + 1;
                    //}
                    //else if (item.Size.Equals("40"))
                    //{
                    //    total40 = total40 + 1;
                    //}
                    //else if (item.Size.Equals("45"))
                    //{
                    //    total45 = total45 + 1;
                    //}


                    i++;

                });
                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='2' style='border-bottom:1px solid #000; border-right:1px solid #000; font-size:7pt;'>" + lstData.LstTotal.Count() + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; font-size:7pt;'>" + lstData.LstTotal.Sum(x => x.TotalSbs) + "</th>");
                Pages.Append("<th  style='border-bottom:1px solid #000;border-right:1px solid #000; font-size:7pt;'>" + lstData.LstTotal.Sum(x => x.TotalPkg) + "</th>");
                Pages.Append("<th  style='border-bottom:1px solid #000;border-right:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("<th  style='border-bottom:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region  Empty Vehicle in/out Register
        [HttpGet]
        public ActionResult EmptyVehicleInOutRegister()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult EmptyVehicleInOutRegisterPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.EmptyVehicleinoutRegister(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFEmptyVehicleInOutRegister(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFEmptyVehicleInOutRegister(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        {
            try
            {
                var FileName = "EmptyVehicleInOutRegister.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><span style='font-size:7pt;'><b>Run Date:</b>" + DateTime.Now + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>EMPTY VEHICLE IN / OUT REGISTER</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Truck No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Empty Gate In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Loaded Gate In Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:8%;'>Out Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Remarks</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


                total20 = 0;
                total40 = 0;
                total45 = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.VehicleNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.LoadedInDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ExitDateTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.Remarks + "</td>");
                    Pages.Append("</tr>");

                    //if (item.Size.Equals("20"))
                    //{
                    //    total20 = total20 + 1;
                    //}
                    //else if (item.Size.Equals("40"))
                    //{
                    //    total40 = total40 + 1;
                    //}
                    //else if (item.Size.Equals("45"))
                    //{
                    //    total45 = total45 + 1;
                    //}


                    i++;

                });
                total20 = total20;
                total40 = total40;
                total45 = total45;
                total = total20 + total40 + total45;
                teus20 = total20;
                totalteus = teus20 + total40 * 2 + total45 * 2;
                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>" + lstData.LstTotal.Count() + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("<th  style='border-bottom:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("<th  style='border-bottom:1px solid #000; font-size:7pt;'></th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        //#region  Carting Allow Register
        //[HttpGet]
        //public ActionResult CartingAllowRegister()
        //{
        //    return PartialView();
        //}
        //[HttpPost]
        //[ValidateAntiForgeryToken]
        //public JsonResult CartingAllowRegisterPrint(string PeriodFrom, string PeriodTo)
        //{
        //    Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
        //    ObjRR.CartingAllowRegister(PeriodFrom, PeriodTo);
        //    string Path = "";
        //    if (ObjRR.DBResponse.Data != null)
        //    {
        //        Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
        //        lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
        //        Path = GeneratePDFCartingAllowRegister(lstData, PeriodFrom, PeriodTo);
        //        return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
        //    }

        //    else
        //        return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        //}
        //[NonAction]
        //public string GeneratePDFCartingAllowRegister(Dnd_TotalContainerReport lstData, string FromDate, string ToDate)
        //{
        //    try
        //    {
        //        var FileName = "CartingAllowRegister.pdf";
        //        StringBuilder Pages = new StringBuilder();
        //        string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
        //        Pages.Append("<tr><td colspan='12'>");
        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
        //        Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
        //        Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Carting Allow Register</label><span style='font-size:7pt;'><b>Run Date:</b>" + DateTime.Now + "</span><br/></td></tr>");
        //        Pages.Append("</tbody></table>");
        //        Pages.Append("</td></tr>");
        //        Pages.Append("</thead></table>");

        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
        //        Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Truck No</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>In Date</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Tot Sbs</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Tot Pkgs</th></tr></thead>");
        //        Pages.Append("<tbody>");
        //        int i = 1;
        //        int total45; int total20; int total40; int total; int teus; int teus20; int teus40; int totalteus;


        //        total20 = 0;
        //        total40 = 0;
        //        total45 = 0;
        //        lstData.LstTotal.ForEach(item =>
        //        {
        //            Pages.Append("<tr>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.VehicleNo + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.InDateTime + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.TotalSbs + "</td>");
        //            Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.TotalPkg + "</td>");
        //            Pages.Append("</tr>");

        //            //if (item.Size.Equals("20"))
        //            //{
        //            //    total20 = total20 + 1;
        //            //}
        //            //else if (item.Size.Equals("40"))
        //            //{
        //            //    total40 = total40 + 1;
        //            //}
        //            //else if (item.Size.Equals("45"))
        //            //{
        //            //    total45 = total45 + 1;
        //            //}


        //            i++;

        //        });
        //        total20 = total20;
        //        total40 = total40;
        //        total45 = total45;
        //        total = total20 + total40 + total45;
        //        teus20 = total20;
        //        totalteus = teus20 + total40 * 2 + total45 * 2;
        //        Pages.Append("<tr>");
        //        Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
        //        Pages.Append("<th colspan='8' style='border-bottom:1px solid #000; font-size:7pt;'>" + lstData.LstTotal.Count() + "</th>");
        //        Pages.Append("<th style='border-bottom:1px solid #000; font-size:7pt;'>" + lstData.LstTotal.Sum(x => x.TotalSbs) + "</th>");
        //        Pages.Append("<th  style='border-bottom:1px solid #000; font-size:7pt;'>" + lstData.LstTotal.Sum(x => x.TotalPkg) + "</th>");

        //        Pages.Append("</tr>");
        //        Pages.Append("</tbody></table>");


        //        Pages.Append("<table cellspacing='0' cellpadding='5' style='width:50%; text-align: center; border-collapse:collapse; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
        //        Pages.Append("<thead>");
        //        //Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; text-align: center; width: 300px;'>Total</th></tr>");

        //        Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
        //        Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
        //        Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>45 FT</th>");
        //        Pages.Append("<th style='width: 100px;'>Tues</th></tr>");
        //        Pages.Append("</thead>");

        //        Pages.Append("<tbody>");

        //        Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total20 + "</td>");
        //        Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total40 + "</td>");
        //        Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + total45 + "</td>");
        //        Pages.Append("<td style='border-top: 1px solid #000;'>" + totalteus + "</td></tr>");

        //        Pages.Append("</tbody></table>");

        //        Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

        //        if (!Directory.Exists(LocalDirectory))
        //        {
        //            Directory.CreateDirectory(LocalDirectory);
        //        }
        //        if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
        //        {
        //            System.IO.File.Delete(LocalDirectory + "/" + FileName);
        //        }
        //        //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
        //        //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
        //        using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
        //        {
        //            ObjPdf.HeadOffice = this.HeadOffice;
        //            ObjPdf.HOAddress = this.HOAddress;
        //            ObjPdf.ZonalOffice = this.ZonalOffice;
        //            ObjPdf.ZOAddress = this.ZOAddress;
        //            ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
        //        }
        //        return "/Docs/" + Session.SessionID + "/Report/" + FileName;
        //    }
        //    catch
        //    {
        //        return "";
        //    }
        //}
        //#endregion

        #region register of outward supply

        [HttpGet]
        public ActionResult RegisterOfOutwardSupply()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public FileResult RegisterOfOutwardSupply(FormCollection fc)
        {
            try
            {
                var date1 = Convert.ToDateTime(fc["PeriodFrom"].ToString());
                var date2 = Convert.ToDateTime(fc["PeriodTo"].ToString());
                var ObjRR = new Dnd_ReportRepository();
                ObjRR.GetRegisterofOutwardSupply(date1, date2);
                if (!string.IsNullOrEmpty(ObjRR.DBResponse.Data.ToString()))
                    return File(ObjRR.DBResponse.Data.ToString(), "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "RegisterofOutwardSupply.xlsx");
                else
                {
                    string name = DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
                    var excelFile = Server.MapPath("~/Docs/Excel/" + name + ".xlsx");
                    using (var exl = new DynamicExcel.ExcelGenerator(excelFile))
                    {
                        exl.AddCell("A1", "No data found");
                        exl.Save();
                        return File(excelFile, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "RegisterofOutwardSupply.xlsx");
                    }
                }
            }
            catch
            {
                string name = DateTime.Now.ToOADate().ToString().Replace(".", string.Empty);
                var excelFile = Server.MapPath("~/Docs/Excel/" + name + ".xlsx");
                using (var exl = new DynamicExcel.ExcelGenerator(excelFile))
                {
                    exl.AddCell("A1", "No data found");
                    exl.Save();
                    return File(excelFile, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "RegisterofOutwardSupply.xlsx");
                }
            }
            // return null;
        }

        #endregion
        #region ChequeSummaryReport

        /*Invoice Report Details Section-21.08.2018*/
        [HttpGet]
        public ActionResult ChequeSummaryReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetChequeSummaryReport(Dnd_ChequeSummary ObjChequeSummary)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            List<Dnd_ChequeSummary> LstChequeSummary = new List<Dnd_ChequeSummary>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.ChequeSummary(ObjChequeSummary);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstChequeSummary = (List<Dnd_ChequeSummary>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateChequeSummaryReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "ChequeSummary.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/ChequeSummary/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/ChequeSummary/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        //-----------------for update ChequeSummaryReport

        [HttpGet]
        public ActionResult ChequeDdPoSdSummaryReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetChequeDdPoSdSummaryReport(Dnd_ChequeSummary ObjChequeSummary)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            List<Dnd_ChequeSummary> LstChequeSummary = new List<Dnd_ChequeSummary>();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.ChequeCashDDPOSummary(ObjChequeSummary);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstChequeSummary = (List<Dnd_ChequeSummary>)ObjRR.DBResponse.Data;
                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateChequeDdPoSdSummaryReportPDF(FormCollection fc)
        {
            try
            {

                //string SubDomain = System.Configuration.ConfigurationManager.AppSettings["SubDomain"];
                // string FtpIdPath = "";
                //string LocalIdPath = "";
                var Pages = new string[1];
                var FileName = "ChequeSummary.pdf";
                Pages[0] = fc["Page"].ToString();
                // var GovtImg = Server.MapPath("~/Content/Images/gov.png");
                //Pages[0] = fc["Page"].ToString().Replace("GOVT_IMG", GovtImg).Replace("MODEL", DateTime.Today.ToShortDateString()).Replace("DIR/DED.............", fc["WaiverOrderNo"]);
                //int WavOrdrIssueId = Convert.ToInt32(fc["WavOrdrIssueId"]);
                //FtpIdPath = "WBDED/Docs/Waiver/WaiverOrder/" + WavOrdrIssueId;
                // LocalIdPath = Server.MapPath("~/Docs") + "/Report/RenewalPending/";
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/ChequeSummary/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/ChequeSummary/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        //END 





        #endregion
        #region Stuffing  Pendency
        [HttpGet]
        public ActionResult StuffingPendencyReport()
        {
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult StuffingPendencyReportPrint(string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.StuffingPendencyReportPrint(PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                List<Dnd_StuffingPendency> lstData = new List<Dnd_StuffingPendency>();
                lstData = (List<Dnd_StuffingPendency>)ObjRR.DBResponse.Data;
                Path = GeneratePDFStuffingPendencyReport(lstData, PeriodFrom, PeriodTo);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFStuffingPendencyReport(List<Dnd_StuffingPendency> lstData, string FromDate, string ToDate)
        {
            try
            {
                CompanyDetailsForReport objCompanyDetails = new CompanyDetailsForReport();
                WFLD_ReportRepository ObjRR = new WFLD_ReportRepository();
                ObjRR.getCompanyDetails();
                objCompanyDetails = (CompanyDetailsForReport)ObjRR.DBResponse.Data;
                var FileName = "StuffingPendencyReport.pdf";
                StringBuilder Pages = new StringBuilder();
                var Godown = ""; var Size = "";
                lstData.Select(x => new { Godown = x.Godown }).Distinct().ToList().ForEach(item =>
                {
                    if (Godown == "")
                        Godown = item.Godown;
                    else
                        Godown += "," + item.Godown;
                });
                lstData.Select(x => new { Size = x.Size }).Distinct().ToList().ForEach(item =>
                {
                    if (Size == "")
                        Size = item.Size;
                    else
                        Size += "," + item.Size;
                });
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 28px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 14px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:14px;'>" + objCompanyDetails.CompanyAddress + "</span><br/><span style='font-size:14px;'><b>Run Date...</b>" + DateTime.Now + " </span><br/><label style='font-size: 16px; font-weight:bold;'>Stuffing Pendency</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'>");
                Pages.Append("<thead><tr><td colspan='12'><table style='border-top:1px solid #000;border-left:1px solid #000;border-right:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Sr.</th> ");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Stuff Req No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Stuff Req Date</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:10%;'>Cfs Code</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Cont No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:7%;'>Size</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'>S/Line</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:13%;'>In Date</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>No Of Sbs</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>No Of Units</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:9%;'>GR.Wt</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:13%;'>FOB</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>Via No</th>");
                Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>Vessel Name</th>");
                Pages.Append("</tr></tbody></table></td></tr></thead>");

                Pages.Append("<tbody>");
                //Loop
                lstData.Select(x => new { Godown = x.Godown }).Distinct().ToList().ForEach(x =>
                {
                    Pages.Append("<tr><td colspan='12' style='padding:0;'>");
                    Pages.Append("<table style='margin:0 0 15px;border:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                    Pages.Append("<tr><td colspan='12'>");
                    Pages.Append("<table style='margin:0;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;text-align:center'><tbody><tr>");
                    //Pages.Append("<th style='text-align:left;padding:10px;width:5.5%;'>" + x.EximTraderAlias + "</th> ");
                    Pages.Append("<td style='padding:10px;width:100%;'><b>Shed No :</b>" + x.Godown + "</td> ");
                    Pages.Append("</tr></tbody></table>");
                    Pages.Append("</td></tr>");
                    //Loop
                    int total20; int total40; int total45;
                    total20 = 0;
                    total40 = 0;
                    total45 = 0;
                    int i = 1;
                    lstData.Where(y => y.Godown == x.Godown).ToList().ForEach(y =>
                    {
                        Pages.Append("<tr><td colspan='12'>");
                        Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + i + "</td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.StuffingReqNo + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.StuffingReqDate + "</td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:10%;'>" + y.CFSCode + "</td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.ContainerNo + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:7%;'>" + y.Size + "</td> ");
                        Pages.Append("<td style='text-align:left;padding:10px;width:9%;'>" + y.ShippingLine + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:13%;'>" + y.InDate + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.NoOfSbs + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:5%;'>" + y.NoOfUnits.ToString("0.00") + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:9%;'>" + y.GrossWeight.ToString("0.00") + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:13%;'>" + y.FOB.ToString("0.00") + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:8%;'>" + y.Via + "</td>");
                        Pages.Append("<td style='text-align:left;padding:10px;width:5%;'>" + y.Vessel + "</td> ");
                        Pages.Append("</tr></tbody></table>");
                        Pages.Append("</td></tr>");
                        //if (Size.Equals("20"))
                        //{
                        //    total20 = total20 + 1;
                        //}
                        //else if (Size.Equals("40"))
                        //{
                        //    total40 = total40 + 1;
                        //}
                        //else if (Size.Equals("45"))
                        //{
                        //    total45 = total45 + 1;
                        //}
                        i++;

                    });
                    //loop end

                    Pages.Append("<tr><td colspan='12'>");
                    Pages.Append("<table style='width:100%;font-size:8pt;border-top:1px solid #000;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>TOTAL :</th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>" + lstData.Where(z => z.Godown == x.Godown).Count() + "</th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:8%;'></th> ");
                    Pages.Append("<th style='text-align:left;padding:10px;width:10%;'></th> ");
                    Pages.Append("<th style='text-align:left;padding:10px;width:8%;'></th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:7%;'></th> ");
                    Pages.Append("<th style='text-align:left;padding:10px;width:9%;'></th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:13%;'></th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:8%;'>" + lstData.Where(z => z.Godown == x.Godown).Sum(z => z.NoOfSbs) + "</th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:5%;'>" + lstData.Where(z => z.Godown == x.Godown).Sum(z => z.NoOfUnits).ToString("0.00") + "</th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:9%;'>" + lstData.Where(z => z.Godown == x.Godown).Sum(z => z.GrossWeight).ToString("0.00") + "</th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:13%;'>" + lstData.Where(z => z.Godown == x.Godown).Sum(z => z.FOB).ToString("0.00") + "</th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:8%;'></th>");
                    Pages.Append("<th style='text-align:left;padding:10px;width:5%;'></th>");
                    Pages.Append("</tr></tbody></table>");
                    Pages.Append("</td></tr>");

                    //Pages.Append("<tr><td colspan='12'>");
                    //Pages.Append("<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                    //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:2%;'></th> ");
                    //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'>Total :</th>");
                    //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'>" + lstData.Where(z => z.Godown == x.Godown).Count() + "</th> ");
                    //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:10%;'></th> ");
                    //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'></th>");
                    //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:7%;'>" + lstData.Where(z => z.Godown == x.Godown).Sum(z => z.NoOfSbs) + "</th> ");
                    //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:9%;'>" + lstData.Where(z => z.Godown == x.Godown).Sum(z => z.NoOfUnits).ToString("0.00") + "</th>");
                    //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:13%;'>" + lstData.Where(z => z.Godown == x.Godown).Sum(z => z.GrossWeight).ToString("0.00") + "</th>");
                    //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:8%;'>" + lstData.Where(z => z.Godown == x.Godown).Sum(z => z.FOB).ToString("0.00") + "</th>");
                    //Pages.Append("<th style='text-align:left;border-top:1px solid #000;padding:10px;width:5%;'>" + lstData.Where(z => z.ShippingLineId == x.ShippingLineId).Sum(z => z.Area).ToString("0.00") + "</th>");
                    //Pages.Append("</tr></tbody></table>");
                    //Pages.Append("</td></tr>");

                    Pages.Append("</tbody></table>");
                    Pages.Append("</td></tr>");
                });
                //loop  end

                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellpadding='10' style='border:1px solid #000;width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody><tr>");
                Pages.Append("<th style='text-align:left;width:8%;'>Total :</th>");
                Pages.Append("<th style='text-align:left;width:8%;'>" + lstData.Count() + "</th>");
                Pages.Append("<th style='text-align:left;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;width:10%;'></th>");
                Pages.Append("<th style='text-align:left;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;width:7%;'></th>");
                Pages.Append("<th style='text-align:left;width:9%;'></th>");
                Pages.Append("<th style='text-align:left;width:13%;'></th>");
                Pages.Append("<th style='text-align:left;width:8%;'>" + lstData.Sum(x => x.NoOfSbs) + "</th>");
                Pages.Append("<th style='text-align:left;width:5%;'>" + lstData.Sum(x => x.NoOfUnits).ToString("0.00") + "</th>");
                Pages.Append("<th style='text-align:left;width:9%;'>" + lstData.Sum(x => x.GrossWeight) + "</th>");
                Pages.Append("<th style='text-align:left;width:13%;'>" + lstData.Sum(x => x.FOB).ToString("0.00") + "</th>");
                Pages.Append("<th style='text-align:left;width:8%;'></th>");
                Pages.Append("<th style='text-align:left;width:5%;'></th>");
                Pages.Append("</tr></tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("</tbody>");
                Pages.Append("</table>");
                Pages.Append("</td></tr>");
                Pages.Append("</tbody></table>");




                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:40%; border-collapse:collapse; text-align: center; border:1px solid #000; font-size:7pt; margin-top:20px;'>");
                Pages.Append("<thead>");
                Pages.Append("<tr><th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 300px;'>Total</th></tr>");
                //  Pages.Append("<th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 300px;'>Empty In</th>");
                //  Pages.Append("<th colspan='3' style='border-right: 1px solid #000; border-bottom: 1px solid #000; width: 300px;'>Loaded In</th>");
                //  Pages.Append("<th colspan='3' style='border-bottom: 1px solid #000; width: 300px;'>Hub In</th></tr>");

                Pages.Append("<tr><th style='border-right: 1px solid #000; width: 100px;'>20 FT</th>");
                Pages.Append("<th style='border-right: 1px solid #000; width: 100px;'>40 FT</th>");
                Pages.Append("<th style='width: 100px;'>45 FT</th></tr>");
                Pages.Append("</thead>");

                Pages.Append("<tbody>");

                Pages.Append("<tr><td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + lstData.Count(x => x.Size.Equals("20")) + "</td>");
                Pages.Append("<td style='border-right: 1px solid #000; border-top: 1px solid #000;'>" + lstData.Count(x => x.Size.Equals("40")) + "</td>");
                Pages.Append("<td style='border-top: 1px solid #000;'> " + lstData.Count(x => x.Size.Equals("45")) + "</td></tr>");

                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }

        #endregion

        #region Container Arrival Report

        [HttpGet]
        public ActionResult ContainerArrivalReport()
        {
            return PartialView();
        }

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult GetContainerArrivalReport(Dnd_ContainerArrivalReport ObjContainerArrivalReport)
        {

            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            Dnd_ContainerArrivalReport LstContainerArrivalReport = new Dnd_ContainerArrivalReport();
            Login objLogin = (Login)Session["LoginUser"];
            ObjRR.ContainerArrivalReport(ObjContainerArrivalReport);//, objLogin.Uid
            if (ObjRR.DBResponse.Data != null)
            {
                LstContainerArrivalReport = (Dnd_ContainerArrivalReport)ObjRR.DBResponse.Data;

                return Json(ObjRR.DBResponse);
            }
            else
            {
                return Json(ObjRR.DBResponse);
            }

        }

        [HttpPost, ValidateInput(false)]
        [CustomValidateAntiForgeryToken]
        public JsonResult GenerateContainerArrivalReportPDF(FormCollection fc)
        {
            try
            {
                var Pages = new string[1];
                var FileName = "ContainerArrivalReport.pdf";
                Pages[0] = fc["Page"].ToString();
                string LocalDirectory = Server.MapPath("~/Docs") + "/" + Session.SessionID + "/Report/ContainerArrivalReport/";
                if (!Directory.Exists(LocalDirectory))
                    Directory.CreateDirectory(LocalDirectory);
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + FileName, Pages);

                }
                var ObjResult = new { Status = 1, Message = "/Docs/" + Session.SessionID + "/Report/ContainerArrivalReport/" + FileName };
                return Json(ObjResult);

            }
            catch (Exception ex)
            {
                return Json(new { Status = "-1", Message = "", }, JsonRequestBehavior.DenyGet);
            }

        }

        #endregion

        #region  Cargo shifting register
        [HttpGet]
        public ActionResult CargoShiftingRegister()
        {
            Dnd_ReportRepository ObjGR = new Dnd_ReportRepository();
            ObjGR.GetGodownForCargoCarting();
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult DailyTransactionShiftingPrint(Dnd_TotalContainerReport obj, string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.DailyTransactionShiftingPrint(obj, PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFDailyShiftingReport(lstData, PeriodFrom, PeriodTo, obj.GodownName);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFDailyShiftingReport(Dnd_TotalContainerReport lstData, string FromDate, string ToDate, string GodownName)
        {
            try
            {
                var FileName = "CargoShiftingRegister.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                // Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Daily Transaction Diary(Carting)</label></td></tr>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 23px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:8pt;'>Container Freight Station</span><br/><span style='font-size:8pt;'>" + lstData.mstcompany + "</span><br/><label style='font-size: 8pt; font-weight:bold;'>Cargo Shifting Register</label><br/><span style='font-size:8pt;'><b>Shed No-</b> " + GodownName + "</span><br/><label style='font-size: 8pt;'><b>For the Period </b>" + FromDate + " And " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:6pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:70px;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Entry No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>SB No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>SB Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Pkgs.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Gross Weight</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>FOB</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:60px;'>To Shed</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>From SLA</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>To SLA</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Shift Slip No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Slip Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Bill Sla</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:100px;'>Shift Date</th></tr></thead>");

                Pages.Append("<tbody>");
                int i = 1;
                decimal NOP; decimal GW; decimal FOB; int totalSB;


                NOP = 0;
                GW = 0;
                FOB = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.EntryNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingBillNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingBillDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.TotalPkg + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GrossWeight + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Fob + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GodownName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLineName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.MovementDate + "</td>");
                    Pages.Append("</tr>");

                    i++;

                });

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Total</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.LstTotal.Count() + " </th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.LstTotal.Sum(x => x.TotalPkg) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.LstTotal.Sum(x => x.GrossWeight) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.LstTotal.Sum(x => x.Fob) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'></th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion

        #region  Cargo Receiving register
        [HttpGet]
        public ActionResult CargoReceivingRegister()
        {
            Dnd_ReportRepository ObjGR = new Dnd_ReportRepository();
            ObjGR.GetGodownForCargoCarting();
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public JsonResult DailyTransactionReceivingPrint(Dnd_TotalContainerReport obj, string PeriodFrom, string PeriodTo)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.DailyTransactionReceivingPrint(obj, PeriodFrom, PeriodTo);
            string Path = "";
            if (ObjRR.DBResponse.Data != null)
            {
                Dnd_TotalContainerReport lstData = new Dnd_TotalContainerReport();
                lstData = (Dnd_TotalContainerReport)ObjRR.DBResponse.Data;
                Path = GeneratePDFDailyReceivingReport(lstData, PeriodFrom, PeriodTo, obj.GodownName);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }

            else
                return Json(new { Status = 0, Data = "No Record Found" }, JsonRequestBehavior.AllowGet);
        }
        [NonAction]
        public string GeneratePDFDailyReceivingReport(Dnd_TotalContainerReport lstData, string FromDate, string ToDate, string GodownName)
        {
            try
            {
                var FileName = "CargoReceivingRegister.pdf";
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                // Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 16px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 7pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + lstData.mstcompany + "</span><br/><span style='font-size:7pt;'><b>From </b> " + FromDate + " <b>To </b>" + ToDate + "</span><br/><label style='font-size: 7pt; font-weight:bold;'>Daily Transaction Diary(Carting)</label></td></tr>");
                Pages.Append("<td width='180%' valign='top' align='center'><h1 style='font-size: 23px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:8pt;'>Container Freight Station</span><br/><span style='font-size:8pt;'>" + lstData.mstcompany + "</span><br/><label style='font-size: 8pt; font-weight:bold;'>Cargo Received By Shifting Register</label><br/><span style='font-size:8pt;'><b>Shed No-</b> " + GodownName + "</span><br/><label style='font-size: 8pt;'><b>For the Period </b>" + FromDate + " And " + ToDate + "</label></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:6pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:70px;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Entry No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>SB No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>SB Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Pkgs.</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Gross Weight</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>FOB</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:60px;'>From Shed</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>From SLA</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>To SLA</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Shift Slip No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Slip Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:100px;'>Bill Sla</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:100px;'>Shift Date</th></tr></thead>");

                Pages.Append("<tbody>");
                int i = 1;
                decimal NOP; decimal GW; decimal FOB; int totalSB;


                NOP = 0;
                GW = 0;
                FOB = 0;
                lstData.LstTotal.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.EntryNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingBillNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingBillDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.TotalPkg + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GrossWeight + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.Fob + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.GodownName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ShippingLineName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.MovementNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'></td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.MovementDate + "</td>");
                    Pages.Append("</tr>");

                    i++;

                });

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'>Total</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.LstTotal.Count() + " </th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.LstTotal.Sum(x => x.TotalPkg) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.LstTotal.Sum(x => x.GrossWeight) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + lstData.LstTotal.Sum(x => x.Fob) + "</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;'></th>");
                Pages.Append("<th style='border-bottom:1px solid #000;'></th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 40f, 40f, 40f, 40f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }
        #endregion


        #region ECONOMY REPORT
        public ActionResult EconomyReport()
        {
            return PartialView();
        }

        public JsonResult GetEconomyReport(int Month, int Year)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            ObjRR.GetEconomyReport(Month, Year);
            return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpPost]
        public JsonResult SaveEconomyReport(int Month, int Year, List<EconomyReport> lstRptData)
        {
            try
            {
                Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();

                decimal result;
                List<EconomyReport> lst = new List<EconomyReport>();
                lstRptData.ForEach(item =>
                {
                    if (decimal.TryParse(item.Amount, out result))
                    {
                        lst.Add(item);
                    }
                });

                string xml = "";
                if (lst != null)
                {
                    xml = Utility.CreateXML(lst);
                }

                ObjRR.SaveEconomyReport(Month, Year, xml, ((Login)(Session["LoginUser"])).Uid);

                return Json(ObjRR.DBResponse, JsonRequestBehavior.AllowGet);

            }
            catch (Exception ex)
            {
                return Json(new { Status = -1, Message = "Internal Error Occurs !!", Data = "" }, JsonRequestBehavior.AllowGet);
            }
        }

        [HttpPost]
        public JsonResult EconomyReportPrint(int Month, int Year)
        {
            try
            {
                Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
                ObjRR.GetEconomyReportForPrint(Month, Year);
                if (ObjRR.DBResponse.Status == 1)
                {
                    return Json(new { Status = 1, Message = "Data Detected", Data = GeneratingPDFforEcoRpt((EconomyRptPrint)ObjRR.DBResponse.Data) }, JsonRequestBehavior.AllowGet);
                }
                else
                {
                    return Json(new { Status = -1, Message = ObjRR.DBResponse.Message }, JsonRequestBehavior.AllowGet);
                }

            }
            catch (Exception e)
            {
                return Json(new { Status = -1, Message = "Internal Error Occurs !!" }, JsonRequestBehavior.AllowGet);
            }
        }
        [NonAction]
        public string GeneratingPDFforEcoRpt(EconomyRptPrint data)
        {
            CompanyDetailsForReport objCompanyDetails = new CompanyDetailsForReport();
            WFLD_ReportRepository ObjRR = new WFLD_ReportRepository();
            ObjRR.getCompanyDetails();
            objCompanyDetails = (CompanyDetailsForReport)ObjRR.DBResponse.Data;
            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();
            StringBuilder html2 = new StringBuilder();
            StringBuilder html3 = new StringBuilder();
            StringBuilder html4 = new StringBuilder();
            StringBuilder html5 = new StringBuilder();
            //html.Append("<h1>Test</h1>");
            //Page 1*********************************************************************************************************************
            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif;'><thead>");
            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%;'><tbody>");
            html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
            html.Append("<td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:12px;'>" + objCompanyDetails.CompanyAddress + "</span><br/>");
            html.Append("<label style='font-size: 14px; font-weight:bold;'>ECONOMY REPORT FOR THE PERIOD OF " + Convert.ToDateTime(data.FormDate).ToString("dd-MMM-yyyy") + " TO " + Convert.ToDateTime(data.ToDate).ToString("dd-MMM-yyyy") + "</label></td></tr>");
            html.Append("<tr><th><br/><br/></th></tr>");
            html.Append("<tr><th colspan='12' style='text-align: right; font-size:8pt;'>DATED : " + Convert.ToDateTime(data.CreatedOn).ToString("dd-MMM-yyyy") + "</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");
            html.Append("</thead></table>");

            html.Append("<table style='width:100%; margin-bottom:20px; font-size: 8pt;' cellspacing='0' cellpadding='5'>");
            html.Append("<thead>");
            html.Append("<tr><th cellpadding='5' colspan='12' style='border-top: 1px solid #000; border-bottom: 1px solid #000; font-size: 9pt; text-align: center;'>COVERED AREA AND ITS CAPACITY</th></tr>");
            html.Append("<tr><th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Gross in <br/> Sq.Mtrs</th>");
            html.Append("<th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Net(Usable) in Sq.Mtrs</th>");
            html.Append("<th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Grids/Slot(Nos)</th>");
            html.Append("<th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Std.Bags(Nos)</th>");
            html.Append("</tr>");
            html.Append("</thead>");

            html.Append("<tbody>");
            html.Append("<tr><td colspan='3' style='padding:15px 5px;'>" + data.SqmCovered + "</td>");
            html.Append("<td colspan='3' style='padding:15px 5px;'></td>");
            html.Append("<td colspan='3' style='padding:15px 5px;'></td>");
            html.Append("<td colspan='3' style='padding:15px 5px;'>" + data.BagCovered + "</td></tr>");
            html.Append("</tbody>");
            html.Append("</table>");

            html.Append("<table style='width:100%; margin-bottom:20px; font-size: 8pt;' cellspacing='0' cellpadding='5'>");
            html.Append("<thead>");
            html.Append("<tr><th colspan='12' style='border-top: 1px solid #000; border-bottom: 1px solid #000; font-size: 9pt; text-align: center;'>OPEN AREA AND ITS CAPACITY</th></tr>");
            html.Append("<tr><th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Gross in <br/> Sq.Mtrs</th>");
            html.Append("<th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Net(Usable) in Sq.Mtrs</th>");
            html.Append("<th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>TEU's(Nos.)</th>");
            html.Append("<th colspan='3' style='border-bottom: 1px solid #000; text-align:left;'>Std.Bags(Nos)</th>");
            html.Append("</tr>");
            html.Append("</thead>");
            html.Append("<tbody>");
            html.Append("<tr><td colspan='3' style='padding:15px 5px;'>" + data.SqmOpen + "</td>");
            html.Append("<td colspan='3' style='padding:15px 5px;'></td>");
            html.Append("<td colspan='3' style='padding:15px 5px;'></td>");
            html.Append("<td colspan='3' style='padding:15px 5px;'>" + data.BagOpen + "</td></tr>");
            html.Append("</tbody>");
            html.Append("</table>");

            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-size:9pt;'><tbody>");
            html.Append("<tr><td><br/><br/><br/><br/></td></tr>");
            html.Append("<tr><td colspan='12' style='text-align: left;'>Submmited to:- <br/> <b>The Regional Manager</b> <br/> CWC, RO, DELHI</td></tr>");
            html.Append("</tbody></table>");

            //html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
            lstSB.Add(html.ToString());
            //Page 2*********************************************************************************************************************

            html2.Append("<table style='border-top: 1px solid #000;width:100%; font-size:8pt;' cellspacing='0' cellpadding='5'>");
            html2.Append("<thead>");
            html2.Append("<tr><th style='border-bottom: 1px solid #000; text-align:left; width:50%;'>Head of Income</th>");
            html2.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:17%;'>Amount <br/> RS   P.</th>");
            html2.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:17%;'>Cumulative <br/> Since 1st April</th>");
            html2.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:17%;'>Progressive Cumulative <br/> RS   P.</th></tr>");

            html2.Append("<tr><th style='border-bottom: 1px solid #000; text-align:left; width:50%;'>1</th>");
            html2.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:17%;'>2</th>");
            html2.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:17%;'>3</th>");
            html2.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:17%;'>4</th></tr>");
            html2.Append("</thead>");
            html2.Append("<tbody>");

            data.RptDetails.Where(x => x.ItemType == "I" && x.PageNo == 2).ToList().ForEach(i =>
            {
                html2.Append("<tr><td cellpadding='5'>" + i.ItemLabel + "</td>");
                html2.Append("<td cellpadding='5'>" + i.Amount + "</td>");
                html2.Append("<td cellpadding='5'>" + i.CumAmount + "</td>");
                html2.Append("<td cellpadding='5'>" + i.ProCumAmount + "</td></tr>");
            });
            html2.Append("</tbody>");
            html2.Append("</table>");

            lstSB.Add(html2.ToString());

            //Page 3**********************************************************************************************************************          
            html3.Append("<table style='width:100%; font-size:9pt;' cellspacing='0' cellpadding='5'>");
            html3.Append("<thead>");
            html3.Append("<tr><th style='border-top:1px solid #000; border-bottom: 1px solid #000;text-align:left; width:50%;''>1</th>");
            html3.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:17%;'>2</th>");
            html3.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:17%;'>3</th>");
            html3.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:17%;'>4</th></tr>");
            html3.Append("</thead>");
            html3.Append("<tbody>");

            data.RptDetails.Where(x => x.ItemType == "I" && x.PageNo == 3).ToList().ForEach(i =>
            {
                html3.Append("<tr><td cellpadding='4'>" + i.ItemLabel + "</td>");
                html3.Append("<td cellpadding='4'>" + i.Amount + "</td>");
                html3.Append("<td cellpadding='4'>" + i.CumAmount + "</td>");
                html3.Append("<td cellpadding='4'>" + i.ProCumAmount + "</td></tr>");
            });
            html3.Append("</tbody>");
            html3.Append("</table>");
            lstSB.Add(html3.ToString());

            //Page 4**********************************************************************************************************************            
            html4.Append("<table style='width:100%; font-size: 8pt;' cellspacing='0' cellpadding='5'>");
            html4.Append("<thead>");
            html4.Append("<tr><th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:8%;'>Code No</th>");
            html4.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:47%;'>Head of Expenses</th>");
            html4.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Amount <br/> RS   P.</th>");
            html4.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Cumulative <br/> Since 1st April</th>");
            html4.Append("<th style='border-top:1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Progressive Cumulative <br/> RS   P.</th></tr>");

            html4.Append("<tr><th style='border-bottom: 1px solid #000; text-align:left; width:8%;'>5</th>");
            html4.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:47%;'>6</th>");
            html4.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:15%;'>7</th>");
            html4.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:15%;'>8</th>");
            html4.Append("<th style='border-bottom: 1px solid #000; text-align:left; width:15%;'>9</th></tr>");
            html4.Append("</thead>");
            html4.Append("<tbody>");

            int maxSr = data.RptDetails.Where(x => x.ItemType == "E").Max(x => x.Sr);
            data.RptDetails.Where(x => x.ItemType == "E" && x.PageNo == 4).ToList().ForEach(i =>
            {

                html4.Append("<tr>");
                if (i.Sr == maxSr)
                {
                    html4.Append("<td cellpadding='5' colspan='2'>" + i.ItemLabel + "</td>");
                    //html4.Append("<td style='font-size: 9pt; padding:10px;'>" + i.ItemLabel + "</td>");
                }
                else
                {
                    html4.Append("<td cellpadding='5'>" + i.ItemCodeNo + "</td>");
                    html4.Append("<td cellpadding='5'>" + i.ItemLabel + "</td>");
                }
                html4.Append("<td cellpadding='5'>" + i.Amount + "</td>");
                html4.Append("<td cellpadding='5'>" + i.CumAmount + "</td>");
                html4.Append("<td cellpadding='5'>" + i.ProCumAmount + "</td></tr>");
            });

            html4.Append("</tbody>");
            /*html4.Append("<tfoot>");
            html4.Append("<tr><th colspan='2' style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Excess of Income over Expenditure</th>");
            html4.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Dynamic</th>");
            html4.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Dynamic</th>");
            html4.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Dynamic</th></tr>");
            html4.Append("</tfoot>");*/
            html4.Append("</table>");
            lstSB.Add(html4.ToString());

            //Page last**********************************************************************************************************************    

            html5.Append("<table style='width:100%; font-size:8pt;' cellspacing='0' cellpadding='5'>");
            html5.Append("<thead><tr><th colspan='12' style='text-align: left; font-size:9pt;'>Summary of Financial Performance for the period of " + Convert.ToDateTime(data.FormDate).ToString("dd-MMM-yyyy") + " to " + Convert.ToDateTime(data.ToDate).ToString("dd-MMM-yyyy") + "</th></tr>");
            html5.Append("<tr><th style='border-top: 1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Code No</th>");
            html5.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; text-align:left; width:40%;'>Head of Income</th>");
            html5.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Amount <br /> RS   P.</th>");
            html5.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Cumulative <br /> Since 1st April</th>");
            html5.Append("<th style='border-top: 1px solid #000; border-bottom: 1px solid #000; text-align:left; width:15%;'>Progressive Cumulative <br /> RS   P.</th></tr>");
            html5.Append("</thead>");
            html5.Append("<tbody>");
            data.RptSummary.ForEach(i =>
            {
                html5.Append("<tr><td cellpadding='5'>" + i.CodeNo + "</td>");
                html5.Append("<td cellpadding='5'>" + i.ItemLabel + "</td>");
                html5.Append("<td cellpadding='5'>" + i.Amount + "</td>");
                html5.Append("<td cellpadding='5'>" + i.CumAmount + "</td>");
                html5.Append("<td cellpadding='5'>" + i.ProCumAmount + "</td></tr>");
            });
            html5.Append("</tbody>");
            /*html5.Append("<tfoot>");
            html5.Append("<tr><th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'></th>");
            html5.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Total(A+B)</th>");
            html5.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Dynamic</th>");
            html5.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Dynamic</th>");
            html5.Append("<th style='border-top:1px solid #000; font-size: 11pt; padding:10px; text-align:left;'>Dynamic</th></tr>");
            html5.Append("</tfoot>");*/
            html5.Append("</table>");

            html5.Append("<table style='border-top:1px solid #000; width:100%;' cellspacing='0' cellpadding='10'>");
            html5.Append("<tbody>");
            html5.Append("<tr><td width='3%' align='right' style='font-size:8pt;'>1.</td><td colspan='2' width='85%' style='font-size:9pt;'>Indicate total number of time barred Bond and income involved(with vearwise break-up)</td></tr>");
            html5.Append("<tr><td width='3%' align='right' style='font-size:8pt;'>2.</td><td colspan='2' width='85%' style='font-size:9pt;'>Number of contaiers seized abandanded and their income involved(with vearwise break-up)</td></tr>");
            html5.Append("</tbody>");
            html5.Append("</table>");

            lstSB.Add(html5.ToString());

            var FileName = "EcoReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        #region WorkSlip
        public ActionResult WorkSlipReport()
        {
            return PartialView();
        }

        [HttpPost]
        public JsonResult GetWorkSlipReport(string PeriodFrom, string PeriodTo, int CasualLabour)
        {
            Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
            Login objLogin = (Login)Session["LoginUser"];
            string FilePath = "";
            string fdt = Convert.ToDateTime(PeriodFrom).ToString("yyyy-MM-dd");
            string tdt = Convert.ToDateTime(PeriodTo).ToString("yyyy-MM-dd");
            ObjRR.WorkSlipDetailsForPrint(fdt, tdt, CasualLabour, objLogin.Uid);//, objLogin.Uid
            if (ObjRR.DBResponse.Status == 1)
            {
                DataSet ds = (DataSet)ObjRR.DBResponse.Data;
                FilePath = GeneratingPDFforWS(ds, Convert.ToDateTime(PeriodFrom).ToString("dd-MMM-yy"), Convert.ToDateTime(PeriodTo).ToString("dd-MMM-yy"));
                return Json(new { Status = 1, Data = FilePath });
            }
            else
                return Json(new { Status = -1, Data = "No Record Found." });
        }

        [NonAction]
        public string GeneratingPDFforWS(DataSet ds, string dt, string dtt)
        {
            List<dynamic> objWs = ConvertingDataTabletoDynamic.ToDynamic(ds.Tables[0]);
            List<string> lstSB = new List<string>();
            StringBuilder html = new StringBuilder();

            List<dynamic> objImport = objWs.Where(o => o.Operation == "Import").ToList();
            List<dynamic> objExport = objWs.Where(o => o.Operation == "Export").ToList();
            List<dynamic> objGeneral = objWs.Where(o => o.Operation == "General").ToList();

            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
            html.Append("<tr><td colspan='12'>");

            html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><tbody>");
            html.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td><td width='100%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 12px;'>(A Govt. of India Undertaking)</label><br/><label style='font-size: 12px;'>Dronagiri Node, Navi Mumbai - 400707</label><br/><label style='font-size: 14px; font-weight:bold;'>Workslip</label></td></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");

            html.Append("<tr><td colspan='12'><table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
            html.Append("<tr><th align='left' colspan='4' width='30%' style='font-size:13px;'>WorkSlip No : " + objImport[0].WorkSlipNo + "</th><th align='left' colspan='8' width='70%' style='font-size:13px;'>From Date of Operation : " + dt + "</th><th align='left' colspan='8' width='70%' style='font-size:13px;'>To Date of Operation : " + dtt + "</th></tr>");
            html.Append("</tbody></table></td></tr>");

            //IMPORT
            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
            html.Append("<tr><th width='5%' style='font-size:14px;' valign='top' align='right'>A).</th>");
            html.Append("<th colspan='2' width='95%' align='left' style='font-size:14px;'>IMPORT OPERATIONS :-</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");

            //loop start
            objImport.ForEach(item =>
            {
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='5%' valign='top' align='left' style='font-size:12px;'>" + item.WSClause + "</td>");
                html.Append("<td colspan='2' width='95%' style='font-size:12px;'>" + item.Heading + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='5%'></td><th width='31%'  align='left' style='font-size:12px;'>" + item.CFSCodeCont20 + "</th><td width='30%'></td>");
                html.Append("<th colspan='5' width='40%' style='font-size:12px;' align='left'>" + item.CFSCodeCont40 + "</th></tr>");

                html.Append("<tr><td width='5%'></td>");
                html.Append("<td width='31%' valign='top'>");
                if (item.WSClause != "5" && item.WSClause != "6" && item.WSClause != "12" && item.WSClause != "13" && item.WSClause != "14")
                {
                    html.Append("<table cellspacing='0' cellpadding='5' style='font-size:12px; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody><tr>");
                    html.Append("<th width='80%' align='left'>SUMMARY ITEM " + item.WSClause + "</th><th width='10%' align='left'>" + item.Count20 + "</th><th width='10%' align='right'>+</th>");
                    html.Append("</tr></tbody></table>");
                    html.Append("</td>");
                    html.Append("<td width='30%'>");
                    html.Append("<table cellspacing='0' cellpadding='5' style='font-size:12px; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody><tr>");
                    html.Append("<th width='30%' align='left'>" + item.Count40 + "</th><th width='40%' align='left'>= " + item.CountTotal + "</th><th width='40%' align='left'>TEUS</th>");
                    html.Append("</tr></tbody></table>");
                }
                html.Append("</td>");
                html.Append("<td colspan='5' width='40%'></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

            });
            //Loop end

            //EXPORT
            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
            html.Append("<tr><th width='5%' style='font-size:14px;' valign='top' align='right'>B).</th>");
            html.Append("<th colspan='2' width='95%' align='left' style='font-size:14px;'>EXPORT OPERATIONS :-</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");

            //loop start
            objExport.ForEach(item =>
            {
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='5%' valign='top' align='left' style='font-size:12px;'>" + item.WSClause + "</td>");
                html.Append("<td colspan='2' width='95%' style='font-size:12px;'>" + item.Heading + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='5%'></td><th width='31%'  align='left' style='font-size:12px;'>" + item.CFSCodeCont20 + "</th><td width='30%'></td>");
                html.Append("<th colspan='5' width='40%' style='font-size:12px;' align='left'>" + item.CFSCodeCont40 + "</th></tr>");

                html.Append("<tr><td width='5%'></td>");
                html.Append("<td width='31%' valign='top'>");
                if (item.WSClause != "5" && item.WSClause != "6" && item.WSClause != "12" && item.WSClause != "13" && item.WSClause != "14")
                {
                    html.Append("<table cellspacing='0' cellpadding='5' style='font-size:12px; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody><tr>");
                    html.Append("<th width='80%' align='left'>SUMMARY ITEM " + item.WSClause + "</th><th width='10%' align='left'>" + item.Count20 + "</th><th width='10%' align='right'>+</th>");
                    html.Append("</tr></tbody></table>");
                    html.Append("</td>");
                    html.Append("<td width='30%'>");
                    html.Append("<table cellspacing='0' cellpadding='5' style='font-size:12px; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody><tr>");
                    html.Append("<th width='30%' align='left'>" + item.Count40 + "</th><th width='40%' align='left'>= " + item.CountTotal + "</th><th width='40%' align='left'>TEUS</th>");
                    html.Append("</tr></tbody></table>");
                }
                html.Append("</td>");
                html.Append("<td colspan='5' width='40%'></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

            });
            //Loop end

            //GENERAL
            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
            html.Append("<tr><th width='5%' style='font-size:14px;' valign='top' align='right'>C).</th>");
            html.Append("<th colspan='2' width='95%' align='left' style='font-size:14px;'>GENERAl OPERATIONS :-</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");

            //loop start
            objGeneral.ForEach(item =>
            {
                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='0' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='5%' valign='top' align='left' style='font-size:12px;'>" + item.WSClause + "</td>");
                html.Append("<td colspan='2' width='95%' style='font-size:12px;'>" + item.Heading + "</td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

                html.Append("<tr><td colspan='12'>");
                html.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                html.Append("<tr><td width='5%'></td><th width='31%'  align='left' style='font-size:12px;'>" + item.CFSCodeCont20 + "</th><td width='30%'></td>");
                html.Append("<th colspan='5' width='40%' style='font-size:12px;' align='left'>" + item.CFSCodeCont40 + "</th></tr>");

                html.Append("<tr><td width='5%'></td>");
                html.Append("<td width='31%' valign='top'>");

                if (item.WSClause != "5" && item.WSClause != "6" && item.WSClause != "12" && item.WSClause != "13" && item.WSClause != "14")
                {
                    html.Append("<table cellspacing='0' cellpadding='5' style='font-size:12px; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody><tr>");
                    html.Append("<th width='80%' align='left'>SUMMARY ITEM " + item.WSClause + "</th><th width='10%' align='left'>" + item.Count20 + "</th><th width='10%' align='right'>+</th>");
                    html.Append("</tr></tbody></table>");
                    html.Append("</td>");
                    html.Append("<td width='30%'>");
                    html.Append("<table cellspacing='0' cellpadding='5' style='font-size:12px; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody><tr>");
                    html.Append("<th width='30%' align='left'>" + item.Count40 + "</th><th width='40%' align='left'>= " + item.CountTotal + "</th><th width='40%' align='left'>TEUS</th>");
                    html.Append("</tr></tbody></table>");
                }
                html.Append("</td>");
                html.Append("<td colspan='5' width='40%'></td></tr>");
                html.Append("</tbody></table>");
                html.Append("</td></tr>");

            });
            //Loop end

            html.Append("<tr><td colspan='12'>");
            html.Append("<table cellspacing='0' cellpadding='5' style='font-size:12px; width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
            html.Append("<tr><td><br/><br/><br/></td></tr>");
            html.Append("<tr><th colspan='2'>Name & Sign of H & T Contractor</th>");
            html.Append("<th colspan='1'></th>");
            html.Append("<th colspan='2'>Name & Sign of Supdt.Imp./Exp/Wh/C.U.</th>");
            html.Append("<th colspan='1'></th>");
            html.Append("<th colspan='2'>Name & Sign of S.A.M(Imp.) S.A.M. [Imp.][Exp.] Wh.</th>");
            html.Append("<th colspan='1'></th>");
            html.Append("<th colspan='2'>Name & Sign of Manager CFS</th></tr>");
            html.Append("</tbody></table>");
            html.Append("</td></tr>");
            html.Append("</tbody></table>");

            html = html.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

            lstSB.Add(html.ToString());

            var FileName = "WorkSlipReport" + DateTime.Now.ToOADate().ToString().Replace(".", string.Empty) + ".pdf";
            var location = Server.MapPath("~/Docs/") + Session.SessionID + "/" + FileName;
            if (!System.IO.Directory.Exists(Server.MapPath("~/Docs/") + Session.SessionID))
            {
                System.IO.Directory.CreateDirectory(Server.MapPath("~/Docs/") + Session.SessionID);
            }
            /*if (System.IO.File.Exists(location))
            {
                System.IO.File.Delete(location);
            }*/

            using (var rp = new ReportingHelper(PdfPageSize.A4, 20f, 40f, 20f, 20f, false, true))
            {
                rp.HeadOffice = "";
                rp.HOAddress = "";
                rp.ZonalOffice = "";
                rp.ZOAddress = "";
                rp.GeneratePDF(location, lstSB);
            }
            return "/Docs/" + Session.SessionID + "/" + FileName;
        }
        #endregion

        #region Stock Register Report
        public ActionResult StockRegisterReport()
        {
            DNODEMasterRepository ObjGR = new DNODEMasterRepository();
            ObjGR.GetAllGodown();
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }

        [HttpPost]
        public JsonResult GetStockRegisterReport(Dnd_StockRegisterReportViewModel vm)
        {
            string Path;
            Dnd_ReportRepository obj = new Dnd_ReportRepository();
            obj.StockRegisterReport(vm);

            if (obj.DBResponse.Status == 1)
            {
                Path = GeneratePDFStockRegisterReport((Dnd_StockRegisterReportViewModel)obj.DBResponse.Data, vm.AsOnDate, vm.GodownName);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(new { Status = 0, Data = "No Record Found....." }, JsonRequestBehavior.AllowGet);
            }
        }

        public string GeneratePDFStockRegisterReport(Dnd_StockRegisterReportViewModel lstStockdetails, string AsOnDate, string GodownName)
        {
            try
            {
                var FileName = "StockRegisterReport.pdf";
                StringBuilder Pages = new StringBuilder();

                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                Pages.Append("<tr><td colspan='13'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:8pt;'>Stock Register of Shed No " + GodownName + "</span><br/><span style='font-size:8pt;'><b>As on Date </b> " + AsOnDate + " </span></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='13'>");

                Pages.Append("<table style='width:100%;font-size:7pt;text-align:left;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border:1px solid #000;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>SLA Cd</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:30px;'>Sr.</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Sb No</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Sb Date</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Entry No</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Carting Date</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>No Pkg</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px; text-align:right;'>Gr Wt.</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px; text-align:right;'>Fob</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Slot No</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px; text-align:right;'>Area</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Crg</th>");
                Pages.Append("<th cellpadding='5' style='width:100px;'>Cargo Desc</th>");
                Pages.Append("</tr></thead>");

                Pages.Append("<tbody>");
                //Loop Start
                lstStockdetails.lstShipping.ToList().ForEach(x =>
                {
                    Pages.Append("<tr><td colspan='13'>");
                    Pages.Append("<table style='width:100%;font-size:7pt;text-align:left;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                    Pages.Append("<tr><th cellpadding='5' colspan='13' style='border-top:1px solid #000;'>" + x.SLACode + " <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> " + x.ShippingName + "</th></tr>");
                    //loop start
                    int i = 1;
                    lstStockdetails.StockDetails.Where(y => y.Shippingid == x.Shippingid).ToList().ForEach(y =>
                    {
                        Pages.Append("<tr>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:30px;''>" + i + "</td> ");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.SbNo + "</td> ");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.SbDate + "</td> ");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.EntryNo + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.CartingDate + "</td> ");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.NoOfPKG + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + y.GWT + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + y.FOB + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.SlotNo + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + y.Area + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.Crg + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-top:1px solid #000; width:100px;'>" + y.CargoDesc + "</td>");
                        Pages.Append("</tr>");
                        i++;
                    });

                    Pages.Append("</tbody></table>");
                    Pages.Append("</td></tr>");
                });
                Pages.Append("<tr>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>Total</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:30px;''></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + lstStockdetails.StockDetails.Sum(p => p.NoOfPKG).ToString("0.00") + "</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + lstStockdetails.StockDetails.Sum(p => p.GWT).ToString("0.00") + "</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + lstStockdetails.StockDetails.Sum(p => p.FOB).ToString("0.00") + "</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + lstStockdetails.StockDetails.Sum(p => p.Area).ToString("0.00") + "</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");





                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 30f, 30f, 30f, 30f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;

            }
            catch (Exception ex)
            {
                return "";
            }

        }





        #endregion

        #region Stock Register SLA Wise


        public ActionResult StockRegisterReportSLAWise()
        {
            Dnd_ImportRepository objIR = new Dnd_ImportRepository();
            objIR.ListOfShippingLinePartyCode("", 0);
            if (objIR.DBResponse.Data != null)
            {
                var Jobj = Newtonsoft.Json.JsonConvert.SerializeObject(objIR.DBResponse.Data);
                var Jobject = Newtonsoft.Json.Linq.JObject.Parse(Jobj);
                ViewBag.lstShippingLine = Jobject["lstShippingLine"];
                ViewBag.State = Jobject["State"];
            }
            else
            {
                ViewBag.lstShippingLine = null;
                ViewBag.State = null;
            }
            DNODEMasterRepository ObjGR = new DNODEMasterRepository();
            ObjGR.GetAllGodown();
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }
        [HttpGet]
        public JsonResult SearchByPartyCode(string PartyCode)
        {
            Dnd_ImportRepository objRepo = new Dnd_ImportRepository();
            objRepo.ListOfShippingLinePartyCode(PartyCode, 0);
            return Json(objRepo.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpGet]
        public JsonResult LoadEximtradeList(string PartyCode, int Page)
        {
            Dnd_ImportRepository objRepo = new Dnd_ImportRepository();
            objRepo.ListOfShippingLinePartyCode(PartyCode, Page);
            return Json(objRepo.DBResponse, JsonRequestBehavior.AllowGet);
        }

        [HttpPost]
        public JsonResult GetStockRegisterReportSLAWise(Dnd_StockRegisterReportViewModel vm)
        {
            string Path;
            Dnd_ReportRepository obj = new Dnd_ReportRepository();
            obj.StockRegisterReportSLAWise(vm);

            if (obj.DBResponse.Status == 1)
            {
                Path = GeneratePDFStockRegisterReportSLAWise((Dnd_StockRegisterReportViewModel)obj.DBResponse.Data, vm.AsOnDate, vm.GodownName);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(new { Status = 0, Data = "No Record Found....." }, JsonRequestBehavior.AllowGet);
            }
        }

        public string GeneratePDFStockRegisterReportSLAWise(Dnd_StockRegisterReportViewModel lstStockdetails, string AsOnDate, string GodownName)
        {
            try
            {
                var FileName = "StockRegisterReportSlaWise.pdf";
                StringBuilder Pages = new StringBuilder();

                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                Pages.Append("<tr><td colspan='13'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:8pt;'>Stock Register of Shed No " + GodownName + "</span><br/><span style='font-size:8pt;'><b>As on Date </b> " + AsOnDate + " </span></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='13'>");

                Pages.Append("<table style='width:100%;font-size:7pt;text-align:left;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border:1px solid #000;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>SLA Cd</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:30px;'>Sr.</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Sb No</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Sb Date</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Entry No</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Carting Date</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>No Pkg</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px; text-align:right;'>Gr Wt.</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px; text-align:right;'>Fob</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Slot No</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px; text-align:right;'>Area</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Crg</th>");
                Pages.Append("<th cellpadding='5' style='width:100px;'>Cargo Desc</th>");
                Pages.Append("</tr></thead>");

                Pages.Append("<tbody>");
                //Loop Start
                lstStockdetails.lstShipping.ToList().ForEach(x =>
                {
                    Pages.Append("<tr><td colspan='13'>");
                    Pages.Append("<table style='width:100%;font-size:7pt;text-align:left;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                    Pages.Append("<tr><th cellpadding='5' colspan='13' style='border-top:1px solid #000;'>" + x.SLACode + " <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> " + x.ShippingName + "</th></tr>");
                    //loop start
                    int i = 1;
                    lstStockdetails.StockDetails.Where(y => y.Shippingid == x.Shippingid).ToList().ForEach(y =>
                    {
                        Pages.Append("<tr>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:30px;''>" + i + "</td> ");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.SbNo + "</td> ");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.SbDate + "</td> ");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.EntryNo + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.CartingDate + "</td> ");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.NoOfPKG + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + y.GWT + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + y.FOB + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.SlotNo + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + y.Area + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.Crg + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-top:1px solid #000; width:100px;'>" + y.CargoDesc + "</td>");
                        Pages.Append("</tr>");
                        i++;
                    });
                    Pages.Append("</tbody></table>");
                    Pages.Append("</td></tr>");
                });
                Pages.Append("<tr>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>Total</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:30px;''></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + lstStockdetails.StockDetails.Sum(p => p.NoOfPKG).ToString("0.00") + "</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + lstStockdetails.StockDetails.Sum(p => p.GWT).ToString("0.00") + "</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + lstStockdetails.StockDetails.Sum(p => p.FOB).ToString("0.00") + "</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + lstStockdetails.StockDetails.Sum(p => p.Area).ToString("0.00") + "</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("</tr>");

                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");





                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 30f, 30f, 30f, 30f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;

            }
            catch (Exception ex)
            {
                return "";
            }

        }
        #endregion

        #region Consolidated Stock Register 
        public ActionResult ConsolidatedStockRegisterReport()
        {
            DNODEMasterRepository ObjGR = new DNODEMasterRepository();
            ObjGR.GetAllGodown();
            if (ObjGR.DBResponse.Data != null)
                ViewBag.ListOfGodown = ObjGR.DBResponse.Data;
            else ViewBag.ListOfGodown = null;
            return PartialView();
        }

        [HttpPost]
        public JsonResult ConsolidatedGetStockRegisterReport(Dnd_ConsolidatedStockRegister vm)
        {
            string Path;
            Dnd_ReportRepository obj = new Dnd_ReportRepository();
            obj.ConsolidatedStockRegisterReport(vm);

            if (obj.DBResponse.Status == 1)
            {
                Path = GeneratePDFConsolidatedStockRegisterReport((Dnd_ConsolidatedStockRegister)obj.DBResponse.Data, vm.AsOnDate);
                return Json(new { Status = 1, Data = Path }, JsonRequestBehavior.AllowGet);
            }
            else
            {
                return Json(new { Status = 0, Data = "No Record Found....." }, JsonRequestBehavior.AllowGet);
            }
        }

        public string GeneratePDFConsolidatedStockRegisterReport(Dnd_ConsolidatedStockRegister lstStockdetails, string AsOnDate)
        {
            try
            {
                var FileName = "StockRegisterReport.pdf";
                StringBuilder Pages = new StringBuilder();

                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px; '><tbody>");
                Pages.Append("<tr><td colspan='13'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:8pt;'>Consolidated Stock Register</span><br/><span style='font-size:8pt;'><b>As on Date </b> " + AsOnDate + " </span></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><td colspan='13'>");

                Pages.Append("<table style='width:100%;font-size:7pt;text-align:left;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border:1px solid #000;'>");
                Pages.Append("<thead><tr>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Godown Name</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:30px;'>Sr.</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Sb No</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Sb Date</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Entry No</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Carting Date</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>No Pkg</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px; text-align:right;'>Gr Wt.</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px; text-align:right;'>Fob</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Slot No</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px; text-align:right;'>Area</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; width:100px;'>Crg</th>");
                Pages.Append("<th cellpadding='5' style='width:100px;'>Cargo Desc</th>");
                Pages.Append("</tr></thead>");

                Pages.Append("<tbody>");
                //Loop Start
                lstStockdetails.lstgodown.ToList().ForEach(x =>
                {
                    Pages.Append("<tr><td colspan='13'>");
                    Pages.Append("<table style='width:100%;font-size:7pt;text-align:left;font-family:Verdana,Arial,San-serif;border-collapse:collapse;'><tbody>");
                    Pages.Append("<tr><th cellpadding='5' colspan='13' style='border-top:1px solid #000;'> " + x.GodownName + "</th></tr>");
                    //loop start
                    int i = 1;
                    lstStockdetails.StockDetails.Where(y => y.GodownId == x.GodownId).ToList().ForEach(y =>
                    {
                        Pages.Append("<tr>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:30px;''>" + i + "</td> ");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.SbNo + "</td> ");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.SbDate + "</td> ");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.EntryNo + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.CartingDate + "</td> ");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.NoOfPKG + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + y.GWT + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + y.FOB + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.SlotNo + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + y.Area + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + y.Crg + "</td>");
                        Pages.Append("<td cellpadding='5' style='border-top:1px solid #000; width:100px;'>" + y.CargoDesc + "</td>");
                        Pages.Append("</tr>");
                        i++;
                    });
                    Pages.Append("<tr>");
                    Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>Total</th>");
                    Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:30px;''></th> ");
                    Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th> ");
                    Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th> ");
                    Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                    Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th> ");
                    Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + lstStockdetails.StockDetails.Where(p => p.GodownId == x.GodownId).Sum(p => p.NoOfPKG).ToString("0.00") + "</th>");
                    Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + lstStockdetails.StockDetails.Where(p => p.GodownId == x.GodownId).Sum(p => p.GWT).ToString("0.00") + "</th>");
                    Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + lstStockdetails.StockDetails.Where(p => p.GodownId == x.GodownId).Sum(p => p.FOB).ToString("0.00") + "</th>");
                    Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                    Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + lstStockdetails.StockDetails.Where(p => p.GodownId == x.GodownId).Sum(p => p.Area).ToString("0.00") + "</th>");
                    Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                    Pages.Append("<th cellpadding='5' style='border-top:1px solid #000; width:100px;'></th>");
                    Pages.Append("</tr>");
                    Pages.Append("</tbody></table>");
                    Pages.Append("</td></tr>");
                });
                Pages.Append("<tr>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>Total</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:30px;''></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'>" + lstStockdetails.StockDetails.Sum(p => p.NoOfPKG).ToString("0.00") + "</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + lstStockdetails.StockDetails.Sum(p => p.GWT).ToString("0.00") + "</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + lstStockdetails.StockDetails.Sum(p => p.FOB).ToString("0.00") + "</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px; text-align:right;'>" + lstStockdetails.StockDetails.Sum(p => p.Area).ToString("0.00") + "</th>");
                Pages.Append("<th cellpadding='5' style='border-right:1px solid #000; border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("<th cellpadding='5' style='border-top:1px solid #000; width:100px;'></th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");





                Pages.Append("</tbody></table>");

                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4Landscape, 30f, 30f, 30f, 30f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;

            }
            catch (Exception ex)
            {
                return "";
            }

        }
        #endregion

        #region VESSEL CUT OFF REPORT
        [HttpGet]
        public ActionResult VesselCutOffReport()
        {
            Dnd_ReportRepository ImpRep = new Dnd_ReportRepository();
            ViewBag.LstPort = null;
            ImpRep.GetAllPort();
            if (ImpRep.DBResponse.Data != null)
            {
                ViewBag.LstPort = ImpRep.DBResponse.Data;

            }
            return PartialView();

        }




        [HttpPost]
        // [CustomValidateAntiForgeryToken]
        public JsonResult VesselCutOffprint(Dnd_VesselCutOffRpt ObjStuff)
        {
            Dnd_ReportRepository ObjER = new Dnd_ReportRepository();
            Dnd_VesselCutOffRpt ObjStuffing = new Dnd_VesselCutOffRpt();
            ObjER.VesselCutOffPrint(ObjStuff);
            if (ObjER.DBResponse.Data != null)
            {
                ObjStuffing = (Dnd_VesselCutOffRpt)ObjER.DBResponse.Data;
                string Path = GeneratePdfForVesselCutOff(ObjStuffing, ObjStuff.AsOnDate);
                return Json(new { Status = 1, Message = Path });
            }
            else
            {
                return Json(new { Status = 0, Message = "No Data Found" });
            }

        }
        [NonAction]
        public string GeneratePdfForVesselCutOff(Dnd_VesselCutOffRpt ObjVessel, string AsOnDate)
        {
            try
            {
                CompanyDetailsForReport objCompanyDetails = new CompanyDetailsForReport();
                Dnd_ReportRepository ObjRR = new Dnd_ReportRepository();
                ObjRR.getCompanyDetails();
                objCompanyDetails = (CompanyDetailsForReport)ObjRR.DBResponse.Data;
                var FileName = "VesselCutOffReport.pdf";
                string Port = "";
                ObjVessel.LstVessel.Select(x => new { Port = x.PortName }).Distinct().ToList().ForEach(item =>
                {
                    if (Port == "")
                        Port = item.Port;
                    else
                        Port += "," + item.Port;
                });
                StringBuilder Pages = new StringBuilder();
                string LocalDirectory = Server.MapPath("~/Docs/") + Session.SessionID + "/Report";

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 5px;'><thead>");
                Pages.Append("<tr><td colspan='12'>");
                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; font-family: Arial, Helvetica, sans-serif; margin: 0;'><tbody>");
                Pages.Append("<tr><td valign='top'><img align='right' src='IMGSRC' width='90'/></td>");
                Pages.Append("<td width='200%' valign='top' align='center'><h1 style='font-size: 22px; margin: 0; padding: 0;'>CENTRAL WAREHOUSING CORPORATION</h1><label style='font-size: 8pt;'>(A Govt. of India Undertaking)</label><br/><span style='font-size:7pt;'>" + objCompanyDetails.CompanyAddress + "</span><br/><span style='font-size:8pt;'>Vessel Plan Report</span><br/><span style='font-size:8pt;'><b>As on Date: </b> " + AsOnDate + " </span></td></tr>");
                Pages.Append("</tbody></table>");
                Pages.Append("</td></tr>");

                Pages.Append("<tr><th colspan='12' style='font-size: 7pt;'>Port : " + Port + "</th></tr>");
                Pages.Append("</thead></table>");

                Pages.Append("<table cellspacing='0' cellpadding='5' style='width:100%; border-collapse:collapse; border:1px solid #000; border-bottom:0; font-size:7pt;'>");
                Pages.Append("<thead><tr><th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>S.No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Via No</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:10%;'>Vessel Name</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:15%;'>Cut Off Date and Time</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;border-right:1px solid #000;width:5%;'>Open Date</th>");
                Pages.Append("<th style='border-bottom:1px solid #000;width:10%;'>Departure Date</th></tr></thead>");
                Pages.Append("<tbody>");
                int i = 1;
                ObjVessel.LstVessel.ForEach(item =>
                {
                    Pages.Append("<tr>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + i + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.ViaNo + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.VesselName + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.CutOffDate + " " + item.CutOffTime + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;border-right:1px solid #000;'>" + item.OpenDate + "</td>");
                    Pages.Append("<td style='border-bottom:1px solid #000;'>" + item.DepartureDate + "</td>");
                    Pages.Append("</tr>");



                    i++;
                });

                Pages.Append("<tr>");
                Pages.Append("<th style='border-bottom:1px solid #000; border-right:1px solid #000; width:10%; font-size:7pt;'>Total</th>");
                Pages.Append("<th colspan='5' style='border-bottom:1px solid #000; font-size:7pt;'>" + ObjVessel.LstVessel.Count() + "</th>");
                Pages.Append("</tr>");
                Pages.Append("</tbody></table>");




                Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));

                if (!Directory.Exists(LocalDirectory))
                {
                    Directory.CreateDirectory(LocalDirectory);
                }
                if (System.IO.File.Exists(LocalDirectory + "/" + FileName))
                {
                    System.IO.File.Delete(LocalDirectory + "/" + FileName);
                }
                //Pages.Replace("IMGSRC", Server.MapPath("~/Content/Images/CWCPDF.PNG"));
                //Pages.Replace("ISO", Server.MapPath("~/Content/Images/iso_logo.jpg"));
                using (var ObjPdf = new ReportingHelper(PdfPageSize.A4, 30f, 30f, 30f, 30f, false, true))
                {
                    ObjPdf.HeadOffice = this.HeadOffice;
                    ObjPdf.HOAddress = this.HOAddress;
                    ObjPdf.ZonalOffice = this.ZonalOffice;
                    ObjPdf.ZOAddress = this.ZOAddress;
                    ObjPdf.GeneratePDF(LocalDirectory + "/" + FileName, Pages.ToString());
                }
                return "/Docs/" + Session.SessionID + "/Report/" + FileName;
            }
            catch
            {
                return "";
            }
        }

        #endregion

    }

}
