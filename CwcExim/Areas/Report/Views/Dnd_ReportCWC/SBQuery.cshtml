@model CwcExim.Areas.Report.Models.DND_SBQuery

<style>
    .Table_center{
        text-align:center;
    }
</style>

@{

    AjaxOptions options = new AjaxOptions();
    options.HttpMethod = "POST";
    options.OnFailure = "PVFailure";
    options.OnSuccess = "CargoSuccess";
    options.InsertionMode = InsertionMode.InsertAfter;

}
@using (Ajax.BeginForm("GetDailyInvoiceReport", "Dnd_ReportCWC", options))
{
 @Html.AntiForgeryToken()

   @Html.HiddenFor(m => m.Id)
<div class="container-fluid">
    <div class="row">
        <div class="col-md-11 col-md-offset-0-5">
            <div class="Head_h4">
                <div class="row">
                    <div class="col-md-12">
                        <h4>SB Query</h4>
                    </div>
                </div>

                <div class="row Form_Space_top">
                    <div class="form-group Form_Input">
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>SB No:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="SBNo" id="Shipbill" />
                            <span class="search" id="SrchSBNo"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#SBNoModal"></i></span>
                        </div>
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>Shipping Bill Date:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="ShipBillDate" id="ShipBillDate" readonly="readonly" />
                        </div>
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>Shipping Line:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="ShippingLin" id="ShippingLine" readonly="readonly" />
                        </div>
                    </div>
                </div>

                <div class="row Form_Space_top">
                    <div class="form-group Form_Input">
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>Entry No:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="CFSCode" id="CFSCode" readonly="readonly" />
                        </div>
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>In Date:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="EntryDateTime" id="EntryDateTime" readonly="readonly" />
                        </div>
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>CHA:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="CHA" id="CHA" readonly="readonly" />
                        </div>
                    </div>
                </div>

                <div class="row Form_Space_top">
                    <div class="form-group Form_Input">
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>Port of Loading:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="PortOfLoading" id="PortOfLoading" readonly="readonly" />
                        </div>
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>Port of Discharge:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="PortOfDischarge" id="PortOfDischarge" readonly="readonly" />
                        </div>
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>Godown:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="Godown" id="Godown" readonly="readonly" />
                        </div>
                    </div>
                </div>

                <div class="row Form_Space_top">
                    <div class="form-group Form_Input">
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>Package:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="Package" id="Package" readonly="readonly" />
                        </div>
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>Weight:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" id="Weight" readonly="readonly" />
                        </div>
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>FOB:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" id="FOB" readonly="readonly" />
                        </div>
                    </div>
                </div>

                @*<div class="row Form_Space_top">
                    <div class="form-group Form_Input">
                        <div class="col-md-offset-1-5 col-md-1 col_cus_2">
                            <input checked="checked" id="HAZ" name="Type" type="radio" value="HAZ"  >
                            <label for="HAZ"><i class="circle"></i><span>HAZ</span></label>
                        </div>
                        <div class="col-md-2-5">
                            <input id="NON-HAZ" name="Type" type="radio" value="NON-HAZ">
                            <label for="NON-HAZ"><i class="circle"></i><span>NON-HAZ</span></label>
                        </div>
                    </div>
                </div>*@

                <div class="row Form_Space_top">
                    <div class="form-group Form_Input">
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>Commodity:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="Commodit" readonly="readonly" id="Commodity" />
                        </div>
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>CargoType:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="CargoType" readonly="readonly" id="CargoType" />
                        </div>
                        <div class="col-md-1-5 col_cus_2 padding_rt">
                            <label>BAL:</label>
                        </div>
                        <div class="col-md-2-5 col_cus_4">
                            <input type="text" name="BAL" readonly="readonly" id="BAL" />
                        </div>
                    </div>
                </div>

                <div class="row SignUp_space_bottom"></div>

                <div class="Head_h5">
                    <div class="row">
                        <div class="col-md-12">
                            <h5>Carting Details</h5>
                        </div>
                    </div>
                    <div class="row Form_Space_top">
                        <div class="col-md-12">
                            <table id="carting_deatils" class="table table-striped table-bordered dataTable Table_center">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Godown</th>
                                        <th>Location</th>
                                        <th>No of Pkg</th>
                                    </tr>
                                </thead>
                                <tbody id="cartingdeatilstbody">
                                    @*<tr>
                                        <td>Dynamic</td>
                                        <td>Dynamic</td>
                                        <td>Dynamic</td>
                                        <td>Dynamic</td>
                                    </tr>*@
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="Head_h5">
                    <div class="row">
                        <div class="col-md-12">
                            <h5>Delivery Details</h5>
                        </div>
                    </div>
                    <div class="row Form_Space_top">
                        <div class="col-md-12">
                            <table id="carting_deatils" class="table table-striped table-bordered dataTable Table_center">
                                <thead>
                                    <tr>
                                        <th>Invoice No</th>
                                        <th>Invoice Date</th>
                                        <th>Exporter</th>
                                        <th>CHA</th>
                                        <th>No of Pkg</th>
                                    </tr>
                                </thead>
                                <tbody id="Deliverydeatilstbody">
                                    @*<tr>
                                        <td>Dynamic</td>
                                        <td>Dynamic</td>
                                        <td>Dynamic</td>
                                        <td>Dynamic</td>
                                        <td>Dynamic</td>
                                    </tr>*@
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="Head_h5">
                    <div class="row">
                        <div class="col-md-12">
                            <h5>Back To Town</h5>
                        </div>
                    </div>
                    <div class="row Form_Space_top">
                        <div class="col-md-12">
                            <table id="carting_deatils" class="table table-striped table-bordered dataTable Table_center">
                                <thead>
                                    <tr>
                                        <th>Invoice No</th>
                                        <th>Invoice Date</th>
                                        <th>No of Pkg</th>
                                    </tr>
                                </thead>
                                <tbody >
                                    @*<tr>
                                        <td>Dynamic</td>
                                        <td>Dynamic</td>
                                        <td>Dynamic</td>
                                    </tr>*@
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
}

@Scripts.Render("~/bundles/jqueryval")

@* SB No Modal *@
<div class="modal fade" id="SBNoModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">Choose SB No</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="box" type="text" />
                @if (ViewBag.ListOfSB != null)
                {
                    <ul class="navList" id="lstSb">
                        @foreach (var item in ViewBag.ListOfSB)
                        {
                            <li id="@item.Value">@item.Text</li>
                        }
                    </ul>
                }
                else
                {
                    <ul class="navList" id="lstParty">
                        <li></li>
                    </ul>
                }
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@Scripts.Render("~/bundles/jqueryval")
<script>

    $('#box').keyup(function () {
        debugger;
        var valThis = $(this).val().toLowerCase();
        if (valThis == "") {
            $('#lstSb > li').show();
        } else {
            $('#lstSb > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(valThis) >= 0) ? $(this).show() : $(this).hide();
            });
        };
    });

  $('#lstSb li').on("click", function () {
      debugger;

      var sbno =$(this).text();
      $('#Shipbill').val($(this).text());
        $('#id').val($(this).attr('id'));
        $("#SBNoModal").modal("hide");
        GetRegisterDetails($(this).attr('id'), sbno);
    });
  function GetRegisterDetails(Id, sbno) {
        debugger;
        $.ajax({
            url: '/Report/Dnd_ReportCWC/GetApplicationDetForSBQuery',
            type: 'GET',
            data: { Id: Id, sbno: sbno },
            dataType: 'JSON',
            success: function (data) {
                debugger;
                
                if (data != null) {
                    debugger;
                    $('#Shipbill').val(data.SBNO);
                    $('#ShipBillDate').val(data.ShippingBillDate);
                    $('#ShippingLine').val(data.ShippingLine);
                    $('#CFSCode').val(data.CFSCode);
                    $('#EntryDateTime').val(data.EntryDateTime);
                    $('#CHA').val(data.CHA);                    
                    $('#PortOfLoading').val(data.PortOFLoad);
                    $('#PortOfDischarge').val(data.PortOFDischarge);
                    $('#Godown').val(data.Godown);
                    $('#Package').val(data.Package);
                    $('#Weight').val(data.Weight);
                    $('#FOB').val(data.FOB);
                    $('#Commodity').val(data.Comodity);                   
                    $('#CargoType').val(data.Cargotype);
                                       
                    $('#cartingdeatilstbody').html('');
                    $('#Deliverydeatilstbody').html('');
                }
                if(data.CartingSBQList.length >0)
                {
                    debugger;
                    var html = '';
                    var k = 1;
                    $.each(data.CartingSBQList, function (i, item) {
                        html += "<tr><td>" + item.Date + "</td><td>" + item.Godown + "</td><td>" + item.Location + "</td><td>" + item.NOOfPackages +  "</td><tr>";
                        k++;
                    });
                    $('#cartingdeatilstbody').html(html);
                }
                if(data.DeliverySBQList.length >0)
                {
                    debugger;
                    
                    var html = '';
                    var k = 1;
                    $.each(data.DeliverySBQList, function (i, item) {
                        html += "<tr><td>" + item.InvoiceNO + "</td><td>" + item.Date + "</td><td>" + item.Exporter + "</td><td>" + item.CHA + "</td><td>" + item.NOOfPackages + "</td><tr>";
                        //k++;
                    });
                    $('#Deliverydeatilstbody').html(html);

                }
            
                //ArrayOfCartingRegDtl = data.lstRegisterDtl;
              //  GenerateCartingRegTable();
                //LocationDetails = data.lstGdnWiseLctn;
                //LocationDet();
             
                
            }
        
        });
    }
    </script>