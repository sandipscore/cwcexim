@model CwcExim.Areas.Import.Models.WFLDDestuffingEntry
<style>
    #tbleCha.dataTable tbody > tr > td {
        cursor: pointer;
    }

    #tbleCommodity.dataTable tbody > tr > td {
        cursor: pointer;
    }

    .slimScrollDiv {
        height: 300px;
    }

    .table.tblhd {
        border-bottom: 0;
    }
</style>
@{

    AjaxOptions options = new AjaxOptions();
    options.Confirm = "Are You Sure You Want To Save?";
    options.OnSuccess = "DestuffingEntryOnSuccess";
    options.OnFailure = "DestuffingEntryOnFailure";
    options.InsertionMode = InsertionMode.InsertAfter;
}

<style>
    table.table-bordered.dataTable th:last-child, table.table-bordered.dataTable th:last-child, table.table-bordered.dataTable td:last-child, table.table-bordered.dataTable td:last-child {
        border-right-width: 1px;
    }
</style>
<style>
    #tbleSline.dataTable tbody > tr > td {
        cursor: pointer;
    }
</style>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-offset-0-5 col-md-11">
            <div class="Head_h4">
                @using (Ajax.BeginForm("AddEditDestuffingEntry", "VLDA_CWCImport", options))
                {
                    @Html.AntiForgeryToken()
                    @Html.HiddenFor(m => m.DestuffingEntryXML)
                    @Html.HiddenFor(m => m.DestuffingEntryId)
                    @Html.HiddenFor(m => m.TallySheetId)
                    @Html.HiddenFor(m => m.ContainerId)
                    @Html.Hidden("TallySheetDtlId")
                    @Html.HiddenFor(m => m.Size)
                    @Html.HiddenFor(m => m.CFSCode)
                    @Html.HiddenFor(m => m.GodownId)
                    @Html.Hidden("OBLNo")
                    //   @Html.HiddenFor(m => m.Id)
                    @Html.Hidden("TallySheetArea")
                    @Html.Hidden("GdTransId")
                    @Html.Hidden("StockDetailsId")
                    {
                        if (ViewBag.RightsList != null)
                        {
                            <input type="hidden" id="hdnRights" value="@ViewBag.RightsList" />
                        }
                        else
                        {
                            <input type="hidden" id="hdnRights" value="" />
                        }
                        if (ViewBag.GodownList != null)
                        {
                            <input type="hidden" id="ViewGodownList" name="GodownList" value=@ViewBag.GodownList.ToString() />
                        }
                        else
                        {
                            <input type="hidden" id="ViewGodownList" name="GodownList" value="" />
                        }
                        @*if (ViewBag.OBLList != null)
                            {
                                <input type="hidden" id="ViewOBLList" name="OBLList" value=@ViewBag.OBLList.ToString() />
                            }
                            else
                            {
                                <input type="hidden" id="ViewOBLList" name="OBLList" value="" />
                            }*@
                    }
                    <div id="DivAddDestuffingEntry">
                        <div class="row">
                            <div class="col-md-12">
                                <h4>Destuffing</h4>
                            </div>
                        </div>
                        <div class="row Form_Space_top">
                            <div class="form-group Form_Input">
                                <div class="col-md-1-5 col_cus_2">
                                    <label>Container / CBT No:</label>
                                </div>
                                <div class="col-md-2-5">
                                    @Html.TextBoxFor(m => m.ContainerNo, "", new { @class = "form-control input-sm", @readonly = true ,@tabindex=1, @onkeydown = "PopupActivate('ContainerModal');" })
                                    <span class="search"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#ContainerModal"></i></span>
                                    @Html.ValidationMessageFor(m => m.ContainerNo, "", new { @class = "Error_Msg" })
                                </div>
                                <div class="col-md-1-5 col_cus_2 col_cus_offset_3 col-md-offset-4">
                                    <label>Start Date:</label>
                                </div>
                                <div class="col-md-2-5 col_cus_2_5 Date_Img">
                                    @Html.TextBoxFor(m => m.StartDate, new { @class = "form-control input-sm",  @tabindex = 2, @onkeyup = "checks()", @onblur = "checkdates()" })
                                    @Html.ValidationMessageFor(m => m.StartDate, "", new { @class = "Error_Msg" })
                                </div>
                            </div>
                        </div>
                        <div class="row Form_Space_top">
                            <div class="form-group Form_Input">
                                <div class="col-md-1-5 col_cus_2">
                                    <label>Destuffing No:</label>
                                </div>
                                <div class="col-md-2-5">
                                    @Html.TextBoxFor(m => m.DestuffingEntryNo, new { @class = "form-control input-sm", @readonly = true, @tabindex = 3 })
                                </div>
                                <div class="col-md-1-5 col_cus_2 col_cus_offset_3 col-md-offset-4">
                                    <label>Destuffing Date:</label>
                                </div>
                                <div class="col-md-2-5 col_cus_2_5 Date_Img">
                                    @Html.TextBoxFor(m => m.DestuffingEntryDate, new { @class = "form-control input-sm", @readonly = true, @tabindex = 4 })
                                    @Html.ValidationMessageFor(m => m.DestuffingEntryDate, "", new { @class = "Error_Msg" })
                                </div>
                            </div>
                        </div>
                        @*<div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>Shipping Line:</label>
                                    </div>
                                    <div class="col-md-10-5 col_cus_10">
                                        @Html.TextBoxFor(m => m.ShippingLine, "", new { @class = "form-control input-sm", @readonly = true })
                                        <span class="search"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#ShippingLineModal"></i></span>
                                        @Html.HiddenFor(m => m.ShippingLineId)
                                        @Html.ValidationMessageFor(m => m.ShippingLine, "", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>*@
                        <div class="row Form_Space_top">
                            <div class="form-group Form_Input">
                                <div class="col-md-1-5 col_cus_2">
                                    <label>CHA:</label>
                                </div>
                                <div class="col-md-10-5 col_cus_10">
                                    @Html.TextBoxFor(m => m.CHA, "", new { @class = "form-control input-sm", @readonly = true,@tabindex = 5 , @onkeydown = "PopupActivate('CHAModal');" })
                                    <span class="search"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#CHAModal"></i></span>
                                    @Html.HiddenFor(m => m.CHAId)
                                    @Html.ValidationMessageFor(m => m.CHA, "", new { @class = "Error_Msg" })
                                </div>
                            </div>
                        </div>
                        <div class="row Form_Space_top">
                            <div class="form-group Form_Input">
                                <div class="col-md-1-5 col_cus_2">
                                    <label>Rotation:</label>
                                </div>
                                <div class="col-md-4">
                                    @Html.TextBoxFor(m => m.Rotation, "", new { @class = "form-control input-sm", @tabindex = 6})
                                    @Html.ValidationMessageFor(m => m.Rotation, "", new { @class = "Error_Msg" })
                                </div>
                                <div class="col-md-1-5 col_cus_2 col_cus_offset_3 col-md-offset-2-5">
                                    <label>Customs Seal No:</label>
                                </div>
                                <div class="col-md-2-5 col_cus_2_5 Date_Img">
                                    @Html.TextBoxFor(m => m.CustomSealNo, new { @class = "form-control input-sm", @maxlength = 50, @tabindex = 7 })
                                </div>
                            </div>
                        </div>
                        <div class="row Form_Space_top">
                            <div class="form-group Form_Input">
                                @*<div class="col-md-3">
                                        <div class="boolean-container">
                                            @Html.RadioButtonFor(m => m.DeliveryType, "1", new { @id = "Container", @checked = true })
                                            <label for="Container"><i class="circle"></i>Container Delivery</label>
                                        </div>
                                    </div>*@

                                <div class="col-md-3">
                                    <div class="boolean-container">
                                        @Html.RadioButtonFor(m => m.DeliveryType, "2", new { @id = "Cargo", @checked = true })
                                        <label for="Cargo"><i class="circle"></i>Cargo Delivery</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="DivDestuffingEntryDet" class="Head_h5">
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>OBL/HBL No:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @*@Html.TextBox("BOLNo", "", new { @class = "form-control input-sm", @readonly = true })*@
                                        @Html.TextBoxFor(m => m.BOLNo, "", new { @class = "form-control input-sm", @readonly = true, @tabindex = 8 , @onkeydown = "PopupActivate('OBLModal');" })
                                        <span class="search"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#OBLModal"></i></span>

                                        @Html.ValidationMessage("BOLNo", new { @class = "Error_Msg" })
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4 col_cus_2 col_cus_offset_3">
                                        <label>OBL/HBL Date:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("BOLDate", "", new { @class = "form-control input-sm", @readonly = true, @tabindex = 9 })
                                        @Html.ValidationMessage("BOLDate", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>Line No:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("LineNo", "", new { @class = "form-control input-sm", @readonly = true, @tabindex = 10})
                                        @Html.ValidationMessage("LineNo", new { @class = "Error_Msg" })
                                    </div>
                                    <div class="col-md-offset-2-5 col-md-1-5 col_cus_2">
                                        <label>Commodity:</label>
                                    </div>
                                    <div class="col-md-4">
                                        @Html.TextBox("Commodity", "", new { @class = "form-control input-sm", @readonly = true, @tabindex = 11 })
                                        <span class="search"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#CommodityModal"></i></span>
                                        <input type="hidden" id="CommodityId" />
                                        @Html.ValidationMessage("Commodity", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>Cargo Description:</label>
                                    </div>
                                    <div class="col-md-10-5">
                                        @Html.TextArea("CargoDescription", "", new { @class = "form-control input-sm", @disabled = true, @tabindex = 12 })
                                        @Html.ValidationMessage("CargoDescription", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>

                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>Shipping Line:</label>
                                    </div>
                                    <div class="col-md-10-5">
                                        @Html.Hidden("ImporterId")
                                        @Html.Hidden("IsReserved")
                                        @Html.Hidden("ShippingLineId")
                                        @Html.TextBox("ShippingLineName", "", new { @class = "form-control input-sm", @disabled = true , @tabindex = 13 })
                                        @Html.ValidationMessage("ShippingLineName", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">


                                    <div class="col-md-1-5 ">Cargo Type<span class="LabelColon">:</span></div>
                                    <div class="col-md-2-5">
                                        @Html.DropDownList("CargoType", new List<SelectListItem>
                                {
                                new SelectListItem { Text="Haz",Value="1"},
                                new SelectListItem { Text="Non-Haz",Value="2"},
                                 new SelectListItem {Text="ODC",Value="3" }
                                }, "----Select----", new { @class = "form-control input-sm" , @disabled = true, @tabindex = 14 })
                                    </div>

                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2 padding_rt">
                                        <label>No of Packages:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("NoOfPackages", "", new { @class = "form-control input-sm", @readonly = true, @tabindex = 15 })
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4 col_cus_2 col_cus_offset_3">
                                        <label>Gross Weight (Kg):</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("GrossWeight", "", new { @class = "form-control input-sm", @readonly = true, @tabindex = 16 })
                                        @Html.ValidationMessage("GrossWeight", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 ">
                                        <label>Remaining Packages:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("RemPackages", "", new { @class = "form-control input-sm", @readonly = true, @tabindex = 17 })
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>Remaining WT(Kg):</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("RemWeight", "", new { @class = "form-control input-sm", @readonly = true, @tabindex = 18})
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>BOE No:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("BOENo", "", new { @class = "form-control input-sm", @onblur = "GetCIFDuty()", @tabindex = 19 })
                                        @*@Html.ValidationMessage("BOENo", "", new { @class = "Error_Msg" })*@
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>BOE Date:</label>
                                    </div>
                                    <div class="col-md-2-5 Date_Img">
                                        @Html.TextBox("BOEDate", "", new { @class = "form-control input-sm",  @tabindex = 20, @onkeyup = "checksBOE()", @onblur = "checkdatesBOE()" })
                                        @*@Html.ValidationMessage("BOEDate", "", new { @class = "Error_Msg" })*@
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">

                                    <div class="col-md-1-5 col_cus_2">
                                        <label>OBL Wise Destuffing Date:</label>
                                    </div>

                                    <div class="col-md-2-5 Date_Img">
                                        @Html.TextBox("OBLWiseDestuffingDate", "", new { @class = "form-control input-sm",  @tabindex = 21, @readonly = true })
                                        @Html.ValidationMessage("OBLWiseDestuffingDate", "", new { @class = "Error_Msg" })
                                    </div>
                                    <div id="divsqm" style="display:none">
                                        <div class="col-md-1-5 col_cus_2 padding_rt">
                                            <label>UOM:</label>
                                        </div>
                                        <div class="col-md-2-5 col_cus_10">
                                            @Html.DropDownList("UOM", new List<SelectListItem> { new SelectListItem { Text = "SQM", Value = "SQM" } })
                                            @*@Html.TextBox("UOM", "", new { @class = "form -control input-sm", @readonly = true })*@
                                            @Html.ValidationMessage("UOM", new { @class = "Error_Msg" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2 padding_rt">
                                        <label>Remarks:</label>
                                    </div>
                                    <div class="col-md-10-5 col_cus_10">
                                        @Html.TextArea("Remarks", "", new { @style = "width:100%;height:75px", @maxlength = 500, @tabindex = 22})
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                    </div>
                                    <div class="col-md-2-5">
                                        <div class="boolean-container">
                                            @Html.RadioButton("IsHoldRelease", "0", new { @id = "IsHold", @onclick = "IVType('Hold')", @tabindex = 23 })
                                            <label for="IsHold"><i class="circle"></i>  Hold</label>
                                        </div>
                                    </div>
                                    <div class="col-md-2-5">
                                        <div class="boolean-container">
                                            @Html.RadioButton("IsHoldRelease", "1", new { @id = "IsRelease", @checked = true, @onclick = "IVType('Hold')", @tabindex = 24 })
                                            <label for="IsRelease"><i class="circle"></i>  Release</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="stoke SignUp_space_top SignUp_space_bottom"></div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>Godown:</label>
                                    </div>
                                    <div class="col-md-2-5">

                                        @Html.TextBox("GodownName", "", new { @class = "form-control input-sm", @readonly = true , @tabindex = 25 , @onkeydown = "PopupActivate('GodownModal');" })
                                        <span class="search" id="GodownSearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#GodownModal"></i></span>
                                        <input type="hidden" id="GodownId" />
                                        <input type="hidden" id="GodownName" />
                                        @Html.ValidationMessage("GodownName", new { @class = "Error_Msg" })

                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>Location:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("GodownWiseLocationNames", "", new { @class = "form-control input-sm", @readonly = true, @tabindex = 26 })
                                        <span class="search" id="LocationSearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#LocationModal"></i></span>
                                        @Html.Hidden("GodownWiseLocationIds")
                                        @Html.ValidationMessage("GodownWiseLocationNames", "", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>


                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5">
                                        <label>Receive Packages:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("ReceivedPackages", "", new { @class = "form-control input-sm", @onblur = "calcbm();", @tabindex = 27 })
                                        @Html.ValidationMessage("ReceivedPackages", new { @class = "Error_Msg" })
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>Un Reserved Weight(Kg):</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("DestuffingWeight", "", new { @class = "form -control input-sm", @tabindex = 28 })
                                        @Html.ValidationMessage("DestuffingWeight", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>

                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>UnReserved Area (SQM):</label>
                                    </div>
                                    <div class="col-md-2-5 col_cus_2">
                                        @Html.TextBox("Area", "", new { @class = "form-control input-sm", @tabindex = 29 })
                                        @Html.ValidationMessage("Area", "", new { @class = "Error_Msg" })
                                    </div>

                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>CBM:</label>
                                    </div>
                                    <div class="col-md-2-5 col_cus_3">
                                        @Html.TextBox("AreaCbm", "", new { @class = "form-control input-sm",@tabindex = 30 })
                                        @Html.ValidationMessage("AreaCbm", "", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>

                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>CIF Value:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("CIFValue", "", new { @class = "form -control input-sm" , @tabindex = 31 })
                                        @Html.ValidationMessage("CIFValue", "", new { @class = "Error_Msg" })
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>Gross Duty:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("GrossDuty", "", new { @class = "form-control input-sm", @tabindex = 32 })
                                        @Html.ValidationMessage("GrossDuty", "", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>Reserved Area (SQM):</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("RevArea", "0", new { @class = "form -control input-sm" ,@tabindex = 33 })
                                        @Html.ValidationMessage("RevArea", "", new { @class = "Error_Msg" })
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>Reserved Weight(Kg):</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("ReservedWeight", "0", new { @class = "form -control input-sm", @tabindex = 34 })
                                        @Html.ValidationMessage("ReservedWeight", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="stoke SignUp_space_top SignUp_space_bottom"></div>
                            </div>
                            <div class="row">
                                <div class="col-md-offset-4 col-md-2">
                                    <input type="button" id="BtnAddDestuffingEntry" class="btn log_Btn_sm" value="Add" onclick="SaveDestuffingEntryDtl()" disabled tabindex = 35  />
                                </div>
                                <div class="col-md-2">
                                    <input type="button" class="btn log_Btn_sm" value="Reset" id="btnReset" onclick="ResetGodownDet()" tabindex = 36  />
                                </div>
                            </div>
                            <div id="DivDestuffingEntryTblMsg" class="logErrMsg Form_Space_top Form_Space_bottom" style="background-color:transparent"></div>
                            <table class="table table-striped table-bordered dataTable slim_tble" id="TblDestuffingEntryDet" style="width:100%;">
                                <thead>
                                    <tr>
                                        <th colspan="2" width="15%" class="text-center">@Html.DisplayName("OBL/HBL")</th>
                                        <th rowspan="2" width="6%" class="text-center">@Html.DisplayName("Line No")</th>
                                        <th rowspan="2" width="15%" class="text-center">@Html.DisplayName("Godown Name")</th>
                                        @*<th rowspan="2" width="10%" class="text-center">Area <br /> ( Generated From TallySheet )</th>*@
                                        <th rowspan="2" width="5%" class="text-center">@Html.DisplayName("Area")</th>
                                        <th rowspan="2" width="5%" class="text-center">@Html.DisplayName("CBM")</th>
                                        <th rowspan="2" width="10%" class="text-center">@Html.DisplayName("Received Packages")</th>
                                        <th rowspan="2" width="10%" class="text-center">@Html.DisplayName("Un Reserved Weight(Kg)")</th>
                                        <th rowspan="2" width="10%" class="text-center">@Html.DisplayName("Reserved Weight(Kg)")</th>

                                           <th rowspan="2" width="5%" class="text-center">@Html.DisplayName("Edit")</th>
                                        <th rowspan="2" width="5%" class="text-center">@Html.DisplayName("View")</th>
                                    </tr>
                                    <tr>
                                        <th width="50px" class="text-center">No.</th>
                                        <th width="50px" class="text-center">Date</th>
                                    </tr>
                                </thead>
                                <tbody align="center"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="row">
                        <div class="stoke SignUp_space_bottom2 SignUp_space_top2"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-offset-4 col-md-2 SignUp_space_bottom">
                            <input type="submit" class="btn log_Btn_sm" value="Save" id="BtnSaveDestuffingEntry" tabindex = 37 />
                        </div>
                        <div class="col-md-2">
                            <input type="button" class="btn log_Btn_sm" value="Reset" onclick="ReloadDestuffingEntryPage()"  tabindex = 38/>
                        </div>
                    </div>
                    <div class="logSuccMsg" style="background-color:transparent" id="DivDestuffingEntryMsg"></div>
                    <div class="logErrMsg Form_Space_bottom" style="background-color:transparent" id="DivDestuffingEntryErrMsg"></div>
                }
                @Scripts.Render("~/bundles/jqueryval")

            </div>

            <div class="row Form_Space_top Form_Space_bottom">
                <div class="form-group Form_Input">
                    <div class="col-md-2">
                        <input type="button" id="BtnCommodityLoad" value="Show List" class="btn log_Btn_sm" onclick="GetDestuffingEntryList()" style="margin-left:0;" />
                    </div>
                    <div class="col-md-offset-7 col-md-3">
                        @Html.TextBox("ContainerNoSearch", "", new { placeholder = "Search By Container / CBT / OBL" })
                        <span class="search"><i class="fa fa-search" aria-hidden="true" onclick="SearchByContainerNo()"></i></span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div id="tblEntryDet"></div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div id="DivDestuffingEntryList"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript" src="/scripts/jquery.nicescroll.min.js"></script>
<script type="text/javascript">

    $('#ContainerNo').focus();
    $(function () {
        $('#slim_scroll').slimScroll({
            allowPageScroll: true
        });
    });

    $(function () {
        $('#slim_scroll_1').slimScroll({
            allowPageScroll: true
        });
    });

    $(function () {
        $('#slim_scroll_2').slimScroll({
            allowPageScroll: true
        });
    });
</script>



<div class="modal fade" id="LocationModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Godown Wise Location</h4>
            </div>
            <div class="modal-body popup_body">
                <div class="form-group Form_Input" id="DivLocationDet"></div>
                <div class="clearfix"></div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="CommodityModal" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content popup_modal" style="width:80%;">
            <div class="modal-header popup_header">
                <button type="button" class="close" onclick="CloseCommodity()"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Commodity</h4>
            </div>
            <div class="modal-body popup_body" style="position:relative;">
                <input placeholder="Search By Commodity Name " id="CommodityBox" type="text" />
                <span class="search" style="top: 18px;"><i class="fa fa-search" aria-hidden="true" onclick="SearchCommodityByPartyCode()"></i></span>
                <table class="table table-striped table-bordered dataTable tblhd" style="width:100%; margin:0 !important; border-bottom:0; padding:0;">
                    <thead>
                        <tr>
                            <th>Commodity Name</th>
                        </tr>
                    </thead>
                </table>
                <div id="slim_scroll_2">
                    <table class="table dataTable table-bordered table-striped slim_tble" id="tbleCommodity">
                        @{
                            if (ViewBag.LstCommodity != null)
                            {
                                foreach (var item in ViewBag.LstCommodity)
                                {
                                    <tr onclick="SelectCommodity(@item.CommodityId,'@item.CommodityName')">
                                        <td class="txt_wrp">@item.CommodityName</td>
                                        @*<td colspan="4" width="40%">@item.PartyCode</td>*@
                                    </tr>
                                }
                            }
                        }
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-5">
                        @if (ViewBag.CommodityState != null && Convert.ToBoolean(ViewBag.CommodityState) == true)
                        {
                            <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreCommodity()" class="btn log_Btn_sm" id="btnLoadMoreCommodity">Load More Data</button>
                        }
                        else
                        {
                            <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreCommodity()" class="btn log_Btn_sm" id="btnLoadMoreCommodity" disabled>Load More Data</button>
                        }
                    </div>
                    <div class="col-md-offset-3 col-md-4">
                        <button type="button" class="btn log_Btn_sm" onclick="CloseCommodity()">Close</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<div class="modal fade" id="GodownModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Godown</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="Godownbox" type="text" tabindex="400" />
                <ul tabindex="401" class="navList" id="lstGodown">
                    @if (ViewBag.GodownList != null)
                    {
                        var TabValue = 402;
                        foreach (var item in ViewBag.GodownList)
                        {
                            <li tabindex='@TabValue' id="@item.GodownId">@item.GodownName</li>
                            TabValue++;
                        }
                    }
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="ContainerModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Container / CBT No</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="ContainerBox" type="text" tabindex="100" />
                <ul tabindex="101" class="navList" id="ContainerList">
                    @{
                        if (ViewBag.ContainerList != null)
                        {
                            var TabValue = 102;
                            foreach (var item in ViewBag.ContainerList)
                            {
                                <li tabindex="@TabValue" id="@item.TallySheetId">@item.ContainerNo</li>
                                TabValue++;
                            }
                        }
                    }
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="ShippingLineModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" onclick="CloseEximTrade()"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Shipping Line Name</h4>
            </div>
            <div class="modal-body popup_body" style="position:relative;">
                <input placeholder="Search By Shipping Line Name Or Party Code" id="ShpngLinebox" type="text" />
                <span class="search" style="top: 18px;"><i class="fa fa-search" aria-hidden="true" onclick="SearchByPartyCode()"></i></span>
                <table class="table table-striped table-bordered dataTable tblhd" style="width:100%; margin:0 !important; border-bottom:0; padding:0;">
                    <thead>
                        <tr>
                            <th colspan="8" width="80%">Shipping Line Name</th>
                            <th colspan="4" width="20%">Party Code</th>
                        </tr>
                    </thead>
                </table>
                <div id="slim_scroll">
                    <table class="table dataTable table-bordered table-striped slim_tble" id="tbleSline">
                        <tbody>
                            @{
                                if (ViewBag.lstShippingLine != null)
                                {
                                    foreach (var item in ViewBag.lstShippingLine)
                                    {
                                        <tr onclick="SelectShippingLine(@item.ShippingLineId,'@item.ShippingLineName')">
                                            <td colspan="8" width="80%" class="txt_wrp">@item.ShippingLineName</td>
                                            <td colspan="4" width="20%" class="txt_wrp">@item.PartyCode</td>
                                        </tr>
                                    }
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-6">
                        @if (ViewBag.State != null && Convert.ToBoolean(ViewBag.State) == true)
                        {
                            <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreEximTrader()" class="btn log_Btn_sm" id="btnLoadMore">Load More Data</button>
                        }
                        else
                        {
                            <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreEximTrader()" class="btn log_Btn_sm" id="btnLoadMore" disabled>Load More Data</button>
                        }
                    </div>
                    <div class="col-md-6">
                        <button type="button" class="btn log_Btn_sm" onclick="CloseEximTrade()">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="CHAModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" onclick="CloseCHA()"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of CHA Name</h4>
            </div>
            <div class="modal-body popup_body" style="position:relative;">
                <input placeholder="Search By CHA Name Or Party Code" id="Chabox" type="text" tabindex="200" />
                <span class="search" style="top: 18px;"><i class="fa fa-search" aria-hidden="true" onclick="SearchChaByPartyCode()"></i></span>
                <table class="table table-striped table-bordered dataTable tblhd" style="width:100%; margin:0 !important; border-bottom:0; padding:0;">
                    <thead>
                        <tr>
                            <th colspan="8" width="80%">CHA Name</th>
                            <th colspan="4" width="20%">Party Code</th>
                        </tr>
                    </thead>
                </table>
                <div id="slim_scroll_1">
                    <table tabindex="201" class="table dataTable table-bordered table-striped slim_tble" id="tbleCha">
                        @{
                                    if (ViewBag.lstCHA != null)
                                    {
                                        var tabvalue = 202;
                                        foreach (var item in ViewBag.lstCHA)
                                        {
                                    <tr tabindex="@tabvalue" onclick="SelectCHA(@item.CHAId,'@item.CHAName')" onkeypress="SelectCHA(@item.CHAId,'@item.CHAName')">
                                        <td colspan="8" width="80%" class="txt_wrp">@item.CHAName</td>
                                        <td colspan="4" width="20%" class="txt_wrp">@item.PartyCode</td>
                                    </tr>
                                    tabvalue++;
                                }
                            }
                        }
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-6">
                        @if (ViewBag.CHAState != null && Convert.ToBoolean(ViewBag.CHAState) == true)
                        {
                            <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreCHA()" class="btn log_Btn_sm" id="btnLoadCHA">Load More Data</button>
                        }
                        else
                        {
                            <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreCHA()" class="btn log_Btn_sm" id="btnLoadCHA" disabled>Load More Data</button>
                        }
                    </div>
                    <div class="col-md-6">
                        <button type="button" class="btn log_Btn_sm" onclick="CloseCHA()">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="OBLModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of OBL No</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="OBLBox" type="text" tabindex="300" />
                <ul tabindex="301" class="navList" id="OBLList"></ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    var ArrayLst = [];
    var r2;
    var arrayOblList=[];
    var OBLlistHtml='';
    var compObllist=[];
    $(function () {
        debugger;
        TimeInSeconds = 5000;
        GenerateBlankTable();
        //$('#divsqm').visible=false;
        //GetDestuffingEntryList();
        $('#TblDestuffingEntryDet').hide();
        r2 = JSON.parse($("#hdnRights").val());
        if (r2.CanAdd == 0) {
            $('#BtnSaveDestuffingEntry').prop('disabled', true);
        }
        ///$("#StartDate").datepicker("option", "minDate", '@DateTime.Now.ToString("dd/MM/yy")');
    });
    $('#DestuffingEntryDate').datetimepicker({
        dateFormat: "dd/mm/yy",
        showOn: "button",
        buttonImage: "/Content/images/calendar.png",
        buttonImageOnly: true,
        buttonText: "Select date",
        changeMonth: true,
        changeYear: true,
        showAnima: "fadein",
        onClose: function () {
            $("[data-valmsg-for='DestuffingEntryDate']").html('');
            $('#CHA').focus();
            ValidateReservation();
        }
    });

    $('#StartDate').datepicker({
        dateFormat: "dd/mm/yy",
        showOn: "button",
        buttonImage: "/Content/images/calendar.png",
        buttonImageOnly: true,
        buttonText: "Select date",
        changeMonth: true,
        changeYear: true,
        showAnima: "fadein",
        //minDate:true,
        //maxDate:new Date(@DateTime.Today.Year,((@DateTime.Today.Month)-1),@DateTime.Today.Day),
        onClose: function () {
            $("[data-valmsg-for='StartDate']").html('');
            $('#DestuffingEntryDate').focus();
        }
    });
    $('#BOEDate').datepicker({
        dateFormat: "dd/mm/yy",
        showOn: "button",
        buttonImage: "/Content/images/calendar.png",
        buttonImageOnly: true,
        buttonText: "Select date",
        changeMonth: true,
        changeYear: true,
        showAnima: "fadein",
        onClose: function () {
            $("[data-valmsg-for='DestuffingEntryDate']").html('');
            GetCIFDuty();
        },
        onSelect: function () {
            // The "this" keyword refers to the input (in this case: #someinput)
            $('#OBLWiseDestuffingDate').focus();
        }
    });
    $('#OBLWiseDestuffingDate').datetimepicker({
        dateFormat: "dd/mm/yy",
        timeFormat: "HH:mm",
        showOn: "button",
        buttonImage: "/Content/images/calendar.png",
        buttonImageOnly: true,
        buttonText: "Select date",
        changeMonth: true,
        changeYear: true,
        showAnima: "fadein",
        maxDate: new Date() ,
        onClose: function () {
            $('#Remarks').focus();
        },
        onSelect: function () {
            // The "this" keyword refers to the input (in this case: #someinput)
            $('#Remarks').focus();
        }
    });

    function SelectShippingLine(ShippingLineId, ShippingLineName) {
        debugger;
        $('#ShippingLine').val(ShippingLineName);
        $('#ShippingLineId').val(ShippingLineId);
        $("#ShippingLineModal").modal("hide");
        $('#ShpngLinebox').val('');
        LoadEximTrader();
    }
    var Page = 0;

    function SearchByPartyCode() {
        if ($('#ShpngLinebox').val() != '') {
            $.ajax({
                url: '/Import/VLDA_CWCImport/SearchByPartyCode',
                type: 'GET',
                data: { PartyCode: $('#ShpngLinebox').val() },
                success: function (data) {
                    if (data.Status == 1) {
                        var html = '';
                        $.each(data.Data.lstShippingLine, function (item, elem) {
                            html += '<tr onclick="SelectShippingLine(' + elem.ShippingLineId + ',&quot;' + elem.ShippingLineName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.ShippingLineName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                        });
                        $('#tbleSline tbody').html('');
                        $('#tbleSline tbody').html(html);
                        $('#btnLoadMore').prop('disabled', false);
                        Page = -1;
                    }
                    else {
                        $('#tbleSline tbody').html('');
                        Page = -1;
                        $('#btnLoadMore').prop('disabled', false);
                    }

                }
            });
        }
        else
            LoadEximTrader();
    }


    function LoadMoreEximTrader() {
        debugger;
        $.ajax({
            url: '/Import/VLDA_CWCImport/LoadEximtradeList',
            type: 'GET',
            data: { PartyCode: "", Page: Page + 1 },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    $.each(data.Data.lstShippingLine, function (item, elem) {
                        debugger;
                        html += '<tr onclick="SelectShippingLine(' + elem.ShippingLineId + ',&quot;' + elem.ShippingLineName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.ShippingLineName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                    });
                    if (Page == -1)
                        $('#tbleSline tbody').html(html);
                    else
                        $('#tbleSline tbody').append(html);
                    Page++;

                    if (data.Data.State == true)
                        $('#btnLoadMore').prop('disabled', false);
                    else $('#btnLoadMore').prop('disabled', true);
                }
            }
        });
    }

    function LoadEximTrader() {
        Page = 0;
        $.ajax({
            url: '/Import/VLDA_CWCImport/LoadEximtradeList',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    $.each(data.Data.lstShippingLine, function (item, elem) {
                        debugger;
                        html += '<tr onclick="SelectShippingLine(' + elem.ShippingLineId + ',&quot;' + elem.ShippingLineName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.ShippingLineName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                    });
                    $('#tbleSline tbody').html(html);

                    if (data.Data.State == true)
                        $('#btnLoadMore').prop('disabled', false);
                    else $('#btnLoadMore').prop('disabled', true);
                }
            }
        });
    }

    function CloseEximTrade() {
        $('#ShpngLinebox').val('');
        $("#ShippingLineModal").modal("hide");
        LoadEximTrader();
    }

    function GetLocationByGodown(i) {
        debugger;
        $.ajax({
            url: '/Import/VLDA_CWCImport/GetGodownLocationById',
            type: 'GET',
            dataType: 'JSON',
            data: {GodownId:i },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;

                    var html = "";
                    $.each(data.Data.lstdynamicloc, function (i, elem) {
                        html += '<div style="float:left;"><div class="boolean-container"><input type="checkbox" id="' + elem.LocationId + 'g" name="' + elem.LocationId + '" onclick="SelectLocation()" /><label for="' + elem.LocationId + 'g"><i class="square"></i><span>' + elem.LocationName + '</span></label></div></div>';
                    });
                    $('#DivLocationDet').html(html);
                    $('#BtnAddDestuffingEntry').prop("disabled", false);
                    $('#btnReset').prop("disabled", true);
                }
            }
        });
    }


    $('#Godownbox').keyup(function () {
        var val = $(this).val().toLowerCase();
        if (val == "")
            $('#lstGodown > li').show();
        else {
            $('#lstGodown > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(val) >= 0 ? $(this).show() : $(this).hide());
            });
        }
    });

    $('#GodownSearch').on("click", function () {
        debugger;
        $.ajax({
            url: '@Url.Action("ListOfGodownData", "VLDA_CWCImport", new { Area = "Import" })',
            dataType: 'JSON',
            type: 'GET',
            success: function (data) {
                debugger;
                //$('#ViewContainerList').val(data);
                //ViewBLList = data;
                var html = '';
                var TabValue = 402;
                $.each(data, function (i, item) {
                    html += '<li tabindex=' + TabValue + ' id="' + item.GodownId + '" " onclick="GodownHide(this)" onkeypress="GodownHide(this)">' + item.GodownName + '</li>';
                    TabValue++;
                });
                $('#lstGodown').html(html);
            }
        });

    });
    function GodownHide(elem) {
        $('#GodownName').val($(elem).text());
        $('#GodownId').val($(elem).attr('id'))


        GetLocationByGodown($(elem).attr('id'));



        debugger;

        $("#GodownModal").modal("hide");
    }


    function SelectCommodity(CommodityId, CommodityName) {
        $('#Commodity').val(CommodityName);
        $('#CommodityId').val(CommodityId);
        $('#CommodityModal').modal('hide');
        $('#CommodityBox').val('');
        LoadCommodity();
    }

    function LoadMoreCommodity() {
        debugger;
        $.ajax({
            url: '/Import/VLDA_CWCImport/LoadCommodityList',
            type: 'GET',
            data: { PartyCode: "", Page: Page + 1 },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    $.each(data.Data.LstCommodity, function (item, elem) {
                        debugger;
                        html += '<tr onclick="SelectCommodity(' + elem.CommodityId + ',&quot;' + elem.CommodityName + '&quot;)"><td class="txt_wrp">' + elem.CommodityName + '</td></tr>';
                    });
                    if (Page == -1)
                        $('#tbleCommodity tbody').html(html);
                    else
                        $('#tbleCommodity tbody').append(html);
                    Page++;

                    if (data.Data.State == true)
                        $('#btnLoadMoreCommodity').prop('disabled', false);
                    else $('#btnLoadMoreCommodity').prop('disabled', true);
                }
            }
        });
    }

    function LoadCommodity() {
        Page = 0;
        $.ajax({
            url: '/Import/VLDA_CWCImport/LoadCommodityList',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    $.each(data.Data.LstCommodity, function (item, elem) {
                        debugger;
                        html += '<tr onclick="SelectCommodity(' + elem.CommodityId + ',&quot;' + elem.CommodityName + '&quot;)"><td class="txt_wrp">' + elem.CommodityName + '</td></tr>';
                    });
                    $('#tbleCommodity tbody').html(html);

                    if (data.Data.State == true)
                        $('#btnLoadMoreCommodity').prop('disabled', false);
                    else $('#btnLoadMoreCommodity').prop('disabled', true);
                }
            }
        });
    }

    function SearchCommodityByPartyCode() {
        if ($('#CommodityBox').val() != '') {
            $.ajax({
                url: '/Import/VLDA_CWCImport/SearchCommodityByPartyCode',
                type: 'GET',
                data: { PartyCode: $('#CommodityBox').val() },
                success: function (data) {
                    if (data.Status == 1) {
                        var html = '';
                        $.each(data.Data.LstCommodity, function (item, elem) {
                            html += '<tr onclick="SelectCommodity(' + elem.CommodityId + ',&quot;' + elem.CommodityName + '&quot;)"><td class="txt_wrp">' + elem.CommodityName + '</td></tr>';
                        });
                        $('#tbleCommodity tbody').html('');
                        $('#tbleCommodity tbody').html(html);
                        $('#btnLoadMoreCommodity').prop('disabled', false);
                        Page = -1;
                    }
                    else {
                        $('#tbleCommodity tbody').html('');
                        Page = -1;
                        $('#btnLoadMoreCommodity').prop('disabled', false);
                    }

                }
            });
        }
        else
            LoadCommodity();
    }

    function CloseCommodity() {
        $('#CommodityBox').val('');
        $("#CommodityModal").modal("hide");
        LoadCommodity();
    }

    $('#OBLBox').keyup(function () {
        var valThis = $(this).val().toLowerCase();
        if (valThis == "") {
            $('#OBLModal .navList > li').show();
        } else {
            $('#OBLModal .navList > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(valThis) >= 0) ? $(this).show() : $(this).hide();
            });
        };
    });

    $('#ContainerBox').keyup(function () {
        var valThis = $(this).val().toLowerCase();
        if (valThis == "") {
            $('#ContainerModal .navList > li').show();
        } else {
            $('#ContainerModal .navList > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(valThis) >= 0) ? $(this).show() : $(this).hide();
            });
        };
    });


    $('#ContainerList li').on("click", function () {
        debugger;
        var ContainerNo = ($(this).text().split('(')[1].split('-')[0]);
        $('#Size').val(($(this).text()).split(')')[0].split('-')[1]);
        $('#CFSCode').val(($(this).text()).split('(')[1].split('-')[0]);
        $('#ContainerNo').val($(this).text().split('(')[0]);

        $('#TallySheetId').val($(this).attr('id'));
        $("#ContainerModal").modal("hide");
        $('#DivDestuffingEntryTblMsg').html('');
        ResetDestuffingEntryDet();

        //$('#OBLWiseDestuffingDate').val('@DateTime.Now.ToString("dd/MM/yy")');
        GetContainerDet($(this).attr('id'),$('#CFSCode').val());

    });


    $('#ContainerList li').on("keypress", function () {
        debugger;
        var ContainerNo = ($(this).text().split('(')[1].split('-')[0]);
        $('#Size').val(($(this).text()).split(')')[0].split('-')[1]);
        $('#CFSCode').val(($(this).text()).split('(')[1].split('-')[0]);
        $('#ContainerNo').val($(this).text().split('(')[0]);

        $('#TallySheetId').val($(this).attr('id'));
        $("#ContainerModal").modal("hide");
        $('#DivDestuffingEntryTblMsg').html('');
        ResetDestuffingEntryDet();

        //$('#OBLWiseDestuffingDate').val('@DateTime.Now.ToString("dd/MM/yy")');
        GetContainerDet($(this).attr('id'), $('#CFSCode').val());

    });



    function GetContainerDet(i,CfsCode) {
        debugger;
        $.ajax({
            url: '/Import/VLDA_CWCImport/GetCntrDetForDestuffingEntry',
            type: 'GET',
            dataType: 'JSON',
            data: { TallySheetId: i,CFSCode:CfsCode },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    //  $('#GodownId').val(data.Data.lstdynamic[0].GodownId);
                    $('#ContainerId').val(data.Data.lstdynamic[0].ContainerId);

                    if (data.Data.lstdynamichdr.length > 0) {
                        $('#CHAId').val(data.Data.lstdynamichdr[0].CHAId);
                        $('#CHA').val(data.Data.lstdynamichdr[0].CHAName);
                        $('#Rotation').val(data.Data.lstdynamichdr[0].RotationNo);
                        $('#CustomSealNo').val(data.Data.lstdynamichdr[0].CustomSealNo);
                    }
                    //ArrayLst = data.Data.lstdynamic;
                    arrayOblList=[];
                    OBLlistHtml='';
                    if (data.Data.ShippingLine != null || data.Data.ShippingLine != undefined || data.Data.ShippingLine != '') {
                        $('#ShippingLineId').val(data.Data.ShippingLine.split(',')[0]);
                        $('#ShippingLine').val(data.Data.ShippingLine.split(',')[1]);
                        $("#DestuffingEntryDate").datepicker("option", "minDate", data.Data.ShippingLine.split(',')[2]);
                    }
                    //GenerateDestuffingEntryTable();
                }
            }
        });
        GetContainerOBL(i,CfsCode);
    }

    function GetContainerOBL(i,CfsCode) {
        debugger;
        $.ajax({
            url: '/Import/VLDA_CWCImport/GetOBLDetForDestuffingEntry',
            type: 'GET',
            dataType: 'JSON',
            data: { TallySheetId: i,CFSCode: CfsCode},
            success: function (data) {
                debugger;
                if (data.Status == 1) {
                    debugger;
                    if (data.Data.length > 0) {

                        //arrayOblList=data.Data;
                        var arrayObl =  data.Data.filter(function(finaldata) {
                            return finaldata.IsHoldRelease == 0;
                        });
                        compObllist=[];
                        compObllist=arrayObl;
                        arrayOblList=arrayObl;
                    }

                    var tid=0;
                    var bol="";
                    var tarea=0;
                    var boldt="";
                    var lineno="";
                    var comvalue="";
                    var cid=0;
                    var cdeg="";
                    var nopkg=0;
                    var gsw=0;
                    var ctype="";
                    var Um=0;
                    var rpck=0;
                    var remwg=0;
                    var ishold=0;
                    var boe="";
                    var boedt="";
                    var obldet="";
                    var rem="";
                    var sline = 0;
                    var slineId = 0;
                    var ImporterId = 0;
                    var cif=0;
                    if (arrayOblList.length != 0) {
                        var TabValue=302;
                        $.each(arrayOblList, function (i, item) {
                            if(i==0)
                            {
                                tid=item.TallySheetDtlId;
                                bol=item.BOLNo;
                                tarea=item.TallySheetArea;
                                boldt=item.BOLDate;
                                lineno=item.LineNo;
                                comvalue=item.Commodity;
                                cid=item.CommodityId;
                                cdeg=item.CargoDescription;
                                nopkg=item.NoOfPackages;
                                gsw=item.GrossWeight;
                                ctype=item.CargoType;
                                Um=item.UOM;
                                rpck=item.RemPackages;
                                remwg=item.RemWeight;
                                ishold=item.IsHoldRelease;
                                boe=item.BOENo;
                                boedt=item.BOEDate;
                                obldet=item.OBLWiseDestuffingDate;
                                rem=item.Remarks;
                                sline = item.ShippingLine;
                                slineId = item.ShippingLineId;
                                cif=item.CIFValue;
                                ImporterId = item.ImporterId;


                            }
                            OBLlistHtml += '<li tabindex=' + TabValue + ' id="' + item.TallySheetDtlId + '" " name=' + item.BOLNo + ' onkeypress="SelectOBLDetails(' + item.TallySheetDtlId + ',&quot;' + item.BOLNo + '&quot;,&quot;' + item.TallySheetArea + '&quot;,&quot;' + item.BOLDate + '&quot;,&quot;' + item.LineNo + '&quot;,&quot;' + item.Commodity + '&quot;,' + item.CommodityId + ',&quot;' + item.CargoDescription + '&quot;,' + item.NoOfPackages + ',' + item.GrossWeight + ',&quot;' + item.CargoType + '&quot;,&quot;' + item.UOM + '&quot;,' + item.RemPackages + ',' + item.RemWeight + ',' + item.IsHoldRelease + ',&quot;' + item.BOENo + '&quot;,&quot;' + item.BOEDate + '&quot;,&quot;' + item.OBLWiseDestuffingDate + '&quot;,&quot;' + item.Remarks + '&quot;,&quot;' + item.ShippingLine + '&quot;,&quot;' + item.CIFValue + '&quot;,&quot;' + item.ShippingLineId + '&quot;,&quot;' + item.ImporterId + '&quot;)" onclick="SelectOBLDetails(' + item.TallySheetDtlId + ',&quot;' + item.BOLNo + '&quot;,&quot;' + item.TallySheetArea + '&quot;,&quot;' + item.BOLDate + '&quot;,&quot;' + item.LineNo + '&quot;,&quot;' + item.Commodity + '&quot;,' + item.CommodityId + ',&quot;' + item.CargoDescription + '&quot;,' + item.NoOfPackages + ',' + item.GrossWeight + ',&quot;' + item.CargoType + '&quot;,&quot;' + item.UOM + '&quot;,' + item.RemPackages + ',' + item.RemWeight + ',' + item.IsHoldRelease + ',&quot;' + item.BOENo + '&quot;,&quot;' + item.BOEDate + '&quot;,&quot;' + item.OBLWiseDestuffingDate + '&quot;,&quot;' + item.Remarks + '&quot;,&quot;' + item.ShippingLine + '&quot;,&quot;' + item.CIFValue + '&quot;,&quot;' + item.ShippingLineId + '&quot;,&quot;' + item.ImporterId + '&quot;)">' + item.BOLNo + '</li>';
                            TabValue++;
                        });
                    }
                    $('#OBLList').html(OBLlistHtml);

                    //ArrayLst = data.Data.lstdynamic;
                    SelectOBLDetails(tid,bol,tarea,boldt,lineno,comvalue,cid,cdeg,nopkg,gsw,ctype,Um,rpck,remwg,ishold,boe,boedt,obldet,rem,sline,cif,slineId,ImporterId);

                    //GenerateDestuffingEntryTable();
                }
            }
        });
    }
    function SelectLocation() {
        var data = '';
        var inf = '';
        $('#DivLocationDet').find('input:checked').each(function () {
            if (data == '')
                data = $(this).prop('name');
            else
                data = data + ',' + $(this).prop('name');
            if (inf == '')
                inf = $('label[for="' + $(this).prop('id') + '"]').text();
            else
                inf = inf + ',' + $('label[for="' + $(this).prop('id') + '"]').text();
        });
        $('#GodownWiseLocationIds').val(data);
        $('#GodownWiseLocationNames').val(inf);
    }
    function GetDestuffingEntryList() {
        debugger;
        $('#tblEntryDet').html('');
        $('#DivDestuffingEntryList').load('/Import/VLDA_CWCImport/GetDestuffingEntryList');
    }
    function ReloadDestuffingEntryPage() {
        $('#DivBody').load('/Import/VLDA_CWCImport/CreateDestuffingEntry');
    }

    function ResetGodownDet() {
        debugger;
        //$('#DivDestuffingEntryDet').find('input:text,textarea').val('');
        //$('#DivDestuffingEntryDet').find('input:hidden').val('');

        $('#GodownWiseLocationNames').val('');
        $('#GodownName').val('');
        $('#Area').val(0);
        $('#RevArea').val(0);
        $('#AreaCbm').val(0)
        $('#DestuffingWeight').val(0);
        $('#ReservedWeight').val(0);
        $('#ReceivedPackages').val(0);
        $('#CIFValue').val(0);
        $('#GrossDuty').val(0);

        $('#DivLocationDet').find('input[type="checkbox"]:checked').each(function () {
            $(this).prop("checked", false);
        });
        //$( "#IsHold" ).prop( "checked", true );
    }

    function ResetDestuffingEntryDet() {
        debugger;
        $('#DivDestuffingEntryDet').find('input:text,textarea').val('');
        $('#DivDestuffingEntryDet').find('input:hidden').val('');
        $('#DivLocationDet').find('input[type="checkbox"]:checked').each(function () {
            $(this).prop("checked", false);
        });
        $( "#IsRelease" ).prop( "checked", true );
    }

    function SearchByContainerNo() {
        debugger;
        $('#tblEntryDet').hide();
        $('#DivDestuffingEntryList').load('/Import/VLDA_CWCImport/GetDestuffingEntryListSearch?ContainerNo=' + $('#ContainerNoSearch').val().trimLeft());
    }

    function GenerateDestuffingEntryTable() {
        $('#TblDestuffingEntryDet').hide();
        $('#TblDestuffingEntryDet>tbody').html('');
        var Html = '';
        if (ArrayLst.length != 0) {
            $.each(ArrayLst, function (i, item) {
                Html += '<tr><td width="50px" class="text-center txt_wrp">' + item.BOLNo + '</td><td width="50px" class="txt_wrp">' + item.BOLDate + '</td><td width="6%" class="txt_wrp">' + item.LineNo + '</td><td width="15%" class="txt_wrp">' + item.GodownName + '</td><td width="5%" class="txt_wrp">' + ((item.Area == null || item.Area == undefined) ? 0 : item.Area) + '</td><td width="5%" class="txt_wrp">' + ((item.AreaCbm == null || item.AreaCbm == undefined) ? 0 : item.AreaCbm) + '</td><td width="10%" class="txt_wrp">' + item.ReceivedPackages + '</td><td width="10%" class="txt_wrp">' + item.DestuffingWeight + '</td><td width="10%" class="txt_wrp">' + item.ReservedWeight + '</td><td width="5%" class="text-center"><a href="#" onclick="EditDestuffingEntry(' + i + ')"><i class="fa fa fa-pencil-square Edit" aria-hidden="true"></i></a></td><td width="5%" class="text-center"><a href="#" onclick="ViewDestuffingEntry(' + i + ')"><i class="fa fa-search-plus" aria-hidden="true"></i></a></td></tr>';
            });
            $('#TblDestuffingEntryDet>tbody').html(Html);
            $('#TblDestuffingEntryDet').show();
        }
    }

    function GenerateBlankTable() {
        tablehtml = '';
        var tablehtml = '<table id="tblEntryDet" class="table table-striped table-bordered dataTable" style="width:100%;"><thead><tr><th class="text-center">SL No</th><th>Destuffing No</th><th>Destuffing Date</th><th>CFS Code</th><th>Container / CBT No</th><th>CHA</th><th>Shipping Line</th><th class="text-center">View</th><th class="text-center">Edit</th><th class="text-center">Delete</th><th class="text-center">Print</th></tr></thead><tbody>';
        tablehtml += '</tbody></table>';
        $('#tblEntryDet').html(tablehtml);
    }

    var Pkg=0;
    var CBMValue=0;
    var PkgWt=0;
    function SelectOBLDetails(TallySheetDtlId,BOLNo,TallySheetArea,BOLDate,LineNo,Commodity,CommodityId,CargoDescription,NoOfPackages,GrossWeight,CargoType,UOM,RemPackages,RemWeight,IsHoldRelease,BOENo,BOEDate,OBLWiseDestuffingDate,Remarks,ShippingLine,CIFValue,ShippingLineId,ImporterId) {
        $('#BtnAddDestuffingEntry').prop("disabled", true);
        $('#btnReset').prop("disabled", false);
        $( "#IsRelease" ).prop( "checked", true );
        ResetGodownDet();
        debugger;
        if(IsHoldRelease==1)
        {
            alert('Released of this OBL');
            return false;
        }

        debugger;
        if ($('#BtnAddDestuffingEntry').is(":disabled") == true) {
            Pkg=parseFloat(RemPackages);
            CBMValue=parseFloat(UOM);
            PkgWt=parseFloat(RemWeight);
            $('#btnReset').prop("disabled", true);
            $('#BtnAddDestuffingEntry').prop("disabled", false);
            $('#LocationSearch').css("display", "block");
            $('#DivLocationDet').find('input[type="checkbox"]:checked').prop("checked", false);
            $('#BOLNo').val(BOLNo);
            var BOELineNoSplit = BOLNo.split('-');
            $('#OBLNo').val(BOELineNoSplit[0]);
            $('#TallySheetDtlId').val(TallySheetDtlId);
            $('#TallySheetArea').val(TallySheetArea);
            // $('#BOLNo').val(BOLNo);
            $('#BOLDate').val(BOLDate);
            $('#LineNo').val(LineNo);
            $('#Commodity').val(Commodity);
            $('#CommodityId').val(CommodityId);
            $('#CargoDescription').val(CargoDescription);
            $('#NoOfPackages').val(NoOfPackages);
            $('#GrossWeight').val(GrossWeight);
            $('#CargoType').val(CargoType)
            $('#UOM').val(UOM);
            $('#Area').val(0);
            $('#RevArea').val(0);
            $('#AreaCbm').val(UOM);
            $('#ShippingLineId').val(ShippingLineId)
            $('#ImporterId').val(ImporterId)
            $('#RemWeight').val(RemWeight);
            //------------------------------------------
            $('#IsReserved').val(0);
            $.ajax({
                url: '/Import/VLDA_CWCImport/GetReservationValidate',
                type: 'GET',
                dataType: 'JSON',
                data: { ImporterId: ImporterId, DestuffingDate: $('#DestuffingEntryDate').val() },
                success: function (data) {
                    debugger;
                    if (data != null && data != 'undefined') {
                        debugger;
                        if (data.IsReserved == 1) {
                            $('#IsReserved').val(data.IsReserved);
                            $('#ReservedWeight').val(RemWeight);
                        }
                        else {
                            $('#DestuffingWeight').val(RemWeight)
                        }
                    }
                  
                }

            });
            //------------------------------------------

            $('#ReceivedPackages').val(RemPackages);
            $('#CIFValue').val(CIFValue);
            $('#GrossDuty').val(0);
            $('#RemPackages').val(RemPackages);
            $('#RemWeight').val(RemWeight);
            $('#BOENo').val(BOENo);
            $('#BOEDate').val(BOEDate);
            $('#OBLWiseDestuffingDate').val(OBLWiseDestuffingDate);
            $('#Remarks').val(Remarks);
            $('#GdTransId').val(0);
            $('#StockDetailsId').val(0);

            $('#ShippingLineName').val(ShippingLine);
        }

        $("#OBLModal").modal("hide");
        $('#DivDestufGodownEntryTblMsg').html('');
    }

    function ValidateReservation() {
        //debugger;
        //alert('dd');
        var RemWt = 0;
        RemWt = $('#RemWeight').val();
        if ($('#BOLNo').val() != '' && Number($('#ReceivedPackages').val())>0) {
            $('#IsReserved').val(0);
            $.ajax({
                url: '/Import/VLDA_CWCImport/GetReservationValidate',
                type: 'GET',
                dataType: 'JSON',
                data: { ImporterId: $('#ImporterId').val(), DestuffingDate: $('#DestuffingEntryDate').val() },
                success: function (data) {
                    //debugger;
                    if (data != null && data != 'undefined') {
                       // debugger;
                        if (data.IsReserved == 1) {
                            $('#IsReserved').val(data.IsReserved);
                            $('#ReservedWeight').val(RemWt);
                            $('#DestuffingWeight').val('0');
                        }
                        else {
                            $('#DestuffingWeight').val(RemWt)
                            $('#ReservedWeight').val(0);
                        }
                    }
                }
            });
        }
        
   }

    function ViewDestuffingEntry(Index) {
        debugger;
        $('#BtnAddDestuffingEntry').prop("disabled", true);
        $('#LocationSearch').css("display", "none");
        $('#TallySheetDtlId').val(ArrayLst[Index].TallySheetDtlId);
        $('#TallySheetArea').val(ArrayLst[Index].TallySheetArea);
        $('#BOLNo').val(ArrayLst[Index].BOLNo);
        $('#BOLDate').val(ArrayLst[Index].BOLDate);
        $('#LineNo').val(ArrayLst[Index].LineNo);
        $('#Commodity').val(ArrayLst[Index].Commodity);
        $('#CommodityId').val(ArrayLst[Index].CommodityId);
        $('#CargoDescription').val(ArrayLst[Index].CargoDescription);
        $('#NoOfPackages').val(ArrayLst[Index].NoOfPackages);
        $('#ReceivedPackages').val(ArrayLst[Index].ReceivedPackages);
        $('#UOM').val(ArrayLst[Index].UOM);
        $('#GrossWeight').val(ArrayLst[Index].GrossWeight);
        $('#DestuffingWeight').val(ArrayLst[Index].DestuffingWeight);
        $('#ReservedWeight').val(ArrayLst[Index].ReservedWeight);

        $('#ShippingLineId').val(ArrayLst[Index].ShippingLineId);
        $('#ImporterId').val(ArrayLst[Index].ImporterId);
        $('#IsReserved').val(ArrayLst[Index].IsReserved);
               
        $('#Remarks').val(ArrayLst[Index].Remarks);
        $('#GodownWiseLocationNames').val(ArrayLst[Index].GodownWiseLocationNames);
        $('#GodownWiseLocationIds').val(ArrayLst[Index].GodownWiseLocationIds);
        $('#Area').val(ArrayLst[Index].Area);
        $('#AreaCbm').val(ArrayLst[Index].AreaCbm);
        $('#CIFValue').val(ArrayLst[Index].CIFValue);
        $('#GrossDuty').val(ArrayLst[Index].GrossDuty);
        $('#BOENo').val(ArrayLst[Index].BOENo);
        $('#BOEDate').val(ArrayLst[Index].BOEDate);
        $('#OBLWiseDestuffingDate').val(ArrayLst[Index].OBLWiseDestuffingDate);
        $('#CargoType').val(ArrayLst[Index].CargoType);
        $('#GodownId').val(ArrayLst[Index].GodownId);
        $('#GodownName').val(ArrayLst[Index].GodownName);
        $('#GdTransId').val(ArrayLst[Index].GdTransId);
        $('#StockDetailsId').val(ArrayLst[Index].StockDetailsId);
        $('#RevArea').val(ArrayLst[Index].RevArea);

    }



    function EditDestuffingEntry(Index) {
        debugger;
        if ($('#BtnAddDestuffingEntry').is(":disabled") == true) {
            Pkg=parseFloat(ArrayLst[Index].ReceivedPackages);
            CBMValue=parseFloat(ArrayLst[Index].AreaCbm);
            PkgWt=parseFloat(ArrayLst[Index].DestuffingWeight);
            $('#btnReset').prop("disabled", true);
            $('#BtnAddDestuffingEntry').prop("disabled", false);
            $('#LocationSearch').css("display", "block");
            $('#DivLocationDet').find('input[type="checkbox"]:checked').prop("checked", false);
            $('#TallySheetDtlId').val(ArrayLst[Index].TallySheetDtlId);
            $('#TallySheetArea').val(ArrayLst[Index].TallySheetArea);
            $('#BOLNo').val(ArrayLst[Index].BOLNo);
            $('#OBLNo').val(ArrayLst[Index].BOLNo);
            $('#BOLDate').val(ArrayLst[Index].BOLDate);
            $('#LineNo').val(ArrayLst[Index].LineNo);
            $('#Commodity').val(ArrayLst[Index].Commodity);
            $('#CommodityId').val(ArrayLst[Index].CommodityId);
            $('#CargoDescription').val(ArrayLst[Index].CargoDescription);
            $('#NoOfPackages').val(ArrayLst[Index].NoOfPackages);
            $('#ReceivedPackages').val(ArrayLst[Index].ReceivedPackages);
            $('#UOM').val(ArrayLst[Index].UOM);
            $('#GrossWeight').val(ArrayLst[Index].GrossWeight);
            $('#DestuffingWeight').val(ArrayLst[Index].DestuffingWeight);
            $('#ReservedWeight').val(ArrayLst[Index].ReservedWeight);

            $('#ShippingLineId').val(ArrayLst[Index].ShippingLineId);
            $('#ImporterId').val(ArrayLst[Index].ImporterId);
            $('#IsReserved').val(ArrayLst[Index].IsReserved);
            
            $('#Remarks').val(ArrayLst[Index].Remarks);
            $('#GodownWiseLocationNames').val(ArrayLst[Index].GodownWiseLocationNames);
            $('#GodownWiseLocationIds').val(ArrayLst[Index].GodownWiseLocationIds);
            $('#Area').val(ArrayLst[Index].Area);
            $('#RevArea').val(ArrayLst[Index].RevArea);
            $('#AreaCbm').val(ArrayLst[Index].AreaCbm);
            $('#CIFValue').val(ArrayLst[Index].CIFValue);
            $('#GrossDuty').val(ArrayLst[Index].GrossDuty);
            $('#BOENo').val(ArrayLst[Index].BOENo);
            $('#BOEDate').val(ArrayLst[Index].BOEDate);
            $('#OBLWiseDestuffingDate').val(ArrayLst[Index].OBLWiseDestuffingDate);
            $('#CargoType').val(ArrayLst[Index].CargoType);
            $('#GodownId').val(ArrayLst[Index].GodownId);
            $('#GodownName').val(ArrayLst[Index].GodownName);
            $('#RemPackages').val(ArrayLst[Index].RemPackages);
            $('#RemWeight').val(ArrayLst[Index].RemWeight);
            $('#GdTransId').val(ArrayLst[Index].GdTransId);
            $('#StockDetailsId').val(ArrayLst[Index].StockDetailsId);

            if (ArrayLst[Index].LocationDetails != null && ArrayLst[Index].LocationDetails != undefined) {
                var split = ArrayLst[Index].LocationDetails.split(',');
                $(split).each(function (j, data) {
                    $('#' + data + 'g').prop('checked', true);
                });
            }
            ArrayLst.splice(Index, 1);
            GenerateDestuffingEntryTable();
        }
        else {
            $('#DivDestuffingEntryTblMsg').html('Please add above record');
            setTimeout(function () { $('#DivDestuffingEntryTblMsg').html(''); }, 1000);
        }
    }

    function SaveDestuffingEntryDtl() {


        debugger;
        var wt = Number($('#DestuffingWeight').val())+Number($('#ReservedWeight').val());


        var NoOfPack = Number($('#NoOfPackages').val());
        var ReceivePack = Number($('#ReceivedPackages').val());

        var ishold = 0;
        if (isflag == 0) {
            if (ReceivePack < NoOfPack) {
                $('#IsHold').prop("checked", true);
                $('#IsRelease').prop("checked", false);




            }
            else {
                $('#IsHold').prop("checked", false);
                $('#IsRelease').prop("checked", true);
            }

            if ($("#IsHold")[0].checked) {
                ishold = 0;
            }
            else {
                ishold = 1;
            }


        }
        $('[data-valmsg-for="GodownName"]').html('<span></span>');

        $('[data-valmsg-for="GodownWiseLocationNames"]').html('<span></span>');
        $('[data-valmsg-for="Area"]').html('<span></span>');
        $('[data-valmsg-for="AreaCbm"]').html('<span></span>');
        $('[data-valmsg-for="ReceivedPackages"]').html('<span></span>');
        $('[data-valmsg-for="DestuffingWeight"]').html('<span></span>');

        if ($('#GodownName').val() == '') {
            $('[data-valmsg-for="GodownName"]').html('<span>Fill Out This Field</span>');
            return false;
        }
        if ($('#GodownWiseLocationNames').val() == '') {
            $('[data-valmsg-for="GodownWiseLocationNames"]').html('<span>Fill Out This Field</span>');
            return false;
        }
        if(Number($('#Area').val())<0)
         {
          $('[data-valmsg-for="Area"]').html('<span>Fill Out This Field</span>');
           return false;
         }
        if (Number($('#AreaCbm').val()) <= 0) {
            $('[data-valmsg-for="AreaCbm"]').html('<span>Fill Out This Field</span>');
            return false;
        }
        //if($('#Area').val() == '0'||$('#Area').val() == "" ||$('#Area').val() == '0.0')
       // {
          //  $('[data-valmsg-for="Area"]').html('<span>Fill Out This Field</span>');
            //return false;
       // }
        //if ($('#AreaCbm').val() == '0' || $('#AreaCbm').val() == ""|| $('#AreaCbm').val() == '0.0')
        //{
        //    $('[data-valmsg-for="AreaCbm"]').html('<span>Fill Out This Field</span>');
        //    return false;
        //}

        if (Number($('#ReceivedPackages').val()) < 1) {
            $('[data-valmsg-for="ReceivedPackages"]').html('<span>Enter Received Package More Than 0 </span>');
            return false;
        }
        if (wt <=0) {
            $('[data-valmsg-for="DestuffingWeight"]').html('<span>Enter UnReserved Weight or Reserved Weight More Than 0 </span>');
            return false;
        }


        //var arRecPkg=0;
        //var arRecWt=0;
        //if(ArrayLst.length>0)
        //{
        //    var Obl=$('#BOLNo').val();
        //    for (var i = 0; i < ArrayLst.length; i++) {

        //        if(Obl==ArrayLst[i].BOLNo)
        //        {
        //            arRecPkg = Number(arRecPkg)+ Number(ArrayLst[i].ReceivedPackages);
        //            arRecWt =Number(arRecWt)+Number(ArrayLst[i].DestuffingWeight);
        //        }
        //    }
        //}

        //debugger;
        //var IsHoldRelease = Number($('input[name=IsHoldRelease]:checked').val());
        //var RecivedPackage=Number($('#ReceivedPackages').val());
        //var RemPackages=Number($('#RemPackages').val());
        //var TotRecPackage=Number(RecivedPackage)+ Number(arRecPkg);


        //if(Number(IsHoldRelease)==1){
        //    if(Number(RemPackages)==Number(TotRecPackage)){

        //    }
        //    else
        //    {
        //        alert('Can not release (Remaining Packages and Received Packages not equal)');
        //        return false;
        //    }
        //}

        //if(Number(RemPackages)>Number(TotRecPackage)){
        //    $('#BtnAddDestuffingEntry').prop("disabled", true);
        //    $('#btnReset').prop("disabled", false);
        //   // ResetGodownDet();
        //}
        //else if(Number(RemPackages)<Number(TotRecPackage)){
        //    alert('Remaining Packages and Received Packages not equal');
        //    return false;
        //}

        //var RemWeight=Number($('#RemWeight').val());
        //var DestuffingWeight=Number($('#DestuffingWeight').val());
        //var TotDestufWeight=Number(DestuffingWeight)+ Number(arRecWt);

        //if(Number(RemWeight)<Number(TotDestufWeight)){
        //    alert('Remaining Weight and Destuffing Weight not equal');
        //    return false;
        //}


        var RPack=parseFloat($('#ReceivedPackages').val());
        var RemPack=parseFloat($('#RemPackages').val())
        //if(RPack>=RemPack)
        //{

        //    $( "#IsRelease" ).prop( "checked", true );
        //}
        //else
        //{
        //    $( "#IsHold" ).prop( "checked", true );
        //}
        if ($('#ContainerNo').val() != "") {
            debugger;
            var DestuffingEntryDtl = {
                "TallySheetDtlId": $('#TallySheetDtlId').val(),
                "BOLNo": $('#OBLNo').val(),
                "BOLDate": $('#BOLDate').val(),
                "LineNo": $('#LineNo').val(),
                "CommodityId": $('#CommodityId').val(),
                "Commodity": $('#Commodity').val(),
                "CargoDescription": $('#CargoDescription').val(),
                "NoOfPackages": $('#NoOfPackages').val(),
                "ReceivedPackages": $('#ReceivedPackages').val() == "" ? 0 : $('#ReceivedPackages').val(),
                "UOM": $('#UOM').val(),
                "GrossWeight": $('#GrossWeight').val(),
                "DestuffingWeight": $('#DestuffingWeight').val() == "" ? 0 : $('#DestuffingWeight').val(),
                "ReservedWeight": $('#ReservedWeight').val() == "" ? 0 : $('#ReservedWeight').val(),
                
                "TallySheetArea": $('#TallySheetArea').val(),
                "Area": $('#Area').val() == "" ? 0 : $('#Area').val(),
                "AreaCbm": $('#Area').val() == "" ? 0 : $('#AreaCbm').val(),
                "GodownWiseLocationIds": $('#GodownWiseLocationIds').val(),
                "GodownWiseLocationNames": $('#GodownWiseLocationNames').val(),
                "Remarks": $('#Remarks').val(),
                "CIFValue": ($('#CIFValue').val() == '' ? 0 : $('#CIFValue').val()),
                "GrossDuty": ($('#GrossDuty').val() == '' ? 0 : $('#GrossDuty').val()),
                "BOENo": $('#BOENo').val(),
                "BOEDate": $('#BOEDate').val(),
                "OBLWiseDestuffingDate": $('#OBLWiseDestuffingDate').val(),
                "CargoType":$('#CargoType').val(),
                "IsHoldRelease": isflag == 0 ? ishold : Number($('input[name=IsHoldRelease]:checked').val()),

                "GodownId":$('#GodownId').val(),
                "GodownName":$('#GodownName').val(),
                "RemPackages":$('#RemPackages').val(),
                "RemWeight":$('#RemWeight').val(),
                "GdTransId":$('#GdTransId').val(),
                "StockDetailsId":$('#StockDetailsId').val(),
                "RevArea": $('#RevArea').val() == "" ? 0 : $('#RevArea').val(),
                "ImporterId": $('#ImporterId').val() == "" ? 0 : $('#ImporterId').val(),
                "IsReserved": $('#IsReserved').val() == "" ? 0 : $('#IsReserved').val(),

            }
            ArrayLst.push(DestuffingEntryDtl);

            if(ArrayLst.length>0)
            {
                var Obl=$('#OBLNo').val();
                for (var i = 0; i < ArrayLst.length; i++) {

                    if(Obl==ArrayLst[i].BOLNo)
                    {
                       // ArrayLst[i].IsHoldRelease=$('input[name=IsHoldRelease]:checked').val();
                        ArrayLst[i].BOENo= $('#BOENo').val();
                        ArrayLst[i].BOEDate= $('#BOEDate').val();
                        ArrayLst[i].Remarks= $('#Remarks').val();
                        ArrayLst[i].OBLWiseDestuffingDate= $('#OBLWiseDestuffingDate').val();

                    }
                }
            }


            $('#BtnAddDestuffingEntry').prop("disabled", true);
            $('#btnReset').prop("disabled", false);
            //ResetDestuffingEntryDet();
            ResetGodownDet();
            GenerateDestuffingEntryTable();
            debugger;
            // Remove Obl which is already added
            //$('#OBLList [name='+ $('#BOLNo').val()+']').remove();
            RebindModal();
            //$('#OBLList').html(OBLlistHtml);
        }

        else {
            $('#DivDestuffingEntryTblMsg').html('Please Select A Container No In Order To Add Details'); 
        }

    }
    
    $('#BtnSaveDestuffingEntry').on("click", function () {


        var NoOfPack = $('#NoOfPackages').val();
        var ReceivePack = $('#ReceivedPackages').val();

        if (ReceivePack < NoOfPack)
        {
            $("#IsHoldRelease").prop("checked", true);
            $("#IsRelease").prop("checked", false);
        }
        else
        {
            $("#IsHoldRelease").prop("checked", false);
            $("#IsRelease").prop("checked", true);
        }

        
        //--------------------
        ArryResList = [];
        if (ArrayLst.length > 0) {
            //debugger;
            ArryResList = ArrayLst;
            var flag = 0;
            var ResvOBL = "";
            var DestuffingDate = "";
            DestuffingDate= $('#DestuffingEntryDate').val();
            for (var j = 0; j < ArryResList.length; j++) {
                if (ArryResList[j].IsReserved == 1) {
                    var Resve1 = CheckReservation(ArryResList[j].ImporterId, DestuffingDate);
                    //debugger;
                    if (ArryResList[j].IsReserved != Resve1) {
                        flag = 1;
                        ResvOBL += ArryResList[j].BOLNo + ',';
                    }
                }
                              
            }

            if (flag==1)
            {
                $('#DivDestuffingEntryMsg').html('Reserved area not available for this OBL ( ' + ResvOBL+ ' )');
                setTimeout(function () { $('#DivDestuffingEntryMsg').html(''); }, 5000);
                return false;
            }
        }
        //--------------------
        //alert('kk');
        debugger;

        if(ArrayLst.length>0)
        {
            var Obl=$('#OBLNo').val();
            for (var i = 0; i < ArrayLst.length; i++) {

                if(Obl==ArrayLst[i].BOLNo)
                {
                  //  ArrayLst[i].IsHoldRelease=$('input[name=IsHoldRelease]:checked').val();
                    ArrayLst[i].BOENo= $('#BOENo').val();
                    ArrayLst[i].BOEDate= $('#BOEDate').val();
                    ArrayLst[i].Remarks= $('#Remarks').val();
                    ArrayLst[i].OBLWiseDestuffingDate= $('#OBLWiseDestuffingDate').val();

                }
            }
        }

        //var flg=0
        //$.each(ArrayLst, function (i, item) {
        //    if (item.Area == null || item.Area == undefined || item.Area==0) {
        //        flg = 1;
        //    }
        //});
        //if (flg == 1) {
        //    alert('Please fill up area for related OBL');
        //    return false;
        //}
        $('#BtnSaveDestuffingEntry').prop('disabled', false);
        if ($('#BtnAddDestuffingEntry').prop("disabled") == false) {
            $('#DivDestuffingEntryTblMsg').html('Please Add The Above Records');
            return false;
        }
        $('#DivDestuffingEntryTblMsg').html('');
        if ($('#TblDestuffingEntryDet >tbody').html() != "") {
            if (ArrayLst.length != 0) {
                $('#DestuffingEntryXML').val(JSON.stringify(ArrayLst));
            }
        }
        $('[data-valmsg-for="StartDate"]').html('<span></span>');
        if ($('#StartDate').val() == '') {
            $('[data-valmsg-for="StartDate"]').html('<span>Please Select Start Date</span>');
            return false;
        }

        //$('[data-valmsg-for="CHA"]').html('<span></span>');
        //if ($('#CHA').val() == '') {
        //    $('[data-valmsg-for="CHA"]').html('<span>Please Select CHA Name</span>');
        //    return false;
        //}

        $('[data-valmsg-for="ShippingLine"]').html('<span></span>');
        if ($('#ShippingLine').val() == '') {
            $('[data-valmsg-for="ShippingLine"]').html('<span>Please Select Shipping Line</span>');
            return false;
        }

      


    });

    
    function CheckReservation(ImporterId, DestuffingDate) {
        var Resv = 0;
        $.ajax({
            url: '/Import/VLDA_CWCImport/GetReservationValidate',
            type: 'GET',
            async: false,
            dataType: 'JSON',
            data: { ImporterId: ImporterId, DestuffingDate: DestuffingDate },
            success: function (data) {
                //debugger;
                if (data != null && data != 'undefined') {
                    //debugger;                    
                    Resv = data.IsReserved;
                }
            }

        });
        //debugger;
        return Resv;
    }
    function DestuffingEntryOnSuccess(data) {
        if (data.Status == 1) {
            $('#DivDestuffingEntryMsg').html(data.Message);

        }
        else {
            $('#DivDestuffingEntryErrMsg').html(data.Message);
        }
        setTimeout(ReloadDestuffingEntryPage, 5000);
    }

    function DestuffingEntryOnFailure() { }
    function GetCIFDuty() {
        if (
                $('#BOENo').val() != '' &&
                $('#BOEDate').val() != '' &&
                ($('#CIFValue').val() == '' || $('#CIFValue').val() == '0') &&
                ($('#GrossDuty').val() == '' || $('#GrossDuty').val() == '0')
            ) {
            $.ajax({
                url: '/Import/VLDA_CWCImport/GetCIFandDutyForBOE',
                type: 'GET',
                data: { "BOENo": $('#BOENo').val(), "BOEDate": $('#BOEDate').val() },
                dataType: 'JSON',
                success: function (data) {
                    if (data.Status == 1) {
                        $('#CIFValue').val(data.Data.CIFValue);
                        $('#GrossDuty').val(data.Data.GrossDuty);
                    }
                }
            });
        }
    }

    function LoadMoreCHA() {
        debugger;
        $.ajax({
            url: '/Import/VLDA_CWCImport/LoadCHAList',
            type: 'GET',
            data: { PartyCode: "", Page: Page + 1 },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    var tabvalue=202;
                    $.each(data.Data.lstCHA, function (item, elem) {
                        debugger;
                        html += '<tr tabindex=' + tabvalue + ' onclick="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)" onkeypress="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                        tabvalue++;
                    });
                    if (Page == -1)
                        $('#tbleCha tbody').html(html);
                    else
                        $('#tbleCha tbody').append(html);
                    Page++;

                    debugger;
                    if (data.Data.State == true)
                        $('#btnLoadCHA').prop('disabled', false);
                    else $('#btnLoadCHA').prop('disabled', true);
                }
            }
        });
    }

    function LoadCHA() {
        debugger;
        Page = 0;
        $.ajax({
            url: '/Import/VLDA_CWCImport/LoadCHAList',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    var tabvalue=202;
                    $.each(data.Data.lstCHA, function (item, elem) {
                        debugger;
                        html += '<tr tabindex=' + tabvalue + ' onclick="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)" onkeypress="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                        tabvalue++;
                    });

                    $('#tbleCha tbody').html(html);

                    if (data.Data.State == true)
                        $('#btnLoadCHA').prop('disabled', false);
                    else $('#btnLoadCHA').prop('disabled', true);
                }
            }
        });
    }

    function SelectCHA(CHAId, CHAName) {
        debugger;
        $('#CHA').val(CHAName);
        $('#CHAId').val(CHAId);
        $("#CHAModal").modal("hide");
        $('#Chabox').val('');
        LoadCHA();
    }


    function SearchChaByPartyCode() {
        if ($('#Chabox').val() != '') {
            $.ajax({
                url: '/Import/VLDA_CWCImport/CHASearchByPartyCode',
                type: 'GET',
                data: { PartyCode: $('#Chabox').val() },
                success: function (data) {
                    if (data.Status == 1) {
                        var html = '';
                        var tabvalue=202;
                        $.each(data.Data.lstCHA, function (item, elem) {
                            html += '<tr tabindex=' + tabvalue + ' onclick="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)" onkeypress="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                            tabvalue++;
                        });
                        $('#tbleCha tbody').html('');
                        $('#tbleCha tbody').html(html);
                        $('#btnLoadCHA').prop('disabled', false);
                        Page = -1;
                    }
                    else {
                        $('#tbleCha tbody').html('');
                        Page = -1;
                        $('#btnLoadCHA').prop('disabled', false);
                    }

                }
            });
        }
        else
            LoadCHA();
    }

    function CloseCHA() {
        $('#Chabox').val('');
        $("#CHAModal").modal("hide");
        LoadCHA();
    }

    function calcbm()

    {

        debugger;
        var RPkg = parseFloat($('#ReceivedPackages').val());
        
        if ($('#IsReserved').val() == "1") {
            if (Number(Pkg) > 0 || Pkg != "") {

                debugger;
            //    $('#ReservedWeight').val(((PkgWt / Pkg) * RPkg).toFixed(2));
            //    $('#AreaCbm').val(((CBMValue / Pkg) * RPkg).toFixed(2));
            }
            else {
                $('#ReservedWeight').val(0);
                $('#AreaCbm').val(0);
            }
        }
        else {
            if (Number(Pkg) > 0 || Pkg != "") {
                debugger;
                //$('#DestuffingWeight').val(((PkgWt / Pkg) * RPkg).toFixed(2));
                //$('#AreaCbm').val(((CBMValue / Pkg) * RPkg).toFixed(2));
            }
            else {
                  debugger;
                $('#DestuffingWeight').val(0);
                $('#AreaCbm').val(0);
            }
        }

        
    }
    function RebindModal()
    {
        if(compObllist.length>0 && ArrayLst.length>0)
        {
            let $obllistdata=$('#OBLList');
            $obllistdata.html('');
            $('#OBLBox').val('');
            $.each(compObllist,function(i,item)
            {
                let sum=0;
                if(ArrayLst.filter(x=>x.BOLNo== item.BOLNo.split('-')[0]).length>0)
                {
                    ArrayLst.filter(x=>x.BOLNo== item.BOLNo.split('-')[0]).forEach(function(elem,i)
                    {
                        sum=sum+Number(elem.ReceivedPackages);
                    });
                }
                if(sum<Number(item.NoOfPackages))
                    $obllistdata.append('<li id="' + item.TallySheetDtlId + '" " name=' + item.BOLNo + ' onclick="SelectOBLDetails(' + item.TallySheetDtlId + ',&quot;' + item.BOLNo + '&quot;,&quot;' + item.TallySheetArea + '&quot;,&quot;' + item.BOLDate + '&quot;,&quot;' + item.LineNo + '&quot;,&quot;' + item.Commodity + '&quot;,' + item.CommodityId + ',&quot;' + item.CargoDescription + '&quot;,' + item.NoOfPackages + ',' + item.GrossWeight + ',&quot;' + item.CargoType + '&quot;,&quot;' + item.UOM + '&quot;,' + item.RemPackages + ',' + item.RemWeight + ',' + item.IsHoldRelease + ',&quot;' + item.BOENo + '&quot;,&quot;' + item.BOEDate + '&quot;,&quot;' + item.OBLWiseDestuffingDate + '&quot;,&quot;' + item.Remarks + '&quot;,&quot;' + item.ShippingLine + '&quot;,&quot;' + item.CIFValue + '&quot;,&quot;' + item.ShippingLineId + '&quot;,&quot;' + item.ImporterId + '&quot;)">' + item.BOLNo + '</li>');
            });
        }
    }

    var isflag = 0;

    function IVType(type) {
        isflag = 1;
    }


    function PopupActivate(Id) {
        //debugger;
        var CharCode;
        if (window.event) {
            CharCode = window.event.keyCode;
        }
        else {
            CharCode = evt.which;
        }

        if (CharCode == 32) {

            $('#' + Id).modal('show');


            //if (Id == "ContainerOBLModal") {
            //    SearchOBLWise();
            //    $('#ContainerOBLBox').focus();
            //}
            ////if (Id == "CHAHdrModal") {
            //    SearchChaByPartyCode;
            //    $('#Chabox').focus();
            //}

            if (Id == "ContainerModal") {

                $('#ContainerBox').focus();
            }
            if (Id == "ImporterModal") {


                $('#Impbox').focus();
            }
            if (Id == "CHAModal") {

                $('#Chabox').focus();
            }

            if (Id == "ContainerModal") {
                $('#ContainerBox').focus();
            }
            if (Id == "OBLModal") {
                $('#OBLBox').focus();

            }
            if (Id == "GodownModal") {
                $('#Godownbox').focus();
                //LoadCargoParty();
            }
        }
    }
    $('#OBLModal').on('shown.bs.modal', function () {
        $('#OBLBox').focus();
    });

   
    $('#GodownModal').on('shown.bs.modal', function () {
        $('#Godownbox').focus();
    });

    $('#GodownModal').on('hide.bs.modal', function () {
        $('#GodownWiseLocationNames').focus();
    });
    $('#ShippingLineModal').on('shown.bs.modal', function () {
        $('#ShpngLinebox').focus();
    });
    $('#CHAModal').on('shown.bs.modal', function () {
        $('#Chabox').focus();
    });


    $('#CHAModal').on('hide.bs.modal', function () {
        $('#Chabox').val('');

        $('#Rotation').focus();
    });
    $('#ContainerModal').on('shown.bs.modal', function () {
        $('#ContainerBox').focus();
    });

    $('#ContainerModal').on('hide.bs.modal', function () {
        $('#ContainerBox').val('');
        $('#ContainerModal .navList > li').show();
        $('#StartDate').focus();
    });


    $('#ContainerOBLModal').on('shown.bs.modal', function () {
        $('#ContainerOBLBox').focus();
    });


    function checks() {
        debugger;
        //alert(elm);
        $('#StartDate').val($('#StartDate').val().replace(/^(\d\d)(\d)$/g, '$1/$2').replace(/^(\d\d\/\d\d)(\d+)$/g, '$1/$2').replace(/[^\d\/]/g, ''));
        //  elm = elm.replace(/^(\d\d)(\d)$/g, '$1/$2').replace(/^(\d\d\/\d\d)(\d+)$/g, '$1/$2').replace(/[^\d\/]/g, '');
    }


    function checkdates() {
        debugger;
        if ($('#StartDate').val() != '') {
            var result = moment($('#StartDate').val(), "DD/MM/YYYY", true).isValid();
            if (!result) {
                $('#DivMsges').html('Incorrect Date');
                setTimeout(function () { $('#DivMsges').html(''); }, 5000);
                $('#StartDate').val('');
            }
        }
    }




    function checksBOE() {
        debugger;
        //alert(elm);
        $('#BOEDate').val($('#BOEDate').val().replace(/^(\d\d)(\d)$/g, '$1/$2').replace(/^(\d\d\/\d\d)(\d+)$/g, '$1/$2').replace(/[^\d\/]/g, ''));
        //  elm = elm.replace(/^(\d\d)(\d)$/g, '$1/$2').replace(/^(\d\d\/\d\d)(\d+)$/g, '$1/$2').replace(/[^\d\/]/g, '');
    }


    function checkdatesBOE() {
        debugger;
        if ($('#BOEDate').val() != '') {
            var result = moment($('#BOEDate').val(), "DD/MM/YYYY", true).isValid();
            if (!result) {
                $('#DivMsges').html('Incorrect Date');
                setTimeout(function () { $('#DivMsges').html(''); }, 5000);
                $('#BOEDate').val('');
            }
        }
    }

    function checksDBOE() {
        debugger;
        //alert(elm);
        $('#OBLWiseDestuffingDate').val($('#OBLWiseDestuffingDate').val().replace(/^(\d\d)(\d)$/g, '$1/$2').replace(/^(\d\d\/\d\d)(\d+)$/g, '$1/$2').replace(/[^\d\/]/g, ''));
        //  elm = elm.replace(/^(\d\d)(\d)$/g, '$1/$2').replace(/^(\d\d\/\d\d)(\d+)$/g, '$1/$2').replace(/[^\d\/]/g, '');
    }


    function checkdatesDBOE() {
        debugger;
        if ($('#OBLWiseDestuffingDate').val() != '') {
            var result = moment($('#OBLWiseDestuffingDate').val(), "DD/MM/YYYY", true).isValid();
            if (!result) {
                $('#DivMsges').html('Incorrect Date');
                setTimeout(function () { $('#DivMsges').html(''); }, 5000);
                $('#OBLWiseDestuffingDate').val('');
            }
        }
    }


    function debounce(func, wait, immediate) {
        var timeout;
        return function () {
            var context = this, args = arguments;
            var later = function () {
                timeout = null;
                if (!immediate) func.apply(context, args);
            };
            var callNow = immediate && !timeout;
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
            if (callNow) func.apply(context, args);
        };
    };
    
    document.getElementById('Chabox').addEventListener('keyup', debounce(function () {
        SearchChaByPartyCode();
    }, 800));
  
    
</script>