@model  CwcExim.Areas.Import.Models.VRN_MergeDeliveryIssueViewModel


<style>
    .Head_h4 {
        margin-bottom: 20px;
    }
</style>

<div class="container-fluid">
    <div class="col-md-offset-0-5 col-md-11">
        <div class="Head_h4">
            <div class="row">
                <div class="col-md-12">
                    <h4>Merge DeliApp PaymentSheet IssueSlip Application</h4>
                </div>
            </div>
            <div class="wizard">
                <div class="wizard-inner">
                    <ul class="nav nav-tabs" role="tablist" style="display:none;">

                        <li role="presentation" class="active">
                            <a href="#step1" data-toggle="tab" aria-controls="step1" role="tab" title="Step 1">Delivery Application</a>
                        </li>

                        <li role="presentation" class="disabled">
                            <a href="#step2" data-toggle="tab" aria-controls="step2" role="tab" title="Step 2">Godown Invoice</a>
                        </li>

                        <li role="presentation" class="disabled">
                            <a href="#complete" data-toggle="tab" aria-controls="complete" role="tab" title="Complete">Invoice Checking</a>
                        </li>
                    </ul>
                </div>

                @*<form role="form">*@
                <div class="tab-content">
                    <div class="tab-pane active" role="tabpanel" id="step1">
                        <div class="Head_h4">
                            @using (Ajax.BeginForm("AddEditSingleMergeDeliveryApplication", "VRN_CWCImport", new AjaxOptions { HttpMethod = "POST", OnSuccess = "DeliveryOnSuccess", OnFailure = "DeliveryOnFailure" }))

                            {
                                if (ViewBag.RightsList != null)
                                {
                                    <input type="hidden" id="hdnRights" value="@ViewBag.RightsList" />
                                }
                                else
                                {
                                    <input type="hidden" id="hdnRights" value="" />
                                }


                                <div id="DivCreateDeliveryApp">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <h4>Delivery Application</h4>
                                        </div>
                                    </div>
                                    @Html.Hidden("LineNo")
                                    @Html.Hidden("BOENo")
                                    @Html.Hidden("CommodityId")
                                    @Html.Hidden("DestuffingEntryDtlId")
                                    @Html.Hidden("NewDeliveryId")
                                    @Html.Hidden("InvoiceNoPrint")
                                    @Html.Hidden("IssueNoPrint")
                                    @Html.Hidden("ConvertToBondFlag")
                                    @Html.Hidden("hdnSupplyType")

                                    @Html.HiddenFor(m => m.DeliApp.DeliveryAppDtlXml)
                                    @Html.HiddenFor(m => m.DeliApp.DeliveryOrdDtlXml)
                                    @Html.HiddenFor(m => m.DeliApp.DestuffingId)
                                    @Html.HiddenFor(m => m.DeliApp.DeliveryDate)
                                    @Html.HiddenFor(m => m.DeliApp.ObleFreeFlag)
                                    @Html.HiddenFor(m => m.DeliApp.lstContWiseAmountXML)
                                    @Html.HiddenFor(m => m.DeliApp.lstInvoiceCargoXML)
                                    @Html.HiddenFor(m => m.DeliApp.lstOperationCFSCodeWiseAmountXML)
                                    @Html.HiddenFor(m => m.DeliApp.lstPostPaymentChrgXML)
                                    @Html.HiddenFor(m => m.DeliApp.lstPostPaymentChrgBreakupXML)
                                    @Html.HiddenFor(m => m.DeliApp.lstPostPaymentContXML)
                                    @Html.HiddenFor(m => m.DeliApp.lstPrePaymentContXML)
                                    @Html.HiddenFor(m => m.SEZ)

                                    @Html.Hidden("ContainerJson")
                                    @Html.Hidden("BOEJson")
                                    @Html.Hidden("hdnAddress")
                                    @Html.Hidden("hdnState")
                                    @Html.Hidden("hdnStateCode")
                                    @Html.Hidden("PaymentSheetModelJson")
                                    @Html.Hidden("Movement");
                                    @Html.AntiForgeryToken()
                                    <div class="row Form_Space_top">
                                        <div class="form-group Form_Input">
                                            <div class="col-md-1-5 col_cus_2 padding_rt">
                                                <label>Delivery Application No:</label>
                                            </div>
                                            <div class="col-md-2-5">
                                                @Html.TextBoxFor(m => m.DeliApp.DeliveryNo, new { @class = "form-control input-sm", @readonly = true })
                                            </div>
                                            <div class="col-md-1-5 col-md-offset-4 col_cus_offset_3 col_cus_2 padding_rt">
                                                <label>Destuffing Entry No:</label>
                                            </div>
                                            <div class="col-md-2-5">
                                                @Html.TextBoxFor(m => m.DeliApp.DestuffingEntryNo, new { @class = "form-control input-sm", @readonly = true })
                                                @Html.ValidationMessageFor(m => m.DeliApp.DestuffingEntryNo, "", new { @class = "Error_Msg" })
                                                <span class="search" id="DestuffingEntryNoSearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#DestuffingEntryNoModal"></i></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row Form_Space_top">
                                        <div class="form-group Form_Input">
                                            <div class="col-md-1-5 col_cus_2 padding_rt">
                                                <label>CHA:</label>
                                            </div>
                                            <div class="col-md-10-5 col_cus_10">
                                                @Html.TextBoxFor(m => m.DeliApp.CHA, new { @class = "form-control input-sm", @readonly = true })
                                                <span class="search" id="CHADtlSearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#CHADtlModal"></i></span>
                                                @Html.HiddenFor(m => m.DeliApp.CHAId)
                                                @Html.ValidationMessageFor(m => m.DeliApp.CHA, "", new { @class = "Error_Msg" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row Form_Space_top Form_Space_bottom">
                                        <div class="form-group Form_Input">
                                            <div class="col-md-1-5 col_cus_2 padding_rt">
                                                <label>Movement:</label>
                                            </div>
                                            <div class="col-md-2-5">
                                                @*  <span class="ReQSimbol"></span>*@
                                                @Html.DropDownListFor(m => m.hdMovement, new List<SelectListItem> { new SelectListItem { Text = "CWC", Value = "1" }, new SelectListItem { Text = "Own Transport (FR)", Value = "2" } })
                                            </div>
                                            <div class="col-md-offset-1 col-md-1-5" style="display:none;">
                                                <label>Distance:</label>
                                            </div>
                                            <div class="col-md-2-5" style="display:none;">
                                                @*<span class="ReQSimbol"></span>*@
                                                @Html.TextBoxFor(m => m.Distance, new { @class = "form-control input-sm",Value=0 })
                                            </div>
                                            @*<div class="col-md-offset-0-5 col-md-1-5 col_cus_2 padding_rt ">
                                                    <label>ConverttoBond:</label>
                                                </div>*@

                                            <div class="col-md-1 col_cus_2_5">

                                                @Html.CheckBoxFor(m => m.ConvertToBond, new { })
                                                <label for="ConvertToBond"><i class="square"></i><span>ConvertToBond</span></label>
                                            </div>
                                        </div>
                                    </div>





                                    @*<div class="row Form_Space_top SignUp_space_bottom2">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-1-5 col_cus_2 padding_rt">
                                                    <label>Importer:</label>
                                                </div>
                                                <div class="col-md-10-5 col_cus_10">
                                                    @Html.TextBoxFor(m => m.Importer, new { @class = "form-control input-sm", @readonly = true })
                                                    <span class="search" id="ImporterSearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#ImporterModal"></i></span>
                                                    @Html.HiddenFor(m => m.ImporterId)
                                                    @Html.ValidationMessageFor(m => m.Importer, "", new { @class = "Error_Msg" })
                                                </div>
                                            </div>
                                        </div>*@
                                    <div id="DivDeliveryAppDetails" class="Head_h5">
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-1-5 col_cus_2 padding_rt">
                                                    <label>OBL/HBL - Line No:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("BOELineNo", "", new { @class = "form-control input-sm", @readonly = true })
                                                    <span class="search" id="SearchBOELineNo"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#BOELineNoModal"></i></span>
                                                    @Html.ValidationMessage("BOELineNo", "", new { @class = "Error_Msg" })
                                                </div>
                                                <div class="col-md-1-5">
                                                    <label>BOE No:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("OOC_BOENo", "", new { @class = "form-control input-sm", @onblur = "return GetCfcValue();" })
                                                    @Html.ValidationMessage("OOC_BOENo", "", new { @class = "Error_Msg" })
                                                </div>
                                                <div class="col-md-1-5">
                                                    <label>BOE Date:</label>
                                                </div>
                                                <div class="col-md-2 col_cus_2_5 Date_Img">
                                                    @*@Html.TextBoxFor(m => m.InvoiceDate, new { @readonly = true, Value = DateTime.Today.ToString("dd/MM/yyyy") })*@
                                                    @Html.TextBox("OOC_BOEDATE", "", new { @readonly = true, Value = DateTime.Now.ToString("dd/MM/yyyy") })
                                                    @Html.ValidationMessage("OOC_BOEDATE", "", new { @class = "Error_Msg" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-1-5 col_cus_2">
                                                    <label>Cargo Description</label>
                                                </div>
                                                <div class="col-md-10-5">
                                                    @Html.TextArea("CargoDescription", "", new { @style = "height:100px;width:100%", @readonly = true })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top SignUp_space_bottom2">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-1-5 col_cus_2 padding_rt">
                                                    <label>Importer:</label>
                                                </div>
                                                <div class="col-md-10-5 col_cus_10">
                                                    @Html.TextBoxFor(m => m.DeliApp.Importer, new { @class = "form-control input-sm", @readonly = true })
                                                    <span class="search" id="ImporterSearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#ImporterModal"></i></span>
                                                    @Html.HiddenFor(m => m.DeliApp.ImporterId)
                                                    @Html.ValidationMessageFor(m => m.DeliApp.Importer, "", new { @class = "Error_Msg" })
                                                </div>
                                            </div>
                                        </div>
                                        @*<div class="row Form_Space_top">
                                                <div class="form-group Form_Input">
                                                    <div class="col_cus_2 col-md-1-5">
                                                        <label>Commodity:</label>
                                                    </div>
                                                    <div class="col-md-10-5 col_cus_2_5 ">
                                                        @Html.TextBox("Commodity", "", new { @class = "form-control input-sm", @readonly = true })
                                                    </div>
                                                </div>
                                            </div>*@
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col_cus_2 col-md-1-5">
                                                    <label>Destuff No Of Packages:</label>
                                                </div>
                                                <div class="col-md-2-5 col_cus_2_5 Date_Img">
                                                    @Html.TextBox("NoOfPackages", "", new { @class = "form-control input-sm", @readonly = true })
                                                </div>
                                                <div class="col-md-1-5 col_cus_2 col-md-offset-4 col_cus_offset_3 padding_rt">
                                                    <label>No Of Packages:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("DelNoOfPackages", "", new { @class = "form-control input-sm", @onchange = "FillBalancedUnits()", @onkeypress = "return AllowOnlyInteger(event)" })
                                                    @Html.ValidationMessage("DelNoOfPackages", "", new { @class = "Error_Msg" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-1-5 col_cus_2">
                                                    <label>Destuff Weight(Kg):</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("GrossWt", "", new { @class = "form-control input-sm", @readonly = true })
                                                    @Html.ValidationMessage("GrossWt", "", new { @class = "Error_Msg" })
                                                </div>
                                                <div class="col-md-1-5 col_cus_2 col-md-offset-4 col_cus_offset_3 padding_rt">
                                                    <label>Weight(Kg):</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("DelGrossWt", "", new { @class = "form-control input-sm", @onchange = "FillBalancedWeights()", @onkeypress = "return AllowOnlyDecimal(event)", maxlength = "11" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-1-5 col_cus_2 padding_rt">
                                                    <label>Destuff SQM:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("SQM", "", new { @class = "form-control input-sm", @readonly = true })
                                                </div>
                                                <div class="col-md-1-5 col_cus_2 col-md-offset-4 col_cus_offset_3 padding_rt">
                                                    <label>SQM:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("DelSQM", "", new { @class = "form-control input-sm", maxlength = "11", @onkeypress = "return AllowOnlyDecimal(event)" })
                                                    @Html.ValidationMessage("DelSQM", "", new { @class = "Error_Msg" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-1-5 col_cus_2 padding_rt">
                                                    <label>Destuff CUM:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("CUM", "", new { @class = "form-control input-sm", @readonly = true })
                                                </div>
                                                <div class="col-md-1-5 col_cus_2 col-md-offset-4 col_cus_offset_3 padding_rt">
                                                    <label>CUM:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("DelCUM", "", new { @class = "form-control input-sm", maxlength = "11", @onkeypress = "return AllowOnlyDecimal(event)" })
                                                    @Html.ValidationMessage("DelCUM", "", new { @class = "Error_Msg" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-1-5 col_cus_2 padding_rt">
                                                    <label>Destuff CIF:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("CIF", "", new { @class = "form-control input-sm", @readonly = true })
                                                </div>
                                                <div class="col-md-1-5 col_cus_2 col-md-offset-4 col_cus_offset_3 padding_rt">
                                                    <label>CIF:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("DelCIF", "", new { @class = "form-control input-sm", maxlength = "11", @onkeypress = "return AllowOnlyDecimal(event)" })
                                                    @Html.ValidationMessage("DelCIF", "", new { @class = "Error_Msg" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-1-5 col_cus_2 padding_rt">
                                                    <label>Destuff Duty:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("Duty", "", new { @class = "form-control input-sm", @readonly = true })
                                                </div>
                                                <div class="col-md-1-5 col_cus_2 col-md-offset-4 col_cus_offset_3 padding_rt">
                                                    <label>Duty:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("DelDuty", "", new { @class = "form-control input-sm", maxlength = "11", @onkeypress = "return AllowOnlyDecimal(event)" })
                                                    @Html.ValidationMessage("DelDuty", "", new { @class = "Error_Msg" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="stoke SignUp_space_top SignUp_space_bottom"></div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-offset-4 col-md-2">
                                                <input type="button" id="BtnAddDeliveryApp" class="btn log_Btn_sm" value="Add" onclick="SaveDeliveryAppDtl()" />
                                            </div>
                                            <div class="col-md-2">
                                                <input type="button" class="btn log_Btn_sm" value="Reset" onclick="ResetDeliveryAppDet()" />
                                            </div>
                                        </div>
                                        <div id="DivDeliveryAppTblErrMsg" class="logErrMsg Form_Space_top Form_Space_bottom" style="background-color:transparent"></div>
                                        <table class="table table-striped table-bordered dataTable" id="TblDeliveryAppDtl" style="width:100%;">
                                            <thead>
                                                <tr>
                                                    <th class="text-center">@Html.DisplayName("SL No")</th>
                                                    <th>@Html.DisplayName("OBL/HBL-Line No")</th>
                                                    <th>@Html.DisplayName("Weight(Kg)")</th>
                                                    <th>@Html.DisplayName("Edit")</th>
                                                    <th class="text-center">@Html.DisplayName("View")</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>

                                    @*Delivery Order details*@

                                    <div id="DivDeliveryOrderDetails" class="Head_h5">
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-1-5 col_cus_1_5 padding_rt">
                                                    <label>Do Issued By:</label>
                                                </div>
                                                <div class="col-md-3-5">
                                                    @Html.TextBox("IssuedBy", "", new { @class = "form-control input-sm", @readonly = true })
                                                    <span class="search" id="IssuePartySearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#IssuePartyModal"></i></span>
                                                    @Html.ValidationMessage("IssuedBy", "", new { @class = "Error_Msg" })
                                                </div>
                                                <div class="col-md-offset-3 col-md-1-5">
                                                    <label>Cargs. Delivered To:</label>
                                                </div>
                                                <div class="col-md-2-5 col_cus_2_5">
                                                    @Html.TextBox("CargsDelivered", "", new { @class = "form-control input-sm", @readonly = true })
                                                    <span class="search" id="CargoPartySearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#CargoPartyModal"></i></span>
                                                    @Html.ValidationMessage("CargsDelivered", "", new { @class = "Error_Msg" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-1-5 col_cus_2">
                                                    <label>Valid Type</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.DropDownList("ddlValidType", new List<SelectListItem>
                                        {
                                        new SelectListItem { Text="Open",Value="Open"},
                                        new SelectListItem { Text="Closed",Value="Closed"},

                                        }, "----Select----", new { @class = "form-control input-sm", @onchange = "ValidDt(this);" })
                                                    <span class="field-validation-error" id="ErrddlValidType"></span>
                                                </div>
                                                <div class="col-md-offset-4 col-md-1-5">
                                                    <label>DO Valid Date:</label>
                                                </div>
                                                <div class="col-md-2-5 col_cus_2_5 Date_Img">
                                                    @*@Html.TextBoxFor(m => m.InvoiceDate, new { @readonly = true, Value = DateTime.Today.ToString("dd/MM/yyyy") })*@
                                                    @Html.TextBox("ValidDate", "", new { @readonly = true, Value = DateTime.Now.ToString("dd/MM/yyyy") })

                                                </div>

                                            </div>
                                        </div>
                                        @*<div class="row Form_Space_top">
                                                <div class="form-group Form_Input">
                                                    <div class="col_cus_2 col-md-1-5">
                                                        <label>Commodity:</label>
                                                    </div>
                                                    <div class="col-md-10-5 col_cus_2_5 ">
                                                        @Html.TextBox("Commodity", "", new { @class = "form-control input-sm", @readonly = true })
                                                    </div>
                                                </div>
                                            </div>*@

                                        <div class="row">
                                            <div class="stoke SignUp_space_top SignUp_space_bottom"></div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-offset-4 col-md-2">
                                                <input type="button" id="BtnAddDeliveryOrd" class="btn log_Btn_sm" value="Add" onclick="SaveDeliveryOrdDtl()" />
                                            </div>
                                            <div class="col-md-2">
                                                <input type="button" class="btn log_Btn_sm" value="Reset" onclick="ResetDeliveryOrdDet()" />
                                            </div>
                                        </div>
                                        <div id="DivDeliveryOrdTblErrMsg" class="logErrMsg Form_Space_top Form_Space_bottom" style="background-color:transparent"></div>
                                        <table class="table table-striped table-bordered dataTable" id="TblDeliveryAppOrd" style="width:100%;">
                                            <thead>
                                                <tr>
                                                    <th class="text-center">@Html.DisplayName("SL No")</th>
                                                    <th>@Html.DisplayName("Issued By")</th>
                                                    <th>@Html.DisplayName("Cargo. Delivered")</th>
                                                    <th>@Html.DisplayName("Edit")</th>

                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>




                                    <div class="row Form_Space_top">
                                        <div class="form-group Form_Input">
                                            <div class="col-md-1-5 col_cus_2">
                                                <label>Party Name:</label>
                                            </div>
                                            <div class="col-md-10-5 col_cus_10">
                                                @*@Html.HiddenFor(m => m.PayeeId)*@
                                                @Html.HiddenFor(m => m.DeliApp.PartyId)
                                                @*@Html.TextBoxFor(m => m.PayeeName, new { @readonly = true })*@
                                                @Html.TextBoxFor(m => m.DeliApp.PartyName, new { @class = "form-control input-sm", @readonly = true })



                                                <span class="search" id="PartysearchGst"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#PartyGstModal"></i></span>
                                                @*@Html.ValidationMessageFor(m => m.PayeeName)*@
                                            </div>
                                        </div>
                                    </div>





                                    <div class="row Form_Space_top">
                                        <div class="form-group Form_Input">
                                            <div class="col-md-1-5 col_cus_2">
                                                <label>Payee Name:</label>
                                            </div>
                                            <div class="col-md-10-5 col_cus_10">
                                                @*@Html.HiddenFor(m => m.PayeeId)*@
                                                @Html.HiddenFor(m => m.DeliApp.PayeeId)
                                                @*@Html.TextBoxFor(m => m.PayeeName, new { @readonly = true })*@
                                                @Html.TextBoxFor(m => m.DeliApp.PayeeName, new { @class = "form-control input-sm", @readonly = true })



                                                <span class="search" id="Payeesearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#PayeeModal"></i></span>
                                                @*@Html.ValidationMessageFor(m => m.PayeeName)*@
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row Form_Space_top">
                                        <div class="form-group Form_Input">
                                            <div class="col-md-1-5 col_cus_2">
                                                <label> GST No:</label>
                                            </div>
                                            <div class="col-md-4 col_cus_3">
                                                @*@Html.TextBoxFor(m => m.GSTNo, new { @readonly = true })*@
                                                @Html.TextBox("GSTNo", "", new { @readonly = true })
                                            </div>
                                            <div class="col-md-3 col_cus_4">
                                                @*<input class="btn log_Btn_sm" aria-hidden="true" data-toggle="modal" data-target="#Containerdtl" type="button" value="Container Details" />*@
                                            </div>
                                            @*<div class="col-md-3">
                                                    <input class="btn log_Btn_sm" aria-hidden="true" data-toggle="modal" data-target="#BOEdtl" type="button" value="OBL Details" />
                                                </div>*@
                                        </div>
                                    </div>
                                    <div class="row Form_Space_top">
                                        <div class="form-group Form_Input">
                                            <div class="col-md-1-5 col_cus_2">
                                                <label> OT Hours:</label>
                                            </div>
                                            <div class="col-md-2">
                                                @Html.TextBoxFor(m => m.DeliApp.OTHr, "0", new { @type = "number" })
                                            </div>

                                            <div class="col-md-offset-2-5 col-md-1-5">
                                                <label for="ExportUnder">SEZ</label>
                                            </div>
                                            <div class="col-md-2">
                                                                                    @*@Html.DropDownList("ExportUnder", new List<SelectListItem>
                                                 {
                                                 new SelectListItem { Text = "SEZ", Value = "SEZ" }
                                                }, "----Select----", new { @class = "form-control input-sm" })*@
                                                @Html.CheckBox("ExportUnder", new { @id = "ExportUnder" })
                                                <label for="ExportUnder"><i class="square"></i><span></span></label>
                                            </div>

                                            <div class="col-md-2 col-md-offset-4-5 col_cus_offset_2 col_cus_2">
                                                <div class="boolean-container">
                                                    @*@Html.RadioButtonFor(m => m.InvoiceType, "Tax", new { id = "Tax", @checked = true, @onclick = "IVType('Tax')" })*@
                                                    @Html.RadioButtonFor(m => m.DeliApp.InvoiceType, "Tax", new { id = "Tax", @checked = true, @onclick = "IVType('Tax')" })
                                                    <label for="Tax"><i class="circle"></i><span>Tax Invoice</span></label>
                                                </div>
                                            </div>
                                            <div class="col-md-2 col_cus_3">
                                                <div class="boolean-container">
                                                    @*@Html.RadioButtonFor(m => m.InvoiceType, "Bill", new { id = "Bill", @onclick = "IVType('Bill')" })*@
                                                    @Html.RadioButtonFor(m => m.DeliApp.InvoiceType, "Bill", new { id = "Bill", @onclick = "IVType('Bill')" })
                                                    <label for="Bill"><i class="circle"></i><span>Bill Of Supply</span></label>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="row Form_Space_top">
                                        <div class="form-group Form_Input">
                                            <div class="col-md-1-5 col_cus_2">
                                                <label>Invoice No:</label>
                                            </div>
                                            <div class="col-md-2-5">
                                                @*@Html.TextBoxFor(m => m.InvoiceNo, new { @readonly = true })*@
                                                @Html.TextBox("InvoiceNo", "", new { @readonly = true })
                                            </div>
                                            <div class="col-md-1-5 col-md-offset-4 col_cus_offset_3 col_cus_2">
                                                <label>Delivery Date:</label>
                                            </div>
                                            <div class="col-md-2 col_cus_2_5 Date_Img">
                                                <input type="hidden" id="DeliveryDateCheck" />
                                                <input type="hidden" id="DeliAppDate" />
                                                @*@Html.TextBoxFor(m => m.InvoiceDate, new { @readonly = true, Value = DateTime.Today.ToString("dd/MM/yyyy") })*@
                                                @Html.TextBox("InvoiceDate", "", new { @readonly = true, Value = DateTime.Now.ToString("dd/MM/yyyy HH:mm") })
                                                <span style="color:red" id="ErrAppDate"></span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row Form_Space_top">
                                        <div class="form-group Form_Input">

                                            <div class="col-md-2-5">
                                                <label>Payment Mode:</label>
                                            </div>
                                            <div class="col-md-1 col_cus_2">
                                                <div class="col-md-1" style="padding-top: 6px;margin-left: -92px;">
                                                    <span id="PMode">

                                                    </span>

                                                </div>

                                            </div>
                                            @*<div class="col-md-3 col_cus_4">
                                                <input class="btn log_Btn_sm" aria-hidden="true" data-toggle="modal" data-target="#Containerdtl" type="button" value="Container Details" />
                                                                        </div>*@
                                            <div class="col-md-offset-2 col-md-3">
                                                <input id="btninvoice" class="btn log_Btn_sm" type="button" value="Generate Invoice" />
                                            </div>
                                        </div>
                                    </div>


                                    <div class="row Form_Space_top Form_Space_bottom">
                                        <div class="col-md-12">
                                            <table id="tblOBL" class="table table-bordered table-striped dataTable">
                                                <thead>
                                                    <tr>
                                                        <th style="width:8%;" class="text-center">Sl No</th>
                                                        <th>OBL/HBL No</th>
                                                        <th>OBL/HBL Date</th>
                                                        <th>Cargo Type</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="row Form_Space_top">
                                        <div class="form-group Form_Input">
                                            <div class="col-md-1-5 col_cus_2">
                                                <label>Importers:</label>
                                            </div>
                                            <div class="col-md-10-5 col_cus_10">
                                                <textarea id="Importers" readonly ></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="Head_h5">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <h5>CWC Charges</h5>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="col-md-12">
                                                <table id="tblCWCCharges" class="table table-bordered table-striped dataTable Table_center">
                                                    <thead>
                                                        <tr>
                                                            <th rowspan="2">Charges</th>
                                                            <th rowspan="2">Value</th>
                                                            <th colspan="2" class="text-center">IGST</th>
                                                            <th colspan="2" class="text-center">CGST</th>
                                                            <th colspan="2" class="text-center">SGST</th>
                                                            <th rowspan="2" style="width:15%;">Total</th>
                                                        </tr>
                                                        <tr>
                                                            <th>%</th>
                                                            <th>Amt</th>
                                                            <th>%</th>
                                                            <th>Amt</th>
                                                            <th>%</th>
                                                            <th style="border-right:1px solid #ddd;">Amt</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                    <tfoot>
                                                        @*<tr>
                                                                 <td colspan="8" style="text-align:right;">Total:</td>
                                                                 <td class="Table_right"><input type="text" id="TOTCWCChrg" value="0" readonly></td>
                                                             </tr>
                                                            <tr>
                                                                 <td colspan="8" style="text-align:right;">TDS %:</td>
                                                                 <td class="Table_right"><input type="text" id="CWCTDSPer" value="0" onblur="CalcInvoice()"></td>
                                                             </tr>
                                                             <tr>
                                                                 <td colspan="8" style="text-align:right;">TDS Amount:</td>
                                                                 <td class="Table_right"><input type="text" id="TOTCWCTDS" value="0" readonly></td>
                                                             </tr>*@
                                                        <tr>
                                                            <td colspan="8" class="text-right">Total:</td>
                                                            <td><input type="text" id="TOTCWCChrg" value="0" class="text-right"></td>
                                                        </tr>
                                                    </tfoot>
                                                </table>
                                            </div>
                                        </div>

                                        @*<div class="row Form_Space_top">
                                                <div class="col-md-12">
                                                    <h5>H & T Charges</h5>
                                                </div>
                                            </div>*@
                                        @*<div class="row Form_Space_top">
                                                                <div class="col-md-12">
                                                                    <table id="tblHTCharges" class="table table-bordered table-striped dataTable Table_center">
                                                                        <thead>
                                                                            <tr>
                                                                                <th rowspan="2">Charges</th>
                                                                                <th rowspan="2">Value</th>
                                                                                <th colspan="2" class="text-center">IGST</th>
                                                                                <th colspan="2" class="text-center">CGST</th>
                                                                                <th colspan="2" class="text-center">SGST</th>
                                                                                <th rowspan="2" style="width:15%;">Total</th>
                                                                            </tr>
                                                                            <tr>
                                                                                <th>%</th>
                                                                                <th>Amt</th>
                                                                                <th>%</th>
                                                                                <th>Amt</th>
                                                                                <th>%</th>
                                                                                <th style="border-right:1px solid #ddd;">Amt</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody></tbody>
                                                                        @*<tfoot>
                                                <tr>
                                                    <td colspan="8" style="text-align:right;">Total:</td>
                                                    <td class="Table_right"><input type="text" id="TOTHTChrg" value="0" readonly></td>
                                                </tr>
                                                <tr>
                                                    <td colspan="8" style="text-align:right;">TDS %:</td>
                                                    <td class="Table_right"><input type="text" id="HTTDSPer" value="0" onblur="CalcInvoice()"></td>
                                                </tr>
                                                <tr>
                                                    <td colspan="8" style="text-align:right;">H&amp;T TDS Amount:</td>
                                                    <td class="Table_right"><input type="text" id="TOTHTTDS" value="0" readonly></td>
                                                </tr>
                                            </tfoot>
                                                                    </table>
                                                                </div>
                                                            </div>*@
                                        <div class="row SignUp_space_bottom2 SignUp_space_top2" style="display:none;">
                                            <div class="col-md-offset-2 col-md-4">
                                                <button id="btnShowHT" type="button" class="btn log_Btn_sm" data-toggle="modal" data-target="#HnTModal">
                                                    <span class="glyphicon glyphicon-search" aria-hidden="true"></span> Show H&amp;T Charges
                                                </button>
                                            </div>
                                            <div class="col-md-4">
                                                <button id="btnAddExtraHT" type="button" class="btn log_Btn_sm" data-toggle="modal" data-target="#NewHnTModal" disabled>
                                                    <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span> Add Extra H&amp;T
                                                </button>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top" style="display:none;">
                                            <div class="col-md-12">
                                                <h5>H & T Charges</h5>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top" style="display:none;">
                                            <div class="col-md-12">
                                                <table id="tblHTCharges" class="table table-bordered table-striped dataTable Table_center">
                                                    <thead>
                                                        <tr>
                                                            <th rowspan="2">Charges</th>
                                                            <th rowspan="2">Value</th>
                                                            <th colspan="2" class="text-center">IGST</th>
                                                            <th colspan="2" class="text-center">CGST</th>
                                                            <th colspan="2" class="text-center">SGST</th>
                                                            <th rowspan="2" style="width:15%;">Total</th>
                                                            <th rowspan="2" class="text-center" style="width:15px;"></th>
                                                        </tr>
                                                        <tr>
                                                            <th>%</th>
                                                            <th>Amt</th>
                                                            <th>%</th>
                                                            <th>Amt</th>
                                                            <th>%</th>
                                                            <th style="border-right:1px solid #ddd;">Amt</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                    <tfoot>
                                                        <tr>
                                                            <td colspan="8" class="text-right">Total:</td>
                                                            <td><input type="text" id="TOTHTChrg" value="0" class="text-right"></td>
                                                            <td></td>
                                                        </tr>
                                                    </tfoot>
                                                </table>
                                            </div>
                                        </div>

                                        <div class="row Form_Space_top">
                                            <div class="col-md-12">
                                                <h5>Total</h5>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-offset-8 col_cus_offset_7 col_cus_2 col-md-1-5">
                                                    <label>Total Value:</label>
                                                </div>
                                                <div class="col-md-2-5 col_cus_3">
                                                    @*@Html.TextBoxFor(m => m.AllTotal, new { @readonly = true })*@
                                                    @Html.TextBox("AllTotal", "0", new { @readonly = true, @style = "text-align:right;" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-offset-8 col_cus_offset_7 col_cus_2 col-md-1-5">
                                                    <label>Round Up:</label>
                                                </div>
                                                <div class="col-md-2-5 col_cus_3">
                                                    @*@Html.TextBoxFor(m => m.RoundUp, new { @onblur = "CalcInvoice()" })*@
                                                    @Html.TextBox("RoundUp", "0", new { @onblur = "CalcInvoice()", @style = "text-align:right;" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-offset-8 col_cus_offset_7 col_cus_2 col-md-1-5">
                                                    <label>Invoice Value:</label>
                                                </div>
                                                <div class="col-md-2-5 col_cus_3">
                                                    @*@Html.TextBoxFor(m => m.InvoiceValue, new { @readonly = true })*@
                                                    @Html.TextBox("InvoiceValue", "0", new { @readonly = true, @style = "text-align:right;" })
                                                </div>
                                            </div>
                                        </div>

                                    </div>


                                    <div class="row">
                                        <div class="stoke SignUp_space_bottom2 SignUp_space_top2"></div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-offset-0-5 col-md-1-5">
                                            <input type="button" class="btn log_Btn_sm" value="Save" id="BtnSaveDelvApp" style="width:100% !important;" />
                                        </div>
                                        <div class="col-md-2">
                                            <input type="button" id="BtnInvoice" class="btn log_Btn_sm" value="Invoice Print" onclick="PrintInvoice()" disabled="disabled" style="width:100% !important;" />
                                        </div>
                                        <div class="col-md-2-5">
                                            <input type="button" id="BtnIssueSlip" class="btn log_Btn_sm" value="Issue Slip Print" onclick="PreviewIssueSlip()" disabled="disabled" style="width:100% !important;" />
                                        </div>
                                        <div class="col-md-1-5">
                                            <input type="button" class="btn log_Btn_sm" value="Reset" onclick="ResetAll()" style="width:100% !important;" />
                                        </div>
                                        <div class="col-md-2-5">
                                            <input type="button" id="btnIRN" disabled class="btn log_Btn_sm" value="Generate IRN"  onclick="GenerateIRN()" style="width:100% !important;" />
                                        </div>
                                      
                                    </div>
                                    <div id="DivDeliveryMsg" class="logSuccMsg" style="background-color:transparent"></div>
                                    <div id="DivDeliveryErrMsg" class="logErrMsg" style="background-color:transparent"></div>
                                </div>

                            }
                            <div class="row">
                                <div class="col-md-2 SignUp_space_bottom">
                                    <input type="button" id="BtnCommodityLoad" value="Show List" class="btn log_Btn_sm" onclick="LoadDeliveryAppList()" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div id="tblEntryDet"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div id="DivDeliveryAppList"></div>
                                </div>
                            </div>
                        </div>
                        <ul class="list-inline pull-right">
                            @*<li><button type="button" class="btn btn-primary next-step">Save and continue</button></li>*@
                            <li><button type="button" id="BtnCont" class="btn btn-primary next-step" disabled style="display:none;">continue</button></li>

                        </ul>
                    </div>

                    <div class="tab-pane" role="tabpanel" id="step2">
                        @if (ViewBag.StuffingReqList != null)
                        {
                            <input type="hidden" id="hdnStuffingReq" value="@ViewBag.StuffingReqList" />
                        }
                        else
                        {
                            <input type="hidden" id="hdnStuffingReq" value="" />
                        }

                        @using (Ajax.BeginForm("AddEditDeliverymergePaymentSheet", "VRN_CWCImport", new AjaxOptions { HttpMethod = "POST", OnSuccess = "PaymentOnSuccess", OnFailure = "PaymentOnFailure" }, new { @Id = "PaymentSheetForm" }))
                        {
                            @Html.AntiForgeryToken()
                            @Html.Hidden("ContainerJson")
                            @Html.Hidden("BOEJson")
                            @Html.Hidden("hdnAddress")
                            @Html.Hidden("hdnState")
                            @Html.Hidden("hdnStateCode")
                            @Html.Hidden("PaymentSheetModelJson")
                            <div class="Head_h4">
                                <div class="row">
                                    <div class="col-md-12">
                                        <h4>Payment Sheet / Invoice</h4>
                                    </div>
                                </div>
                                <div class="row Form_Space_top">
                                    <div class="form-group Form_Input">
                                        <div class="col-md-2-5 col-md-offset-1-5 col_cus_offset_2 col_cus_2">
                                            <div class="boolean-container">
                                                @*@Html.RadioButtonFor(m => m.InvoiceType, "Tax", new { id = "Tax", @checked = true, @onclick = "IVType('Tax')" })*@
                                                @Html.RadioButton("InvoiceType", "Tax", new { id = "Tax", @checked = true, @onclick = "IVType('Tax')" })
                                                <label for="Tax"><i class="circle"></i><span>Tax Invoice</span></label>
                                            </div>
                                        </div>
                                        <div class="col-md-2 col_cus_3">
                                            <div class="boolean-container">
                                                @*@Html.RadioButtonFor(m => m.InvoiceType, "Bill", new { id = "Bill", @onclick = "IVType('Bill')" })*@
                                                @Html.RadioButton("InvoiceType", "Bill", new { id = "Bill", @onclick = "IVType('Bill')" })
                                                <label for="Bill"><i class="circle"></i><span>Bill Of Supply</span></label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row Form_Space_top">
                                    <div class="form-group Form_Input">
                                        <div class="col-md-1-5 col_cus_2">
                                            <label>Invoice No:</label>
                                        </div>
                                        <div class="col-md-2-5">
                                            @*@Html.TextBoxFor(m => m.InvoiceNo, new { @readonly = true })*@
                                            @Html.TextBox("InvoiceNo", "", new { @readonly = true })
                                        </div>
                                        <div class="col-md-1-5 col-md-offset-4 col_cus_offset_3 col_cus_2">
                                            <label>Delivery Date:</label>
                                        </div>
                                        <div class="col-md-2 col_cus_2_5 Date_Img">
                                            <input type="hidden" id="DeliveryDateCheck" />
                                            <input type="hidden" id="DeliAppDate" />
                                            @*@Html.TextBoxFor(m => m.InvoiceDate, new { @readonly = true, Value = DateTime.Today.ToString("dd/MM/yyyy") })*@
                                            @Html.TextBox("InvoiceDate", "", new { @readonly = true, Value = DateTime.Now.ToString("dd/MM/yyyy HH:mm") })
                                            <span style="color:red" id="ErrAppDate"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="row Form_Space_top">
                                    <div class="form-group Form_Input">
                                        <div class="col-md-1-5 col_cus_2 padding_rt">
                                            <label>Application No:</label>
                                        </div>
                                        <div class="col-md-2-5">
                                            @*@Html.HiddenFor(m => m.StuffingReqId)*@
                                            @Html.Hidden("StuffingReqId")
                                            @*@Html.TextBoxFor(m => m.StuffingReqNo, new { @readonly = true })*@
                                            @Html.TextBox("StuffingReqNo", "", new { @readonly = true })
                                            <span class="search" id="stuffingsearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#stuffingModal"></i></span>
                                            @*@Html.ValidationMessageFor(m => m.StuffingReqNo)*@
                                        </div>
                                        <div class="col-md-1-5 col-md-offset-4 col_cus_offset_3 col_cus_2">
                                            <label>Date:</label>
                                        </div>
                                        <div class="col-md-2 col_cus_2_5">
                                            @*@Html.TextBoxFor(m => m.StuffingReqDate, new { @readonly = true })*@
                                            @Html.TextBox("StuffingReqDate", "", new { @readonly = true })
                                        </div>
                                    </div>
                                </div>
                                <div class="row Form_Space_top">
                                    <div class="form-group Form_Input">
                                        <div class="col-md-1-5 col_cus_2">
                                            <label>Party Name:</label>
                                        </div>
                                        <div class="col-md-10-5 col_cus_10">
                                            @*@Html.HiddenFor(m => m.PartyId)*@
                                            @Html.Hidden("PartyId")
                                            @*@Html.TextBoxFor(m => m.PartyName, new { @readonly = true })*@
                                            @Html.TextBox("PartyName", "", new { @readonly = true })
                                            <span class="search" id="Partysearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#PartyModal"></i></span>
                                            @*@Html.ValidationMessageFor(m => m.PartyName)*@
                                        </div>
                                    </div>
                                </div>
                                <div class="row Form_Space_top">
                                    <div class="form-group Form_Input">
                                        <div class="col-md-1-5 col_cus_2">
                                            <label>Payee Name:</label>
                                        </div>
                                        <div class="col-md-10-5 col_cus_10">
                                            @*@Html.HiddenFor(m => m.PayeeId)*@
                                            @Html.Hidden("PayeeId")
                                            @*@Html.TextBoxFor(m => m.PayeeName, new { @readonly = true })*@
                                            @Html.TextBox("PayeeName", "", new { @readonly = true })
                                            <span class="search" id="Payeesearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#PayeeModal"></i></span>
                                            @*@Html.ValidationMessageFor(m => m.PayeeName)*@
                                        </div>
                                    </div>
                                </div>
                                <div class="row Form_Space_top">
                                    <div class="form-group Form_Input">
                                        <div class="col-md-1-5 col_cus_2">
                                            <label> GST No:</label>
                                        </div>
                                        <div class="col-md-4 col_cus_3">
                                            @*@Html.TextBoxFor(m => m.GSTNo, new { @readonly = true })*@
                                            @Html.TextBox("GSTNo", "", new { @readonly = true })
                                        </div>
                                        <div class="col-md-3 col_cus_4">
                                            @*<input class="btn log_Btn_sm" aria-hidden="true" data-toggle="modal" data-target="#Containerdtl" type="button" value="Container Details" />*@
                                        </div>
                                        @*<div class="col-md-3">
                                                <input class="btn log_Btn_sm" aria-hidden="true" data-toggle="modal" data-target="#BOEdtl" type="button" value="OBL Details" />
                                            </div>*@
                                    </div>
                                </div>
                                <div class="row Form_Space_top">
                                    <div class="form-group Form_Input">
                                        <div class="col-md-1-5 col_cus_2">
                                            <label> OT Hours:</label>
                                        </div>
                                        <div class="col-md-2">
                                            @Html.TextBox("OTHours", "0")
                                        </div>
                                        <div class="col-md-1-5 padding_rt">
                                            <label>Payment Mode:</label>
                                        </div>
                                        <div class="col-md-1 col_cus_2">
                                            <div class="col-md-1" style="padding-top: 6px;">
                                                <span id="PMode">

                                                </span>

                                            </div>

                                        </div>
                                        @*<div class="col-md-3 col_cus_4">
                                            <input class="btn log_Btn_sm" aria-hidden="true" data-toggle="modal" data-target="#Containerdtl" type="button" value="Container Details" />
                                                                    </div>*@
                                        <div class="col-md-offset-2 col-md-3">
                                            <input class="btn log_Btn_sm" aria-hidden="true" data-toggle="modal" data-target="#BOEdtl" type="button" value="OBL Details" />
                                        </div>
                                    </div>
                                </div>

                                @*<div class="row Form_Space_top Form_Space_bottom">
                                        <div class="col-md-12">
                                            <table id="tblContainer" class="table table-bordered table-striped dataTable">
                                                <thead>
                                                    <tr>
                                                        <th style="width:8%;" class="text-center">Sl No</th>
                                                        <th>ICD No</th>
                                                        <th>Container No</th>
                                                        <th>Size</th>
                                                        <th>Reefer</th>
                                                        <th>Insured</th>
                                                        <th>Cargo Type</th>
                                                        <th>DO Date</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>*@


                                <div class="row Form_Space_top Form_Space_bottom">
                                    <div class="col-md-12">
                                        <table id="tblOBL" class="table table-bordered table-striped dataTable">
                                            <thead>
                                                <tr>
                                                    <th style="width:8%;" class="text-center">Sl No</th>
                                                    <th>OBL/HBL No</th>
                                                    <th>OBL/HBL Date</th>
                                                    <th>Cargo Type</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="row Form_Space_top">
                                    <div class="form-group Form_Input">
                                        <div class="col-md-1-5 col_cus_2">
                                            <label>Importers:</label>
                                        </div>
                                        <div class="col-md-10-5 col_cus_10">
                                            <textarea id="Importers" readonly ></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="Head_h5">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <h5>CWC Charges</h5>
                                        </div>
                                    </div>
                                    <div class="row Form_Space_top">
                                        <div class="col-md-12">
                                            <table id="tblCWCCharges" class="table table-bordered table-striped dataTable Table_center">
                                                <thead>
                                                    <tr>
                                                        <th rowspan="2">Charges</th>
                                                        <th rowspan="2">Value</th>
                                                        <th colspan="2" class="text-center">IGST</th>
                                                        <th colspan="2" class="text-center">CGST</th>
                                                        <th colspan="2" class="text-center">SGST</th>
                                                        <th rowspan="2" style="width:15%;">Total</th>
                                                    </tr>
                                                    <tr>
                                                        <th>%</th>
                                                        <th>Amt</th>
                                                        <th>%</th>
                                                        <th>Amt</th>
                                                        <th>%</th>
                                                        <th style="border-right:1px solid #ddd;">Amt</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                                <tfoot>
                                                    @*<tr>
                                                             <td colspan="8" style="text-align:right;">Total:</td>
                                                             <td class="Table_right"><input type="text" id="TOTCWCChrg" value="0" readonly></td>
                                                         </tr>
                                                        <tr>
                                                             <td colspan="8" style="text-align:right;">TDS %:</td>
                                                             <td class="Table_right"><input type="text" id="CWCTDSPer" value="0" onblur="CalcInvoice()"></td>
                                                         </tr>
                                                         <tr>
                                                             <td colspan="8" style="text-align:right;">TDS Amount:</td>
                                                             <td class="Table_right"><input type="text" id="TOTCWCTDS" value="0" readonly></td>
                                                         </tr>*@
                                                </tfoot>
                                            </table>
                                        </div>
                                    </div>

                                    @*<div class="row Form_Space_top">
                                            <div class="col-md-12">
                                                <h5>H & T Charges</h5>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="col-md-12">
                                                <table id="tblHTCharges" class="table table-bordered table-striped dataTable Table_center">
                                                    <thead>
                                                        <tr>
                                                            <th rowspan="2">Charges</th>
                                                            <th rowspan="2">Value</th>
                                                            <th colspan="2" class="text-center">IGST</th>
                                                            <th colspan="2" class="text-center">CGST</th>
                                                            <th colspan="2" class="text-center">SGST</th>
                                                            <th rowspan="2" style="width:15%;">Total</th>
                                                        </tr>
                                                        <tr>
                                                            <th>%</th>
                                                            <th>Amt</th>
                                                            <th>%</th>
                                                            <th>Amt</th>
                                                            <th>%</th>
                                                            <th style="border-right:1px solid #ddd;">Amt</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>

                                                </table>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="col-md-12">
                                                <h5>Total</h5>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-offset-8 col_cus_offset_7 col_cus_2 col-md-1-5">
                                                    <label>Total Value:</label>
                                                </div>
                                                <div class="col-md-2-5 col_cus_3">
                                                    @Html.TextBox("AllTotal", "0", new { @readonly = true, @style = "text-align:right;" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-offset-8 col_cus_offset_7 col_cus_2 col-md-1-5">
                                                    <label>Round Up:</label>
                                                </div>
                                                <div class="col-md-2-5 col_cus_3">
                                                    @Html.TextBox("RoundUp", "0", new { @onblur = "CalcInvoice()", @style = "text-align:right;" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-offset-8 col_cus_offset_7 col_cus_2 col-md-1-5">
                                                    <label>Invoice Value:</label>
                                                </div>
                                                <div class="col-md-2-5 col_cus_3">
                                                    @Html.TextBox("InvoiceValue", "0", new { @readonly = true, @style = "text-align:right;" })
                                                </div>
                                            </div>
                                        </div>*@

                                    <section id="rest-charge-details" class="hide">
                                        <div class="row Form_Space_top">
                                            <div class="col-md-12">
                                                <h5>H & T Charges</h5>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="col-md-12">
                                                <table id="tblHTCharges" class="table table-bordered table-striped dataTable Table_center">
                                                    <thead>
                                                        <tr>
                                                            <th rowspan="2">Charges</th>
                                                            <th rowspan="2">Value</th>
                                                            <th colspan="2" class="text-center">IGST</th>
                                                            <th colspan="2" class="text-center">CGST</th>
                                                            <th colspan="2" class="text-center">SGST</th>
                                                            <th rowspan="2" style="width:15%;">Total</th>
                                                            <th rowspan="2" class="text-center" style="width:15px;"></th>
                                                        </tr>
                                                        <tr>
                                                            <th>%</th>
                                                            <th>Amt</th>
                                                            <th>%</th>
                                                            <th>Amt</th>
                                                            <th>%</th>
                                                            <th style="border-right:1px solid #ddd;">Amt</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                    <tfoot>
                                                        <tr>
                                                            <td colspan="8" class="text-right">Total:</td>
                                                            <td><input type="text" id="TOTHTChrg" value="0" class="text-right"></td>
                                                            <td></td>
                                                        </tr>
                                                    </tfoot>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-offset-8 col-md-1-5">
                                                    <label>Total Value:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("AllTotal", "0", new { @readonly = true, @style = "text-align:right;" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-offset-8 col-md-1-5">
                                                    <label>Round Up:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("RoundUp", "0", new { @style = "text-align:right;" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row Form_Space_top">
                                            <div class="form-group Form_Input">
                                                <div class="col-md-offset-8 col-md-1-5">
                                                    <label>Invoice Value:</label>
                                                </div>
                                                <div class="col-md-2-5">
                                                    @Html.TextBox("InvoiceValue", "0", new { @readonly = true, @style = "text-align:right;" })
                                                </div>
                                            </div>
                                        </div>
                                    </section>

                                </div>

                                <div class="row SignUp_space_bottom SignUp_space_top">
                                    <div class="stoke"></div>
                                </div>
                                <div class="logSuccMsg Form_Space_bottom" id="DivPaySheetCargoMsg" style="background-color:transparent"></div>
                                <div class="row SignUp_space_bottom2">
                                    <div class="col-md-offset-3 col-md-2">
                                        <input type="button" id="savbtn" value="Save" onclick="BindJson()" class="btn log_Btn_sm" />
                                    </div>
                                    <div class="col-md-2">
                                        <input type="button" value="Reset" class="btn log_Btn_sm" onclick="ResetField()" />
                                    </div>
                                    <div class="col-md-2">
                                        <input type="button" value="Print" class="btn log_Btn_sm" onclick="PrintInvoice()" id="btnPrint" disabled />
                                    </div>
                                </div>
                            </div>
                        }

                        <ul class="list-inline pull-right">
                            <li><button type="button" class="btn btn-default prev-step">Previous</button></li>
                            <li><button type="button" id="BtnContPay" class="btn btn-primary next-step" disabled>continue</button></li>
                        </ul>
                    </div>

                    <div class="tab-pane" role="tabpanel" id="complete">
                        @{
                            AjaxOptions options = new AjaxOptions();
                            options.Confirm = "Are You Sure You Want To Save?";
                            options.OnSuccess = "IssueSlipOnSuccess";
                            options.OnFailure = "IssueSlipOnFailure";
                            options.InsertionMode = InsertionMode.InsertAfter;
                        }
                        <div class="Head_h4">
                            @using (Ajax.BeginForm("AddEditMergeIssueSlip", "VRN_CWCImport", options))
                            {
                                @Html.AntiForgeryToken()
                                <div id="DivAddIssueSlip">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <h4>Invoice Checking</h4>
                                        </div>
                                    </div>
                                    <div class="row Form_Space_top">
                                        <div class="form-group Form_Input">
                                            <div class="col-md-1-5 col_cus_2 padding_rt">
                                                <label>Issue Slip No:</label>
                                            </div>
                                            <div class="col-md-2-5">

                                                @Html.Hidden("IssueSlipIdValue")
                                                @Html.TextBoxFor(m => m.IssueSlip.IssueSlipNo, "", new { @class = "form-control input-sm", @readonly = true })

                                            </div>
                                            <div class="col-md-1-5 col-md-offset-4 col_cus_offset_3 col_cus_2 padding_rt">
                                                <label>Issue Slip Date:</label>
                                            </div>
                                            <div class="col-md-2 col_cus_2_5 Date_Img">
                                                @Html.TextBoxFor(m => m.IssueSlip.IssueSlipDate, new { @class = "form-control input-sm", @readonly = true, Value = DateTime.Now.ToString("dd-MM-yyyy") })
                                                @Html.ValidationMessageFor(m => m.IssueSlip.IssueSlipDate, "", new { @class = "Error_Msg" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row Form_Space_top">
                                        <div class="form-group Form_Input">
                                            <div class="col-md-1-5 col_cus_2">
                                                <label>Invoice No:</label>
                                            </div>
                                            <div class="col-md-2-5">
                                                @Html.HiddenFor(m => m.IssueSlip.InvoiceId)
                                                @Html.TextBoxFor(m => m.IssueSlip.InvoiceNo, new { @class = "form-control input-sm", @readonly = true })
                                                <span class="search"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#InvoiceModal"></i></span>
                                                @Html.ValidationMessageFor(m => m.IssueSlip.InvoiceNo, "", new { @class = "Error_Msg" })
                                            </div>
                                            <div class="col-md-1-5 col-md-offset-4 col_cus_offset_3 col_cus_2">
                                                <label>Invoice Date:</label>
                                            </div>
                                            <div class="col-md-2 col_cus_2_5">
                                                @Html.TextBoxFor(m => m.IssueSlip.InvoiceDate, new { @class = "form-control input-sm", @readonly = true })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row Form_Space_top">
                                        <div class="form-group Form_Input">
                                            <div class="col-md-1-5 col_cus_2 padding_rt">
                                                <label>Cargo Description:</label>
                                            </div>
                                            <div class="col-md-10-5 col_cus_10">
                                                @Html.TextAreaFor(m => m.IssueSlip.CargoDescription, new { @style = "width:100%;height:100px" })
                                                @Html.ValidationMessageFor(m => m.IssueSlip.CargoDescription, "", new { @class = "Error_Msg" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row Form_Space_top">
                                        <div id="DivTblContainer" class="col-md-12">
                                            <table class="table table-striped table-bordered dataTable" id="TblContainer" style="width:100%;">
                                                <thead>
                                                    <tr>
                                                        <th colspan="7">Container / CBT Details</th>
                                                    </tr>
                                                    <tr>
                                                        <th>@Html.DisplayName("ICD No")</th>
                                                        <th>@Html.DisplayName("Container / CBT No")</th>
                                                        <th style="width:10%;">@Html.DisplayName("Size")</th>
                                                        <th style="width:15%;">@Html.DisplayName("Gross Wt(Kg)")</th>
                                                        <th style="width:15%;">@Html.DisplayName("CIF Value")</th>
                                                        <th style="width:15%;">@Html.DisplayName("Duty")</th>
                                                        <th style="width:15%;">@Html.DisplayName("Total")</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div id="DivTblCargo" class="col-md-12">
                                            <table class="table table-striped table-bordered dataTable" id="TblCargo" style="width:100%;">
                                                <thead>
                                                    <tr>
                                                        <th colspan="7">Cargo Details</th>
                                                    </tr>
                                                    <tr>
                                                        <th style="width:15%;">@Html.DisplayName("OBL / HBL No")</th>
                                                        <th>@Html.DisplayName("Cargo Description")</th>
                                                        <th style="width:15%;">@Html.DisplayName("Godown No")</th>
                                                        <th>@Html.DisplayName("Location")</th>
                                                        <th>@Html.DisplayName("Stack No")</th>
                                                        <th>@Html.DisplayName("Area")</th>
                                                        <th style="width:10%;">@Html.DisplayName("Net Wt")</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="stoke SignUp_space_bottom2 SignUp_space_top2"></div>
                                </div>

                                <div class="row">
                                    <div class="col-md-offset-4 col-md-2 SignUp_space_bottom">
                                        <input type="submit" class="btn log_Btn_sm" value="Save" id="BtnSaveIssueSlip" />
                                    </div>
                                    <div class="col-md-2">
                                        <input type="button" class="btn log_Btn_sm" value="Reset" onclick="ResetAllFields()" />
                                    </div>

                                    <div class="col-md-2">
                                        <input type="button" value="Print" class="btn log_Btn_sm" onclick="PreviewIssueSlip()" id="btnissuePrint" disabled />
                                    </div>
                                    @*<div class="col-md-2">
                                            <input type="button" class="btn log_Btn_sm" value="Preview"  />
                                        </div>*@
                                  
                                </div>
                                <div class="logSuccMsg" style="background-color:transparent" id="DivIssueSlipMsg"></div>
                                <div class="logErrMsg Form_Space_bottom" style="background-color:transparent" id="DivIssueSlipErrMsg"></div>
                            }

                            <div class="row">
                                <div class="col-md-12">
                                    <div id="DivIssueSlipList"></div>
                                </div>
                            </div>
                        </div>

                        <ul class="list-inline pull-right">
                            <li><button type="button" id="BtnDone" onclick="resetfield()" class="btn btn-success" disabled><i class="fa fa-check"></i> Done!</button></li>
                        </ul>
                    </div>
                    <div class="clearfix"></div>
                </div>
                @*</form>*@
            </div>
        </div>
    </div>
</div>

<!--------------------------------- DELIVERY APPLICATION MODAL --------------------------------->

<div id="DestuffingEntryNoModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Destuffing Entry No</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="DestuffingEntrybox" type="text" />
                <ul class="navList" id="DestuffingEntryNoList">
                    @*@{
                        if (ViewBag.DestuffingEntryNoList != null)
                        {
                            foreach (var item in ViewBag.DestuffingEntryNoList)
                            {
                                        <li id="@item.DestuffingId">@item.DestuffingEntryNo</li>
                                                }
                                            }
                                        }*@
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="BOELineNoModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of OBL/HBL-Line No</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="BOELineNobox" type="text" />
                <ul class="navList" id="BOELineNoList"></ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="CHADtlModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" onclick="CloseCHA()"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List Of CHA</h4>
            </div>
            <div class="modal-body popup_body" style="position:relative;">
                <input placeholder="Search By CHA Name Or Party Code" id="Chabox" type="text" />
                <span class="search" style="top: 18px;"><i class="fa fa-search" aria-hidden="true" onclick="SearchChaByPartyCode()"></i></span>

                <table class="table table-striped table-bordered dataTable tblhd" style="width:100%; margin:0 !important; border-bottom:0; padding:0;">
                    <thead>
                        <tr>
                            <th colspan="8" width="80%">Shipping Line Name</th>
                            <th colspan="4" width="20%">Party Code</th>
                        </tr>
                    </thead>
                </table>
                <div id="slim_scroll">
                    <table class="table dataTable table-bordered table-striped slim_tble" id="tbleCha">
                        @*@{
                                if (ViewBag.lstCHA != null)
                                {
                                    foreach (var item in ViewBag.lstCHA)
                                    {
                            <tr onclick="SelectCHA(@item.CHAId,'@item.CHAName')">
                                <td colspan="8" width="80%" class="txt_wrp">@item.CHAName</td>
                                <td colspan="4" width="20%" class="txt_wrp">@item.PartyCode</td>
                            </tr>
                                    }
                                }
                            }*@
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-6">

                        <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreCHA()" class="btn log_Btn_sm" id="btnLoadCHA">Load More Data</button>

                    </div>
                    <div class="col-md-6">
                        <button type="button" class="btn log_Btn_sm" onclick="CloseCHA()">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="IssuePartyModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of issued by</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="Issuebox" type="text" />
                <ul class="navList" id="lstIssue">
                    @*@{
                        foreach (var item in Model.lstGodownList)
                        {
                        <li id="@item.GodownId">@item.GodownName</li>
                        }
                        }*@
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="CargoPartyModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of cargo delivered to</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="Cargobox" type="text" />
                <ul class="navList" id="lstCargo">
                    @*@{
                        foreach (var item in Model.lstGodownList)
                        {
                        <li id="@item.GodownId">@item.GodownName</li>
                        }
                        }*@
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="ImporterModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Importer</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="Impbox" type="text" />
                <ul class="navList" id="lstImp">
                    @*@{
                            if (ViewBag.ImporterList != null)
                            {
                                foreach (var data in ViewBag.ImporterList)
                                {
                        <li id="@data.Value">@data.Text</li>
                                }
                            }
                        }*@
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!--------------------------------- GODOWN INVOICE MODAL --------------------------------->

<div id="stuffingModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Delivery Application No.</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="stuffingbox" type="text" />
                <ul class="navList" id="lststuffing">
                    @*@{
                        foreach (var item in Model.lstGodownList)
                        {
                        <li id="@item.GodownId">@item.GodownName</li>
                        }
                        }*@
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@*<div id="PartyModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content popup_modal">
                <div class="modal-header popup_header">
                    <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                    <h4 class="modal-title">List of Party</h4>
                </div>
                <div class="modal-body popup_body">
                    <input placeholder="Search Me" id="Partybox" type="text" />
                    <ul class="navList" id="lstParty">
                        @*{
                            foreach (var item in Model.lstGodownList)
                            {
                            <li id="@item.GodownId">@item.GodownName</li>
                            }
                            }
                    </ul>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-md-offset-6 col-md-6">
                            <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>*@

<div class="modal fade" id="PartyModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" onclick="CloseParty()"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Party</h4>
            </div>
            <div class="modal-body popup_body" style="position:relative;">
                <input placeholder="Search By Party Name Or Party Code" id="Partybox" type="text" />
                <span class="search" style="top: 18px;"><i class="fa fa-search" aria-hidden="true" onclick="SearchPartyByPartyCode()"></i></span>
                <table class="table table-striped table-bordered dataTable tblhd" style="width:100%; margin:0 !important; border-bottom:0; padding:0;">
                    <thead>
                        <tr>
                            <th colspan="8" width="80%">Party Name</th>
                            <th colspan="4" width="20%">Party Code</th>
                        </tr>
                    </thead>
                </table>
                <div id="slim_scroll">
                    <table class="table dataTable table-bordered table-striped slim_tble" id="tbleParty">
                        <tbody>
                            @*@{
                                    if (ViewBag.lstParty != null)
                                    {
                                        foreach (var item in ViewBag.lstParty)
                                        {
                                <tr onclick="SelectParty(@item.PartyId,'@item.PartyName','@item.Address','@item.StateName','@item.StateCode','@item.GSTNo')">
                                    <td colspan="8" width="80%" class="txt_wrp">@item.PartyName</td>
                                    <td colspan="4" width="20%" class="txt_wrp">@item.PartyCode</td>
                                </tr>
                                        }
                                    }
                                }*@
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-6">
                        @if (ViewBag.State != null && Convert.ToBoolean(ViewBag.State) == true)
                        {
                            <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreParty()" class="btn log_Btn_sm" id="btnLoadMore">Load More Data</button>
                        }
                        else
                        {
                            <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreParty()" class="btn log_Btn_sm" id="btnLoadMore" disabled>Load More Data</button>
                        }
                    </div>
                    <div class="col-md-6">
                        <button type="button" class="btn log_Btn_sm" onclick="CloseParty()">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="PayeeModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" onclick="ClosePayee()"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Payee</h4>
            </div>
            <div class="modal-body popup_body" style="position:relative;">
                <input placeholder="Search By Payee Name Or Payee Code" id="Payeebox" type="text" />
                <span class="search" style="top: 18px;"><i class="fa fa-search" aria-hidden="true" onclick="SearchPayeeByPayeeCode()"></i></span>
                <table class="table table-striped table-bordered dataTable tblhd" style="width:100%; margin:0 !important; border-bottom:0; padding:0;">
                    <thead>
                        <tr>
                            <th colspan="8" width="80%">Payee Name</th>
                            <th colspan="4" width="20%">Payee Code</th>
                        </tr>
                    </thead>
                </table>
                <div id="slim_scroll_1">
                    <table class="table dataTable table-bordered table-striped slim_tble" id="tblePayee">
                        <tbody>
                            @*@{
                                    if (ViewBag.lstParty != null)
                                    {
                                        foreach (var item in ViewBag.lstParty)
                                        {
                                <tr onclick="SelectPayee(@item.PartyId,'@item.PartyName')">
                                    <td colspan="8" width="80%" class="txt_wrp">@item.PartyName</td>
                                    <td colspan="4" width="20%" class="txt_wrp">@item.PartyCode</td>
                                </tr>
                                        }
                                    }
                                }*@
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-6">

                        <button type="button" style="width:100%; margin-left:0;" onclick="LoadMorePayee()" class="btn log_Btn_sm" id="btnLoadMorePayee">Load More Data</button>

                    </div>
                    <div class="col-md-6">
                        <button type="button" class="btn log_Btn_sm" onclick="ClosePayee()">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<div class="modal fade" id="PartyGstModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" onclick="ClosePartyGst()"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Party</h4>
            </div>
            <div class="modal-body popup_body" style="position:relative;">
                <input placeholder="Search By Payee Name Or Payee Code" id="PartyGstbox" type="text" />
                <span class="search" style="top: 18px;"><i class="fa fa-search" aria-hidden="true" onclick="SearchPartyByPayeeCode()"></i></span>
                <table class="table table-striped table-bordered dataTable tblhd" style="width:100%; margin:0 !important; border-bottom:0; padding:0;">
                    <thead>
                        <tr>
                            <th colspan="8" width="80%">Party Name</th>
                            <th colspan="4" width="20%">Party Code</th>
                        </tr>
                    </thead>
                </table>
                <div id="slim_scroll_2">
                    <table class="table dataTable table-bordered table-striped slim_tble" id="tblePartyGst">
                        <tbody>
                            @*@{
                                    if (ViewBag.lstParty != null)
                                    {
                                        foreach (var item in ViewBag.lstParty)
                                        {
                                <tr onclick="SelectPayee(@item.PartyId,'@item.PartyName')">
                                    <td colspan="8" width="80%" class="txt_wrp">@item.PartyName</td>
                                    <td colspan="4" width="20%" class="txt_wrp">@item.PartyCode</td>
                                </tr>
                                        }
                                    }
                                }*@
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-6">

                        <button type="button" style="width:100%; margin-left:0;" onclick="LoadMorePartyGst()" class="btn log_Btn_sm" id="btnLoadMorePayee">Load More Data</button>

                    </div>
                    <div class="col-md-6">
                        <button type="button" class="btn log_Btn_sm" onclick="ClosePartyGst()">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@*<div id="PayeeModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content popup_modal">
                <div class="modal-header popup_header">
                    <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                    <h4 class="modal-title">List of Payee</h4>
                </div>
                <div class="modal-body popup_body">
                    <input placeholder="Search Me" id="Payeebox" type="text" />
                    <ul class="navList" id="lstPayee">
                        @*{
                            foreach (var item in Model.lstGodownList)
                            {
                            <li id="@item.GodownId">@item.GodownName</li>
                            }
                            }
                    </ul>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-md-offset-6 col-md-6">
                            <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>*@
<div id="Containerdtl" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal" onclick="ContainerSelect();"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Container</h4>
            </div>
            <div class="modal-body popup_body">
                @*<input placeholder="Search Me" id="cfscode" type="text" />
                    <ul class="navList" id="lstcfscode">

                        @{
                        foreach (var item in Model.lstGodownList)
                        {
                        <li id="@item.GodownId">@item.GodownName</li>
                        }
                        }
                    </ul>*@
                <table id="lstcfsCode" class="table table-bordered">
                    <tbody></tbody>
                </table>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal" onclick="ContainerSelect();">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="BOEdtl" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal" onclick="BOESelect();"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of OBL/HBL No.</h4>
            </div>
            <div class="modal-body popup_body">
                @*<input placeholder="Search Me" id="cfscode" type="text" />
                    <ul class="navList" id="lstcfscode">

                        @{
                        foreach (var item in Model.lstGodownList)
                        {
                        <li id="@item.GodownId">@item.GodownName</li>
                        }
                        }
                    </ul>*@
                <table id="lstBOENo" class="table table-bordered slim_tble">
                    <tbody></tbody>
                </table>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal" onclick="BOESelect();">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="HnTModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of H&amp;T Charges</h4>
            </div>
            <div class="modal-body popup_body">
                @*<input placeholder="Search Me" id="stuffingbox" type="text" />*@
                <ul class="navList" id="lstHT">
                    @*@{
                        foreach (var item in Model.lstGodownList)
                        {
                        <li id="@item.GodownId">@item.GodownName</li>
                        }
                        }*@
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal" onclick="BindHnTCharges()">OK</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="NewHnTModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of H&amp;T Charges</h4>
            </div>
            <div class="modal-body popup_body">
                @*<input placeholder="Search Me" id="stuffingbox" type="text" />*@
                <ul class="navList" id="lstNewHT">
                    @*@{
                        foreach (var item in Model.lstGodownList)
                        {
                        <li id="@item.GodownId">@item.GodownName</li>
                        }
                        }*@
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal" onclick="AddHnTCharges()">OK</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--------------------------------- INVOICE CHECKING MODAL --------------------------------->

<div class="modal fade" id="InvoiceModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Invoice No</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="InvoiceBox" type="text" />
                <ul class="navList" id="InvoiceList">
                    @{
                        if (ViewBag.InvoiceNoList != null)
                        {
                            foreach (var item in ViewBag.InvoiceNoList)
                            {
                                <li id="@item.Value">@item.Text</li>
                            }
                        }
                    }
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



@Scripts.Render("~/bundles/jqueryval")

<script type="text/javascript">
    $(document).ready(function () {
        //Initialize tooltips
        $('.nav-tabs > li a[title]').tooltip();

        //Wizard
        $('a[data-toggle="tab"]').on('show.bs.tab', function (e) {

            var $target = $(e.target);

            if ($target.parent().hasClass('disabled')) {
                return false;
            }
        });

        $(".next-step").click(function (e) {

            var $active = $('.wizard .nav-tabs li.active');
            $active.next().removeClass('disabled');
            nextTab($active);

        });
        $(".prev-step").click(function (e) {

            var $active = $('.wizard .nav-tabs li.active');
            prevTab($active);

        });

        $('#DeliveryDateCheck').val(new Date());
        TimeInSeconds = 5000;
        //$("#InvoiceDate").datepicker({
        //    dateFormat: "dd/mm/yy",
        //    showOn: "button",
        //    buttonImage: "/Content/images/calendar.png",
        //    buttonImageOnly: true,
        //    buttonText: "Select date",
        //    changeMonth: true,
        //    changeYear: true,
        //    showAnima: "fadein",
        //    onClose: function () {
        //        $(".Date_Img .Error_Msg").text("");
        //        $('[data-valmsg-for="Data"]').html('<span></span>');
        //    }
        //});

        $('#InvoiceDate').datetimepicker({
            showOn: "button",
            buttonImage: "/Content/images/calendar.png",
            buttonImageOnly: true,
            dateFormat: "dd/mm/yy",
            altField: "#slider_example_4andHalf_alt",
            altFieldTimeOnly: false,
            onSelect: function (dateText) {
                dateText = $('#InvoiceDate').datepicker({ dateFormat: 'MM/dd/yyyy' }).val();
                var dt = dateText.split("/");
                var dt1 = dt[1] + "/" + dt[0] + "/" + dt[2];

                $('#DeliveryDateCheck').val(dt1);
            },
            onClose: function () {
                $(".Date_Img .Error_Msg").text("");
                $('[data-valmsg-for="Data"]').html('<span></span>');
            }
        });




    });

    function nextTab(elem) {
        $(elem).next().find('a[data-toggle="tab"]').click();
    }
    function prevTab(elem) {
        $(elem).prev().find('a[data-toggle="tab"]').click();
    }
</script>

<!--------------------------------- DELIVERY APPLICATION SCRIPT --------------------------------->
<script type="text/javascript" src="/scripts/jquery.nicescroll.min.js"></script>
<script type="text/javascript">
    var old_html="";
    $(function () {
        $('#slim_scroll').slimScroll({
            allowPageScroll: true
        });
        $('#slim_scroll_1').slimScroll({
            allowPageScroll: true
        });
        $('#slim_scroll_2').slimScroll({
            allowPageScroll: true
        });
        old_html = $("#DivDeliveryAppDetails").html();
    });

</script>

<script>
    $('#OOC_BOEDATE').datepicker({
        showOn: "button",
        buttonImage: "/Content/images/calendar.png",
        buttonImageOnly: true,
        dateFormat: "dd/mm/yy",
        altField: "#slider_example_4andHalf_alt",
        altFieldTimeOnly: false,
        onClose: function () {
            $(".Date_Img .Error_Msg").text("");
            $('[data-valmsg-for="Data"]').html('<span></span>');
        }
    });

    $('#ValidDate').datepicker({
        showOn: "button",
        buttonImage: "/Content/images/calendar.png",
        buttonImageOnly: true,
        dateFormat: "dd/mm/yy",
        altField: "#slider_example_4andHalf_alt",
        altFieldTimeOnly: false,
        onClose: function () {
            $(".Date_Img .Error_Msg").text("");
            $('[data-valmsg-for="Data"]').html('<span></span>');
        }
    });
    var ArrayOfDeliveryApp = [];
    var ArrayOfDeliveryOrd = [];
    $(function () {
        GenerateBlankTable();
        $('#SearchBOELineNo').css("display", "none");
        $('#TblDeliveryAppDtl').hide();
        $('#TblDeliveryAppOrd').hide();
        $('#BtnSaveDelvApp').attr("disabled",false);
        //LoadDeliveryAppList();
    });
    function LoadDeliveryAppList() {
        $('#tblEntryDet').html('');
        $('#DivDeliveryAppList').load('/Import/VRN_CWCImport/ListOfMergeDeliveryApplication');
    }
    function ResetAll() {
        debugger;
        $('#DivBody').load('/Import/VRN_CWCImport/MergeSingleDeliAppPaymentSheetIssueSlip');

        //  ArrayOfDeliveryApp = [];
        //  ArrayOfDeliveryOrd = [];
        //   $('[data-valmsg-for]').html('<span><span>');
        //  $('#DivCreateDeliveryApp').find('input:text,textarea').val('');
        //   $('#DivCreateDeliveryApp').find('input:hidden').val('');
        //$('#DeliveryOrderNo,#Value,#Duty,#CHAId,#Importer,#WorkOrderNo,#WorkOrderDate,#BondBOENo,#BondBOEDate,#WRNo,#WRDate,#GodownName,#CargoDescription,#SacNo,#SacDate,#Units,#Weight,#GodownId,#SpaceAppId,#ClosingUnits,#ClosingWeight,#Remarks').val('');
        //   $('#DivDeliveryMsg,#DivDeliveryErrMsg').html('');
        //   $('#TblDeliveryAppDtl,#TblDeliveryAppOrd').html('');
        //   $('#tblOBL,#tblCWCCharges,#tblHTCharges').html('');
        //   $('#PMode').html('');
        //   $('#BtnSaveDelvApp').attr("disabled",false);
        //   $('#BtnInvoice').attr("disabled",true);
        //   $('#BtnIssueSlip').attr("disabled",true);
    }



    var PartyDet = "";
    $('#IssuePartySearch').on("click", function () {
        debugger;
        $.ajax({
            url: '@Url.Action("ListOfIssueParty", "VRN_CWCImport", new { Area = "Import" })',
            dataType: 'JSON',
            type: 'GET',
            success: function (data) {
                debugger;
                PartyDet = data;
                var html = '';
                $.each(data, function (i, item) {
                    html += '<li id="' + item.IssueBy + '" " onclick="GetIssue(this)">' + item.IssueBy + '</li>';
                });
                $('#lstIssue').html(html);
            }
        });

    });
    function GetIssue(elem) {
        debugger;
        $('#IssuedBy').val($(elem).text());




        $("#IssuePartyModal").modal("hide");
    }

    $('#Issuebox').keyup(function () {
        var val = $(this).val().toLowerCase();
        if (val == "")
            $('#lstIssue > li').show();
        else {
            $('#lstIssue > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(val) >= 0 ? $(this).show() : $(this).hide());
            });
        }
    });

    $('#BOELineNobox').keyup(function () {
        var val = $(this).val().toLowerCase();
        if (val == "")
            $('#BOELineNoList > li').show();
        else {
            $('#BOELineNoList > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(val) >= 0 ? $(this).show() : $(this).hide());
            });
        }
    });

    $('#CargoPartySearch').on("click", function () {
        debugger;
        $.ajax({
            url: '@Url.Action("ListOfCargoParty", "VRN_CWCImport", new { Area = "Import" })',
            dataType: 'JSON',
            type: 'GET',
            success: function (data) {
                debugger;
                PartyDet = data;
                var html = '';
                $.each(data, function (i, item) {
                    html += '<li id="' + item.IssueBy + '" " onclick="GetCargo(this)">' + item.IssueBy + '</li>';
                });
                $('#lstCargo').html(html);
            }
        });

    });
    function GetCargo(elem) {
        debugger;
        $('#CargsDelivered').val($(elem).text());




        $("#CargoPartyModal").modal("hide");
    }

    $('#Cargobox').keyup(function () {
        var val = $(this).val().toLowerCase();
        if (val == "")
            $('#lstCargo > li').show();
        else {
            $('#lstCargo > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(val) >= 0 ? $(this).show() : $(this).hide());
            });
        }
    });














    function ValidDt(vtype)
    {
        debugger;
        if(vtype.value=="Open")
        {
            $("#ValidDate").datepicker("option", "disabled", true);
            $("#ValidDate").val("");




        }
        else
        {

            $("#ValidDate").datepicker("option", "disabled", false);
        }
    }
    function GetCfcValue()
    {
        debugger;
        var BOE = $('#OOC_BOENo').val();
        var BOEDT = $('#OOC_BOEDATE').val();
        //if ($('#OOC_BOEDATE').val() == "") {
        //alert("Select BOE Date");
        //}
        //else {
        var DT = BOEDT.split(",");
        var BOED = DT[0];

        $.ajax({
            url: '/Import/VRN_CWCImport/GetCIFFromOOC',
            type: 'GET',
            data: {
                BOE: BOE,
                BOEDT: BOED

            },
            dataType: 'JSON',
            success: function (data) {
                debugger;

                if (data.Status == 1) {

                    var cif = data.Data.CIF;
                    var duty = data.Data.Duty;
                    var ExistCif = $('#CIF').val();
                    var ExistDuty = $('#Duty').val();
                    $('#OOC_BOEDATE').val(data.Data.BOE_DATE);
                    if (ExistCif == '0') {
                        $('#CIF').val(cif);
                        $('#Duty').val(duty);
                        $('#DelCIF').val(cif);
                        $('#DelDuty').val(duty);
                        //$('#OOC_BOEDATE').val(data.Data.BOE_DATE);
                    }

                }
            }
        });

        //}

    }


    $('#Impbox').keyup(function () {
        debugger;
        var val = $(this).val().toLowerCase();
        if (val == "")
            $('#lstImp > li').show();
        else {
            $('#lstImp > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(val) >= 0 ? $(this).show() : $(this).hide());
            });
        }
    });
    $('#lstImp > li').on("click", function () {
        debugger;
        $('#Importer').val($(this).text());
        $('#ImporterId').val($(this).attr('id'));
        $("#ImporterModal").modal("hide");
    });

    $('#DestuffingEntrybox').keyup(function () {
        var valThis = $(this).val().toLowerCase();
        if (valThis == "") {
            $('#DestuffingEntryNoList > li').show();
        } else {
            $('#DestuffingEntryNoList > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(valThis) >= 0) ? $(this).show() : $(this).hide();
            });
        };
    });
    $('#DestuffingEntryNoList li').on("click", function () {
        debugger;
        ResetDeliveryAppDet();
        ArrayOfDeliveryApp = [];
        ArrayOfDeliveryOrd = [];
        $('#TblDeliveryAppDtl').hide();
        $('#TblDeliveryAppOrd').hide();
        $('#TblDeliveryAppDtl').html('');
        $('#TblDeliveryAppOrd').html('');
        $('#DestuffingEntryNo').val($(this).text().split('(')[0]);
        $('#DestuffingId').val($(this).attr('id'));
        var DestuffingId = $(this).attr('id')
        // var hdnDestuffingEntryNoList = $('#hdnDestuffingEntryNoList').val();
        var model = @Html.Raw(Json.Encode(ViewBag.DestuffingEntryNoList));
        var Destuffing = $.grep(model, function (item) { return item.DestuffingId == DestuffingId;})[0];
        //$('#ImporterId').val(Destuffing.ImporterId);
        //$('#Importer').val(Destuffing.ImporterName);

        $("#DestuffingEntryNoModal").modal("hide");
        GetBOELineNo(DestuffingId);
    });

    //function FillDetails() {
    //    var DestuffingId = $('#DestuffingId').val();
    //    if (SpaceAppId > 0) {
    //        $.ajax({
    //            url: '/Import/Kol_CWCImport/GetBOENoForDeliveryApp',
    //            type: 'GET',
    //            data: { SpaceAppId: SpaceAppId },
    //            dataType: 'JSON',
    //            success: function (data) {
    //                debugger;
    //                if (data.Status == 1) {
    //                    $('#BondBOENo').val(data.Data.BondBOENo);
    //                    $('#BondBOEDate').val(data.Data.BondBOEDate);
    //                    $('#SacDate').val(data.Data.SacDate);
    //                    $('#CHAId').val(data.Data.CHAId);
    //                    $('#Importer').val(data.Data.Importer);
    //                    GetDepositNo(SpaceAppId);
    //                }
    //            }
    //        });
    //    }
    //}
    function GenerateBlankTable() {
        tablehtml = '';
        var tablehtml = '<table id="tblEntryDet" class="table table-striped table-bordered dataTable" style="width:100%;"><thead><tr><th class="text-center">SL No</th><th>Invoice Date</th><th>Delivery No</th><th>Invoice No</th><th>PartyName</th><th>PayeeName</th><th>Invoice</th><th>Issue Slip</th></tr></thead><tbody>';
        tablehtml += '</tbody></table>';
        $('#tblEntryDet').html(tablehtml);
    }


    function GetBOE(elem) {
        debugger;
        $('#DeliApp_DestuffingEntryNo').val($(elem).text().split('(')[0]);
        $('#DeliApp_DestuffingId').val($(elem).attr('id'));
        var DestuffingId =  $('#DeliApp_DestuffingId').val();
        // var hdnDestuffingEntryNoList = $('#hdnDestuffingEntryNoList').val();
        //  var model = @Html.Raw(Json.Encode(ViewBag.DestuffingEntryNoList));
        //  var Destuffing = $.grep(model, function (item) { return item.DestuffingId == DestuffingId;})[0];
        //$('#ImporterId').val(Destuffing.ImporterId);
        //$('#Importer').val(Destuffing.ImporterName);

        $("#DestuffingEntryNoModal").modal("hide");




        $("#DivDeliveryAppDetails").html(old_html);
        $('#OOC_BOEDATE').datepicker({
            showOn: "button",
            buttonImage: "/Content/images/calendar.png",
            buttonImageOnly: true,
            dateFormat: "dd/mm/yy",
            altField: "#slider_example_4andHalf_alt",
            altFieldTimeOnly: false,
            onClose: function () {
                $(".Date_Img .Error_Msg").text("");
                $('[data-valmsg-for="Data"]').html('<span></span>');
            }
        });
        GetBOELineNo(DestuffingId);


    }



    function GetImporter(elem) {
        debugger;
        $('#DeliApp_Importer').val($(elem).text());
        $('#DeliApp_ImporterId').val($(elem).attr('id'));
        //  var DestuffingId =  $('#DeliApp_DestuffingId').val();
        // var hdnDestuffingEntryNoList = $('#hdnDestuffingEntryNoList').val();
        //  var model = @Html.Raw(Json.Encode(ViewBag.DestuffingEntryNoList));
        //  var Destuffing = $.grep(model, function (item) { return item.DestuffingId == DestuffingId;})[0];
        //$('#ImporterId').val(Destuffing.ImporterId);
        //$('#Importer').val(Destuffing.ImporterName);

        $("#ImporterModal").modal("hide");



        //  GetBOELineNo(DestuffingId);


    }
    function GetBOELineNo(DestuffingId) {
        var Dt = new Date();
        $('#BOELineNoList').html('');


        debugger;
        if (DestuffingId > 0) {
            $.ajax({
                url: '/Import/VRN_CWCImport/GetBOENoForDeliveryApp',
                type: 'GET',
                data: { DestuffingId: DestuffingId },
                dataType: 'JSON',
                success: function (data) {
                    debugger;
                    $('#SearchBOELineNo').css("display", "block");
                    if (data.Status == 1) {
                        var Html = '';
                        $.each(data.Data, function (i, item) {
                            debugger;
                            Html += '<li id=' + item.DestuffingEntryDtlId + ' onclick="FillBOELineNoTxtBox(' + item.DestuffingEntryDtlId + ',&quot;' + item.BOELineNo + '&quot;)">' + item.BOELineNo + '</li>';
                        });
                        $('#BOELineNoList').html(Html);

                        var dd = Dt.getDate(); var mm = Dt.getMonth() + 1;
                        var yyyy = Dt.getFullYear();
                        if (dd < 10) { dd = '0' + dd };
                        if (mm < 10) { mm = '0' + mm };
                        var today = dd + '/' + mm + '/' + yyyy;
                        debugger;
                        $('#OOC_BOEDATE').val(today);
                        $('#DeliApp_CHA').val(data.Data[0].CHA);
                        $('#DeliApp_CHAId').val(data.Data[0].CHAId);
                        $('#DeliApp_PayeeName').val(data.Data[0].CHA);
                        $('#DeliApp_PayeeId').val(data.Data[0].CHAId);

                        $('#DeliApp_PartyName').val(data.Data[0].CHA);
                        $('#DeliApp_PartyId').val(data.Data[0].CHAId);
                    }
                }
            });
        }
    }

    function FillBOELineNoTxtBox(DestuffingEntryDtlId, BOELineNo) {
        debugger;
        $('#BtnAddDeliveryApp').prop("disabled", false);
        $('#BOELineNo').val(BOELineNo);
        var BOELineNoSplit = BOELineNo.split('-');
        $('#BOENo').val(BOELineNoSplit[0]);
        $('#LineNo').val(BOELineNoSplit[1]);
        $('#DestuffingEntryDtlId').val(DestuffingEntryDtlId);
        $("#BOELineNoModal").modal("hide");
        $('[data-valmsg-for="DelNoOfPackages"]').html('<span></span>');
        $('[data-valmsg-for="DelGrossWt"]').html('<span></span>');
        GetBOELineNoDet(DestuffingEntryDtlId);
    }

    function GetBOELineNoDet(DestuffingEntryDtlId) {
        if (DestuffingEntryDtlId > 0) {
            $.ajax({
                url: '/Import/VRN_CWCImport/GetBOEDetForDeliveryApp',
                type: 'GET',
                data: { DestuffingEntryDtlId: DestuffingEntryDtlId },
                dataType: 'JSON',
                success: function (data) {
                    debugger;
                    if (data.Status == 1) {
                        //  $('#Commodity').val(data.Data.Commodity);
                        //  $('#CommodityId').val(data.Data.CommodityId);
                        $('#DeliApp_Importer').val(data.Data.Importer);
                        $('#DeliApp_ImporterId').val(data.Data.ImporterId);
                        $('#GrossWt').val(data.Data.GrossWt);
                        $('#NoOfPackages').val(data.Data.NoOfPackages);
                        $('#SQM').val(data.Data.SQM);
                        //  $('#CUM').val(data.Data.CUM);
                        $('#CIF').val(data.Data.CIF);
                        $('#Duty').val(data.Data.Duty);
                        $('#CargoDescription').val(data.Data.CargoDescription);
                        $('#DelGrossWt').val(data.Data.GrossWt);
                        $('#DelNoOfPackages').val(data.Data.NoOfPackages);
                        $('#DelSQM').val(data.Data.SQM);

                        // $('#DelCUM').val(data.Data.CUM);

                        $('#DelCIF').val(data.Data.CIF);
                        $('#DelDuty').val(data.Data.Duty);
                        $('#OOC_BOENo').val(data.Data.OOC_BOENo);
                        $('#OOC_BOEDATE').val(data.Data.OOC_BOEDATE);
                        $('#IssuedBy').val(data.Data.ShippingLine);
                        //  $('#OblFreeFlag').val(data.Data.OblFreeFlag);
                        $('#DeliApp_ObleFreeFlag').val(data.Data.OblFreeFlag);
                        if (data.Data.OOC_BOENo == "") {

                        }
                        else {

                            GetCfcValue();
                        }
                    }
                }
            });
        }
    }

    function SaveDeliveryAppDtl() {
        debugger;
        if ($('#DelNoOfPackages').val() == '') {
            $('[data-valmsg-for="DelNoOfPackages"]').html('<span>Fill Out This Field</span>');
            return false;
        }
        if ($('#DelNoOfPackages').val() <1) {
            $('[data-valmsg-for="DelNoOfPackages"]').html('<span>Enter No Of Package More Than 0</span>');
            return false;
        }
        if ($('#OOC_BOENo').val() == '') {
            $('[data-valmsg-for="OOC_BOENo"]').html('<span>Fill Out This Field</span>');
            return false;
        }
        if ($('#OOC_BOEDATE').val() == '') {
            $('[data-valmsg-for="OOC_BOEDATE"]').html('<span>Fill Out This Field</span>');
            return false;
        }

        if ($('#DelNoOfPackages').val() == '' ||$('#DelNoOfPackages').val() == '0') {
            $('[data-valmsg-for="DelNoOfPackages "]').html('<span>Fill Out This Field</span>');
            return false;
        }
        if ($('#DelGrossWt').val() == ''||$('#DelGrossWt').val() == '0') {
            $('[data-valmsg-for="DelGrossWt"]').html('<span>Fill Out This Field</span>');
            return false;
        }
        if ($('#DelSQM').val() == '' ||$('#DelSQM').val() == '0') {
            $('[data-valmsg-for="DelSQM"]').html('<span>Fill Out This Field</span>');
            return false;
        }

        if ($('#DelCIF').val() == '' ||$('#DelCIF').val() == '0') {
            $('[data-valmsg-for="DelCIF"]').html('<span>Fill Out This Field</span>');
            return false;
        }
        if ($('#DelDuty').val() == '' ||$('#DelDuty').val() == '0') {
            $('[data-valmsg-for="DelDuty"]').html('<span>Fill Out This Field</span>');
            return false;
        }
        if ( Number($('#DelNoOfPackages').val()) > Number($('#NoOfPackages').val()) ) {
            alert('No Of Packages Should Be Less Than Destuff No Of Packages');
            return false;
        }
        if (Number($('#DelGrossWt').val()) > Number($('#GrossWt').val())) {
            alert('Gross Wt Should Be Less Than Destuff Gross Wt');
            return false;
        }
        //if (Number($('#DelSQM').val()) > Number($('#SQM').val())) {
        //    alert('SQM Should Be Less Than Destuff SQM');
        //    return false;
        //}
        //if (Number($('#DelCUM').val()) > Number($('#CUM').val())) {
        //    alert('CUM Should Be Less Than Destuff CUM');
        //    return false;
        //}
        //if (Number($('#DelCIF').val()) > Number($('#CIF').val())) {
        //    alert('CIF Should Be Less Than Destuff CIF');
        //    return false;
        //}
        //if (Number($('#DelDuty').val()) > Number($('#Duty').val())) {
        //    alert('Duty Should Be Less Than Destuff Duty');
        //    return false;
        //}
        if ($('#DeliApp_ImporterId').val() ==0) {
            alert('Please Select Importer');
            return false;
        }
        $('#DivDeliveryAppTblErrMsg').html('');
        if ($('#BOELineNo').val() != "") {
            var DeliveryAppDtl = {
                "BOELineNo": $('#BOELineNo').val(),
                "DestuffingEntryDtlId": $('#DestuffingEntryDtlId').val(),
                "LineNo": $('#LineNo').val(),
                "BOENo": $('#BOENo').val(),
                "BOL": $('#BOENo').val(),
                "OOC_BOENo": $('#OOC_BOENo').val(),
                "OOC_BOEDATE":$('#OOC_BOEDATE').val(),
                "CargoDescription": $('#CargoDescription').val(),
                "ImporterId": $('#DeliApp_ImporterId').val(),
                "ImporterName": $('#DeliApp_Importer').val(),
                "Commodity": $('#Commodity').val(),
                "NoOfPackages": $('#NoOfPackages').val() == "" ? 0 : $('#NoOfPackages').val(),
                "GrossWt": $('#GrossWt').val() == "" ? 0 : $('#GrossWt').val(),
                "SQM": $('#SQM').val() == "" ? 0 : $('#SQM').val(),
                "CUM": $('#CUM').val() == "" ? 0 : $('#CUM').val(),
                "CIF": $('#CIF').val() == "" ? 0 : $('#CIF').val(),
                "Duty": $('#Duty').val() == "" ? 0 : $('#Duty').val(),
                "DelNoOfPackages": $('#DelNoOfPackages').val() == "" ? 0 : $('#DelNoOfPackages').val(),
                "DelGrossWt": $('#DelGrossWt').val() == "" ? 0 : $('#DelGrossWt').val(),
                "DelSQM": $('#DelSQM').val() == "" ? 0 : $('#DelSQM').val(),
                "DelCUM": $('#DelCUM').val() == "" ? 0 : $('#DelCUM').val(),
                "DelCIF": $('#DelCIF').val() == "" ? 0 : $('#DelCIF').val(),
                "DelDuty": $('#DelDuty').val() == "" ? 0 : $('#DelDuty').val()
                // "CommodityId": $('#CommodityId').val(),
            }
            var flg=0;
            $.each(ArrayOfDeliveryApp, function (i, item) {
                debugger;
                if(item.BOELineNo==$('#BOELineNo').val()){
                    flg=1;
                }
            });
            if(flg==1){
                alert('BOE Line No. is already added');
                return false;
            }
            ArrayOfDeliveryApp.push(DeliveryAppDtl);

            var id=  $('#DestuffingEntryDtlId').val();
            $('#'+id).remove();
            debugger;
            // $('#BOELineNoList #' + $('#DestuffingEntryDtlId').val()).remove();
            ResetDeliveryAppDet();
            GenerateDeliveryAppTable();
            $('#BtnAddDeliveryApp').prop("disabled", true);
        }
        else {
            $('#DivDeliveryAppTblErrMsg').html('Please Select A Deposit No In Order To Add Details');
        }
    }


    function SaveDeliveryOrdDtl() {
        debugger;
        if ($('#IssuedBy').val() == '') {
            $('[data-valmsg-for="IssuedBy"]').html('<span>Fill Out This Field</span>');
            return false;
        }


        if ($('#CargsDelivered').val() == '') {
            $('[data-valmsg-for="CargsDelivered"]').html('<span>Fill Out This Field</span>');
            return false;
        }
        //if ($('#DelGrossWt').val() == '') {
        //    $('[data-valmsg-for="DelGrossWt"]').html('<span>Fill Out This Field</span>');
        //    return false;
        //}
        //if ($('#DelSQM').val() == '') {
        //    $('[data-valmsg-for="DelSQM"]').html('<span>Fill Out This Field</span>');
        //    return false;
        //}
        //if ($('#DelCUM').val() == '') {
        //    $('[data-valmsg-for="DelCUM"]').html('<span>Fill Out This Field</span>');
        //    return false;
        //}
        if ($('#ddlValidType').val() == '') {
            $('#ErrddlValidType').html('Fill Out This Field');

            return false;
        }
        $('#DivDeliveryOrdTblErrMsg').html('');
        var dtvalue = "";
        if ($('#ddlValidType').val() == "Open")
        {
            dtvalue = "";
        }
        else
        {
            dtvalue = $('#ValidDate').val();
        }



        var DeliveryAppDtl = {
            "OrderId": 0,
            "DeliveryNo": 0,
            "IssuedBy": $('#IssuedBy').val(),
            "DeliveredTo": $('#CargsDelivered').val(),
            "ValidType": $('#ddlValidType').val(),
            "ValidDate": dtvalue
            // "CommodityId": $('#CommodityId').val(),
        }
        ArrayOfDeliveryOrd.push(DeliveryAppDtl);
        debugger;
        // $('#BOELineNoList #' + $('#DestuffingEntryDtlId').val()).remove();
        ResetDeliveryOrdDet();
        GenerateDeliveryOrdTable();
        //$('#BtnAddDeliveryOrd').prop("disabled", true);


    }


    function ResetDeliveryAppDet() {
        debugger;
        $('#DivDeliveryAppDetails').find('input:text,textarea').val('');
        $('#CommodityId').val('');
        $('#DestuffingEntryDtlId').val('');
        $('#BOELineNobox').val('');
        $('#SearchBOELineNo').css("display", "block");
        $('#BtnAddDeliveryApp').prop("disabled", true);


    }

    function ResetDeliveryOrdDet() {
        debugger;
        $('[data-valmsg-for="IssuedBy"]').html('');
        $('[data-valmsg-for="CargsDelivered"]').html('');
        $('#ErrddlValidType').html('');
        $('#DivDeliveryOrderDetails').find('input:text,textarea').val('');

        $('#ValidType').val('--Select--');

    }


    function GenerateDeliveryAppTable() {
        debugger;
        $('#TblDeliveryAppDtl').hide();
        var Html = '';
        if (ArrayOfDeliveryApp.length != 0) {
            $.each(ArrayOfDeliveryApp, function (i, item) {
                debugger;
                Html += '<tr><td class="text-center">' + (i + 1) + '</td><td>' + item.BOELineNo + '</td><td>' + item.DelGrossWt + '</td><td class="text-center"><a href="#" onclick="EditDeliveryAppDtl(' + i + ')"><i class="fa fa fa-pencil-square Edit" aria-hidden="true"></i></a></td><td class="text-center"><a href="#" onclick="ViewDeliveryAppDtl(' + i + ')"><i class="fa fa-search-plus" aria-hidden="true"></i></a></td></tr>';
            });
            $('#TblDeliveryAppDtl>tbody').html(Html);
            $('#TblDeliveryAppDtl').show();
        }
    }


    function GenerateDeliveryOrdTable() {
        debugger;
        $('#TblDeliveryAppOrd').hide();
        var Html = '';
        if (ArrayOfDeliveryOrd.length != 0) {
            $.each(ArrayOfDeliveryOrd, function (i, item) {
                debugger;
                Html += '<tr><td class="text-center">' + (i + 1) + '</td><td>' + item.IssuedBy + '</td><td>' + item.DeliveredTo + '</td><td class="text-center"><a href="#" onclick="EditDeliveryOrdDtl(' + i + ')"><i class="fa fa fa-pencil-square Edit" aria-hidden="true"></i></a></td></tr>';
            });
            $('#TblDeliveryAppOrd>tbody').html(Html);
            $('#TblDeliveryAppOrd').show();
        }
    }
    function EditDeliveryAppDtl(Index) {
        debugger;
        $('#DivDeliveryAppTblErrMsg').html('');
        if ($('#BtnAddDeliveryApp').prop("disabled") == true) {
            $('#SearchBOELineNo').css("display", "block");
            $('#BtnAddDeliveryApp').prop("disabled", false);
            $('#DestuffingEntryDtlId').val(ArrayOfDeliveryApp[Index].DestuffingEntryDtlId);
            $('#BOELineNo').val(ArrayOfDeliveryApp[Index].BOELineNo);
            $('#OOC_BOENo').val(ArrayOfDeliveryApp[Index].OOC_BOENo);
            $('#OOC_BOEDATE').val(ArrayOfDeliveryApp[Index].OOC_BOEDATE);
            $('#LineNo').val(ArrayOfDeliveryApp[Index].LineNo);
            $('#BOENo').val(ArrayOfDeliveryApp[Index].BOENo);
            $('#CargoDescription').val(ArrayOfDeliveryApp[Index].CargoDescription);

            $('#DeliApp_ImporterId').val(ArrayOfDeliveryApp[Index].ImporterId);
            $('#DeliApp_Importer').val(ArrayOfDeliveryApp[Index].ImporterName);

            $('#Commodity').val(ArrayOfDeliveryApp[Index].Commodity);
            $('#CommodityId').val(ArrayOfDeliveryApp[Index].CommodityId);
            $('#NoOfPackages').val(ArrayOfDeliveryApp[Index].NoOfPackages);
            $('#GrossWt').val(ArrayOfDeliveryApp[Index].GrossWt);
            $('#SQM').val(ArrayOfDeliveryApp[Index].SQM);
            $('#CUM').val(ArrayOfDeliveryApp[Index].CUM);
            $('#CIF').val(ArrayOfDeliveryApp[Index].CIF);
            $('#Duty').val(ArrayOfDeliveryApp[Index].Duty);
            $('#DelNoOfPackages').val(ArrayOfDeliveryApp[Index].DelNoOfPackages);
            $('#DelGrossWt').val(ArrayOfDeliveryApp[Index].DelGrossWt);
            $('#DelSQM').val(ArrayOfDeliveryApp[Index].DelSQM);
            $('#DelCUM').val(ArrayOfDeliveryApp[Index].DelCUM);
            $('#DelCIF').val(ArrayOfDeliveryApp[Index].DelCIF);
            $('#DelDuty').val(ArrayOfDeliveryApp[Index].DelDuty);
            ArrayOfDeliveryApp.splice(Index, 1);
            GenerateDeliveryAppTable();
        }
        else {
            $('#DivDeliveryAppTblErrMsg').html('Please Add The Above Records');
        }
    }

    function ViewDeliveryAppDtl(Index) {
        debugger;
        if ($('#BtnAddDeliveryApp').prop("disabled") == true) {
            $('#BtnAddDeliveryApp').prop("disabled", true);
            $('#SearchBOELineNo').css("display", "none");
            $('#DestuffingEntryDtlId').val(ArrayOfDeliveryApp[Index].DestuffingEntryDtlId);
            $('#BOELineNo').val(ArrayOfDeliveryApp[Index].BOELineNo);
            $('#LineNo').val(ArrayOfDeliveryApp[Index].LineNo);
            $('#BOENo').val(ArrayOfDeliveryApp[Index].BOENo);
            $('#OOC_BOENo').val(ArrayOfDeliveryApp[Index].OOC_BOENo);
            $('#OOC_BOEDATE').val(ArrayOfDeliveryApp[Index].OOC_BOEDATE);
            $('#CargoDescription').val(ArrayOfDeliveryApp[Index].CargoDescription);
            $('#DeliApp_ImporterId').val(ArrayOfDeliveryApp[Index].ImporterId);
            $('#DeliApp_Importer').val(ArrayOfDeliveryApp[Index].ImporterName);
            $('#Commodity').val(ArrayOfDeliveryApp[Index].Commodity);
            $('#CommodityId').val(ArrayOfDeliveryApp[Index].CommodityId);
            $('#NoOfPackages').val(ArrayOfDeliveryApp[Index].NoOfPackages);
            $('#GrossWt').val(ArrayOfDeliveryApp[Index].GrossWt);
            $('#SQM').val(ArrayOfDeliveryApp[Index].SQM);
            $('#CUM').val(ArrayOfDeliveryApp[Index].CUM);
            $('#CIF').val(ArrayOfDeliveryApp[Index].CIF);
            $('#Duty').val(ArrayOfDeliveryApp[Index].Duty);
            $('#DelNoOfPackages').val(ArrayOfDeliveryApp[Index].DelNoOfPackages);
            $('#DelGrossWt').val(ArrayOfDeliveryApp[Index].DelGrossWt);
            $('#DelSQM').val(ArrayOfDeliveryApp[Index].DelSQM);
            $('#DelCUM').val(ArrayOfDeliveryApp[Index].DelCUM);
            $('#DelCIF').val(ArrayOfDeliveryApp[Index].DelCIF);
            $('#DelDuty').val(ArrayOfDeliveryApp[Index].DelDuty);
        }
        else {
            $('#DivDeliveryAppTblErrMsg').html('Please Add The Above Records');
        }

    }




    function EditDeliveryOrdDtl(Index) {
        debugger;
        $('#DivDeliveryOrdTblErrMsg').html('');
        // if ($('#BtnAddDeliveryOrd').prop("disabled") == true) {

        $('#IssuedBy').val(ArrayOfDeliveryOrd[Index].IssuedBy);
        $('#CargsDelivered').val(ArrayOfDeliveryOrd[Index].DeliveredTo);
        $('#ddlValidType').val(ArrayOfDeliveryOrd[Index].ValidType);
        $('#ValidDate').val(ArrayOfDeliveryOrd[Index].ValidDate);
        $('#BtnAddDeliveryOrd').prop("disabled", false);
        ArrayOfDeliveryOrd.splice(Index, 1);
        GenerateDeliveryOrdTable();
        //   }
        //  else {
        //      $('#DivDeliveryOrdTblErrMsg').html('Please Add The Above Records');
        // }
    }

    function ViewDeliveryOrdDtl(Index) {
        debugger;
        $('#DivDeliveryOrdTblErrMsg').html('');
        //  if ($('#BtnAddDeliveryOrd').prop("disabled") == true) {

        $('#IssuedBy').val(ArrayOfDeliveryOrd[Index].IssuedBy);
        $('#CargsDelivered').val(ArrayOfDeliveryOrd[Index].DeliveredTo);
        $('#ddlValidType').val(ArrayOfDeliveryOrd[Index].ValidType);
        $('#ValidDate').val(ArrayOfDeliveryOrd[Index].ValidDate);
        $('#BtnAddDeliveryOrd').attr("disabled");
        //   ArrayOfDeliveryOrd.splice(Index, 1);
        // GenerateDeliveryOrdTable();
        //}
        // else {
        $('#DivDeliveryOrdTblErrMsg').html('Please Add The Above Records');
        //  }

    }
    @*$('#Partysearch').on("click", function () {
        debugger;
        $.ajax({
            url: '@Url.Action("GetCHANAMEForPayment", "Ppg_CWCImport", new { Area = "Import" })',
            dataType: 'JSON',
            type: 'GET',
            success: function (dataParty) {
                debugger;
                // ViewCHAShippingLine = data;
                var html = '';
                $.each(dataParty, function (i, item) {
               //     html += '<tr id="' + item.CHAId + '" " onclick="SelectCHAName(' + item.CHAId + ',&quot;' + item.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + item.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + item.PartyCode + '</td</tr>';
                    html += '<tr id="' + item.PartyId + '" " onclick="SelectParty(' + item.PartyId + ',&quot;' + item.PartyName + '&quot;,&quot;' + item.Address + '&quot;,&quot;' + item.State + '&quot;,&quot;' + item.StateCode + '&quot;,&quot;' + item.GSTNo + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + item.PartyName + '</td><td colspan="4" width="20%" class="txt_wrp">' + item.PartyCode + '</td</tr>';

                });
                $('#tbleParty').html(html);
            }
        });

    });*@





    @*$('#Payeesearch').on("click", function () {
        debugger;
        $.ajax({
            url: '@Url.Action("GetCHANAMEForPayment", "Ppg_CWCImport", new { Area = "Import" })',
            dataType: 'JSON',
            type: 'GET',
            success: function (dataPayee) {
                debugger;
                // ViewCHAShippingLine = data;
                var html = '';
                $.each(dataPayee, function (i, item) {
                    //     html += '<tr id="' + item.CHAId + '" " onclick="SelectCHAName(' + item.CHAId + ',&quot;' + item.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + item.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + item.PartyCode + '</td</tr>';
                    html += '<tr id="' + item.PartyId + '" " onclick="SelectPayee(' + item.PartyId + ',&quot;' + item.PartyName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + item.PartyName + '</td><td colspan="4" width="20%" class="txt_wrp">' + item.PartyCode + '</td</tr>';

                });
                $('#tblePayee').html(html);
            }
        });

    });*@











    function DeliveryOnSuccess(data) {
        debugger;
        if (data.Status == 1) {
            $('#DivDeliveryMsg').html(data.Message);
            $("#NewDeliveryId").val(data.Data.Id);
            var AppNo=data.Data.AppNo;
            var AppValues=AppNo.split(",")
            $("#DeliApp_DeliveryNo").val(AppValues[0]);
            $("#InvoiceNo").val(AppValues[1]);
            $('#InvoiceNoPrint').val(AppValues[1])  ;
            $('#IssueNoPrint').val(AppValues[2])  ;
            $('#hdnSupplyType').val(AppValues[3])  ;
            $('#btnIRN').attr("disabled",false);
            @*$.ajax({
                url: '@Url.Action("GetCHANAMEForPayment", "Ppg_CWCImport", new { Area = "Import" })',
                dataType: 'JSON',
                type: 'GET',
                success: function (dataCha) {


                    debugger;
                    // ViewCHAShippingLine = data;
                    var html = '';
                    $.each(dataCha, function (i, item) {

                        html += '<tr id="' + item.PartyId + '" " onclick="SelectParty(' + item.PartyId + ',&quot;' + item.PartyName + '&quot;,&quot;' + item.Address + '&quot;,&quot;' + item.State + '&quot;,&quot;' + item.StateCode + '&quot;,&quot;' + item.GSTNo + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + item.PartyName + '</td><td colspan="4" width="20%" class="txt_wrp">' + item.PartyCode + '</td</tr>';

                    });
                    $('#tbleParty').html(html);
                    var html = '';
                    $.each(dataCha, function (i, item) {
                        html += '<tr id="' + item.PartyId + '" " onclick="SelectPayee(' + item.PartyId + ',&quot;' + item.PartyName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + item.PartyName + '</td><td colspan="4" width="20%" class="txt_wrp">' + item.PartyCode + '</td</tr>';

                    });
                    $('#tblePayee').html(html);

                }
            });

            $.ajax({
                url: '/Import/Ppg_CWCImport/GetDeliAppMerge',
                type: 'GET',
                data: { DeliveryId: data.Data.Id },
                dataType: 'JSON',
                success: function (dataDeli) {
                    debugger;
                   // alert(dataDeli);
                   // $('#SearchBOELineNo').css("display", "block");


                        debugger;

                        $('#StuffingReqId').val($('#NewDeliveryId').val());
                        $('#StuffingReqNo').val($('#DeliApp_DeliveryNo').val());
                        $('#StuffingReqDate').val(dataDeli.DeliveryAppDate);

                        $('#PartyId').val(dataDeli.CHAId);
                        $('#PartyName').val(dataDeli.CHAName);
                        $('#PayeeId').val(dataDeli.CHAId);
                        $('#PayeeName').val(dataDeli.CHAName);
                        $('#GSTNo').val(dataDeli.GSTNo);
                        $('#hdnAddress').val(dataDeli.Address);
                        $('#hdnState').val(dataDeli.StateName);
                        $('#hdnStateCode').val(dataDeli.StateCode);
                      //  $('#hdnDeliveryType').val(StuffingRequest.DeliveryType);
                        $("#stuffingModal").modal("hide");
                        ContainerBinding($('#NewDeliveryId').val());

                }
            });*@


            // setTimeout(function () {
            //     $('#DivBody').load('/Import/Ppg_CWCImport/CreateDeliveryApplication');
            // },5000)
            $('#BtnSaveDelvApp').attr("disabled",true);
            //     $('#BtnCont').attr("disabled",false);
            $('#BtnInvoice').attr("disabled",false);
            CheckIsBond();
            //$('#BtnIssueSlip').attr("disabled",false);
            // $('#BtnCont').focus();
        }
        else {
            $('#DivDeliveryErrMsg').html(data.Message);
        }
    }

    function DeliveryOnFailure() {

    }

    function FillBalancedUnits() {
        debugger;
        $('[data-valmsg-for="DelNoOfPackages"]').html('<span></span>');
        if (Number($('#DelNoOfPackages').val()) > Number($('#NoOfPackages').val())) {
            alert('No Of Packages Should Be Less Than Destuff  No Of Packages');
            return false;
        }
        else {
            var DelNoOfPackages = Number($('#DelNoOfPackages').val());

            var GrossWt = Number($('#GrossWt').val());
            var SQM = Number($('#SQM').val());
            var CUM = Number($('#CUM').val());
            var CIF = Number($('#CIF').val());
            var NoOfPackages = Number($('#NoOfPackages').val());
            var Duty = Number($('#Duty').val());
            if (NoOfPackages != 0) {
                $('#DelGrossWt').val(((GrossWt / NoOfPackages) * DelNoOfPackages).toFixed(2));
                $('#DelSQM').val(((SQM / NoOfPackages) * DelNoOfPackages).toFixed(2));
                $('#DelCUM').val(((CUM / NoOfPackages) * DelNoOfPackages).toFixed(2));
                $('#DelCIF').val(((CIF / NoOfPackages) * DelNoOfPackages).toFixed(2));
                $('#DelDuty').val(((Duty / NoOfPackages) * DelNoOfPackages).toFixed(2));
                return true;
            }

        }

    }

    function FillBalancedWeights() {
        debugger;
        $('[data-valmsg-for="Weight"]').html('<span></span>');
        if (Number($('#DelGrossWt').val()) > Number($('#GrossWt').val())) {
            alert('Weight Should Be Less Than Closing Weight');
        }
        else {
            $('#ClosingWeight').val((ClosingWeight - Number(parseFloat(Number($('#Weight').val())))).toFixed(3));
        }

    }

    $('#BtnSaveDelvApp').on("click", function () {
        debugger;
        var  dateText = $('#InvoiceDate').datepicker({ dateFormat: 'MM/dd/yyyy' }).val();

        var Invday =dateText.split("/");
        var InvWSp=Invday[2].split(" ");

        var Invdate =Invday[0]  + '/' + Invday[1] + '/' + InvWSp[0];
        var InvdateYear =InvWSp[0]  + '-' + Invday[1] + '-' + Invday[0];
        $('#DeliApp_DeliveryDate').val(InvdateYear);


        $('#DivDeliveryAppTblErrMsg').html('');
        if ($('#BOELineNo').val() == "" && $('#TblDeliveryAppDtl >tbody').html() != "" && $('#TblDeliveryAppOrd >tbody').html() != "" ) {
            if (ArrayOfDeliveryApp.length != 0) {
                $('#DeliApp_DeliveryAppDtlXml').val(JSON.stringify(ArrayOfDeliveryApp));
            }
            else {
                $('#DivDeliveryAppTblErrMsg').html('Please Add The Above Records');

                return false;
            }

            if (ArrayOfDeliveryOrd.length != 0) {
                $('#DeliApp_DeliveryOrdDtlXml').val(JSON.stringify(ArrayOfDeliveryOrd));
            }
            else
            {
                $('#DivDeliveryOrdTblErrMsg').html('Please Add The Above Records');

                return false;
            }
        }
        else if ($('#BOELineNo').val() != "" && $('#BtnAddDeliveryApp').prop("disabled") == true && $('#BtnAddDeliveryOrd').prop("disabled") == true) {
            if (ArrayOfDeliveryApp.length != 0) {
                $('#DeliApp_DeliveryAppDtlXml').val(JSON.stringify(ArrayOfDeliveryApp));
            }
            if (ArrayOfDeliveryOrd.length != 0) {
                $('#DeliApp_DeliveryOrdDtlXml').val(JSON.stringify(ArrayOfDeliveryOrd));
            }
        }
        else {

            if (ArrayOfDeliveryApp.length == 0) {
                $('#DivDeliveryAppTblErrMsg').html('Please Add The Above Records');
            }
            else
            {
                $('#DivDeliveryOrdTblErrMsg').html('Please Add The Above Records');
            }
            return false;
        }




        if (confirm("Are You Sure You Want To Save?")) {
            $('#BtnSaveDelvApp').attr('disabled', true);
            $('#BtnSaveDelvApp').submit();
        }

        else
        {
            $('#BtnSaveDelvApp').attr('disabled', false);
        }



    });


    $('#btninvoice').on("click", function () {
        debugger;
        var DestuffingId =  $('#DeliApp_DestuffingId').val();
        var CHAId=$('#DeliApp_PartyId').val();
        var IsBond;
        var ExportUnder;

        if($('#ConvertToBond').is(":checked"))
        {IsBond=1
        $('#ConvertToBondFlag').val(true);
        }
      else
      {
        IsBond=0;
        $('#ConvertToBondFlag').val(false);
      }

                if($('#ExportUnder').is(":checked"))
        {ExportUnder="SEZ"}
        else
        {
            ExportUnder="";

        }
       
        //SEZ=ExportUnder;
        $('#SEZ').val(ExportUnder);

        dateText = $('#InvoiceDate').datepicker({ dateFormat: 'MM/dd/yyyy' }).val();


        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth() + 1; //January is 0!

        var yyyy = today.getFullYear();
        if (dd < 10) {
            dd = '0' + dd;
        }
        if (mm < 10) {
            mm = '0' + mm;
        }
        var today = mm +'/'+ dd + '/' + yyyy;
        var dt1=new Date(today);


        var Invday =dateText.split("/");
        var InvWSp=Invday[2].split(" ");

        var Invdate =Invday[1]+'/'+Invday[0]  +'/' + InvWSp[0];
        var InvdateYear =InvWSp[0]  + '-' + Invday[1] + '-' + Invday[0];
        var dt2=new Date(Invdate);
        if(dt2<dt1)
        {
            alert("Delivery Invoice Date should be greater than or equal to Delivery Application Date");
            return false;
        }


        if($('#DeliApp_CHA').val() == "")
        {
            alert("Please Select CHA Name");
            return false;
        }

        $('#DeliApp_OTHr').val($('#DeliApp_OTHr').val()==''?0:$('#DeliApp_OTHr').val());
        $('#DivDeliveryAppTblErrMsg').html('');
        if ($('#BOELineNo').val() == "" && $('#TblDeliveryAppDtl >tbody').html() != "" && $('#TblDeliveryAppOrd >tbody').html() != "" ) {
            if (ArrayOfDeliveryApp.length != 0) {
                $('#DeliApp_DeliveryAppDtlXml').val(JSON.stringify(ArrayOfDeliveryApp));
            }
            else {
                $('#DivDeliveryAppTblErrMsg').html('Please Add The Above Records');

                return false;
            }

            if (ArrayOfDeliveryOrd.length != 0) {
                $('#DeliApp_DeliveryOrdDtlXml').val(JSON.stringify(ArrayOfDeliveryOrd));
            }
            else
            {
                $('#DivDeliveryOrdTblErrMsg').html('Please Add The Above Records');

                return false;
            }
        }
        else if ($('#BOELineNo').val() != "" && $('#BtnAddDeliveryApp').prop("disabled") == true && $('#BtnAddDeliveryOrd').prop("disabled") == true) {
            if (ArrayOfDeliveryApp.length != 0) {
                $('#DeliApp_DeliveryAppDtlXml').val(JSON.stringify(ArrayOfDeliveryApp));
            }
            if (ArrayOfDeliveryOrd.length != 0) {
                $('#DeliApp_DeliveryOrdDtlXml').val(JSON.stringify(ArrayOfDeliveryOrd));
            }
        }
        else {

            if (ArrayOfDeliveryApp.length == 0) {
                $('#DivDeliveryAppTblErrMsg').html('Please Add The Above Records');
            }
            else
            {
                $('#DivDeliveryOrdTblErrMsg').html('Please Add The Above Records');
            }
            return false;
        }

        $.ajax({
            url: '/Import/VRN_CWCImport/GetSingleClickDeliveryPaymentSheet',
            type: 'POST',
            data: {
                InvoiceType: TaxType,
                DestuffingAppId: DestuffingId,
                DeliveryDate:InvdateYear,
                InvoiceId: 0,
                DeliveryXML: ArrayOfDeliveryApp,
                PartyId: CHAId,

                PayeeId: $('#DeliApp_PayeeId').val(),
                OTHours:($('#DeliApp_OTHr').val()==''?0:$('#DeliApp_OTHr').val()),
                OblFlag:$('#DeliApp_ObleFreeFlag').val(),
                Movement:$('#hdMovement').val(),
                Distance:$('#Distance').val(),
                IsBond:IsBond,
                ExportUnder:$('#ExportUnder').is(':checked') ? "SEZ" : ''
            },
            dataType: 'JSON',
            success: function (data) {
                debugger;
                if (data != null && data != 'undefined') {
                    $('#PaymentSheetModelJson').val(JSON.stringify(data));
                    //ContainerSelectiner Binding
                    $('#ExportUnder').prop("disabled", true);
                    $('#OTHours').prop('readonly', true);
                    $('#Importers').val(data.ImporterExporter);
                    PModeValue = data.PaymentMode;
                    $('#PMode').html(data.PaymentMode);
                    var html = '';
                    //$.each(data.lstPostPaymentCont, function (i, item) {
                    //    html += '<tr><td>' + (i + 1) + '</td><td>' + item.CFSCode + '</td><td>' + item.ContainerNo + '</td><td>' + item.Size + '</td><td>';//
                    //    if (item.Reefer == 1) {
                    //        html += '<input type="checkbox" checked disabled id="chk' + i + '" /><label for="chk' + i + '"><i class="square" style="margin-left:10px;"></i></label></td><td>' + (item.Insured == 1 ? 'Yes' : 'No') + '</td><td>'+(item.CargoType==1?'Haz':(item.CargoType==2?'Non Haz':''))+'</td><td></td></tr>';
                    //    }
                    //    else {
                    //        html += '<input type="checkbox" disabled id="chk' + i + '" /><label for="chk' + i + '"><i class="square" style="margin-left:10px;"></i></label></td><td>' + (item.Insured == 1 ? 'Yes' : 'No') + '</td><td>' + (item.CargoType == 1 ? 'Haz' : (item.CargoType == 2 ? 'Non Haz' : '')) + '</td><td></td></tr>';
                    //    }
                    //});
                    //$('#tblContainer tbody').html(html);




                    var html = '';
                    $.each(data.lstInvoiceCargo, function (i, item) {
                        var dt = item.BOLDate.split("/");
                        var dt1 = dt[2].split(" ");

                        var dtt = dt[0] + "/" + dt[1] + "/" + dt1[0];
                        html += '<tr><td>' + (i + 1) + '</td><td>' + item.BOLNo + '</td><td>' + dtt + '</td><td>' + (item.CargoType == 1 ? 'Haz' : (item.CargoType == 2 ? 'Non Haz' : '')) + '</td></tr>';//

                        //  html += '<input type="checkbox" disabled id="chk' + i + '" /><label for="chk' + i + '"><i class="square" style="margin-left:10px;"></i></label></td><td>' + (item.Insured == 1 ? 'Yes' : 'No') + '</td><td>' + (item.CargoType == 1 ? 'Haz' : (item.CargoType == 2 ? 'Non Haz' : '')) + '</td><td></td></tr>';

                    });
                    $('#tblOBL tbody').html(html);

                    //CWC Charge Binding
                    // var CWCCharge = $.grep(data.lstPostPaymentChrg, function (item) { return item.ChargeType == "CWC"; });
                    /****************************CWC and HT Charge Bind*******************************/
                    html = '';
                    var tamt = 0;
                    var HtCharges = ['LOL', 'LOE', 'SH', 'BTT', 'TPT', 'DTF', 'HND', 'MF'];
                    var CWCChargesList = data.lstPostPaymentChrg.filter(function (item) {
                        return HtCharges.indexOf(item.Clause) < 0;
                    });
                    $.each(CWCChargesList, function (i, item) {

                        tmat = tamt + item.Amount.toFixed(2);
                        html += '<tr><td>' + item.Clause + '. ' + item.ChargeName + '</td>'
                                + '<td class="Table_right"><input id="' + item.ChargeId + '" type="text"  value="' + item.Amount.toFixed(2) + '" readonly/></td>'
                                + '<td class="Table_right"><input id="IGSTP' + item.ChargeId + '" type="text" value="' + item.IGSTPer + '" readonly /></td>'
                                + '<td class="Table_right"><input id="IGSTA' + item.ChargeId + '" type="text" value="' + item.IGSTAmt.toFixed(2) + '" readonly /></td>'
                                + '<td class="Table_right"><input id="CGSTP' + item.ChargeId + '" type="text" value="' + item.CGSTPer + '"  readonly /></td>'
                                + '<td class="Table_right"><input id="CGSTA' + item.ChargeId + '" type="text" value="' + item.CGSTAmt.toFixed(2) + '" readonly /></td>'
                                + '<td class="Table_right"><input id="SGSTP' + item.ChargeId + '" type="text" value="' + item.SGSTPer + '"  readonly /></td>'
                                + '<td class="Table_right"><input id="SGSTA' + item.ChargeId + '" type="text" value="' + item.SGSTAmt.toFixed(2) + '" readonly /></td>'
                                + '<td class="Table_right"><input id="TOT' + item.ChargeId + '" type="text" value="' + item.Total.toFixed(2) + '" readonly /></td></tr>';
                    });
                    $('#tblCWCCharges tbody').html(html);
                    html = '';
                    var HTChargesList = data.lstPostPaymentChrg.filter(function (item) {
                        return HtCharges.indexOf(item.Clause) > -1;
                    });
                    $.each(HTChargesList, function (i, item) {

                        tmat = tamt + item.Amount.toFixed(2);
                        html += '<tr><td>' + item.Clause + '. ' + item.ChargeName + '</td>'
                                + '<td class="Table_right"><input id="' + item.ChargeId + '" type="text"  value="' + item.Amount.toFixed(2) + '" readonly/></td>'
                                + '<td class="Table_right"><input id="IGSTP' + item.ChargeId + '" type="text" value="' + item.IGSTPer + '" readonly /></td>'
                                + '<td class="Table_right"><input id="IGSTA' + item.ChargeId + '" type="text" value="' + item.IGSTAmt.toFixed(2) + '" readonly /></td>'
                                + '<td class="Table_right"><input id="CGSTP' + item.ChargeId + '" type="text" value="' + item.CGSTPer + '"  readonly /></td>'
                                + '<td class="Table_right"><input id="CGSTA' + item.ChargeId + '" type="text" value="' + item.CGSTAmt.toFixed(2) + '" readonly /></td>'
                                + '<td class="Table_right"><input id="SGSTP' + item.ChargeId + '" type="text" value="' + item.SGSTPer + '"  readonly /></td>'
                                + '<td class="Table_right"><input id="SGSTA' + item.ChargeId + '" type="text" value="' + item.SGSTAmt.toFixed(2) + '" readonly /></td>'
                                + '<td class="Table_right"><input id="TOT' + item.ChargeId + '" type="text" value="' + item.Total.toFixed(2) + '" readonly /></td></tr>';
                    });
                    $('#tblHTCharges tbody').html(html);
                    /**********************************************************************/
                    //  $('#CWCTDSPer').val(data.CWCTDSPer.toFixed(2));
                    // $('#TOTCWCTDS').val(Math.round(data.CWCTDS.toFixed(2)));
                    //HT Charge Binding*/
                    //var HTCharge = $.grep(data.lstPostPaymentChrg, function (item) { return item.ChargeType == "HT"; });
                    //html = '';
                    //$.each(HTCharge, function (i, item) {
                    //    html += '<tr><td>' + item.Clause + '. ' + item.ChargeName + '</td>'
                    //            + '<td class="Table_right"><input id="' + item.ChargeId + '" type="text" value="' + item.Amount.toFixed(2) + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" /></td>'
                    //            + '<td class="Table_right"><input id="IGSTP' + item.ChargeId + '" type="text" value="' + item.IGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                    //            + '<td class="Table_right"><input id="IGSTA' + item.ChargeId + '" type="text" value="' + item.IGSTAmt.toFixed(2) + '" readonly /></td>'
                    //            + '<td class="Table_right"><input id="CGSTP' + item.ChargeId + '" type="text" value="' + item.CGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                    //            + '<td class="Table_right"><input id="CGSTA' + item.ChargeId + '" type="text" value="' + item.CGSTAmt.toFixed(2) + '" readonly /></td>'
                    //            + '<td class="Table_right"><input id="SGSTP' + item.ChargeId + '" type="text" value="' + item.SGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                    //            + '<td class="Table_right"><input id="SGSTA' + item.ChargeId + '" type="text" value="' + item.SGSTAmt.toFixed(2) + '" readonly /></td>'
                    //            + '<td class="Table_right"><input id="TOT' + item.ChargeId + '" type="text" value="' + item.Total.toFixed(2) + '" readonly /></td></tr>';
                    //});
                    //$('#tblHTCharges tbody').html(html);
                    //$('#HTTDSPer').val(data.HTTDSPer.toFixed(2));
                    //$('#TOTHTTDS').val(Math.round(data.HTTDS.toFixed(2)));

                    //Total Charge Calculation

                    var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
                    var TotalCWC = 0;
                    //   var CWCCharge = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeType == "CWC"; });

                    $.each(data.lstPostPaymentChrg, function (i, item) {
                        TotalCWC += item.Total;
                    });
                    $('#TOTCWCChrg').val((TotalCWC).toFixed(2));

                    //var TotalHT = 0;
                    //var HTCharge = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeType == "HT"; });

                    //$.each(HTCharge, function (i, item) {
                    //    TotalHT += item.Total;
                    //});
                    //$('#TOTHTChrg').val((TotalHT).toFixed(2));

                    $('#AllTotal').val((TotalCWC).toFixed(2));


                    $('#AllTotal').val((TotalCWC).toFixed(2));

                    var AllTot = Math.ceil(TotalCWC);
                    var roundup = AllTot - TotalCWC;
                    //    $('#TotalTDS').val(Math.round(data.TDS.toFixed(2)));
                    // $('#TotalTDSCol').val(Math.round(data.TDSCol.toFixed(2)));
                    $('#RoundUp').val(roundup.toFixed(2));
                    $('#InvoiceValue').val(AllTot.toFixed(2));
                    data.InvoiceAmt = AllTot;
                    data.RoundUp = roundup;
                    data.TotalAmt = tmat;
                    //    $('#TotalTDS').val(Math.round(data.TDS.toFixed(2)));
                    // $('#TotalTDSCol').val(Math.round(data.TDSCol.toFixed(2)));
                    // $('#RoundUp').val(data.RoundUp.toFixed(2));
                    // $('#InvoiceValue').val(data.InvoiceAmt.toFixed(2));
                    data.TotalAmt = tmat;
                    //CalcInvoice();
                    $('.search').css('display', 'none');
                    
                    $('#ConvertToBond').attr('disabled','disabled');
                    $('#Movement').val($('#hdMovement').val());
                   
                    $('#hdMovement').attr('disabled','disabled');
                    $('#InvoiceDate').parent().find('img').css('display', 'none');
                    //   $('#DeliApp_OTHr').attr('disabled', 'disabled');
                    document.getElementById('DeliApp_OTHr').setAttribute('readonly', 'readonly')
                    if (data.hasSDAvailableBalance == 0) {
                        alert("Your Invoice can not be saved due to SD Amount is low");

                        $('#BtnSaveDelvApp').attr('disabled',true);
                    }
                    else {
                        $('#BtnSaveDelvApp').removeAttr('disabled');
                    }
                    debugger;
                    $('#DeliApp_lstContWiseAmountXML').val(JSON.stringify(rawJson.lstContWiseAmount));
                    $('#DeliApp_lstInvoiceCargoXML').val(JSON.stringify(rawJson.lstInvoiceCargo));
                    $('#DeliApp_lstOperationCFSCodeWiseAmountXML').val(JSON.stringify(rawJson.lstOperationCFSCodeWiseAmount));
                    $('#DeliApp_lstPostPaymentChrgXML').val(JSON.stringify(rawJson.lstPostPaymentChrg));
                    $('#DeliApp_lstPostPaymentChrgBreakupXML').val(JSON.stringify( rawJson.lstPostPaymentChrgBreakup));
                    $('#DeliApp_lstPostPaymentContXML').val(JSON.stringify(rawJson.lstPostPaymentCont));
                    $('#DeliApp_lstPrePaymentContXML').val(JSON.stringify(rawJson.lstPrePaymentCont));

                }
                else {
                    $('#PaymentSheetModelJson').val('');
                    $('#tblContainer tbody').html('');
                    $('#tblOBL tbody').html('');
                    $('#tblCWCCharges tbody').html('');
                    $('#tblHTCharges tbody').html('');
                    $('#TOTCWCChrg').val('');
                    $('#TOTHTChrg').val('');
                    $('#AllTotal').val('');
                    $('#RoundUp').val('');
                }
            }
        });




    });




    function AllowOnlyDecimal(evt) {
        var CharCode;
        if (window.event) {
            CharCode = window.event.keyCode;
        }
        else {
            CharCode = evt.which;
        }
        if ((CharCode > 47 & CharCode < 58) || (CharCode == 46) || CharCode == 8) {
            return true;
        }
        else {
            evt.preventDefault;
            return false;
        }
    }
    function AllowOnlyInteger(evt) {
        var CharCode;
        if (window.event) {
            CharCode = window.event.keyCode;
        }
        else {
            CharCode = evt.which;
        }
        if ((CharCode > 47 & CharCode < 58) || CharCode == 8) {
            return true;
        }
        else {
            evt.preventDefault;
            return false;
        }
    }


    function LoadMoreCHA() {
        debugger;
        $.ajax({
            url: '/Import/VRN_CWCImport/LoadCHAList',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    $.each(data.Data.lstCHA, function (item, elem) {
                        debugger;
                        html += '<tr onclick="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                    });
                    if (Page == -1)
                        $('#tbleCha tbody').html(html);
                    else
                        $('#tbleCha tbody').append(html);
                    Page++;

                    debugger;
                    if (data.Data.State == true)
                        $('#btnLoadCHA').prop('disabled', false);
                    else $('#btnLoadCHA').prop('disabled', true);
                }
            }
        });
    }

    var Page=0;
    function LoadCHA() {
        debugger;
        Page = 0;
        $.ajax({
            url: '/Import/VRN_CWCImport/LoadCHAList',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    $.each(data.Data.lstCHA, function (item, elem) {
                        debugger;
                        html += '<tr onclick="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                    });

                    $('#tbleCha tbody').html(html);

                    if (data.Data.State == true)
                        $('#btnLoadCHA').prop('disabled', false);
                    else $('#btnLoadCHA').prop('disabled', true);
                }


                $.ajax({
                    url: '/Import/VRN_CWCImport/GetGST',
                    type: 'GET',
                    data: { PartyID:  $('#DeliApp_PartyId').val() },
                    success: function (data) {
                        if (data.Status == 1) {
                            $('#GSTNo').val(data.Data);
                        }

                    }
                });

            }
        });
    }

    function SelectCHA(CHAId, CHAName) {
        debugger;
        $('#DeliApp_CHA').val(CHAName);
        $('#DeliApp_CHAId').val(CHAId);
        $('#DeliApp_PayeeName').val(CHAName);
        $('#DeliApp_PayeeId').val(CHAId);
        $('#DeliApp_PartyName').val(CHAName);
        $('#DeliApp_PartyId').val(CHAId);
        $("#CHADtlModal").modal("hide");
        $('#Chabox').val('');
        LoadCHA();
    }

    function SelectCHAParty(CHAId, CHAName) {
        debugger;
        $('#DeliApp_PartyName').val(CHAName);
        $('#DeliApp_PartyId').val(CHAId);



        $("#PartyGstModal").modal("hide");
        $('#PartyGstbox').val('');
        LoadCHA();
    }


    function SelectPartyName(CHAId, CHAName) {
        debugger;
        $('#DeliApp_PartyName').val(CHAName);
        $('#DeliApp_PartyId').val(CHAId);



        $("#PartyGstModal").modal("hide");
        $('#PartyGstbox').val('');
        LoadCHA();
    }
    function SelectCHAName(CHAId,CHAName) {
        debugger;
        $('#DeliApp_CHA').val(CHAName);
        $('#DeliApp_CHAId').val(CHAId);
        debugger;
        $('#DeliApp_PayeeName').val(CHAName);
        $('#DeliApp_PayeeId').val(CHAId);

        $('#DeliApp_PartyName').val(CHAName);
        $('#DeliApp_PartyId').val(CHAId);
        //var DestuffingId =  $('#DeliApp_DestuffingId').val();
        // var hdnDestuffingEntryNoList = $('#hdnDestuffingEntryNoList').val();
        //  var model = @Html.Raw(Json.Encode(ViewBag.DestuffingEntryNoList));
        //  var Destuffing = $.grep(model, function (item) { return item.DestuffingId == DestuffingId;})[0];
        //$('#ImporterId').val(Destuffing.ImporterId);
        //$('#Importer').val(Destuffing.ImporterName);


        $("#CHADtlModal").modal("hide");
        $('#Chabox').val('');
        LoadCHA();
    }

    function SelectPartyGstName(CHAId,CHAName) {
        debugger;


        $('#DeliApp_PartyName').val(CHAName);
        $('#DeliApp_PartyId').val(CHAId);
        //var DestuffingId =  $('#DeliApp_DestuffingId').val();
        // var hdnDestuffingEntryNoList = $('#hdnDestuffingEntryNoList').val();
        //  var model = @Html.Raw(Json.Encode(ViewBag.DestuffingEntryNoList));
        //  var Destuffing = $.grep(model, function (item) { return item.DestuffingId == DestuffingId;})[0];
        //$('#ImporterId').val(Destuffing.ImporterId);
        //$('#Importer').val(Destuffing.ImporterName);


        $("#PartyGstModal").modal("hide");
        $('#PartyGstbox').val('');
        LoadCHA();
    }


    function SelectPayeeName(CHAId,CHAName) {
        debugger;
        $('#DeliApp_PayeeName').val(CHAName);
        $('#DeliApp_PayeeId').val(CHAId);
        //var DestuffingId =  $('#DeliApp_DestuffingId').val();
        // var hdnDestuffingEntryNoList = $('#hdnDestuffingEntryNoList').val();
        //  var model = @Html.Raw(Json.Encode(ViewBag.DestuffingEntryNoList));
        //  var Destuffing = $.grep(model, function (item) { return item.DestuffingId == DestuffingId;})[0];
        //$('#ImporterId').val(Destuffing.ImporterId);
        //$('#Importer').val(Destuffing.ImporterName);


        $("#PayeeModal").modal("hide");
        $('#Payeebox').val('');
        //  LoadCHA();
    }

    function SearchChaByPartyCode() {
        if ($('#Chabox').val() != '') {
            $.ajax({
                url: '/Import/VRN_CWCImport/CHASearchByPartyCode',
                type: 'GET',
                data: { PartyCode: $('#Chabox').val() },
                success: function (data) {
                    if (data.Status == 1) {
                        var html = '';
                        $.each(data.Data.lstCHA, function (item, elem) {
                            html += '<tr onclick="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                        });
                        $('#tbleCha tbody').html('');
                        $('#tbleCha tbody').html(html);
                        $('#btnLoadCHA').prop('disabled', false);
                        Page = -1;
                    }
                    else {
                        $('#tbleCha tbody').html('');
                        Page = -1;
                        $('#btnLoadCHA').prop('disabled', false);
                    }

                }
            });
        }
        else
            LoadCHA();
    }

    function CloseCHA() {
        $('#Chabox').val('');
        $("#CHADtlModal").modal("hide");
        LoadCHA();
    }

    function SearchPayeeByPartyCode() {
        if ($('#Payeebox').val() != '') {
            $.ajax({
                url: '/Import/VRN_CWCImport/CHASearchByPartyCode',
                type: 'GET',
                data: { PartyCode: $('#Payeebox').val() },
                success: function (data) {
                    if (data.Status == 1) {
                        var html = '';
                        $.each(data.Data.lstCHA, function (item, elem) {
                            html += '<tr onclick="SelectPayee(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                        });
                        $('#tblePayee tbody').html('');
                        $('#tblePayee tbody').html(html);
                        $('#btnLoadPayee').prop('disabled', false);
                        Page = -1;
                    }
                    else {
                        $('#tblePayee tbody').html('');
                        Page = -1;
                        $('#btnLoadPayee').prop('disabled', false);
                    }

                }
            });
        }
        else
            LoadCHA();
    }

    function ClosePayee() {
        $('#Payeebox').val('');
        $("#PayeeDtlModal").modal("hide");
        LoadCHA();
    }

    function ClosePartyGst() {
        $('#PartyGstbox').val('');
        $("#PartyGstModal").modal("hide");
        LoadCHA();
    }
</script>



<!--------------------------------- GODOWN INVOICE SCRIPT --------------------------------->

<script>
    var TimeInSeconds;
    $(document).ready(function () {
        $('#DeliveryDateCheck').val(new Date());
        TimeInSeconds = 5000;
        //$("#InvoiceDate").datepicker({
        //    dateFormat: "dd/mm/yy",
        //    showOn: "button",
        //    buttonImage: "/Content/images/calendar.png",
        //    buttonImageOnly: true,
        //    buttonText: "Select date",
        //    changeMonth: true,
        //    changeYear: true,
        //    showAnima: "fadein",
        //    onClose: function () {
        //        $(".Date_Img .Error_Msg").text("");
        //        $('[data-valmsg-for="Data"]').html('<span></span>');
        //    }
        //});

        $('#InvoiceDate').datetimepicker({
            showOn: "button",
            buttonImage: "/Content/images/calendar.png",
            buttonImageOnly: true,
            dateFormat: "dd/mm/yy",
            altField: "#slider_example_4andHalf_alt",
            altFieldTimeOnly: false,
            onSelect: function (dateText) {
                dateText = $('#InvoiceDate').datepicker({ dateFormat: 'MM/dd/yyyy' }).val();
                var dt = dateText.split("/");
                var dt1 = dt[1] + "/" + dt[0] + "/" + dt[2];

                $('#DeliveryDateCheck').val(dt1);
            },
            onClose: function () {
                $(".Date_Img .Error_Msg").text("");
                $('[data-valmsg-for="Data"]').html('<span></span>');
            }
        });

        // StuffingReqBinding();
        //PartyBinding();
        // PayeeBinding();
    });

    function StuffingReqBinding() {
        if ($('#hdnStuffingReq').val() != '') {
            var StuffingJson = JSON.parse($('#hdnStuffingReq').val());
            var html = '';
            $.each(StuffingJson, function (i, item) {
                html += '<li id="' + item.StuffingReqId + '" onclick="selectStuffing(' + item.StuffingReqId + ');">' + item.StuffingReqNo + '</li>';
            });
            $('#lststuffing').html(html);
        }
    }
    $('#stuffingbox').keyup(function () {
        var val = $(this).val().toLowerCase();
        if (val == "")
            $('#lststuffing > li').show();
        else {
            $('#lststuffing > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(val) >= 0 ? $(this).show() : $(this).hide());
            });
        }
    });
    function selectStuffing(id) {
        debugger;
        var StuffingJson = JSON.parse($('#hdnStuffingReq').val());
        var StuffingRequest = $.grep(StuffingJson, function (item) { return item.StuffingReqId == id; })[0];
        var pos12 = StuffingRequest.StuffingReqNo.indexOf("(");
        //  alert(pos12);
        var StuffingReqNoo = StuffingRequest.StuffingReqNo.substr(0, pos12);
        //  alert(StuffingReqNoo);
        $('#StuffingReqId').val(StuffingRequest.StuffingReqId);
        $('#StuffingReqNo').val(StuffingReqNoo);
        $('#StuffingReqDate').val(StuffingRequest.StuffingReqDate);
        var dt = StuffingRequest.StuffingReqDate.split("/");
        var dt1 = dt[1] + "/" + dt[0] + "/" + dt[2];
        $('#DeliAppDate').val(dt1);

        $('#PartyId').val(StuffingRequest.CHAId);
        $('#PartyName').val(StuffingRequest.CHAName);
        $('#PayeeId').val(StuffingRequest.CHAId);
        $('#PayeeName').val(StuffingRequest.CHAName);
        $('#GSTNo').val(StuffingRequest.CHAGSTNo);
        $('#hdnAddress').val(StuffingRequest.Address);
        $('#hdnState').val(StuffingRequest.State);
        $('#hdnStateCode').val(StuffingRequest.StateCode);
        $('#hdnDeliveryType').val(StuffingRequest.DeliveryType);
        $("#stuffingModal").modal("hide");
        ContainerBinding(id);
    }
    function ContainerBinding(id) {
        debugger;
        $.ajax({
            url: '/Import/VRN_CWCImport/GetPaymentSheetDeliveryBOE',
            type: 'GET',
            data: { AppraisementId: id },
            dataType: 'JSON',
            success: function (data) {
                //alert(data);
                $('#ContainerJson').val(data);
                debugger;
                ContainerJson = JSON.parse(data);
                var html = '';
                $.each(ContainerJson, function (i, item) {
                    if (item.Selected)
                        html += '<tr><td><div class="boolean-container"><input type="checkbox" checked id="chk_' + item.LineNo + item.CFSCode + '" data-val="' + item.LineNo + '" data-cfs="' + item.CFSCode + '"/><label for="chk_' + item.LineNo + item.CFSCode + '"><i class="square" style="margin-left:10px;"></i></label></div></td><td class="txt_wrp">' + item.CFSCode + '</td>'
                                            + '<td class="txt_wrp">' + item.BOENo + '</td><td class="txt_wrp">' + item.LineNo + '</td></tr>';
                    else
                        html += '<tr><td><div class="boolean-container"><input type="checkbox" id="chk_' + item.LineNo + item.CFSCode + '" data-val="' + item.LineNo + '" data-cfs="' + item.CFSCode + '"/><label for="chk_' + item.LineNo + item.CFSCode + '"><i class="square" style="margin-left:10px;"></i></label></div></td><td class="txt_wrp">' + item.CFSCode + '</td>'
                                        + '<td class="txt_wrp">' + item.BOENo + '</td><td class="txt_wrp">' + item.LineNo + '</td></tr>';
                });
                $('#lstBOENo tbody').html(html);
            }
        });
    }

    //function PartyBinding() {
    //    var PartyJson = JSON.parse($('#hdnPartyPayee').val());
    //    var html = '';
    //    $.each(PartyJson, function (i, item) {
    //        html += '<li id="' + item.PartyId + '" onclick="selectParty(' + item.PartyId + ');">' + item.PartyName + '</li>';
    //    });
    //    $('#lstParty').html(html);
    //}
    $('#Partybox').keyup(function () {
        var val = $(this).val().toLowerCase();
        if (val == "")
            $('#lstParty > li').show();
        else {
            $('#lstParty > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(val) >= 0 ? $(this).show() : $(this).hide());
            });
        }
    });
    //function selectParty(id) {
    //    var PartyJson = JSON.parse($('#hdnPartyPayee').val());
    //    var Party = $.grep(PartyJson, function (item) { return item.PartyId == id; })[0];
    //    $('#PartyId').val(Party.PartyId);
    //    $('#PartyName').val(Party.PartyName);
    //    $('#GSTNo').val(Party.GSTNo);
    //    $('#hdnAddress').val(Party.Address);
    //    $('#hdnState').val(Party.State);
    //    $('#hdnStateCode').val(Party.StateCode);
    //    if ($('#PaymentSheetModelJson').val() != null && $('#PaymentSheetModelJson').val() != '' && $('#PaymentSheetModelJson').val() != 'undefined') {
    //        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
    //        rawJson.PartyId = $('#PartyId').val();
    //        rawJson.PartyName = $('#PartyName').val();
    //        rawJson.PartyGST = $('#GSTNo').val();
    //        rawJson.PartyAddress = $('#hdnAddress').val();
    //        rawJson.PartyState = $('#hdnState').val();
    //        rawJson.PartyStateCode = $('#hdnStateCode').val();
    //        rawJson.ROAddress = (rawJson.ROAddress).replace(new RegExp('<br/>', "gi"), '|_br_|');
    //        $('#PaymentSheetModelJson').val(JSON.stringify(rawJson));
    //    }
    //    $("#PartyModal").modal("hide");
    //}

    //function PayeeBinding() {
    //    var PartyJson = JSON.parse($('#hdnPartyPayee').val());
    //    var html = '';
    //    $.each(PartyJson, function (i, item) {
    //        html += '<li id="' + item.PartyId + '" onclick="selectPayee(' + item.PartyId + ');">' + item.PartyName + '</li>';
    //    });
    //    $('#lstPayee').html(html);
    //}
    //$('#Payeebox').keyup(function () {
    //    var val = $(this).val().toLowerCase();
    //    if (val == "")
    //        $('#lstPayee > li').show();
    //    else {
    //        $('#lstPayee > li').each(function () {
    //            var text = $(this).text().toLowerCase();
    //            (text.indexOf(val) >= 0 ? $(this).show() : $(this).hide());
    //        });
    //    }
    //});
    //function selectPayee(id) {
    //    var PartyJson = JSON.parse($('#hdnPartyPayee').val());
    //    var Party = $.grep(PartyJson, function (item) { return item.PartyId == id; })[0];
    //    $('#PayeeId').val(Party.PartyId);
    //    $('#PayeeName').val(Party.PartyName);
    //    $("#PayeeModal").modal("hide");
    //}
    function SelectParty(PartyId,PartyName,Address,StateName,StateCode,GSTNo) {
        debugger;
        //$('#ShippingLine').val(ShippingLineName);
        //$('#ShippingLineId').val(ShippingLineId);
        //$("#ShippingLineModal").modal("hide");
        // $('#ShpngLinebox').val('');
        // LoadEximTrader();
        $('#PartyId').val(PartyId);
        $('#PartyName').val(PartyName);
        $('#GSTNo').val(GSTNo);
        $('#hdnAddress').val(Address);
        $('#hdnState').val(StateName);
        $('#hdnStateCode').val(StateCode);
        if ($('#PaymentSheetModelJson').val() != null && $('#PaymentSheetModelJson').val() != '' && $('#PaymentSheetModelJson').val() != 'undefined') {
            var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
            rawJson.PartyId = $('#PartyId').val();
            rawJson.PartyName = $('#PartyName').val();
            rawJson.PartyGST = $('#GSTNo').val();
            rawJson.PartyAddress = $('#hdnAddress').val();
            rawJson.PartyState = $('#hdnState').val();
            rawJson.PartyStateCode = $('#hdnStateCode').val();
            rawJson.ROAddress = (rawJson.ROAddress).replace(new RegExp('<br/>', "gi"), '|_br_|');
            $('#PaymentSheetModelJson').val(JSON.stringify(rawJson));
        }
        $("#PartyModal").modal("hide");
        LoadParty();
    }

    var Page = 0;

    function LoadParty() {
        debugger;
        Page = 0;
        $.ajax({
            url: '/Import/VRN_CWCImport/LoadPartyList',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    $.each(data.Data.lstParty, function (item, elem) {
                        debugger;
                        html += '<tr onclick="SelectParty(' + elem.PartyId + ',&quot;' + elem.PartyName + '&quot;,&quot;' + elem.Address + '&quot;,&quot;' + elem.State + '&quot;,&quot;' + elem.StateCode + '&quot;,&quot;' + elem.GSTNo + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.PartyName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                    });

                    $('#tbleParty tbody').html(html);

                    if (data.Data.State == true)
                        $('#btnLoadMore').prop('disabled', false);
                    else $('#btnLoadMore').prop('disabled', true);
                }
            }
        });
    }

    function LoadMoreParty() {
        debugger;
        $.ajax({
            url: '/Import/VRN_CWCImport/LoadPartyList',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    $.each(data.Data.lstParty, function (item, elem) {
                        debugger;
                        html += '<tr onclick="SelectParty(' + elem.PartyId + ',&quot;' + elem.PartyName + '&quot;,&quot;' + elem.Address + '&quot;,&quot;' + elem.State + '&quot;,&quot;' + elem.StateCode + '&quot;,&quot;' + elem.GSTNo + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.PartyName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                    });
                    if (Page == -1)
                        $('#tbleParty tbody').html(html);
                    else
                        $('#tbleParty tbody').append(html);
                    Page++;

                    debugger;
                    if (data.Data.State == true)
                        $('#btnLoadMore').prop('disabled', false);
                    else $('#btnLoadMore').prop('disabled', true);
                }
            }
        });
    }

    function SearchPartyByPartyCode() {
        debugger;
        if ($('#Partybox').val() != '') {
            $.ajax({
                url: '/Import/VRN_CWCImport/SearchPartyNameByPartyCode',
                type: 'GET',
                data: { PartyCode: $('#Partybox').val() },
                success: function (data) {
                    if (data.Status == 1) {
                        var html = '';
                        $.each(data.Data.lstParty, function (item, elem) {
                            html += '<tr onclick="SelectParty(' + elem.PartyId + ',&quot;' + elem.PartyName + '&quot;,&quot;' + elem.Address + '&quot;,&quot;' + elem.State + '&quot;,&quot;' + elem.StateCode + '&quot;,&quot;' + elem.GSTNo + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.PartyName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                        });
                        $('#tbleParty tbody').html('');
                        $('#tbleParty tbody').html(html);
                        $('#btnLoadMore').prop('disabled', false);
                        Page = -1;
                    }
                    else {
                        $('#tbleParty tbody').html('');
                        Page = -1;
                        $('#btnLoadMore').prop('disabled', false);
                    }

                }
            });
        }
        else
            LoadParty();
    }

    function CloseParty() {
        $('#Partybox').val('');
        $("#PartyModal").modal("hide");
        LoadParty();
    }

    function SelectPayee(PartyId, PartyName) {
        $('#PayeeId').val(PartyId);
        $('#PayeeName').val(PartyName);
        $("#PayeeModal").modal("hide");
        LoadPayee();
    }

    function LoadPayee() {
        debugger;
        Page = 0;
        $.ajax({
            url: '/Import/VRN_CWCImport/LoadPartyList',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    $.each(data.Data.lstParty, function (item, elem) {
                        debugger;
                        html += '<tr onclick="SelectPayee(' + elem.PartyId + ',&quot;' + elem.PartyName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.PartyName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                    });

                    $('#tblePayee tbody').html(html);

                    if (data.Data.State == true)
                        $('#btnLoadMorePayee').prop('disabled', false);
                    else $('#btnLoadMorePayee').prop('disabled', true);
                }
            }
        });
    }





    function LoadMorePayee() {
        debugger;
        $.ajax({
            url: '/Import/VRN_CWCImport/LoadCHAListforSingleClick',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    $.each(data.Data.lstCHA, function (item, elem) {
                        debugger;
                        html += '<tr onclick="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                    });
                    if (Page == -1)
                        $('#tblePayee tbody').html(html);
                    else
                        $('#tblePayee tbody').append(html);
                    Page++;

                    debugger;
                    if (data.Data.State == true)
                        $('#btnLoadMorePayee').prop('disabled', false);
                    else $('#btnLoadCHA').prop('disabled', true);
                }
            }
        });
    }


    function LoadMorePartyGst() {
        debugger;
        $.ajax({
            url: '/Import/VRN_CWCImport/LoadCHAListforSingleClick',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                if (data.Status == 1) {
                    debugger;
                    var html = '';
                    $.each(data.Data.lstCHA, function (item, elem) {
                        debugger;
                        html += '<tr onclick="SelectPartyName(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                    });
                    if (Page == -1)
                        $('#tblePartyGst tbody').html(html);
                    else
                        $('#tblePartyGst tbody').append(html);
                    Page++;

                    debugger;
                    if (data.Data.State == true)
                        $('#btnLoadMorePayee').prop('disabled', false);
                    else $('#btnLoadCHA').prop('disabled', true);
                }
            }
        });
    }
    function SearchPayeeByPayeeCode() {
        debugger;
        if ($('#Payeebox').val() != '') {
            $.ajax({
                url: '/Import/VRN_CWCImport/SearchPartyNameByPartyCode',
                type: 'GET',
                data: { PartyCode: $('#Payeebox').val() },
                success: function (data) {
                    if (data.Status == 1) {
                        var html = '';
                        $.each(data.Data.lstParty, function (item, elem) {
                            html += '<tr onclick="SelectPayeeName(' + elem.PartyId + ',&quot;' + elem.PartyName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.PartyName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                        });
                        $('#tblePayee tbody').html('');
                        $('#tblePayee tbody').html(html);
                        $('#btnLoadMorePayee').prop('disabled', false);
                        Page = -1;
                    }
                    else {
                        $('#tblePayee tbody').html('');
                        Page = -1;
                        $('#btnLoadMorePayee').prop('disabled', false);
                    }

                }
            });
        }
        else
            LoadPayee();
    }















    function SearchPartyByPayeeCode() {
        debugger;
        if ($('#PartyGstbox').val() != '') {
            $.ajax({
                url: '/Import/VRN_CWCImport/SearchPartyNameByPartyCode',
                type: 'GET',
                data: { PartyCode: $('#PartyGstbox').val() },
                success: function (data) {
                    if (data.Status == 1) {
                        var html = '';
                        $.each(data.Data.lstParty, function (item, elem) {
                            html += '<tr onclick="SelectPartyName(' + elem.PartyId + ',&quot;' + elem.PartyName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.PartyName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                        });
                        $('#tblePartyGst tbody').html('');
                        $('#tblePartyGst tbody').html(html);
                        $('#btnLoadMorePayee').prop('disabled', false);
                        Page = -1;
                    }
                    else {
                        $('#tblePartyGst tbody').html('');
                        Page = -1;
                        $('#btnLoadMorePayee').prop('disabled', false);
                    }

                }
            });
        }
        else
            LoadPayee();
    }






    function ClosePayee() {
        $('#Payeebox').val('');
        $("#PayeeModal").modal("hide");
        LoadPayee();
    }
</script>

<script>
    function BOESelect() {
        ArrayBOE = [];
        debugger;
        $('#lstBOENo tbody tr').each(function () {
            debugger;
            var Chk = $(this).find('input[type="checkbox"]');
            if ($(Chk).is(':checked')) {
                var Line = {
                    "LineNo": $(Chk).attr('data-val'),
                    "CFSCode": $(Chk).attr('data-cfs')
                }
                ArrayBOE.push(Line);

            }
        });
        if (ArrayBOE.length > 0 && $('#InvoiceDate').val() != "") {
            $.ajax({
                url: '/Import/VRN_CWCImport/GetDeliveryPaymentSheet',
                type: 'POST',
                data: {
                    InvoiceDate: $('#InvoiceDate').val(),
                    InvoiceType: TaxType,
                    AppraisementId: parseInt($('#StuffingReqId').val()),
                    DeliveryType: 0,
                    AppraisementNo: $('#StuffingReqNo').val(),
                    AppraisementDate: $('#StuffingReqDate').val(),
                    PartyId: $('#PartyId').val(),
                    PartyName: $('#PartyName').val(),
                    PartyAddress: $('#hdnAddress').val(),
                    PartyState: $('#hdnState').val(),
                    PartyStateCode: $('#hdnStateCode').val(),
                    PartyGST: $('#GSTNo').val(),
                    PayeeId: $('#PayeeId').val(),
                    PayeeName: $('#PayeeName').val(),
                    OTHours:($('#OTHours').val()==''?0:$('#OTHours').val()),
                    lstPaySheetBOE: ArrayBOE
                },
                dataType: 'JSON',
                success: function (data) {
                    debugger;
                    if (data != null && data != 'undefined') {
                        $('#PaymentSheetModelJson').val(JSON.stringify(data));
                        //ContainerSelectiner Binding
                        $('#OTHours').prop('readonly', true);
                        $('#Importers').val(data.ImporterExporter);
                        PModeValue = data.PaymentMode;
                        $('#PMode').html(data.PaymentMode);
                        var html = '';
                        //$.each(data.lstPostPaymentCont, function (i, item) {
                        //    html += '<tr><td>' + (i + 1) + '</td><td>' + item.CFSCode + '</td><td>' + item.ContainerNo + '</td><td>' + item.Size + '</td><td>';//
                        //    if (item.Reefer == 1) {
                        //        html += '<input type="checkbox" checked disabled id="chk' + i + '" /><label for="chk' + i + '"><i class="square" style="margin-left:10px;"></i></label></td><td>' + (item.Insured == 1 ? 'Yes' : 'No') + '</td><td>'+(item.CargoType==1?'Haz':(item.CargoType==2?'Non Haz':''))+'</td><td></td></tr>';
                        //    }
                        //    else {
                        //        html += '<input type="checkbox" disabled id="chk' + i + '" /><label for="chk' + i + '"><i class="square" style="margin-left:10px;"></i></label></td><td>' + (item.Insured == 1 ? 'Yes' : 'No') + '</td><td>' + (item.CargoType == 1 ? 'Haz' : (item.CargoType == 2 ? 'Non Haz' : '')) + '</td><td></td></tr>';
                        //    }
                        //});
                        //$('#tblContainer tbody').html(html);




                        var html = '';
                        $.each(data.lstInvoiceCargo, function (i, item) {
                            var dt = item.BOLDate.split("/");
                            var dt1 = dt[2].split(" ");

                            var dtt = dt[0] + "/" + dt[1] + "/" + dt1[0];
                            html += '<tr><td>' + (i + 1) + '</td><td>' + item.BOLNo + '</td><td>' + dtt + '</td><td>' + (item.CargoType == 1 ? 'Haz' : (item.CargoType == 2 ? 'Non Haz' : '')) + '</td></tr>';//

                            //  html += '<input type="checkbox" disabled id="chk' + i + '" /><label for="chk' + i + '"><i class="square" style="margin-left:10px;"></i></label></td><td>' + (item.Insured == 1 ? 'Yes' : 'No') + '</td><td>' + (item.CargoType == 1 ? 'Haz' : (item.CargoType == 2 ? 'Non Haz' : '')) + '</td><td></td></tr>';

                        });
                        $('#tblOBL tbody').html(html);

                        //CWC Charge Binding
                        // var CWCCharge = $.grep(data.lstPostPaymentChrg, function (item) { return item.ChargeType == "CWC"; });
                        /****************************CWC and HT Charge Bind*******************************/
                        html = '';
                        var tamt = 0;
                        var HtCharges = ['LOL', 'LOE', 'SH', 'BTT', 'TPT', 'DTF', 'HND', 'MF'];
                        var CWCChargesList = data.lstPostPaymentChrg.filter(function (item) {
                            return HtCharges.indexOf(item.Clause) < 0;
                        });
                        $.each(CWCChargesList, function (i, item) {

                            tmat = tamt + item.Amount.toFixed(2);
                            html += '<tr><td>' + item.Clause + '. ' + item.ChargeName + '</td>'
                                    + '<td class="Table_right"><input id="' + item.ChargeId + '" type="text"  value="' + item.Amount.toFixed(2) + '" readonly/></td>'
                                    + '<td class="Table_right"><input id="IGSTP' + item.ChargeId + '" type="text" value="' + item.IGSTPer + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="IGSTA' + item.ChargeId + '" type="text" value="' + item.IGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="CGSTP' + item.ChargeId + '" type="text" value="' + item.CGSTPer + '"  readonly /></td>'
                                    + '<td class="Table_right"><input id="CGSTA' + item.ChargeId + '" type="text" value="' + item.CGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="SGSTP' + item.ChargeId + '" type="text" value="' + item.SGSTPer + '"  readonly /></td>'
                                    + '<td class="Table_right"><input id="SGSTA' + item.ChargeId + '" type="text" value="' + item.SGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="TOT' + item.ChargeId + '" type="text" value="' + item.Total.toFixed(2) + '" readonly /></td></tr>';
                        });
                        $('#tblCWCCharges tbody').html(html);
                        html = '';
                        var HTChargesList = data.lstPostPaymentChrg.filter(function (item) {
                            return HtCharges.indexOf(item.Clause) > -1;
                        });
                        $.each(HTChargesList, function (i, item) {

                            tmat = tamt + item.Amount.toFixed(2);
                            html += '<tr><td>' + item.Clause + '. ' + item.ChargeName + '</td>'
                                    + '<td class="Table_right"><input id="' + item.ChargeId + '" type="text"  value="' + item.Amount.toFixed(2) + '" readonly/></td>'
                                    + '<td class="Table_right"><input id="IGSTP' + item.ChargeId + '" type="text" value="' + item.IGSTPer + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="IGSTA' + item.ChargeId + '" type="text" value="' + item.IGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="CGSTP' + item.ChargeId + '" type="text" value="' + item.CGSTPer + '"  readonly /></td>'
                                    + '<td class="Table_right"><input id="CGSTA' + item.ChargeId + '" type="text" value="' + item.CGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="SGSTP' + item.ChargeId + '" type="text" value="' + item.SGSTPer + '"  readonly /></td>'
                                    + '<td class="Table_right"><input id="SGSTA' + item.ChargeId + '" type="text" value="' + item.SGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="TOT' + item.ChargeId + '" type="text" value="' + item.Total.toFixed(2) + '" readonly /></td></tr>';
                        });
                        $('#tblHTCharges tbody').html(html);
                        /**********************************************************************/
                        //  $('#CWCTDSPer').val(data.CWCTDSPer.toFixed(2));
                        // $('#TOTCWCTDS').val(Math.round(data.CWCTDS.toFixed(2)));
                        //HT Charge Binding*/
                        //var HTCharge = $.grep(data.lstPostPaymentChrg, function (item) { return item.ChargeType == "HT"; });
                        //html = '';
                        //$.each(HTCharge, function (i, item) {
                        //    html += '<tr><td>' + item.Clause + '. ' + item.ChargeName + '</td>'
                        //            + '<td class="Table_right"><input id="' + item.ChargeId + '" type="text" value="' + item.Amount.toFixed(2) + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" /></td>'
                        //            + '<td class="Table_right"><input id="IGSTP' + item.ChargeId + '" type="text" value="' + item.IGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                        //            + '<td class="Table_right"><input id="IGSTA' + item.ChargeId + '" type="text" value="' + item.IGSTAmt.toFixed(2) + '" readonly /></td>'
                        //            + '<td class="Table_right"><input id="CGSTP' + item.ChargeId + '" type="text" value="' + item.CGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                        //            + '<td class="Table_right"><input id="CGSTA' + item.ChargeId + '" type="text" value="' + item.CGSTAmt.toFixed(2) + '" readonly /></td>'
                        //            + '<td class="Table_right"><input id="SGSTP' + item.ChargeId + '" type="text" value="' + item.SGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                        //            + '<td class="Table_right"><input id="SGSTA' + item.ChargeId + '" type="text" value="' + item.SGSTAmt.toFixed(2) + '" readonly /></td>'
                        //            + '<td class="Table_right"><input id="TOT' + item.ChargeId + '" type="text" value="' + item.Total.toFixed(2) + '" readonly /></td></tr>';
                        //});
                        //$('#tblHTCharges tbody').html(html);
                        //$('#HTTDSPer').val(data.HTTDSPer.toFixed(2));
                        //$('#TOTHTTDS').val(Math.round(data.HTTDS.toFixed(2)));

                        //Total Charge Calculation

                        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
                        var TotalCWC = 0;
                        //   var CWCCharge = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeType == "CWC"; });

                        $.each(data.lstPostPaymentChrg, function (i, item) {
                            TotalCWC += item.Total;
                        });
                        $('#TOTCWCChrg').val((TotalCWC).toFixed(2));

                        //var TotalHT = 0;
                        //var HTCharge = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeType == "HT"; });

                        //$.each(HTCharge, function (i, item) {
                        //    TotalHT += item.Total;
                        //});
                        //$('#TOTHTChrg').val((TotalHT).toFixed(2));

                        $('#AllTotal').val((TotalCWC).toFixed(2));


                        $('#AllTotal').val((TotalCWC).toFixed(2));

                        var AllTot = Math.ceil(TotalCWC);
                        var roundup = AllTot - TotalCWC;
                        //    $('#TotalTDS').val(Math.round(data.TDS.toFixed(2)));
                        // $('#TotalTDSCol').val(Math.round(data.TDSCol.toFixed(2)));
                        $('#RoundUp').val(roundup.toFixed(2));
                        $('#InvoiceValue').val(AllTot.toFixed(2));
                        data.InvoiceAmt = AllTot;
                        data.RoundUp = roundup;
                        data.TotalAmt = tmat;
                        //    $('#TotalTDS').val(Math.round(data.TDS.toFixed(2)));
                        // $('#TotalTDSCol').val(Math.round(data.TDSCol.toFixed(2)));
                        // $('#RoundUp').val(data.RoundUp.toFixed(2));
                        // $('#InvoiceValue').val(data.InvoiceAmt.toFixed(2));
                        data.TotalAmt = tmat;
                        //CalcInvoice();
                        $('.search').css('display', 'none');
                        $('#InvoiceDate').parent().find('img').css('display', 'none');
                        if (data.hasSDAvailableBalance == 0) {
                            alert("Your Invoice can not be saved due to SD Amount is low");

                            $('#savbtn').attr('disabled', 'disabled');
                        }
                        else {
                            $('#savbtn').removeAttr('disabled');
                        }
                        $('#DeliApp_lstContWiseAmountXML').val(JSON.stringify(rawJson.lstContWiseAmount));
                        $('#DeliApp_lstInvoiceCargoXML').val(JSON.stringify(rawJson.lstInvoiceCargo));
                        $('#DeliApp_lstOperationCFSCodeWiseAmountXML').val(JSON.stringify(rawJson.lstOperationCFSCodeWiseAmount));
                        $('#DeliApp_lstPostPaymentChrgXML').val(JSON.stringify(rawJson.lstPostPaymentChrg));
                        $('#DeliApp_lstPostPaymentChrgBreakupXML').val(JSON.stringify( rawJson.lstPostPaymentChrgBreakup));
                        $('#DeliApp_lstPostPaymentContXML').val(JSON.stringify(rawJson.lstPostPaymentCont));
                        $('#DeliApp_lstPrePaymentContXML').val(JSON.stringify(rawJson.lstPrePaymentCont));


                    }
                    else {
                        $('#PaymentSheetModelJson').val('');
                        $('#tblContainer tbody').html('');
                        $('#tblOBL tbody').html('');
                        $('#tblCWCCharges tbody').html('');
                        $('#tblHTCharges tbody').html('');
                        $('#TOTCWCChrg').val('');
                        $('#TOTHTChrg').val('');
                        $('#AllTotal').val('');
                        $('#RoundUp').val('');
                    }
                }
            });
        }
        else {
            $('#PaymentSheetModelJson').val('');
            $('#tblContainer tbody').html('');
            $('#tblOBL tbody').html('');
            $('#tblCWCCharges tbody').html('');
            $('#tblHTCharges tbody').html('');
            $('#TOTCWCChrg').val('');
            $('#TOTHTChrg').val('');
            $('#AllTotal').val('');
            $('#RoundUp').val('');
        }
    }

    var PModeValue = "";

    function ContainerSelect() {
        debugger;
        ArrayContainer = [];
        $('#lstcfsCode tbody tr').each(function () {
            debugger;
            var Chk = $(this).find('input[type="checkbox"]');
            if ($(Chk).is(':checked')) {
                var Container = {
                    "CFSCode": $(Chk).attr('id')
                }
                ArrayContainer.push(Container);
            }
        });
        if (ArrayContainer.length > 0) {
            $.ajax({
                url: '/Import/CWCImport/GetPaymentSheetDeliveryBOE',
                type: 'POST',
                data: { lstPaySheetContainer: ArrayContainer },
                dataType: 'JSON',
                success: function (data) {
                    $('#BOEJson').val(data);
                    debugger;
                    BOEJson = JSON.parse(data);
                    var html = '';
                    $.each(BOEJson, function (i, item) {
                        if (item.Selected)
                            html += '<tr><td><div class="boolean-container"><input type="checkbox" checked id="chk_' + item.LineNo + item.CFSCode + '" data-val="' + item.LineNo + '" data-cfs="' + item.CFSCode + '"/><label for="chk_' + item.LineNo + item.CFSCode + '"><i class="square" style="margin-left:10px;"></i></label></div></td><td>' + item.CFSCode + '</td>'
                                + '<td>' + item.BOENo + '</td><td>' + item.BOEDate + '</td><td>' + item.LineNo + '</td></tr>';
                        else
                            html += '<tr><td><div class="boolean-container"><input type="checkbox" checked id="chk_' + item.LineNo + item.CFSCode + '" data-val="' + item.LineNo + '" data-cfs="' + item.CFSCode + '"/><label for="chk_' + item.LineNo + item.CFSCode + '"><i class="square" style="margin-left:10px;"></i></label></div></td><td>' + item.CFSCode + '</td>'
                              + '<td>' + item.BOENo + '</td><td>' + item.BOEDate + '</td><td>' + item.LineNo + '</td></tr>';
                    });
                    $('#lstBOENo tbody').html(html);
                }
            });
        }
        else {
            $('#lstBOENo tbody').html('');
        }
    }

    /*
    function ContainerSelect() {
        ArrayContainer = [];
        $('#lstcfsCode tbody tr').each(function () {
            debugger;
            var Chk = $(this).find('input[type="checkbox"]');
            if ($(Chk).is(':checked')) {
                var Container = {
                    "CFSCode": $(Chk).attr('id')
                }
                ArrayContainer.push(Container);
            }
        });
        if (ArrayContainer.length > 0 && $('#InvoiceDate').val() != "") {
            $.ajax({
                url: '/Import/CWCImport/GetContainerPaymentSheet',
                type: 'POST',
                data: {
                    InvoiceDate: $('#InvoiceDate').val(),
                    InvoiceType: TaxType,
                    AppraisementId: parseInt($('#StuffingReqId').val()),
                    DeliveryType: parseInt($('#hdnDeliveryType').val()),
                    AppraisementNo: $('#StuffingReqNo').val(),
                    AppraisementDate: $('#StuffingReqDate').val(),
                    PartyId: $('#PartyId').val(),
                    PartyName: $('#PartyName').val(),
                    PartyAddress: $('#hdnAddress').val(),
                    PartyState: $('#hdnState').val(),
                    PartyStateCode: $('#hdnStateCode').val(),
                    PartyGST: $('#GSTNo').val(),
                    PayeeId: $('#PayeeId').val(),
                    PayeeName: $('#PayeeName').val(),
                    lstPaySheetContainer: ArrayContainer
                },
                dataType: 'JSON',
                success: function (data) {
                    debugger;
                    if (data != null && data != 'undefined') {
                        $('#PaymentSheetModelJson').val(JSON.stringify(data));
                        //Container Binding
                        var html = '';
                        $.each(data.lstPostPaymentCont, function (i, item) {
                            html += '<tr><td>' + (i + 1) + '</td><td>' + item.CFSCode + '</td><td>' + item.ContainerNo + '</td><td>' + item.Size + '</td><td>';//
                            if (item.Reefer == 1) {
                                html += '<input type="checkbox" checked disabled id="chk' + i + '" /><label for="chk' + i + '"><i class="square" style="margin-left:10px;"></i></label></td><td>' + (item.Insured == 0 ? 'No' : 'Yes') + '</td><td></td></tr>';
                            }
                            else {
                                html += '<input type="checkbox" disabled id="chk' + i + '" /><label for="chk' + i + '"><i class="square" style="margin-left:10px;"></i></label></td><td>' + (item.Insured == 0 ? 'No' : 'Yes') + '</td><td></td></tr>';
                            }
                        });
                        $('#tblContainer tbody').html(html);

                        //CWC Charge Binding
                        debugger;
                        var CWCCharge = $.grep(data.lstPostPaymentChrg, function (item) { return item.ChargeType == "CWC"; });
                        html = '';
                        $.each(CWCCharge, function (i, item) {
                            html += '<tr><td>' + item.Clause + '. ' + item.ChargeName + '</td>'
                                    + '<td class="Table_right"><input id="' + item.ChargeId + '" type="text" value="' + item.Amount.toFixed(2) + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)"/></td>'
                                    + '<td class="Table_right"><input id="IGSTP' + item.ChargeId + '" type="text" value="' + item.IGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                                    + '<td class="Table_right"><input id="IGSTA' + item.ChargeId + '" type="text" value="' + item.IGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="CGSTP' + item.ChargeId + '" type="text" value="' + item.CGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                                    + '<td class="Table_right"><input id="CGSTA' + item.ChargeId + '" type="text" value="' + item.CGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="SGSTP' + item.ChargeId + '" type="text" value="' + item.SGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                                    + '<td class="Table_right"><input id="SGSTA' + item.ChargeId + '" type="text" value="' + item.SGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="TOT' + item.ChargeId + '" type="text" value="' + item.Total.toFixed(2) + '" readonly /></td></tr>';
                        });
                        $('#tblCWCCharges tbody').html(html);
                        $('#CWCTDSPer').val(data.CWCTDSPer.toFixed(2));
                        $('#TOTCWCTDS').val(data.CWCTDS.toFixed(2));
                        debugger;
                        //HT Charge Binding
                        var HTCharge = $.grep(data.lstPostPaymentChrg, function (item) { return item.ChargeType == "HT"; });
                        html = '';
                        $.each(HTCharge, function (i, item) {
                            html += '<tr><td>' + item.Clause + '. ' + item.ChargeName + '</td>'
                                    + '<td class="Table_right"><input id="' + item.ChargeId + '" type="text" value="' + item.Amount.toFixed(2) + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" /></td>'
                                    + '<td class="Table_right"><input id="IGSTP' + item.ChargeId + '" type="text" value="' + item.IGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                                    + '<td class="Table_right"><input id="IGSTA' + item.ChargeId + '" type="text" value="' + item.IGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="CGSTP' + item.ChargeId + '" type="text" value="' + item.CGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                                    + '<td class="Table_right"><input id="CGSTA' + item.ChargeId + '" type="text" value="' + item.CGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="SGSTP' + item.ChargeId + '" type="text" value="' + item.SGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                                    + '<td class="Table_right"><input id="SGSTA' + item.ChargeId + '" type="text" value="' + item.SGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td class="Table_right"><input id="TOT' + item.ChargeId + '" type="text" value="' + item.Total.toFixed(2) + '" readonly /></td></tr>';
                        });
                        $('#tblHTCharges tbody').html(html);
                        $('#HTTDSPer').val(data.HTTDSPer.toFixed(2));
                        $('#TOTHTTDS').val(data.HTTDS.toFixed(2));

                        //Total Charge Calculation

                        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
                        var TotalCWC = 0;
                        var CWCCharge = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeType == "CWC"; });

                        $.each(CWCCharge, function (i, item) {
                            TotalCWC += item.Total;
                        });
                        $('#TOTCWCChrg').val((TotalCWC).toFixed(2));

                        var TotalHT = 0;
                        var HTCharge = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeType == "HT"; });

                        $.each(HTCharge, function (i, item) {
                            TotalHT += item.Total;
                        });
                        $('#TOTHTChrg').val((TotalHT).toFixed(2));
                        $('#AllTotal').val((TotalCWC + TotalHT).toFixed(2));
                        $('#TotalTDS').val(data.TDS.toFixed(2));
                        $('#TotalTDSCol').val(data.TDSCol.toFixed(2));
                        $('#RoundUp').val(data.RoundUp.toFixed(2));
                        $('#InvoiceValue').val(data.InvoiceAmt.toFixed(2));
                        //CalcInvoice();
                    }
                    else {
                        $('#PaymentSheetModelJson').val('');
                        $('#tblContainer tbody').html('');
                        $('#tblCWCCharges tbody').html('');
                        $('#tblHTCharges tbody').html('');
                        $('#TOTCWCChrg').val('');
                        $('#TOTHTChrg').val('');
                        $('#AllTotal').val('');
                        $('#RoundUp').val('');
                    }
                }
            });
        }
    }
    */
    /*
    function CalcTax(elem) {
        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
        var MAmt = Number($('#' + elem).val());
        var IP = 0;
        var CP = 0;
        var SP = 0;
        if (rawJson.InvoiceType == "Tax") {
            if (rawJson.PartyStateCode == rawJson.CompStateCode) {
                CP = Number($('#CGSTP' + elem).val());
                SP = Number($('#SGSTP' + elem).val());
            }
            else {
                IP = Number($('#IGSTP' + elem).val());
            }
        }
        $('#IGSTA' + elem).val((MAmt * (IP / 100)).toFixed(2));
        $('#CGSTA' + elem).val((MAmt * (CP / 100)).toFixed(2));
        $('#SGSTA' + elem).val((MAmt * (SP / 100)).toFixed(2));
        $('#TOT' + elem).val((MAmt + (MAmt * (IP / 100)) + (MAmt * (CP / 100)) + (MAmt * (SP / 100))).toFixed(2));
        var selectedItem = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeId == elem; })[0];
        selectedItem.Amount = MAmt;
        //selectedItem.IGSTPer = IP;
        selectedItem.IGSTAmt = MAmt * (IP / 100);
        //selectedItem.CGSTPer = CP;
        selectedItem.CGSTAmt = MAmt * (CP / 100);
        //selectedItem.SGSTPer = SP;
        selectedItem.SGSTAmt = MAmt * (SP / 100);
        selectedItem.Total = (MAmt + (MAmt * (IP / 100)) + (MAmt * (CP / 100)) + (MAmt * (SP / 100)));

        var TotalCWC = 0;
        var CWCAmt = 0;
        var TotalCGST = 0;
        var TotalSGST = 0;
        var TotalIGST = 0;
        var CWCCharge = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeType == "CWC"; });

        $.each(CWCCharge, function (i, item) {
            TotalCWC += item.Total;
            CWCAmt += item.Amount;
            TotalCGST += item.CGSTAmt;
            TotalSGST += item.SGSTAmt;
            TotalIGST += item.IGSTAmt;
        });
        $('#TOTCWCChrg').val((TotalCWC).toFixed(2));
        $('#TOTCWCTDS').val(((CWCAmt * 10) / 100).toFixed(2));

        var TotalHT = 0;
        var HTAmt = 0;
        var HTCharge = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeType == "HT"; });

        $.each(HTCharge, function (i, item) {
            TotalHT += item.Total;
            HTAmt += item.Amount;
            TotalCGST += item.CGSTAmt;
            TotalSGST += item.SGSTAmt;
            TotalIGST += item.IGSTAmt;
        });
        $('#TOTHTChrg').val((TotalHT).toFixed(2));
        $('#TOTHTTDS').val(((HTAmt * 2) / 100).toFixed(2));

        rawJson.TotalCGST = TotalCGST;
        rawJson.TotalSGST = TotalSGST;
        rawJson.TotalIGST = TotalIGST;
        rawJson.TotalAmt = CWCAmt + HTAmt;
        $('#AllTotal').val((TotalCWC + TotalHT).toFixed(2));
        $('#PaymentSheetModelJson').val(JSON.stringify(rawJson));
        CalcInvoice();
    }

    function CalcInvoice() {
        var CWCTotal = Number($('#TOTCWCChrg').val());
        var CWCTDSPer = Number($('#CWCTDSPer').val());
        var CurCWCTds = (CWCTotal * CWCTDSPer) / 100;
        $('#TOTCWCTDS').val(CurCWCTds.toFixed(2));

        var HTTotal = Number($('#TOTHTChrg').val());
        var HTTDSPer = Number($('#HTTDSPer').val());
        var CurHTTds = (HTTotal * HTTDSPer) / 100;
        $('#TOTHTTDS').val(CurHTTds.toFixed(2));

        $('#TotalTDS').val((CurCWCTds + CurHTTds).toFixed(2));

        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
        rawJson.CWCTDSPer = CWCTDSPer;
        rawJson.CWCTDS = CurCWCTds;
        rawJson.HTTDSPer = HTTDSPer;
        rawJson.HTTDS = CurHTTds;
        rawJson.TDS = (CurCWCTds + CurHTTds);
        rawJson.TDSCol = Number($('#TotalTDSCol').val());
        rawJson.AllTotal = (CWCTotal + HTTotal + Number($('#TotalTDSCol').val())) - (CurCWCTds + CurHTTds);
        var round = Math.ceil(rawJson.AllTotal) - rawJson.AllTotal;
        rawJson.InvoiceAmt = Math.ceil(rawJson.AllTotal);

        if (rawJson.TDSCol.toFixed(2) > rawJson.TDS.toFixed(2)) {
            alert("Invalid TDS collection");
            setTimeout(function () {
                $('#TotalTDSCol').val(0);
                $('#TotalTDSCol').focus().select();
            }, 100);
        }

        $('#AllTotal').val(rawJson.AllTotal.toFixed(2));
        $('#RoundUp').val(round.toFixed(2));
        $('#InvoiceValue').val(rawJson.InvoiceAmt.toFixed(2));
        $('#PaymentSheetModelJson').val(JSON.stringify(rawJson));
    }

    function CalcInvoice1() {
        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
        var TDSCol_New = Number($('#TotalTDSCol').val());
        if (TDSCol_New > rawJson.TDS.toFixed(2)) {
            alert("Invalid TDS collection");
            rawJson.TDSCol = 0;
            setTimeout(function () {
                $('#TotalTDSCol').val(0);
                $('#TotalTDSCol').focus().select();
            }, 100);
        }
        else {
            rawJson.TDSCol = Number($('#TotalTDSCol').val());
            rawJson.AllTotal = (rawJson.CWCTotal + rawJson.HTTotal + Number($('#TotalTDSCol').val())) - (rawJson.CWCTDS + rawJson.HTTDS);
            var round = Math.ceil(rawJson.AllTotal) - rawJson.AllTotal;
            rawJson.InvoiceAmt = Math.ceil(rawJson.AllTotal);
            $('#AllTotal').val(rawJson.AllTotal.toFixed(2));
            $('#RoundUp').val(round.toFixed(2));
            $('#InvoiceValue').val(rawJson.InvoiceAmt.toFixed(2));
            $('#PaymentSheetModelJson').val(JSON.stringify(rawJson));
        }
    }

    function BindJson() {
        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
        rawJson.InvoiceId = 0;
        rawJson.InvoiceType = TaxType;
        rawJson.InvoiceDate = $('#InvoiceDate').val();
        rawJson.RequestId = $('#StuffingReqId').val();
        rawJson.RequestNo = $('#StuffingReqNo').val();
        rawJson.RequestDate = $('#StuffingReqDate').val();
        rawJson.PartyId = $('#PartyId').val();
        rawJson.PartyName = $('#PartyName').val();
        rawJson.PayeeId = $('#PayeeId').val();
        rawJson.PayeeName = $('#PayeeName').val();
        rawJson.PartyGST = $('#GSTNo').val();
        rawJson.Remarks = $('#Remarks').val();
        rawJson.PartyAddress = $('#hdnAddress').val();
        rawJson.PartyState = $('#hdnState').val();
        rawJson.PartyStateCode = $('#hdnStateCode').val();
        rawJson.CompanyAddress = (rawJson.CompanyAddress).replace(new RegExp('<br/>', "gi"), '|_br_|');
        rawJson.ROAddress = (rawJson.ROAddress).replace(new RegExp('<br/>', "gi"), '|_br_|');
        rawJson.InvoiceHtml = InvoiceHtml(rawJson);
        $('#PaymentSheetModelJson').val(JSON.stringify(rawJson));
        $('form#PaymentSheetForm').submit();
    }

    */


    function CalcTax(elem) {
        debugger;
        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
        var MAmt = Number($('#' + elem).val());
        var IP = 0;
        var CP = 0;
        var SP = 0;
        if (rawJson.InvoiceType == "Tax") {
            if (rawJson.PartyStateCode == rawJson.CompStateCode) {
                CP = Number($('#CGSTP' + elem).val());
                SP = Number($('#SGSTP' + elem).val());
            }
            else {
                IP = Number($('#IGSTP' + elem).val());
            }
        }
        $('#IGSTA' + elem).val((MAmt * (IP / 100)).toFixed(2));
        $('#CGSTA' + elem).val((MAmt * (CP / 100)).toFixed(2));
        $('#SGSTA' + elem).val((MAmt * (SP / 100)).toFixed(2));
        $('#TOT' + elem).val((MAmt + Number((MAmt * (IP / 100)).toFixed(2)) + Number((MAmt * (CP / 100)).toFixed(2)) + Number((MAmt * (SP / 100)).toFixed(2))).toFixed(2));
        var selectedItem = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeId == elem; })[0];
        selectedItem.Amount = Number(MAmt.toFixed(2));
        //selectedItem.IGSTPer = IP;
        selectedItem.IGSTAmt = Number((MAmt * (IP / 100)).toFixed(2));
        //selectedItem.CGSTPer = CP;
        selectedItem.CGSTAmt = Number((MAmt * (CP / 100)).toFixed(2));
        //selectedItem.SGSTPer = SP;
        selectedItem.SGSTAmt = Number((MAmt * (SP / 100)).toFixed(2));
        selectedItem.Total = Number($('#TOT' + elem).val());

        var TotalCWC = 0;
        var CWCAmt = 0;
        var TotalCGST = 0;
        var TotalSGST = 0;
        var TotalIGST = 0;
        var CWCCharge = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeType == "CWC"; });

        $.each(CWCCharge, function (i, item) {
            TotalCWC += Number(item.Total.toFixed(2));
            CWCAmt += Number(item.Amount.toFixed(2));
            TotalCGST += Number(item.CGSTAmt.toFixed(2));
            TotalSGST += Number(item.SGSTAmt.toFixed(2));
            TotalIGST += Number(item.IGSTAmt.toFixed(2));
        });
        rawJson.CWCAmtTotal = Number(CWCAmt.toFixed(2));
        $('#TOTCWCChrg').val((TotalCWC).toFixed(2));
        rawJson.CWCTotal = Number(TotalCWC.toFixed(2));
        $('#TOTCWCTDS').val(Math.round(((CWCAmt * rawJson.CWCTDSPer) / 100).toFixed(2)));

        var TotalHT = 0;
        var HTAmt = 0;
        var HTCharge = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeType == "HT"; });

        $.each(HTCharge, function (i, item) {
            TotalHT += Number(item.Total.toFixed(2));
            HTAmt += Number(item.Amount.toFixed(2));
            TotalCGST += Number(item.CGSTAmt.toFixed(2));
            TotalSGST += Number(item.SGSTAmt.toFixed(2));
            TotalIGST += Number(item.IGSTAmt.toFixed(2));
        });
        rawJson.HTAmtTotal = Number(HTAmt.toFixed(2));
        $('#TOTHTChrg').val((TotalHT).toFixed(2));
        rawJson.HTTotal = Number(TotalHT.toFixed(2));
        $('#TOTHTTDS').val(Math.round(((HTAmt * rawJson.HTTDSPer) / 100).toFixed(2)));

        rawJson.TotalCGST = Number(TotalCGST.toFixed(2));
        rawJson.TotalSGST = Number(TotalSGST.toFixed(2));
        rawJson.TotalIGST = Number(TotalIGST.toFixed(2));
        rawJson.TotalAmt = Number((CWCAmt + HTAmt).toFixed(2));
        //$('#AllTotal').val((TotalCWC + TotalHT).toFixed(2));
        $('#PaymentSheetModelJson').val(JSON.stringify(rawJson));
        CalcInvoice();
    }

    function CalcInvoice() {
        debugger;
        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
        var CWCTotal = rawJson.CWCAmtTotal;//Number($('#TOTCWCChrg').val());
        var CWCTDSPer = Number($('#CWCTDSPer').val());
        var CurCWCTds = (CWCTotal * CWCTDSPer) / 100;
        $('#TOTCWCTDS').val(Math.round(CurCWCTds.toFixed(2)));
        var HTTotal = rawJson.HTAmtTotal; //Number($('#TOTHTChrg').val());
        var HTTDSPer = Number($('#HTTDSPer').val());
        var CurHTTds = (HTTotal * HTTDSPer) / 100;
        $('#TOTHTTDS').val(Math.round(CurHTTds.toFixed(2)));

        $('#TotalTDS').val(Math.round((CurCWCTds + CurHTTds).toFixed(2)));
        $('#TotalTDSCol').val(Math.round((CurCWCTds + CurHTTds).toFixed(2)));

        rawJson.CWCTDSPer = CWCTDSPer;
        rawJson.CWCTDS = Math.round(CurCWCTds);
        rawJson.HTTDSPer = HTTDSPer;
        rawJson.HTTDS = Math.round(CurHTTds);
        rawJson.TDS = (Math.round(CurCWCTds + CurHTTds));
        rawJson.TDSCol = Number($('#TotalTDSCol').val());
        rawJson.AllTotal = (rawJson.CWCTotal + rawJson.HTTotal + Number($('#TotalTDSCol').val())) - (Math.round(CurCWCTds + CurHTTds));
        var round = Math.ceil(rawJson.AllTotal) - rawJson.AllTotal;
        rawJson.InvoiceAmt = Math.ceil(rawJson.AllTotal);
        rawJson.RoundUp = round;

        $('#AllTotal').val(rawJson.AllTotal.toFixed(2));
        $('#RoundUp').val(round.toFixed(2));
        $('#InvoiceValue').val(rawJson.InvoiceAmt.toFixed(2));
        $('#PaymentSheetModelJson').val(JSON.stringify(rawJson));
    }

    function CalcInvoice1() {
        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
        var TDSCol_New = Number($('#TotalTDSCol').val());
        if (TDSCol_New > rawJson.TDS.toFixed(2)) {
            alert("Invalid TDS collection");
            rawJson.TDSCol = 0;
            setTimeout(function () {
                $('#TotalTDSCol').val(0);
                $('#TotalTDSCol').focus().select();
            }, 100);
        }
        else {
            rawJson.TDSCol = Number($('#TotalTDSCol').val());
            rawJson.AllTotal = (rawJson.CWCTotal + rawJson.HTTotal + Number($('#TotalTDSCol').val())) - (rawJson.CWCTDS + rawJson.HTTDS);
            var round = Math.ceil(rawJson.AllTotal) - rawJson.AllTotal;
            rawJson.InvoiceAmt = Math.ceil(rawJson.AllTotal);
            rawJson.RoundUp = round;
            $('#AllTotal').val(rawJson.AllTotal.toFixed(2));
            $('#RoundUp').val(round.toFixed(2));
            $('#InvoiceValue').val(rawJson.InvoiceAmt.toFixed(2));
            $('#PaymentSheetModelJson').val(JSON.stringify(rawJson));
        }
    }

    function BindJson() {
        debugger;

        //    var Invdt = $('#DeliveryDateCheck').val();
        //    var DeliDt = $('#DeliAppDate').val();
        //    var jdt = new Date(Invdt);
        //    var tdt = new Date(DeliDt);
        var total = $('#InvoiceValue').val();

        if ($('#PartyName').val() == '' || $('#PartyName').val() == null)
        {
            alert('Please Select CHA Name');
            return false;
        }
        if ($('#PayeeName').val() == '' || $('#PayeeName').val() == null) {
            alert('Please Select Payee Name');
            return false;
        }

        //  if (jdt >= tdt) {

        if (total > 0) {


            if (PModeValue == "CASH") {


                var conf = confirm("Do you want to save Cash Invoice ?");
                if (conf) {
                    try {
                        $('#btnSave').attr('disabled', true);
                      
                        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());

                        var dt = rawJson.BOEDate.split("/");
                        var dt1 = "";
                        var dtt = "";
                        if (dt.length > 1) {
                            dt1 = dt[2].substring(0, 4);
                            dtt = dt1 + "-" + dt[1] + "-" + dt[0];
                        }
                        else
                        {
                            dtt = rawJson.BOEDate;
                        }
                        rawJson.InvoiceId = 0;
                        rawJson.InvoiceType = TaxType;
                        rawJson.InvoiceDate = $('#InvoiceDate').val();
                        rawJson.RequestId = $('#StuffingReqId').val();
                        rawJson.RequestNo = $('#StuffingReqNo').val();
                        rawJson.RequestDate = $('#StuffingReqDate').val();
                        rawJson.PartyId = $('#PartyId').val();
                        rawJson.PartyName = $('#PartyName').val();
                        rawJson.PayeeId = $('#PayeeId').val();
                        rawJson.PayeeName = $('#PayeeName').val();
                        rawJson.PartyGST = $('#GSTNo').val();
                        rawJson.Remarks = $('#Remarks').val();
                        rawJson.PartyAddress = $('#hdnAddress').val();
                        rawJson.PartyState = $('#hdnState').val();
                        rawJson.PartyStateCode = $('#hdnStateCode').val();
                        rawJson.BOEDate = dtt;
                        rawJson.CompanyAddress = (rawJson.CompanyAddress).replace(new RegExp('<br/>', "gi"), '|_br_|');
                        rawJson.ROAddress = (rawJson.ROAddress).replace(new RegExp('<br/>', "gi"), '|_br_|');
                        rawJson.ExportUnder = SEZ;
                        //rawJson.ROAddress = (rawJson.ROAddress).replace(/\<br/>\/g, '#$');
                        rawJson.InvoiceHtml = InvoiceHtml(rawJson);
                        rawJson.TotalAmt = Number(rawJson.TotalAmt);


                        rawJson.TotalAmt = Number(rawJson.TotalAmt.toFixed(2));
                        rawJson.TotalDiscount = Number(rawJson.TotalDiscount.toFixed(2));
                        rawJson.TotalTaxable = Number(rawJson.TotalAmt.toFixed(2));
                        rawJson.TotalCGST = Number(rawJson.TotalCGST.toFixed(2));
                        rawJson.TotalSGST = Number(rawJson.TotalSGST.toFixed(2));
                        rawJson.TotalIGST = Number(rawJson.TotalIGST.toFixed(2));
                        rawJson.CWCAmtTotal = Number(rawJson.CWCAmtTotal.toFixed(2));
                        rawJson.CWCTotal = Number(rawJson.CWCTotal.toFixed(2));
                        rawJson.HTAmtTotal = Number(rawJson.HTAmtTotal.toFixed(2));
                        rawJson.HTTotal = Number(rawJson.HTTotal.toFixed(2));
                        rawJson.AllTotal = Number(rawJson.AllTotal.toFixed(2));
                        rawJson.RoundUp = Number(rawJson.RoundUp.toFixed(2));

                        $.each(rawJson.lstPostPaymentChrg, function (i, item) {
                            item.Rate = Number(item.Rate.toFixed(2));
                            item.Amount = Number(item.Amount.toFixed(2));
                            item.Discount = Number(item.Discount.toFixed(2));
                            item.Taxable = Number(item.Taxable.toFixed(2));
                            item.IGSTPer = Number(item.IGSTPer.toFixed(2));
                            item.IGSTAmt = Number(item.IGSTAmt.toFixed(2));
                            item.CGSTPer = Number(item.CGSTPer.toFixed(2));
                            item.CGSTAmt = Number(item.CGSTAmt.toFixed(2));
                            item.SGSTPer = Number(item.SGSTPer.toFixed(2));
                            item.SGSTAmt = Number(item.SGSTAmt.toFixed(2));
                            item.Total = Number(item.Total.toFixed(2));
                        });


                        $('#PaymentSheetModelJson').val(JSON.stringify(rawJson));
                        debugger;
                        $('form#PaymentSheetForm').submit();
                    }
                    catch (e) {
                        $('#btnSave').removeAttr('disabled');
                    }
                }

            }
            else
            {
                var conf = confirm("Do you want to save SD Invoice?");
                if (conf) {
                    try {
                        $('#btnSave').attr('disabled', true);
                        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());

                        var dt = rawJson.BOEDate.split("/");

                        var dt1 = dt[2].substring(0, 4);
                        var dtt = dt1 + "-" + dt[1] + "-" + dt[0];

                        rawJson.InvoiceId = 0;
                        rawJson.InvoiceType = TaxType;
                        rawJson.InvoiceDate = $('#InvoiceDate').val();
                        rawJson.RequestId = $('#StuffingReqId').val();
                        rawJson.RequestNo = $('#StuffingReqNo').val();
                        rawJson.RequestDate = $('#StuffingReqDate').val();
                        rawJson.PartyId = $('#PartyId').val();
                        rawJson.PartyName = $('#PartyName').val();
                        rawJson.PayeeId = $('#PayeeId').val();
                        rawJson.PayeeName = $('#PayeeName').val();
                        rawJson.PartyGST = $('#GSTNo').val();
                        rawJson.Remarks = $('#Remarks').val();
                        rawJson.PartyAddress = $('#hdnAddress').val();
                        rawJson.PartyState = $('#hdnState').val();
                        rawJson.PartyStateCode = $('#hdnStateCode').val();
                        rawJson.BOEDate = dtt;
                        rawJson.CompanyAddress = (rawJson.CompanyAddress).replace(new RegExp('<br/>', "gi"), '|_br_|');
                        rawJson.ROAddress = (rawJson.ROAddress).replace(new RegExp('<br/>', "gi"), '|_br_|');
                        //rawJson.ROAddress = (rawJson.ROAddress).replace(/\<br/>\/g, '#$');
                        rawJson.InvoiceHtml = InvoiceHtml(rawJson);
                        rawJson.TotalAmt = Number(rawJson.TotalAmt);


                        rawJson.TotalAmt = Number(rawJson.TotalAmt.toFixed(2));
                        rawJson.TotalDiscount = Number(rawJson.TotalDiscount.toFixed(2));
                        rawJson.TotalTaxable = Number(rawJson.TotalAmt.toFixed(2));
                        rawJson.TotalCGST = Number(rawJson.TotalCGST.toFixed(2));
                        rawJson.TotalSGST = Number(rawJson.TotalSGST.toFixed(2));
                        rawJson.TotalIGST = Number(rawJson.TotalIGST.toFixed(2));
                        rawJson.CWCAmtTotal = Number(rawJson.CWCAmtTotal.toFixed(2));
                        rawJson.CWCTotal = Number(rawJson.CWCTotal.toFixed(2));
                        rawJson.HTAmtTotal = Number(rawJson.HTAmtTotal.toFixed(2));
                        rawJson.HTTotal = Number(rawJson.HTTotal.toFixed(2));
                        rawJson.AllTotal = Number(rawJson.AllTotal.toFixed(2));
                        rawJson.RoundUp = Number(rawJson.RoundUp.toFixed(2));

                        $.each(rawJson.lstPostPaymentChrg, function (i, item) {
                            item.Rate = Number(item.Rate.toFixed(2));
                            item.Amount = Number(item.Amount.toFixed(2));
                            item.Discount = Number(item.Discount.toFixed(2));
                            item.Taxable = Number(item.Taxable.toFixed(2));
                            item.IGSTPer = Number(item.IGSTPer.toFixed(2));
                            item.IGSTAmt = Number(item.IGSTAmt.toFixed(2));
                            item.CGSTPer = Number(item.CGSTPer.toFixed(2));
                            item.CGSTAmt = Number(item.CGSTAmt.toFixed(2));
                            item.SGSTPer = Number(item.SGSTPer.toFixed(2));
                            item.SGSTAmt = Number(item.SGSTAmt.toFixed(2));
                            item.Total = Number(item.Total.toFixed(2));
                        });


                        $('#PaymentSheetModelJson').val(JSON.stringify(rawJson));
                        debugger;
                        $('form#PaymentSheetForm').submit();
                    }
                    catch (e) {
                        $('#btnSave').removeAttr('disabled');
                    }
                }

            }
        }
        else {
            alert('Invoice Amount cannot be Zero or Negative');
            return false;
        }
    }
    // else {
    //      $('#ErrAppDate').html('Invoice Date should not be less Delivery Application Date');
    //      return false;
    // }



    var TaxType = '@ViewData["InvType"].ToString()';
    var SEZ = "";
    function IVType(Type) {
        debugger;
        TaxType = Type;
        //  alert(TaxType);
        if (TaxType == 'Tax')
            $('#Tax').prop('checked', true);
        else
            $('#Bill').prop('checked', true);
        //  $('#DivBody').load('/Import/Ppg_CWCImport/CreateDeliveryPaymentSheet?type=' + Type);
    }
    /*
    if (TaxType == 'Tax')
        $('#Tax').prop('checked', true);
    else
        $('#Bill').prop('checked', true);
        */
</script>

<script>
    function PaymentOnSuccess(data) {
        debugger;
        if (data.Status == 1 || data.Status == 2) {
            if ($('#DivPaySheetCargoMsg').hasClass('logErrMsg'))
                $('#DivPaySheetCargoMsg').removeClass('logErrMsg').addClass('logSuccMsg');
            $('#InvoiceNo').val(data.Data.InvoiceNo);
            // alert(data.Data.InvoiceId);
            $('#PaymentSheetModelJson').val(JSON.stringify(data.Data));
            $('#DivPaySheetCargoMsg').html(data.Message);
            $('#savbtn').attr('disabled', 'disabled');
            $('#btnPrint').removeAttr('disabled');
            $('#BtnContPay').removeAttr('disabled');

            GetInvoiceDetMerge(data.Data.InvoiceNo);
            // setTimeout(ResetField, TimeInSeconds);
        }
        else {
            if ($('#DivPaySheetCargoMsg').hasClass('logSuccMsg'))
                $('#DivPaySheetCargoMsg').removeClass('logSuccMsg').addClass('logErrMsg');
            $('#DivPaySheetCargoMsg').html(data.Message);
        }
    }
    function PaymentOnFailure() {
        alert("Error");
    }
    function ResetField() {
        debugger;
        $('[data-valmsg-for]').html('<span><span>');
        $('#InvoiceNo').val('');
        $('#StuffingReqNo').val('');
        $('#PartyName').val('');$('#PayeeName').val('');
        $('#GSTNo').val('');
        $('#OTHours').val('');
        $('#PMode').html('');
        $('#InvoiceNo').val('');
        $('#AllTotal').val('0');
        $('#InvoiceValue').val('0');
        $('#Remarks').val('');
        //$('#DeliveryOrderNo,#Value,#Duty,#CHAId,#Importer,#WorkOrderNo,#WorkOrderDate,#BondBOENo,#BondBOEDate,#WRNo,#WRDate,#GodownName,#CargoDescription,#SacNo,#SacDate,#Units,#Weight,#GodownId,#SpaceAppId,#ClosingUnits,#ClosingWeight,#Remarks').val('');
        // $('#tblOBL tbody,#tblCWCCharges tbody,tblHTCharges').html('');
        $('#tblHTCharges tbody').html('');
        $('#tblOBL tbody').html('');
        $('#tblCWCCharges tbody').html('');

        //   $('#DivBody').load('/Import/Ppg_CWCImport/CreateDeliveryPaymentSheet');
    }
</script>

<script>
    function InvoiceHtml(actualJson) {
        var html1 = "<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><thead><tr><th style='width:20%;'><img style='width:50%;' src='IMGLeft' /></th><th style='width:60%;'></th><th style='width:20%;'><img style='width:70%;' src='IMGRight' /></th></tr><tr><th colspan='3' style='text-align:center;vertical-align:bottom;'>CENTRAL WAREHOUSING CORPORATION<br />(A GOVT. OF INDIA UNDERTAKING)</th></tr></thead><tbody><tr><td colspan='2' style='font-weight:600;'>" + actualJson.ROAddress + "</td><td style='font-weight:600;'>" + actualJson.CompanyName + "<br />" + actualJson.CompanyAddress + "<br />" + actualJson.EmailAddress + "</td></tr><tr><td colspan='3' style='text-align:center;padding-bottom:20pt;'><span style='border-bottom:1px solid #000;font-weight:600;'>" + (actualJson.InvoiceType == "Tax" ? "TAX INVOICE" : "BILL OF SUPPLY") + "</span></td></tr><tr><td colspan='3'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><tbody><tr><td style='width:30%;'>GSTIN-<span>" + actualJson.CompGST + "</span><br />PAN NO.- <span>" + actualJson.CompPAN + "</span><br />STATE CODE : <span>" + actualJson.CompStateCode + "</span></td><td style='width:50%;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><thead><tr><th colspan='2' style='text-align:left;'>Details of Receiver ( Billed to)</th></tr></thead><tbody><tr><td style='width:45%;'>Name</td>";
        //var html1 = "<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><thead><tr><th style='width:20%;'><img style='width:50%;' src='IMGLeft'/></th><th style='width:60%;'></th><th style='width:20%;'><img style='width:70%;' src='IMGRight' /></th></tr><tr><th colspan='3' style='text-align:center;vertical-align:bottom;'>CENTRAL WAREHOUSING CORPORATION<br />(A GOVT. OF INDIA UNDERTAKING)</th></tr></thead><tbody><tr><td colspan='2' style='font-weight:600;'>REGIONAL OFFICE, KOLKATA<br />CMC BUILDING, PHASE-1, 6TH FLOOR, NEW MARKET COMPLEX,<br />15 N, NELLIE SENGUPTA SARANI, KOLKATA - 700087</td><td style='font-weight:600;'>CONTAINER FREIGHT STATION<br />18, COAL DOCK ROAD,<br />KOLKATA - 700043<br />E-mail ID : manager_cfs@yahoo.in</td></tr><tr><td colspan='3' style='text-align:center;padding-bottom:20pt;'><span style='border-bottom:1px solid #000;font-weight:600;'>" + (actualJson.InvoiceType == "Tax" ? "TAX INVOICE" : "BILL OF SUPPLY") + "</span></td></tr><tr><td colspan='3'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><tbody><tr><td style='width:30%;'>GSTIN-<span>" + actualJson.CompGST + "</span><br />PAN NO.- <span>" + actualJson.CompPAN + "</span><br />STATE CODE : <span>" + actualJson.CompStateCode + "</span></td><td style='width:50%;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><thead><tr><th colspan='2' style='text-align:left;'>Details of Receiver ( Billed to)</th></tr></thead><tbody><tr><td style='width:45%;'>Name</td>";
        html1 += "<td><span>" + actualJson.PartyName + "</span></td></tr><tr><td>Address</td><td><span>" + actualJson.PartyAddress + "</span></td></tr><tr><td>State</td><td><span>" + actualJson.PartyState + "</span></td></tr><tr><td>State Code</td><td><span>" + actualJson.PartyStateCode + "</span></td></tr><tr><td>GSTIN/ Unique ID</td><td><span>" + actualJson.PartyGST + "</span></td></tr></tbody></table>";
        html1 += "</td><td></td></tr><tr><td colspan='2'><b>Invoice No. <span>" + actualJson.InvoiceNo + "</span></b></td><td style='vertical-align:top;text-align: center;'><b>Date: <span>" + (new Date()).getDate() + "/" + ((new Date()).getMonth() + 1) + "/" + (new Date()).getFullYear() + "</span></b></td>";
        html1 += "</tr><tr><td colspan='2'><table><tr><td style='vertical-align:top;width:50%;'><table style='width:100%;float: left;font-size:8pt;font-family:Verdana,Arial,San-serif;border:1px solid #000;border-collapse:collapse;margin-top:20pt;'><thead><tr><th style='border:1px solid #000;'>CONTAINER NO.</th><th style='border:1px solid #000;'>SIZE</th><th style='border:1px solid #000;'>ARRIVAL DT.</th><th style='border:1px solid #000;'>CARGO TYPE</th></tr></thead><tbody>";
        $.each(actualJson.lstPostPaymentCont, function (i, item) {
            html1 += "<tr><td style='border:1px solid #000;text-align:center;'><span>" + item.ContainerNo + "</span></td><td style='border:1px solid #000;text-align:center;'><span>" + item.Size + "</span></td><td style='border:1px solid #000;text-align:center;'><span>" + item.ArrivalDate + " " + item.ArrivalTime + "</span></td><td style='border:1px solid #000;text-align:center;'><span>" + (item.CargoType == 1 ? "Haz" : "Non-Haz") + "</span></td></tr>";
        });
        html1 += "</tbody></table></td><td style='vertical-align:top;width:50%;'><table style='width:100%;float:right;font-size:8pt;font-family:Verdana,Arial,San-serif;border:1px solid #000;border-collapse:collapse;margin-top:20pt;border-left-style: none;'><tbody><tr><td>";
        html1 += "Shipping Line. <span>" + actualJson.ShippingLineName + "</span><br/>CFS Code No. <span>" + actualJson.CFSCode + "</span><br/>Date & Time of Arrival (FN/AN): <span>" + actualJson.ArrivalDate + "</span><br/>Date & Time of Destuffing (FN/AN)/ Delivery. <span>" + actualJson.DestuffingDate + "</span><br/>Name of Importer. <span>" + actualJson.ImporterExporter + "</span><br/>BOE No./Date <span>" + actualJson.BOENo + "/" + actualJson.BOEDate + "</span><br/>Name of CHA. <span>" + actualJson.CHAName + "</span><br/>No of Packages. <span>" + actualJson.TotalNoOfPackages + "</span><br/>Total Gross Weight. <span>" + actualJson.TotalGrossWt + "</span><br/>Gross Weight per Package. <span>" + actualJson.TotalWtPerUnit + "</span><br/>Storage space occupied(" + actualJson.TotalSpaceOccupiedUnit + ") <span>" + actualJson.TotalSpaceOccupied + "</span><br/>Chargeable period for Storage space.";
        html1 += "<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;margin-top:10pt;'><tr><td>(a) Date & Time of Destuffing(FN/AN)</td></tr><tr><td>(b) Date of Delivery " + actualJson.InvoiceDate + "</td></tr><tr><td>(c) Customs Examination Date " + actualJson.ApproveOn + "</td></tr></table></td></tr></tbody></table></td></tr></table></td></tr></tbody></table></td></tr>";
        html1 += "<tr><td colspan='3'>Value of Cargo (CIF Value + Duty + Penalty) Rs.<span>" + actualJson.TotalValueOfCargo + "</span></td></tr></tbody></table>";

        var html2 = "<table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border:1px solid #000;'><thead><tr><th colspan='6' style='vertical-align:top;text-align:left;'>Invoice No. <span>" + actualJson.InvoiceNo + "</span></th><th colspan='6' style='text-align:right;padding-right:20pt;padding-bottom:50pt;'>Date: <span>" + (new Date()).getDate() + "/" + ((new Date()).getMonth() + 1) + "/" + (new Date()).getFullYear() + "</span></th></tr><tr><th style='border:1px solid #000;text-align:center;width:20%;'>Particulars</th><th style='border:1px solid #000;'>SAC</th><th style='border:1px solid #000;'>Value</th><th style='border:1px solid #000;'>TDS</th><th style='border:1px solid #000;text-align:center;'>Discount</th><th colspan='6' style='border:1px solid #000;text-align:center;'>Taxes</th><th style='border:1px solid #000;'>Total Amount</th></tr><tr><th style='border:1px solid #000;border-bottom:none;'></th><th rowspan='2' style='border:1px solid #000;'></th><th rowspan='2' style='border:1px solid #000;'></th><th rowspan='2' style='border:1px solid #000;'></th><th rowspan='2' style='border:1px solid #000;'></th><th style='border:1px solid #000;'>Rate</th><th style='border:1px solid #000;'>CGST</th><th style='border:1px solid #000;'>Rate</th><th style='border:1px solid #000;'>SGST</th><th style='border:1px solid #000;'>Rate</th><th style='border:1px solid #000;'>IGST</th><th style='border:1px solid #000;'></th></tr><tr><th style='border:1px solid #000;border-top:none;'></th><th style='border:1px solid #000;'></th><th style='border:1px solid #000;'></th><th style='border:1px solid #000;'></th><th style='border:1px solid #000;'></th><th style='border:1px solid #000;'></th><th style='border:1px solid #000;'></th><th style='border:1px solid #000;'></th></tr></thead><tbody>";
        var cwcCharges = $.grep(actualJson.lstPostPaymentChrg, function (item) { return item.ChargeType == 'CWC' && item.Total > 0; });
        $.each(cwcCharges, function (i, item) {
            html2 += "<tr><td style='border:1px solid #000;'>" + item.Clause + ". " + item.ChargeName + "</td><td style='border:1px solid #000;'><span>" + item.SACCode + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.Amount.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span></span></td><td style='border:1px solid #000;text-align:center;'><span>" + item.Discount.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.CGSTPer + "%</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.CGSTAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.SGSTPer + "%</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.SGSTAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.IGSTPer + "%</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.IGSTAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.Total.toFixed(2) + "</span></td></tr>";
            //html2 += "<tr><td style='border:1px solid #000;'>" + item.Clause + ". " + item.ChargeName + "</td><td style='border:1px solid #000;'><span>" + item.SACCode + "</span></td><td style='border:1px solid #000;'><span>" + item.Amount + "</span></td><td style='border:1px solid #000;'><span></span></td><td style='border:1px solid #000;'><span>" + item.Discount + "</span></td><td style='border:1px solid #000;'><span>" + item.CGSTPer + "</span></td><td style='border:1px solid #000;'><span>" + item.CGSTAmt + "</span></td><td style='border:1px solid #000;'><span>" + item.SGSTPer + "</span></td><td style='border:1px solid #000;'><span>" + item.SGSTAmt + "</span></td><td style='border:1px solid #000;'><span>" + item.IGSTPer + "</span></td><td style='border:1px solid #000;'><span>" + item.IGSTAmt + "</span></td><td style='border:1px solid #000;'><span>" + item.Total + "</span></td></tr>";
        });
        html2 += "<tr><td style='border:1px solid #000;padding-left:25px;'>CWC TDS</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:center;'>" + actualJson.CWCTDS.toFixed(2) + "</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td></tr>";
        var htCharges = $.grep(actualJson.lstPostPaymentChrg, function (item) { return item.ChargeType == 'HT' && item.Total > 0; });
        //html2 += "<tr><td style='border:1px solid #000;'><b><br />B. H&T Charges :-</b></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td></tr>";
        $.each(htCharges, function (i, item) {
            html2 += "<tr><td style='border:1px solid #000;'>" + item.Clause + ". " + item.ChargeName + "</td><td style='border:1px solid #000;'><span>" + item.SACCode + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.Amount.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span></span></td><td style='border:1px solid #000;text-align:center;'><span>" + item.Discount.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.CGSTPer + "%</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.CGSTAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.SGSTPer + "%</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.SGSTAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.IGSTPer + "%</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.IGSTAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.Total.toFixed(2) + "</span></td></tr>";
            //html2 += "<tr><td style='border:1px solid #000;'>" + item.Clause + ". " + item.ChargeName + "</td><td style='border:1px solid #000;'><span>" + item.SACCode + "</span></td><td style='border:1px solid #000;'><span>" + item.Amount + "</span></td><td style='border:1px solid #000;'><span></span></td><td style='border:1px solid #000;'><span>" + item.Discount + "</span></td><td style='border:1px solid #000;'><span>" + item.CGSTPer + "</span></td><td style='border:1px solid #000;'><span>" + item.CGSTAmt + "</span></td><td style='border:1px solid #000;'><span>" + item.SGSTPer + "</span></td><td style='border:1px solid #000;'><span>" + item.SGSTAmt + "</span></td><td style='border:1px solid #000;'><span>" + item.IGSTPer + "</span></td><td style='border:1px solid #000;'><span>" + item.IGSTAmt + "</span></td><td style='border:1px solid #000;'><span>" + item.Total + "</span></td></tr>";
        });
        html2 += "<tr><td style='border:1px solid #000;padding-left:25px;'>H&T TDS</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:center;'>" + actualJson.HTTDS.toFixed(2) + "</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td></tr>";
        //html2 += "<tr><td>H&T TDS</td><td></td><td></td><td>" + actualJson.HTTDS + "</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>";

        html2 += "<tr><td colspan='12'>&nbsp;</td></tr><tr><td>Grand Total</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + /*actualJson.TDS.toFixed(2) +*/ "</span></td><td style='border:1px solid #000;text-align:right;'>" + actualJson.TotalDiscount.toFixed(2) + "</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalCGST.toFixed(2) + "</span></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalSGST.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span></span></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalIGST.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.AllTotal.toFixed(2) + "</span></td></tr>";
        //html2 += "<tr><td colspan='12'>&nbsp;</td></tr><tr><td>Grand Total</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TDS + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + ((actualJson.CWCTotal * 10 / 100) + (actualJson.HTTotal * 2 / 100)).toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'>" + actualJson.TotalDiscount + "</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalCGST + "</span></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalSGST + "</span></td><td style='border:1px solid #000;text-align:right;'><span></span></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalIGST + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.AllTotal + "</span></td></tr>";
        html2 += "<tr><td>Round Up</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.RoundUp.toFixed(2) + "</span></td></tr>";
        html2 += "<tr><td>Grand Total(Rounded)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.InvoiceAmt.toFixed(2) + "</span></td></tr>";
        html2 += "<tr><td colspan='12'>TDS Deduction : " + actualJson.TDS.toFixed(2) + "<br/>TDS Collection : " + actualJson.TDSCol.toFixed(2) + "<br/><br/>FIGURE IN WORDS: <span>" + CurrentcyToWord(actualJson.InvoiceAmt.toFixed(2)).toUpperCase() + "</span></td></tr><tr><td colspan='12' style='padding:50pt 0pt;'><b>REMARKS:<span>" + actualJson.Remarks + "</span></b></td></tr>";

        html2 += "</tbody><tfoot><tr><td colspan='4'>WAI/TA/JTA/JS/SUPTD</td><td colspan='4'>AM (A/cs)</td><td colspan='4' style='text-align:center;'>Manager (CFS)</td></tr></tfoot></table>";

        return btoa(html1 + '<>' + html2);
    }


    function PrintInvoice() {


        debugger;
        var invoiceno = $('#InvoiceNoPrint').val();

        //if (invoiceno == '')
        //{
        //    alert('No Invoice No');
        //    return;
        //}

        var Token = $('input[name="__RequestVerificationToken"]').val();
        $.ajax({
            /*url: 'Url.Action("YardInvoicePrint", "Ppg_CWCImport", new { Area = "Import" }) ',*/
            url: '@Url.Action("GetBulkInvoiceReport", "VRN_ReportCWC", new { Area = "Report" }) ',
            headers: { "__RequestVerificationToken": Token },
            dataType: 'JSON',
            type: 'POST',
            data: {
               InvoiceNumber: invoiceno,
                InvoiceModule: 'IMPDeli',
                PartyId:$('#DeliApp_PartyId').val(),
                PeriodFrom: '@DateTime.Now.ToString("dd/MM/yyyy")',
                PeriodTo: '@DateTime.Now.ToString("dd/MM/yyyy")',
                InvoiceModuleName: 'ASSESSMENT SHEET GODOWN',
            },
            success: function (data) {
                if (data.Status == 1)
                    window.open(data.Data + "?_t=" + (new Date().getTime()), "_blank");
                else
                    alert(data.Data);
            }
        });
    }

    function Print() {
        var actualJson = JSON.parse($('#PaymentSheetModelJson').val());
        var html1 = "<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><thead><tr><th style='width:20%;'><img style='width:50%;' src='IMGLeft' /></th><th style='width:60%;'></th><th style='width:20%;'><img style='width:70%;' src='IMGRight' /></th></tr><tr><th colspan='3' style='text-align:center;vertical-align:bottom;'>CENTRAL WAREHOUSING CORPORATION<br />(A GOVT. OF INDIA UNDERTAKING)</th></tr></thead><tbody><tr><td colspan='2' style='font-weight:600;'>" + actualJson.ROAddress + "</td><td style='font-weight:600;'>" + actualJson.CompanyName + "<br />" + actualJson.CompanyAddress + "<br />" + actualJson.EmailAddress + "</td></tr><tr><td colspan='3' style='text-align:center;padding-bottom:20pt;'><span style='border-bottom:1px solid #000;font-weight:600;'>" + (actualJson.InvoiceType == "Tax" ? "TAX INVOICE" : "BILL OF SUPPLY") + "</span></td></tr><tr><td colspan='3'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><tbody><tr><td style='width:30%;'>GSTIN-<span>" + actualJson.CompGST + "</span><br />PAN NO.- <span>" + actualJson.CompPAN + "</span><br />STATE CODE : <span>" + actualJson.CompStateCode + "</span></td><td style='width:50%;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><thead><tr><th colspan='2' style='text-align:left;'>Details of Receiver ( Billed to)</th></tr></thead><tbody><tr><td style='width:45%;'>Name</td>";
        //var html1 = "<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><thead><tr><th style='width:20%;'><img style='width:50%;' src='IMGLeft'/></th><th style='width:60%;'></th><th style='width:20%;'><img style='width:70%;' src='IMGRight' /></th></tr><tr><th colspan='3' style='text-align:center;vertical-align:bottom;'>CENTRAL WAREHOUSING CORPORATION<br />(A GOVT. OF INDIA UNDERTAKING)</th></tr></thead><tbody><tr><td colspan='2' style='font-weight:600;'>REGIONAL OFFICE, KOLKATA<br />CMC BUILDING, PHASE-1, 6TH FLOOR, NEW MARKET COMPLEX,<br />15 N, NELLIE SENGUPTA SARANI, KOLKATA - 700087</td><td style='font-weight:600;'>CONTAINER FREIGHT STATION<br />18, COAL DOCK ROAD,<br />KOLKATA - 700043<br />E-mail ID : manager_cfs@yahoo.in</td></tr><tr><td colspan='3' style='text-align:center;padding-bottom:20pt;'><span style='border-bottom:1px solid #000;font-weight:600;'>" + (actualJson.InvoiceType == "Tax" ? "TAX INVOICE" : "BILL OF SUPPLY") + "</span></td></tr><tr><td colspan='3'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><tbody><tr><td style='width:30%;'>GSTIN-<span>" + actualJson.CompGST + "</span><br />PAN NO.- <span>" + actualJson.CompPAN + "</span><br />STATE CODE : <span>" + actualJson.CompStateCode + "</span></td><td style='width:50%;'><table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;'><thead><tr><th colspan='2' style='text-align:left;'>Details of Receiver ( Billed to)</th></tr></thead><tbody><tr><td style='width:45%;'>Name</td>";
        html1 += "<td><span>" + actualJson.PartyName + "</span></td></tr><tr><td>Address</td><td><span>" + actualJson.PartyAddress + "</span></td></tr><tr><td>State</td><td><span>" + actualJson.PartyState + "</span></td></tr><tr><td>State Code</td><td><span>" + actualJson.PartyStateCode + "</span></td></tr><tr><td>GSTIN/ Unique ID</td><td><span>" + actualJson.PartyGST + "</span></td></tr></tbody></table>";
        html1 += "</td><td></td></tr><tr><td colspan='2'><b>Invoice No. <span>" + actualJson.InvoiceNo + "</span></b></td><td style='vertical-align:top;text-align: center;'><b>Date: <span>" + (new Date()).getDate() + "/" + ((new Date()).getMonth() + 1) + "/" + (new Date()).getFullYear() + "</span></b></td>";
        html1 += "</tr><tr><td colspan='2'><table><tr><td style='vertical-align:top;width:50%;'><table style='width:100%;float: left;font-size:8pt;font-family:Verdana,Arial,San-serif;border:1px solid #000;border-collapse:collapse;margin-top:20pt;'><thead><tr><th style='border:1px solid #000;'>CONTAINER NO.</th><th style='border:1px solid #000;'>SIZE</th><th style='border:1px solid #000;'>ARRIVAL DT.</th><th style='border:1px solid #000;'>CARGO TYPE</th></tr></thead><tbody>";
        $.each(actualJson.lstPostPaymentCont, function (i, item) {
            html1 += "<tr><td style='border:1px solid #000;text-align:center;'><span>" + item.ContainerNo + "</span></td><td style='border:1px solid #000;text-align:center;'><span>" + item.Size + "</span></td><td style='border:1px solid #000;text-align:center;'><span>" + item.ArrivalDate + " " + item.ArrivalTime + "</span></td><td style='border:1px solid #000;text-align:center;'><span>" + (item.CargoType == 1 ? "Haz" : "Non-Haz") + "</span></td></tr>";
        });
        html1 += "</tbody></table></td><td style='vertical-align:top;width:50%;'><table style='width:100%;float:right;font-size:8pt;font-family:Verdana,Arial,San-serif;border:1px solid #000;border-collapse:collapse;margin-top:20pt;border-left-style: none;'><tbody><tr><td>";
        html1 += "Shipping Line. <span>" + actualJson.ShippingLineName + "</span><br/>CFS Code No. <span>" + actualJson.CFSCode + "</span><br/>Date & Time of Arrival (FN/AN): <span>" + actualJson.ArrivalDate + "</span><br/>Date & Time of Destuffing (FN/AN)/ Delivery. <span>" + actualJson.DestuffingDate + "</span><br/>Name of Importer. <span>" + actualJson.ImporterExporter + "</span><br/>BOE No./Date <span>" + actualJson.BOENo + "/" + actualJson.BOEDate + "</span><br/>Name of CHA. <span>" + actualJson.CHAName + "</span><br/>No of Packages. <span>" + actualJson.TotalNoOfPackages + "</span><br/>Total Gross Weight. <span>" + actualJson.TotalGrossWt + "</span><br/>Gross Weight per Package. <span>" + actualJson.TotalWtPerUnit + "</span><br/>Storage space occupied(" + actualJson.TotalSpaceOccupiedUnit + ") <span>" + actualJson.TotalSpaceOccupied + "</span><br/>Chargeable period for Storage space.";
        html1 += "<table style='width:100%;font-size:8pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;margin-top:10pt;'><tr><td>(a) Date & Time of Destuffing(FN/AN)</td></tr><tr><td>(b) Date of Delivery " + actualJson.InvoiceDate + "</td></tr><tr><td>(c) Customs Examination Date " + actualJson.ApproveOn + "</td></tr></table></td></tr></tbody></table></td></tr></table></td></tr></tbody></table></td></tr>";
        html1 += "<tr><td colspan='3'>Value of Cargo (CIF Value + Duty + Penalty) Rs.<span>" + actualJson.TotalValueOfCargo + "</span></td></tr></tbody></table>";

        var html2 = "<table style='width:100%;font-size:7pt;font-family:Verdana,Arial,San-serif;border-collapse:collapse;border:1px solid #000;'><thead><tr><th colspan='6' style='vertical-align:top;text-align:left;'>Invoice No. <span>" + actualJson.InvoiceNo + "</span></th><th colspan='6' style='text-align:right;padding-right:20pt;padding-bottom:50pt;'>Date: <span>" + (new Date()).getDate() + "/" + ((new Date()).getMonth() + 1) + "/" + (new Date()).getFullYear() + "</span></th></tr><tr><th style='border:1px solid #000;text-align:center;width:20%;'>Particulars</th><th style='border:1px solid #000;'>SAC</th><th style='border:1px solid #000;'>Value</th><th style='border:1px solid #000;'>TDS</th><th style='border:1px solid #000;text-align:center;'>Discount</th><th colspan='6' style='border:1px solid #000;text-align:center;'>Taxes</th><th style='border:1px solid #000;'>Total Amount</th></tr><tr><th style='border:1px solid #000;border-bottom:none;'></th><th rowspan='2' style='border:1px solid #000;'></th><th rowspan='2' style='border:1px solid #000;'></th><th rowspan='2' style='border:1px solid #000;'></th><th rowspan='2' style='border:1px solid #000;'></th><th style='border:1px solid #000;'>Rate</th><th style='border:1px solid #000;'>CGST</th><th style='border:1px solid #000;'>Rate</th><th style='border:1px solid #000;'>SGST</th><th style='border:1px solid #000;'>Rate</th><th style='border:1px solid #000;'>IGST</th><th style='border:1px solid #000;'></th></tr><tr><th style='border:1px solid #000;border-top:none;'></th><th style='border:1px solid #000;'></th><th style='border:1px solid #000;'></th><th style='border:1px solid #000;'></th><th style='border:1px solid #000;'></th><th style='border:1px solid #000;'></th><th style='border:1px solid #000;'></th><th style='border:1px solid #000;'></th></tr></thead><tbody>";
        var cwcCharges = $.grep(actualJson.lstPostPaymentChrg, function (item) { return item.ChargeType == 'CWC' && item.Total > 0; });
        $.each(cwcCharges, function (i, item) {
            html2 += "<tr><td style='border:1px solid #000;'>" + item.Clause + ". " + item.ChargeName + "</td><td style='border:1px solid #000;'><span>" + item.SACCode + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.Amount.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span></span></td><td style='border:1px solid #000;text-align:center;'><span>" + item.Discount.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.CGSTPer + "%</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.CGSTAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.SGSTPer + "%</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.SGSTAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.IGSTPer + "%</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.IGSTAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.Total.toFixed(2) + "</span></td></tr>";
            //html2 += "<tr><td style='border:1px solid #000;'>" + item.Clause + ". " + item.ChargeName + "</td><td style='border:1px solid #000;'><span>" + item.SACCode + "</span></td><td style='border:1px solid #000;'><span>" + item.Amount + "</span></td><td style='border:1px solid #000;'><span></span></td><td style='border:1px solid #000;'><span>" + item.Discount + "</span></td><td style='border:1px solid #000;'><span>" + item.CGSTPer + "</span></td><td style='border:1px solid #000;'><span>" + item.CGSTAmt + "</span></td><td style='border:1px solid #000;'><span>" + item.SGSTPer + "</span></td><td style='border:1px solid #000;'><span>" + item.SGSTAmt + "</span></td><td style='border:1px solid #000;'><span>" + item.IGSTPer + "</span></td><td style='border:1px solid #000;'><span>" + item.IGSTAmt + "</span></td><td style='border:1px solid #000;'><span>" + item.Total + "</span></td></tr>";
        });
        html2 += "<tr><td style='border:1px solid #000;padding-left:25px;'>CWC TDS</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:center;'>" + actualJson.CWCTDS.toFixed(2) + "</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td></tr>";
        var htCharges = $.grep(actualJson.lstPostPaymentChrg, function (item) { return item.ChargeType == 'HT' && item.Total > 0; });
        //html2 += "<tr><td style='border:1px solid #000;'><b><br />B. H&T Charges :-</b></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td></tr>";
        $.each(htCharges, function (i, item) {
            html2 += "<tr><td style='border:1px solid #000;'>" + item.Clause + ". " + item.ChargeName + "</td><td style='border:1px solid #000;'><span>" + item.SACCode + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.Amount.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span></span></td><td style='border:1px solid #000;text-align:center;'><span>" + item.Discount.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.CGSTPer + "%</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.CGSTAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.SGSTPer + "%</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.SGSTAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.IGSTPer + "%</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.IGSTAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + item.Total.toFixed(2) + "</span></td></tr>";
            //html2 += "<tr><td style='border:1px solid #000;'>" + item.Clause + ". " + item.ChargeName + "</td><td style='border:1px solid #000;'><span>" + item.SACCode + "</span></td><td style='border:1px solid #000;'><span>" + item.Amount + "</span></td><td style='border:1px solid #000;'><span></span></td><td style='border:1px solid #000;'><span>" + item.Discount + "</span></td><td style='border:1px solid #000;'><span>" + item.CGSTPer + "</span></td><td style='border:1px solid #000;'><span>" + item.CGSTAmt + "</span></td><td style='border:1px solid #000;'><span>" + item.SGSTPer + "</span></td><td style='border:1px solid #000;'><span>" + item.SGSTAmt + "</span></td><td style='border:1px solid #000;'><span>" + item.IGSTPer + "</span></td><td style='border:1px solid #000;'><span>" + item.IGSTAmt + "</span></td><td style='border:1px solid #000;'><span>" + item.Total + "</span></td></tr>";
        });
        html2 += "<tr><td style='border:1px solid #000;padding-left:25px;'>H&T TDS</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:center;'>" + actualJson.HTTDS.toFixed(2) + "</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;'></td></tr>";
        //html2 += "<tr><td>H&T TDS</td><td></td><td></td><td>" + actualJson.HTTDS + "</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>";

        html2 += "<tr><td colspan='12'>&nbsp;</td></tr><tr><td>Grand Total</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalAmt.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + /*actualJson.TDS.toFixed(2) +*/ "</span></td><td style='border:1px solid #000;text-align:right;'>" + actualJson.TotalDiscount.toFixed(2) + "</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalCGST.toFixed(2) + "</span></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalSGST.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span></span></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalIGST.toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.AllTotal.toFixed(2) + "</span></td></tr>";
        //html2 += "<tr><td colspan='12'>&nbsp;</td></tr><tr><td>Grand Total</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TDS + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + ((actualJson.CWCTotal * 10 / 100) + (actualJson.HTTotal * 2 / 100)).toFixed(2) + "</span></td><td style='border:1px solid #000;text-align:right;'>" + actualJson.TotalDiscount + "</td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalCGST + "</span></td><td style='border:1px solid #000;'></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalSGST + "</span></td><td style='border:1px solid #000;text-align:right;'><span></span></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.TotalIGST + "</span></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.AllTotal + "</span></td></tr>";
        html2 += "<tr><td>Round Up</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.RoundUp.toFixed(2) + "</span></td></tr>";
        html2 += "<tr><td>Grand Total(Rounded)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td style='border:1px solid #000;text-align:right;'><span>" + actualJson.InvoiceAmt.toFixed(2) + "</span></td></tr>";
        html2 += "<tr><td colspan='12'>TDS Deduction : " + actualJson.TDS.toFixed(2) + "<br/>TDS Collection : " + actualJson.TDSCol.toFixed(2) + "<br/><br/>FIGURE IN WORDS: <span>" + CurrentcyToWord(actualJson.InvoiceAmt.toFixed(2)).toUpperCase() + "</span></td></tr><tr><td colspan='12' style='padding:50pt 0pt;'><b>REMARKS:<span>" + actualJson.Remarks + "</span></b></td></tr>";

        html2 += "</tbody><tfoot><tr><td colspan='4'>WAI/TA/JTA/JS/SUPTD</td><td colspan='4'>AM (A/cs)</td><td colspan='4' style='text-align:center;'>Manager (CFS)</td></tr></tfoot></table>";

        var PostData = new FormData();
        PostData.append("type", "yard");
        PostData.append("id", $('#InvoiceNo').val());
        PostData.append("page", html1);
        PostData.append("npage", html2);
        $.ajax({
            type: 'POST',
            url: '@Url.Action("GeneratePDF", "CWCImport", new { area = "Import" })',
            data: PostData,
            processData: false,
            contentType: false,
            success: function (data) {
                window.open(data.Message + '?t=' + (new Date().getTime()), "_blank", "fullscreen=yes");
            }
        });
    }

    function CurrentcyToWord(s) {
        var th = ['', 'thousand', 'million', 'billion', 'trillion'];
        var dg = ['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine'];
        var tn = ['ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];
        var tw = ['twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];
        s = s.toString();
        s = s.replace(/[\, ]/g, '');
        if (s != parseFloat(s)) return 'not a number';
        var x = s.indexOf('.');
        if (x == -1) x = s.length;
        if (x > 15) return 'too big';
        var n = s.split('');
        var str = '';
        var sk = 0;
        for (var i = 0; i < x; i++) {
            if ((x - i) % 3 == 2) {
                if (n[i] == '1') {
                    str += tn[Number(n[i + 1])] + ' ';
                    i++;
                    sk = 1;
                } else if (n[i] != 0) {
                    str += tw[n[i] - 2] + ' ';
                    sk = 1;
                }
            } else if (n[i] != 0) {
                str += dg[n[i]] + ' ';
                if ((x - i) % 3 == 0) str += 'hundred ';
                sk = 1;
            }
            if ((x - i) % 3 == 1) {
                if (sk) str += th[(x - i - 1) / 3] + ' ';
                sk = 0;
            }
        }
        if (x != s.length) {
            var y = s.length;
            str += 'point ';
            for (var i = x + 1; i < y; i++) str += dg[n[i]] + ' ';
        }
        return str.replace(/\s+/g, ' ');
    }
</script>




<!--------------------------------- INVOICE CHECKING SCRIPT --------------------------------->
<script>
    var ArrayOfContainer = [];
    var ArrayOfCargo = [];
    var TimeInSeconds;
    $(function () {
        TimeInSeconds = 5000;
        //   GetIssueSlipList();
        $('#TblContainer').hide();
        $('#TblCargo').hide();
    });

    function ReloadIssueSlipPage() {
        //  $('#DivBody').load('/Import/Ppg_CWCImport/CreateIssueSlip');
    }
    $('#IssueSlip_IssueSlipDate').datepicker({
        dateFormat: "dd/mm/yy",
        showOn: "button",
        buttonImage:"/Content/images/calendar.png",
        buttonImageOnly: true,
        buttonText: "Select date",
        changeMonth: true,
        changeYear: true,
        showAnima: "fadein",
        onClose: function () {
            $("[data-valmsg-for='IssueSlip_IssueSlipDate']").html('');
        }
    });

    function GetIssueSlipList() {
        //   $('#DivIssueSlipList').load('/Import/Ppg_CWCImport/GetIssueSlipList');
    }

    //function ReloadIssueSlipPage() {
    //    $('#DivBody').load('/Import/CWCImport/CreateIssueSlip');
    //}

    function ResetAllFields() {
        $('#DivAddIssueSlip').find('input:hidden').val('');
        $('#DivAddIssueSlip').find('input:text,textarea').val('');
        $('#DivAddIssueSlip #DivIssueSlipMsg').html('');
        $('#DivAddIssueSlip #DivIssueSlipErrMsg').html('');
        $('[data-valmsg-for]').html('<span><span>');
        $('#DivAddIssueSlip #TblContainer >tbody').html('');
        $('#DivAddIssueSlip #TblContainer').hide();
        $('#DivAddIssueSlip #TblCargo >tbody').html('');
        $('#DivAddIssueSlip #TblCargo').hide();
    }

    function IssueSlipOnSuccess(data) {
        debugger;
        if (data.Status == 1) {
            $('#DivIssueSlipMsg').html(data.Message);
            $('#IssueSlipIdValue').val(data.Data.Id);

            $('#IssueSlip_IssueSlipNo').val(data.Data.AppNo);
            $('#BtnSaveIssueSlip').attr('disabled', 'disabled');
            $('#btnissuePrint').removeAttr('disabled');
            $('#BtnDone').removeAttr('disabled');
            LoadDeliveryAppList();
            //   $('#BtnContPay').removeAttr('disabled');
            // setTimeout(ReloadIssueSlipPage, TimeInSeconds);
            // $('#InvoiceList #' + $('#InvoiceNo').val()).remove();
            // GetIssueSlipList();
        }
        else {
            $('#DivIssueSlipErrMsg').html(data.Message);
        }
    }

    function IssueSlipOnFailure() { }


    $('#InvoiceBox').keyup(function () {
        debugger;
        var valThis = $(this).val().toLowerCase();
        if (valThis == "") {
            $('#InvoiceModal .navList > li').show();
        } else {
            $('#InvoiceModal .navList > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(valThis) >= 0) ? $(this).show() : $(this).hide();
            });
        };
    });
    $('#InvoiceList li').on("click", function () {
        debugger;
        $('#InvoiceNo').val($(this).text());
        $('#InvoiceId').val($(this).attr('id'));
        var InvoiceId = $('#InvoiceId').val();
        $("#InvoiceModal").modal("hide");
        $('#TblContainer >tbody').html('');
        $('#TblContainer').hide();
        $('#TblCargo >tbody').html('');
        $('#TblCargo').hide();
        GetInvoiceDet(InvoiceId);
    });

    function GetInvoiceDet(InvoiceId) {
        debugger;
        $.ajax({
            url: '/Import/VRN_CWCImport/GetInvcDetForIssueSlip',
            type: 'GET',
            dataType: 'JSON',
            data: { InvoiceId: InvoiceId },
            success: function (data) {
                debugger;
                if (data.Status == 1) {
                    $('#InvoiceDate').val(data.Data.InvoiceDate);
                    $('#CargoDescription').val(data.Data.CargoDescription);
                    ArrayOfContainer = data.Data.LstContainer;
                    ArrayOfCargo = data.Data.LstCargo;
                    GenerateConatinerTable();
                    GenerateCargoTable();
                }
            }
        });
    }

    function GenerateConatinerTable() {
        debugger;
        $('#TblContainer').hide();
        var Html = '';
        if (ArrayOfContainer.length != 0) {
            $.each(ArrayOfContainer, function (i, item) {
                debugger;
                Html += '<tr><td>' + item.CFSCode + '</td><td>' + item.ContainerNo + '</td><td>' + item.Size + '</td><td>' + item.GrossWeight + '</td><td>' + item.CIFValue + '</td><td>' + item.Duty + '</td><td>' + item.Total + '</td></tr>';
            });
            $('#TblContainer>tbody').html(Html);
            $('#TblContainer').show();
        }
    }

    function GenerateCargoTable() {
        debugger;
        $('#TblCargo').hide();
        var Html = '';
        if (ArrayOfCargo.length != 0) {
            $.each(ArrayOfCargo, function (i, item) {
                debugger;
                Html += '<tr><td>' + item.OBLNo + '</td><td>' + item.CargoDescription + '</td><td>' + item.GodownNo + '</td><td>' + item.Location + '</td><td>' + item.StackNo + '</td><td>' + item.Area + '</td><td>' + item.NetWeight + '</td></tr>';
            });
            $('#TblCargo>tbody').html(Html);
            $('#TblCargo').show();
        }
    }









    $('#DestuffingEntryNoSearch').on("click", function () {

        ArrayOfDeliveryApp = [];
        ArrayOfDeliveryOrd = [];
        $('#TblDeliveryAppDtl').hide();
        $('#TblDeliveryAppOrd').hide();
        $('#TblDeliveryAppDtl>tbody').html('');
        $('#TblDeliveryAppOrd>tbody').html('');
        debugger;
        $.ajax({
            url: '@Url.Action("GetDestuffingNo", "VRN_CWCImport", new { Area = "Import" })',
            dataType: 'JSON',
            type: 'GET',
            beforeSend: function () {
                $('.modalloader').show();
            },
            success: function (data) {
                debugger;
                // ViewCHAShippingLine = data;
                var html = '';
                $.each(data, function (i, item) {
                    html += '<li id="' + item.DestuffingId + '" " onclick="GetBOE(this)">' + item.DestuffingEntryNo + '</li>';

                });
                $('#DestuffingEntryNoList').html(html);
                $.ajax({
                    url: '@Url.Action("GetImporterName", "VRN_CWCImport", new { Area = "Import" })',
                    dataType: 'JSON',
                    type: 'GET',
                    beforeSend: function () {
                        $('.modalloader').show();
                    },
                    success: function (data) {
                        debugger;
                        // ViewCHAShippingLine = data;
                        var html = '';
                        $.each(data, function (i, item) {
                            html += '<li id="' + item.ImporterId + '" " onclick="GetImporter(this)" >' + item.ImporterName + '</li>';

                        });
                        $('#lstImp').html(html);
                    },

                    complete: function () {
                        $('.modalloader').hide();
                    }
                });

            },
            complete: function () {
                $('.modalloader').hide();
            }
        });






    });


    $('#Payeesearch').on("click", function () {
        debugger;
        $.ajax({
            url: '/Import/VRN_CWCImport/LoadCHAListforSingleClick',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                debugger;
                // ViewCHAShippingLine = data;
                var html = '';
                $.each(data.Data.lstCHA, function (i, item) {
                    html += '<tr id="' + item.CHAId + '" " onclick="SelectPayeeName(' + item.CHAId + ',&quot;' + item.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + item.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + item.PartyCode + '</td</tr>';

                });
                $('#tblePayee').html(html);


            }
        });

    });


    $('#PartysearchGst').on("click", function () {
        debugger;
        $.ajax({
            url: '/Import/VRN_CWCImport/LoadCHAListforSingleClick',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                debugger;
                // ViewCHAShippingLine = data;
                var html = '';
                $.each(data.Data.lstCHA, function (i, item) {
                    html += '<tr id="' + item.CHAId + '" " onclick="SelectPartyGstName(' + item.CHAId + ',&quot;' + item.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + item.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + item.PartyCode + '</td</tr>';

                });
                $('#tblePartyGst').html(html);


            }
        });

    });

    $('#CHADtlSearch').on("click", function () {
        debugger;
        $.ajax({
            url: '@Url.Action("GetCHANAME", "VRN_CWCImport", new { Area = "Import" })',
            dataType: 'JSON',
            type: 'GET',
            success: function (data) {
                debugger;
                // ViewCHAShippingLine = data;
                var html = '';
                $.each(data, function (i, item) {
                    html += '<tr id="' + item.CHAId + '" " onclick="SelectCHAName(' + item.CHAId + ',&quot;' + item.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + item.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + item.PartyCode + '</td</tr>';

                });
                $('#tbleCha').html(html);
                html = '';
                $.each(data, function (i, item) {
                    html += '<tr id="' + item.CHAId + '" " onclick="SelectPayeeName(' + item.CHAId + ',&quot;' + item.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + item.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + item.PartyCode + '</td</tr>';

                });

                $('#tblePayee').html(html);


                html = '';
                $.each(data, function (i, item) {
                    html += '<tr id="' + item.CHAId + '" " onclick="SelectPartyName(' + item.CHAId + ',&quot;' + item.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + item.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + item.PartyCode + '</td</tr>';

                });

                $('#tblePartyGst').html(html);



            }
        });

    });




    function BindHnTCharges() {
        debugger;
        var rawJson = JSON.parse($('#PaymentSheetModelJson').val());
        rawJson.lstPostPaymentChrg = $.grep(rawJson.lstPostPaymentChrg, function (item) { return item.ChargeType == "CWC"; });
        var rowCount = rawJson.lstPostPaymentChrg.length;
        var html = '';
        var TotalHT = 0;
        var htWithOutTax = 0;
        //var htcharge = [];
        for (var i = 0; i < $("#lstHT li").length; i++) {
            if ($('#chkAHT' + i).prop("checked")) {
                var item = JSON.parse(atob($('#chkAHT' + i).attr('data-val')));
                //htcharge.push(item);
                rawJson.lstPostPaymentChrg.push(item);
                TotalHT += item.Total;
                htWithOutTax += item.Amount;
                html += '<tr><td>' + item.Clause + '. ' + item.ChargeName + '</td>'
                                    + '<td><input class="text-right" id="' + item.ChargeId + '" type="text" value="' + item.Amount.toFixed(2) + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" /></td>'
                                    + '<td><input class="text-right" id="IGSTP' + item.ChargeId + '" type="text" value="' + item.IGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                                    + '<td><input class="text-right" id="IGSTA' + item.ChargeId + '" type="text" value="' + item.IGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td><input class="text-right" id="CGSTP' + item.ChargeId + '" type="text" value="' + item.CGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                                    + '<td><input class="text-right" id="CGSTA' + item.ChargeId + '" type="text" value="' + item.CGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td><input class="text-right" id="SGSTP' + item.ChargeId + '" type="text" value="' + item.SGSTPer + '" onblur="CalcTax(&quot;' + item.ChargeId + '&quot;)" readonly /></td>'
                                    + '<td><input class="text-right" id="SGSTA' + item.ChargeId + '" type="text" value="' + item.SGSTAmt.toFixed(2) + '" readonly /></td>'
                                    + '<td><input class="text-right" id="TOT' + item.ChargeId + '" type="text" value="' + item.Total.toFixed(2) + '" readonly /></td>'
                                    + '<td class="text-center" onclick="RemoveHT(' + rowCount + ')"><i class="fa fa-times Delete"></i></td></tr>';
                rowCount += 1;
            }
        }
        $('#tblHTCharges tbody').html(html);
        $('#TOTHTChrg').val((TotalHT).toFixed(2));
        $('#rest-charge-details').removeClass('hide');
        rawJson.HTTotal = TotalHT;
        rawJson.TotalAmt = rawJson.CWCAmtTotal + htWithOutTax;
        rawJson.HTAmtTotal = htWithOutTax;
        $('#PaymentSheetModelJson').val(JSON.stringify(rawJson));
        $('#btnShowHT').prop('disabled', true);
        $('#btnAddExtraHT').removeAttr('disabled');
        $('#btnSave').removeAttr('disabled');
        CalcTax(1);
    }



    function GetInvoiceDetMerge(InvoiceNo) {
        debugger;
        $('#IssueSlip_InvoiceNo').val(InvoiceNo);
        $.ajax({
            url: '/Import/VRN_CWCImport/GetInvcDetForMergeIssueSlip',
            type: 'GET',
            dataType: 'JSON',
            data: { InvoiceNo: InvoiceNo },
            success: function (data) {
                debugger;
                if (data.Status == 1) {
                    $('#IssueSlip_InvoiceId').val(data.Data.InvoiceId);


                    $('#IssueSlip_InvoiceDate').val(data.Data.InvoiceDate);
                    $('#IssueSlip_CargoDescription').val(data.Data.CargoDescription);
                    ArrayOfContainer = data.Data.LstContainer;
                    ArrayOfCargo = data.Data.LstCargo;
                    GenerateConatinerTable();
                    GenerateCargoTable();
                }
            }
        });
    }

    function PreviewIssueSlip()
    {
        var IssueSlipId=$('#IssueNoPrint').val();
        var Token=$('input[name="__RequestVerificationToken"]').val();
        $.ajax({
            url: '/Import/VRN_CWCImport/PrintIssueSlip',
            type:'POST',
            data:{IssueSlipId:IssueSlipId},
            headers:{"__RequestVerificationToken":Token},
            dataType:'JSON',
            success:function(data)
            {
                if(data.Status==1)
                    window.open(data.Message+"?_t="+(new Date().getTime()),"_blank");
                else
                    alert(data.Message);
            }
        });

    }

    function resetfield()
    {
        $('#DivAddIssueSlip').find('input:hidden').val('');
        $('#DivAddIssueSlip').find('input:text,textarea').val('');
        $('#DivAddIssueSlip #DivIssueSlipMsg').html('');
        $('#DivAddIssueSlip #DivIssueSlipErrMsg').html('');
        $('[data-valmsg-for]').html('<span><span>');
        $('#DivAddIssueSlip #TblContainer >tbody').html('');
        $('#DivAddIssueSlip #TblContainer').hide();
        $('#DivAddIssueSlip #TblCargo >tbody').html('');
        $('#DivAddIssueSlip #TblCargo').hide();

        $('#InvoiceNo').val('');
        $('#StuffingReqNo').val('');
        $('#InvoiceDate').val('');
        $('#StuffingReqDate').val('');
        $('#PartyName').val('');
        $('#PayeeName').val('');
        $('#GSTNo').val('');
        $('#OTHours').val('0');
        $('#PMode').val('');
        $('#lstBOENo').html('');
        $('#tblOBL').html('');
        $('#Importers').val('');
        $('#tblCWCCharges').html('');
        $('#AllTotal').val('');
        $('#RoundUp').val('');
        $('#InvoiceValue').val('');
        $('#Remarks').val('');
        $('#DivPaySheetCargoMsg').html('');
        $('#BtnSaveIssueSlip').removeAttr('disabled');
        $('#btnissuePrint').attr('disabled', 'disabled');
        $('#BtnDone').attr('disabled', 'disabled');
        $('#savbtn').removeAttr('disabled');
        $('#btnPrint').attr('disabled', 'disabled');
        $('#DivBody').load('/Import/VRN_CWCImport/MergeDeliAppPaymentSheetIssueSlip');

    }


    function CheckIsBond(){
            if($('#ConvertToBond').is(":checked")){
                $('#BtnIssueSlip').prop('disabled', true);
            }
            else if($('#ConvertToBond').is(":not(:checked)")){
                $('#BtnIssueSlip').removeAttr('disabled');
            }
    }
  

    
    function GenerateIRN() {
        debugger;

        var InvoiceNo = $('#InvoiceNo').val();
        var SupplyType = $('#hdnSupplyType').val();
        $.ajax({
            /*url: 'Url.Action("YardInvoicePrint", "Ppg_CWCImport", new { Area = "Import" }) ',*/
            url: '@Url.Action("GetIRNForYardInvoice", "VRN_CWCImport", new { Area = "Import" }) ',
            type: 'POST',
            data: {
                InvoiceNo: InvoiceNo,
                SupplyType:SupplyType
            },
            success: function (data) {
                if (data.Status == 1) {
                    alert("IRN has been generated sucessfully");
                    $('#btnPrint').removeAttr("disabled");
                }
                else
                    alert(data.Message);
                $('#btnPrint').removeAttr("disabled");

            }
        });
    };
</script>
