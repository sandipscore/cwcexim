@model CwcExim.Areas.Import.Models.DSRDestuffingEntry
@{

    AjaxOptions options = new AjaxOptions();
    options.Confirm = "Are You Sure You Want To Save?";
    options.OnSuccess = "DestuffingEntryOnSuccess";
    options.OnFailure = "DestuffingEntryOnFailure";
    options.InsertionMode = InsertionMode.InsertAfter;

}
<style>
    table.table-bordered.dataTable th:last-child, table.table-bordered.dataTable th:last-child, table.table-bordered.dataTable td:last-child, table.table-bordered.dataTable td:last-child {
        border-right-width: 1px;
    }
</style>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-offset-0-5 col-md-11">
            <div class="Head_h4">
                @using (Ajax.BeginForm("AddEditDestuffingEntry", "DSR_CWCImport", options))
                {
                    @Html.AntiForgeryToken()
                    @Html.HiddenFor(m => m.DestuffingEntryXML)
                    @Html.HiddenFor(m => m.DestuffingEntryId)
                    @Html.HiddenFor(m => m.DeliveryOrdDtlXml)
                    @Html.HiddenFor(m => m.TallySheetId)
                    @Html.HiddenFor(m => m.ContainerId)
                    @Html.Hidden("TallySheetDtlId")
                    @Html.HiddenFor(m => m.Size)
                    @Html.HiddenFor(m => m.CFSCode)
                    @Html.HiddenFor(m => m.GodownId)
                    @Html.Hidden("TallySheetArea")
                    @Html.Hidden("DestuffingEntryDtlId")
                    @Html.Hidden("GdTransId")
                    @Html.Hidden("StockDetailsId")
                    @Html.Hidden("hdnRemPackages")
                    @Html.Hidden("hdnRemWeight")
                    {
                        if (ViewBag.GodownList != null)
                        {
                            <input type="hidden" id="ViewGodownList" name="GodownList" value=@ViewBag.GodownList.ToString() />
                        }
                        else
                        {
                            <input type="hidden" id="ViewGodownList" name="GodownList" value="" />
                        }
                    }
                    <div id="DivAddDestuffingEntry">
                        <div class="row">
                            <div class="col-md-12">
                                <h4>Destuffing</h4>
                            </div>
                        </div>
                        <div class="row Form_Space_top">
                            <div class="form-group Form_Input">
                                <div class="col-md-1-5 col_cus_2">
                                    <label>Container / CBT No:</label>
                                </div>
                                <div class="col-md-2-5">
                                    <span class="ReQSimbol">*</span>
                                    @Html.TextBoxFor(m => m.ContainerNo, "", new { @class = "form-control input-sm", @readonly = true })
                                    <span class="search"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#ContainerModal"></i></span>
                                    @Html.ValidationMessageFor(m => m.ContainerNo, "", new { @class = "Error_Msg" })
                                </div>
                                <div class="col-md-1-5 col_cus_2 col_cus_offset_3 col-md-offset-4">
                                    <label>Start Date:</label>
                                </div>
                                <div class="col-md-2-5 col_cus_2_5 Date_Img">
                                    @Html.TextBoxFor(m => m.StartDate, new { @size = 10, @maxlength = 10, @onkeyup = "chec()", @onblur = "checkdat()", @class = "form-control input-sm" })
                                    <div class="field-validation-error" id="DivMs" style="background-color:transparent"></div>
                                    @Html.ValidationMessageFor(m => m.StartDate, "", new { @class = "Error_Msg" })
                                </div>
                            </div>
                        </div>
                        <div class="row Form_Space_top">
                            <div class="form-group Form_Input">
                                <div class="col-md-1-5 col_cus_2">
                                    <label>Destuffing No:</label>
                                </div>
                                <div class="col-md-2-5">
                                    @Html.TextBoxFor(m => m.DestuffingEntryNo, new { @class = "form-control input-sm", @readonly = true })
                                </div>
                                <div class="col-md-1-5 col_cus_2 col_cus_offset_3 col-md-offset-4">
                                    <label>Destuffing Date:</label>
                                </div>
                                <div class="col-md-2-5 col_cus_2_5 Date_Img">
                                    @Html.TextBoxFor(m => m.DestuffingEntryDate, new { @class = "form-control input-sm", @readonly = true })
                                    @Html.ValidationMessageFor(m => m.DestuffingEntryDate, "", new { @class = "Error_Msg" })
                                </div>
                            </div>
                        </div>
                        <div class="row Form_Space_top">
                            <div class="form-group Form_Input">
                                <div class="col-md-1-5 col_cus_2">
                                    <label>Shipping Line:</label>
                                </div>
                                <div class="col-md-10-5 col_cus_10">
                                    @Html.TextBoxFor(m => m.ShippingLine, "", new { @class = "form-control input-sm", @readonly = true, onkeydown = "PopupActivate('ShippingLineModal');" })
                                    <span class="search" id="ShippingLineSearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#ShippingLineModal"></i></span>
                                    @Html.HiddenFor(m => m.ShippingLineId)
                                    @Html.ValidationMessageFor(m => m.ShippingLine, "", new { @class = "Error_Msg" })
                                </div>
                            </div>
                        </div>
                        <div class="row Form_Space_top">
                            <div class="form-group Form_Input">
                                <div class="col-md-1-5 col_cus_2">
                                    <label>CHA:</label>
                                </div>
                                <div class="col-md-10-5 col_cus_10">
                                    @Html.TextBoxFor(m => m.CHA, "", new { @class = "form-control input-sm", @readonly = true, onkeydown = "PopupActivate('CHAModal');" })
                                    <span class="search" id="ChaSearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#CHAModal"></i></span>
                                    @Html.HiddenFor(m => m.CHAId)
                                </div>
                            </div>
                        </div>
                        <div class="row Form_Space_top">
                            <div class="form-group Form_Input">
                                <div class="col-md-1-5 col_cus_2">
                                    <label>Rotation:</label>
                                </div>
                                <div class="col-md-2-5">
                                    @Html.TextBoxFor(m => m.Rotation, "", new { @class = "form-control input-sm" })
                                    @Html.ValidationMessageFor(m => m.Rotation, "", new { @class = "Error_Msg" })
                                </div>
                                <div class="col-md-1-5 col_cus_2 col_cus_offset_3 col-md-offset-4">
                                    <label>Examination Type:</label>
                                </div>
                                <div class="col-md-2-5 col_cus_2_5">
                                    @Html.DropDownListFor(m => m.RMSValue, new List<SelectListItem>{
                                        new SelectListItem {Text="Upto 25%",Value="1" },
                                        new SelectListItem {Text="Beyond 25% ",Value="2" },
                                        new SelectListItem {Text="RMS Non Exim",Value="3" }
                                      }, "---Select---", new { @class = "form-control input-sm " })
                                </div>
                            </div>
                        </div>
                        <div class="row Form_Space_top">
                            <div class="form-group Form_Input">
                                <div class="col-md-1-5 col_cus_2">
                                    <label>ODC Type:</label>
                                </div>
                                <div class="col-md-2-5">
                                    @Html.DropDownListFor(m => m.ODCType, new List<SelectListItem>{
                                        new SelectListItem {Text="Normal",Value="0" },
                                        new SelectListItem {Text="Single Side ODC",Value="1" },
                                        new SelectListItem {Text="Double Side ODC",Value="2" },
                                        new SelectListItem {Text="Three Side ODC",Value="3" }
                                      }, new { @class = "form-control input-sm dropdown" })
                                </div>
                                <div class="col-md-1-5 col_cus_2 col_cus_offset_3 col-md-offset-4">
                                    <label>Container Packages:</label>
                                </div>
                                <div class="col-md-2-5 col_cus_2_5">
                                    @Html.TextBox("NoOfPKG", "", new { @class = "form-control input-sm", @readonly = true })
                                </div>
                                <div style="display:none">
                                    <div class="col-md-1-5 col_cus_2 col_cus_offset_3 col-md-offset-4">
                                        <label>Handling Type:</label>
                                    </div>
                                    <div class="col-md-2-5 col_cus_2_5">
                                        @Html.DropDownListFor(m => m.CargoDeliveryType, new List<SelectListItem>{
                                        new SelectListItem {Text="---Select---",Value="0" },
                                        new SelectListItem {Text="Manual",Value="1" },
                                        new SelectListItem {Text="Mechanical",Value="2" }
                                      }, new { @class = "form-control input-sm " })
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row Form_Space_top">
                            <div class="form-group Form_Input">

                                <div class="col-md-3" style="display:none">
                                    <div class="boolean-container">
                                        @Html.RadioButtonFor(m => m.DeliveryType, "2", new { @id = "Cargo" })
                                        <label for="Cargo"><i class="circle"></i>Cargo Delivery</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="DivDestuffingEntryDet" class="Head_h5">
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>OBL/HBL No:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        <span class="ReQSimbol">*</span>
                                        @Html.TextBox("BOLNo", "", new { @class = "form-control input-sm", @readonly = true })
                                        <span class="search" id="oblsearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#OBLModal"></i></span>
                                        @Html.ValidationMessage("BOLNo", new { @class = "Error_Msg" })
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4 col_cus_2 col_cus_offset_3">
                                        <label>OBL/HBL Date:</label>
                                    </div>
                                    <div class="col-md-2-5 col_cus_2_5 Date_Img">
                                        @Html.TextBox("BOLDate", "", new { @class = "form-control input-sm", @readonly = true })
                                        @Html.ValidationMessage("BOLDate", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>Line No:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("LineNo", "", new { @class = "form-control input-sm", @readonly = true })
                                        @Html.ValidationMessage("LineNo", new { @class = "Error_Msg" })
                                    </div>
                                    <div class="col-md-offset-2-5 col-md-1-5 col_cus_2">
                                        <label>Commodity:</label>
                                    </div>
                                    <div class="col-md-4">
                                        @Html.TextBox("Commodity", "", new { @class = "form-control input-sm", @readonly = true })
                                        <span class="search" id="CommoditySearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#CommodityModal"></i></span>
                                        <input type="hidden" id="CommodityId" />
                                        <input type="hidden" id="Commodity" />
                                        @Html.ValidationMessage("Commodity", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>Cargo Description:</label>
                                    </div>
                                    <div class="col-md-10-5">
                                        @Html.TextArea("CargoDescription", "", new { @class = "form-control input-sm", @disabled = true })
                                        @Html.ValidationMessage("CargoDescription", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">


                                    <div class="col-md-1-5 col_cus_2">Cargo Type<span class="LabelColon">:</span></div>
                                    <div class="col-md-2-5 col_cus_2_5">
                                        @Html.DropDownList("CargoType", new List<SelectListItem>
                                {
                                new SelectListItem { Text="Haz",Value="1"},
                                new SelectListItem { Text="Non-Haz",Value="2"},
                                }, "----Select----", new { @class = "form-control input-sm" })
                                    </div>

                                </div>
                            </div>

                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2 padding_rt">
                                        <label>No of Packages:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("NoOfPackages", "", new { @class = "form-control input-sm", @readonly = true})
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4 col_cus_2 col_cus_offset_3">
                                        <label>Gross Weight (Kg):</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("GrossWeight", "", new { @class = "form-control input-sm", @readonly = true })
                                        @Html.ValidationMessage("GrossWeight", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 ">
                                        <label>Remaining Packages:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("RemPackages", "", new { @class = "form-control input-sm", @readonly = true })
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>Remaining WT(Kg):</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("RemWeight", "", new { @class = "form-control input-sm", @readonly = true })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 ">
                                        <label>CIF Value:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("OBLCIFValue", "", new { @class = "form-control input-sm", @readonly = true })
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>Duty:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("OBLGrossDuty", "", new { @class = "form-control input-sm", @readonly = true })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>BOE No:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("BOENo", "", new { @class = "form-control input-sm", @onblur = "GetCIFDuty()" })
                                        @*@Html.ValidationMessage("BOENo", "", new { @class = "Error_Msg" })*@
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>BOE Date:</label>
                                    </div>
                                    <div class="col-md-2-5 Date_Img">
                                        @Html.TextBox("BOEDate", "", new { @size = 10, @maxlength = 10, @onkeyup = "checBOE()", @onblur = "checkdatBOE()", @class = "form-control input-sm" })
                                        @*@Html.ValidationMessage("BOEDate", "", new { @class = "Error_Msg" })*@
                                        <div class="field-validation-error" id="DivMsBOE" style="background-color:transparent"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">

                                    <div class="col-md-1-5 col_cus_2">
                                        <label>OBL Wise Destuffing Date:</label>
                                    </div>

                                    <div class="col-md-2-5 Date_Img">
                                        @Html.TextBox("OBLWiseDestuffingDate", "", new { @size = 10, @maxlength = 10, @onkeyup = "checO()", @onblur = "checkdatO()", @class = "form-control input-sm" })
                                        <div class="field-validation-error" id="DivMsO" style="background-color:transparent"></div>
                                        @Html.ValidationMessage("OBLWiseDestuffingDate", "", new { @class = "Error_Msg" })
                                    </div>
                                    <div id="divsqm" style="display:none">
                                        <div class="col-md-1-5 col_cus_2 padding_rt">
                                            <label>UOM:</label>
                                        </div>
                                        <div class="col-md-2-5 col_cus_10">
                                            @Html.DropDownList("UOM", new List<SelectListItem> { new SelectListItem { Text = "SQM", Value = "SQM" } })
                                            @*@Html.TextBox("UOM", "", new { @class = "form -control input-sm", @readonly = true })*@
                                            @Html.ValidationMessage("UOM", new { @class = "Error_Msg" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2 padding_rt">
                                        <label>Remarks:</label>
                                    </div>
                                    <div class="col-md-10-5 col_cus_10">
                                        @Html.TextArea("Remarks", "", new { @style = "width:100%;height:75px", @maxlength = 500 })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2 padding_rt">
                                        <label>Manual Weight(Kg) Handling :</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("ManualWT", "0", new { @class = "form-control input-sm", @onkeypress = "return AllowOnlyDecimal(event)" })
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4 col_cus_offset_3 col_cus_2">
                                        <label>Mechanical Weight(Kg) Handling :</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("MechanicalWT", "0", new { @class = "form-control input-sm", @onkeypress = "return AllowOnlyDecimal(event)" })
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top" style="display:none;">
                                <div class="form-group Form_Input">
                                    <div class="col-md-2 col-md-offset-1-5 col_cus_offset_2 col_cus_3">
                                        <div class="boolean-container">
                                            @Html.CheckBox("chkInterShifting", false, new { @class = "", @id = "chkInterShifting" })
                                            <label for="chkInterShifting"><i class="square"></i><span>Inter Shifting</span></label>
                                        </div>
                                    </div>
                                    <div class="col-md-2 col_cus_3">
                                        <div class="boolean-container">
                                            @Html.CheckBox("chkLiftOn", false, new { @class = "", @id = "chkLiftOn" })
                                            <label for="chkLiftOn"><i class="square"></i><span>Lift On</span></label>
                                        </div>
                                    </div>
                                    <div class="col-md-2 col_cus_3">
                                        <div class="boolean-container">
                                            @Html.CheckBox("chkLiftOff", false, new { @class = "", @id = "chkLiftOff" })
                                            <label for="chkLiftOff"><i class="square"></i><span>Lift Off</span></label>
                                        </div>
                                    </div>
                                    <div class="col-md-2 col_cus_3">
                                        <div class="boolean-container">
                                            @Html.CheckBox("chkReworking", false, new { @class = "", @id = "chkReworking" })
                                            <label for="chkReworking"><i class="square"></i><span>Reworking</span></label>
                                        </div>
                                    </div>
                                    <div class="col-md-2 col_cus_3">
                                        <div class="boolean-container">
                                            @Html.CheckBox("chkWeighment", false, new { @class = "", @id = "chkWeighment" })
                                            <label for="chkWeighment"><i class="square"></i><span>Weighment</span></label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                    </div>
                                    <div class="col-md-1-5">
                                        <div class="boolean-container">
                                            @Html.RadioButton("IsHoldRelease", "0", new { @id = "IsHold", @disabled = "disabled" })
                                            <label for="IsHold"><i class="circle"></i>  Hold</label>
                                        </div>
                                    </div>
                                    <div class="col-md-1-5">
                                        <div class="boolean-container">
                                            @Html.RadioButton("IsHoldRelease", "1", new { @id = "IsRelease", @disabled = "disabled" })
                                            <label for="IsRelease"><i class="circle"></i>  Release</label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="stoke SignUp_space_top SignUp_space_bottom"></div>
                            </div>

                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>Godown:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        <span class="ReQSimbol">*</span>
                                        @Html.TextBox("GodownName", "", new { @class = "form-control input-sm", @readonly = true })
                                        <span class="search" id="GodownSearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#GodownModal"></i></span>
                                        <input type="hidden" id="GodownId" />
                                        <input type="hidden" id="GodownName" />
                                        @Html.ValidationMessage("GodownName", new { @class = "Error_Msg" })

                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>Location:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("GodownWiseLocationNames", "", new { @class = "form-control input-sm", @readonly = true })
                                        <span class="search" id="LocationSearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#LocationModal"></i></span>
                                        @Html.Hidden("GodownWiseLocationIds")
                                        @Html.ValidationMessage("GodownWiseLocationNames", "", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>


                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5">
                                        <label>Receive Packages:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        <span class="ReQSimbol">*</span>
                                        @Html.TextBox("ReceivedPackages", "", new { @class = "form-control input-sm", @onkeypress = "return AllowOnlyDecimal(event)", @onblur = "CalWtFob()" })
                                        @Html.ValidationMessage("ReceivedPackages", new { @class = "Error_Msg" })
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>Destuffing Weight(Kg):</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        <span class="ReQSimbol">*</span>
                                        @Html.TextBox("DestuffingWeight", "", new { @class = "form-control input-sm", @onkeypress = "return AllowOnlyDecimal(event)" })
                                        @Html.ValidationMessage("DestuffingWeight", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>

                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>Area (SQM):</label>
                                    </div>
                                    <div class="col-md-2-5 col_cus_2">
                                        <span class="ReQSimbol">*</span>
                                        @Html.TextBox("Area", "", new { @class = "form-control input-sm", @onkeypress = "return AllowOnlyDecimal(event)" })
                                        @Html.ValidationMessage("Area", "", new { @class = "Error_Msg" })
                                    </div>

                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>CBM:</label>
                                    </div>
                                    <div class="col-md-2-5 col_cus_3">
                                        @Html.TextBox("AreaCbm", "", new { @class = "form-control input-sm", @onkeypress = "return AllowOnlyDecimal(event)" })
                                        @Html.ValidationMessage("AreaCbm", "", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>

                            <div class="row Form_Space_top">
                                <div class="form-group Form_Input">
                                    <div class="col-md-1-5 col_cus_2">
                                        <label>CIF Value:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("CIFValue", "", new { @class = "form-control input-sm", @onkeypress = "return AllowOnlyDecimal(event)" })
                                        @Html.ValidationMessage("CIFValue", "", new { @class = "Error_Msg" })
                                    </div>
                                    <div class="col-md-1-5 col-md-offset-4">
                                        <label>Gross Duty:</label>
                                    </div>
                                    <div class="col-md-2-5">
                                        @Html.TextBox("GrossDuty", "", new { @class = "form-control input-sm", @onkeypress = "return AllowOnlyDecimal(event)" })
                                        @Html.ValidationMessage("GrossDuty", "", new { @class = "Error_Msg" })
                                    </div>
                                </div>
                            </div>


                            <div class="row">
                                <div class="stoke SignUp_space_top SignUp_space_bottom"></div>
                            </div>
                            <div class="row">
                                <div class="col-md-offset-4 col-md-2">
                                    <input type="button" id="BtnAddDestuffingEntry" class="btn log_Btn_sm" value="Add" onclick="SaveDestuffingEntryDtl()" disabled />
                                </div>
                                <div class="col-md-2">
                                    <input type="button" class="btn log_Btn_sm" value="Reset" id="btnReset" onclick="ResetDestuffingEntryDet()" />
                                </div>
                            </div>
                            <div id="DivDestuffingEntryTblMsg" class="logErrMsg Form_Space_top Form_Space_bottom" style="background-color:transparent"></div>
                            <table class="table table-striped table-bordered dataTable slim_tble" id="TblDestuffingEntryDet" style="width:100%;">
                                <thead>
                                    <tr>
                                        <th colspan="2" width="15%" class="text-center">@Html.DisplayName("OBL/HBL")</th>
                                        <th rowspan="2" width="6%" class="text-center">@Html.DisplayName("Line No")</th>
                                        <th rowspan="2" width="20%" class="text-center">@Html.DisplayName("Godown Name")</th>
                                        @*<th rowspan="2" width="10%" class="text-center" hidden="hidden">Area <br /> ( Generated From TallySheet )</th>*@
                                        <th rowspan="2" width="5%" class="text-center">@Html.DisplayName("Area")</th>
                                        <th rowspan="2" width="5%" class="text-center">@Html.DisplayName("CBM")</th>
                                        <th rowspan="2" width="10%" class="text-center">@Html.DisplayName("Received Packages")</th>
                                        <th rowspan="2" width="10%" class="text-center">@Html.DisplayName("Destuffing Weight(Kg)")</th>
                                        <th rowspan="2" width="5%" class="text-center">@Html.DisplayName("Edit")</th>
                                        <th rowspan="2" width="5%" class="text-center">@Html.DisplayName("View")</th>
                                    </tr>
                                    <tr>
                                        <th width="50px" class="text-center">No.</th>
                                        <th width="50px" class="text-center">Date</th>
                                    </tr>
                                </thead>
                                <tbody align="center"></tbody>
                            </table>

                            @*Added on 14/02/2020 By Vineet*@

                            <div id="DivDeliveryOrderDetails" class="Head_h5" style="margin:0 0 5px 0;">
                                <div class="row Form_Space_top">
                                    <div class="form-group Form_Input">
                                        @*<div class="col-md-1-5 col_cus_1_5 padding_rt">
                                            <label>Do Issued By:</label>
                                        </div>
                                        <div class="col-md-3-5">
                                            @Html.TextBox("IssuedBy", "", new { @class = "form-control input-sm", @readonly = true, onkeydown = "PopupActivate('IssuePartyModal');" })
                                            <span class="search" id="IssuePartySearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#IssuePartyModal"></i></span>
                                            @Html.ValidationMessage("IssuedBy", "", new { @class = "Error_Msg" })
                                        </div>*@
                                      @* <div class="col-md-offset-3 col-md-1-5">
                                            <label>Cargs. Delivered To:</label>
                                        </div>
                                        <div class="col-md-2-5 col_cus_2_5">
                                            @Html.TextBox("CargsDelivered", "", new { @class = "form-control input-sm", @readonly = true, onkeydown = "PopupActivate('CargoPartyModal');" })
                                            <span class="search" id="CargoPartySearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#CargoPartyModal"></i></span>
                                            @Html.ValidationMessage("CargsDelivered", "", new { @class = "Error_Msg" })
                                        </div>*@
                                    </div>
                                </div>
                                <div class="row Form_Space_top">
                                    <div class="form-group Form_Input">
                                        <div class="col-md-1-5 col_cus_2">
                                            @*<label>Valid Type</label>*@
                                            <label>Cargs. Delivered To:</label>
                                        </div>
                                        <div class="col-md-2-5">
                                          @*  @Html.DropDownList("ddlValidType", new List<SelectListItem>
                                                        {
                                                        new SelectListItem { Text="Open",Value="Open"},
                                                        new SelectListItem { Text="Closed",Value="Closed"},

                                                        }, "----Select----", new { @class = "form-control input-sm", @onchange = "ValidDt(this);" })
                                            <span class="field-validation-error" id="ErrddlValidType"></span>*@
                                            @Html.TextBox("CargsDelivered", "", new { @class = "form-control input-sm", @readonly = true, onkeydown = "PopupActivate('CargoPartyModal');" })
                                            <span class="search" id="CargoPartySearch"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#CargoPartyModal"></i></span>
                                            @Html.ValidationMessage("CargsDelivered", "", new { @class = "Error_Msg" })
                                        </div>
                                        <div class="col-md-offset-4 col-md-1-5">
                                            <label>DO Valid Date:</label>
                                        </div>
                                        <div class="col-md-2-5 col_cus_2_5 Date_Img">
                                          @* @Html.TextBoxFor(m => m.InvoiceDate, new { @readonly = true, Value = DateTime.Today.ToString("dd/MM/yyyy") })*@
                                            @Html.TextBox("ValidDate", "", new { Value = DateTime.Now.ToString("dd/MM/yyyy"), @size = 10, @maxlength = 10, @onkeyup = "checkDel()", @onblur = "checkdateDel()" })
                                            <div class="field-validation-error" id="DivMsDel" style="background-color:transparent"></div>
                                        </div>

                                    </div>
                                </div>

                                <div class="row">
                                    <div class="stoke SignUp_space_top SignUp_space_bottom"></div>
                                </div>
                                <div class="row">
                                    <div class="col-md-offset-4 col-md-2">
                                        <input type="button" id="BtnAddDeliveryOrd" class="btn log_Btn_sm" value="Add" onclick="SaveDeliveryOrdDtl()" />
                                    </div>
                                    <div class="col-md-2">
                                        <input type="button" class="btn log_Btn_sm" value="Reset" onclick="ResetDeliveryOrdDet()" />
                                    </div>
                                </div>
                                <div id="DivDeliveryOrdTblErrMsg" class="logErrMsg Form_Space_top Form_Space_bottom" style="background-color:transparent"></div>
                                <table class="table table-striped table-bordered dataTable" id="TblDeliveryAppOrd" style="width:100%;">
                                    <thead>
                                        <tr>
                                            <th class="text-center">@Html.DisplayName("SL No")</th>
                                           @* <th>@Html.DisplayName("Issued By")</th>*@
                                            <th>@Html.DisplayName("Cargo. Delivered")</th>
                                            <th>@Html.DisplayName("Edit")</th>

                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>

                            @*End*@
                        </div>
                    </div>

                    <div class="row">
                        <div class="stoke SignUp_space_bottom2 SignUp_space_top2"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-offset-4 col-md-2 SignUp_space_bottom">
                            <input type="submit" class="btn log_Btn_sm" value="Save" id="BtnSaveDestuffingEntry" />
                        </div>
                        <div class="col-md-2">
                            <input type="button" class="btn log_Btn_sm" value="Back" onclick=ReloadDestuffingEntryPage() />
                        </div>
                    </div>
                    <div class="logSuccMsg" style="background-color:transparent" id="DivDestuffingEntryMsg"></div>
                    <div class="logErrMsg Form_Space_bottom" style="background-color:transparent" id="DivDestuffingEntryErrMsg"></div>
                }
                @Scripts.Render("~/bundles/jqueryval")
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="OBLModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of OBL No</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="OBLBox" type="text" />
                <ul class="navList" id="OBLList"></ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="LocationModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Godown Wise Location</h4>
            </div>
            <div class="modal-body popup_body">
                <div class="form-group Form_Input" id="DivLocationDet"></div>
                <div class="clearfix"></div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="CommodityModal" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Commodity</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="Commoditybox" type="text" />
                <ul class="navList" id="lstCommodity">
                    @{
                        if (ViewBag.CommodityList != null)
                        {
                            foreach (var item in ViewBag.CommodityList)
                            {
                                <li onclick="selectcommodity(@item.CommodityId,'@item.CommodityName')" id="@item.CommodityId">@item.CommodityName</li>
                            }
                        }
                    }
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="GodownModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Godown</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="Godownbox" type="text" />
                <ul class="navList" id="lstGodown">
                    @if (ViewBag.GodownList != null)
                    {
                        foreach (var item in ViewBag.GodownList)
                        {
                            <li id="@item.GodownId">@item.GodownName</li>
                        }
                    }
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@*<div class="modal fade" id="ShippingLineModal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content popup_modal">
                <div class="modal-header popup_header">
                    <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                    <h4 class="modal-title">List of Shipping Line Name</h4>
                </div>
                <div class="modal-body popup_body">
                    <input placeholder="Search Me" id="ShippingLineBox" type="text" />
                    <ul class="navList" id="ShippingLineList">
                        @{
                            if (ViewBag.ShippingLineList != null)
                            {
                                foreach (var item in ViewBag.ShippingLineList)
                                {
                                    <li id="@item.Value">@item.Text</li>
                                }
                            }
                        }
                    </ul>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-md-offset-6 col-md-6">
                            <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>*@

<div class="modal fade" id="ShippingLineModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" onclick="CloseEximTrade()"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of Shipping Line Name</h4>
            </div>
            <div class="modal-body popup_body" style="position:relative;">
                <input placeholder="Search By Shipping Line Name Or Party Code" id="ShpngLinebox" type="text" tabindex="400" />
                <span class="search" style="top: 18px;"><i class="fa fa-search" aria-hidden="true" onclick="SearchByPartyCode()"></i></span>
                <table class="table table-striped table-bordered dataTable tblhd" style="width:100%; margin:0 !important; border-bottom:0; padding:0;">
                    <thead>
                        <tr>
                            <th colspan="8" width="80%">Shipping Line Name</th>
                            <th colspan="4" width="20%">Party Code</th>
                        </tr>
                    </thead>
                </table>
                <div id="slim_scroll">
                    <table class="table dataTable table-bordered table-striped slim_tble" id="tbleSline">
                        <tbody>
                            @{
                                if (ViewBag.lstShippingLine != null)
                                {
                                    var tabvalue = 401;
                                    var tab = 0;
                                    var u = "_";
                                    foreach (var item in ViewBag.lstShippingLine)
                                    {
                                        <tr tabindex="@tabvalue@u@tab" onclick="SelectShippingLine(@item.ShippingLineId,'@item.ShippingLineName')" onkeypress="SelectShippingLine(@item.ShippingLineId,'@item.ShippingLineName')">
                                            <td colspan="8" width="80%" class="txt_wrp">@item.ShippingLineName</td>
                                            <td colspan="4" width="20%" class="txt_wrp">@item.PartyCode</td>
                                        </tr>
                                        tab++;
                                    }
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-6">
                        @if (ViewBag.State != null && Convert.ToBoolean(ViewBag.State) == true)
                        {
                            <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreEximTrader()" class="btn log_Btn_sm" id="btnLoadMore">Load More Data</button>
                        }
                        else
                        {
                            <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreEximTrader()" class="btn log_Btn_sm" id="btnLoadMore" disabled>Load More Data</button>
                        }
                    </div>
                    <div class="col-md-6">
                        <button type="button" class="btn log_Btn_sm" onclick="CloseEximTrade()">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@*<div class="modal fade" id="CHAModal" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content popup_modal">
                <div class="modal-header popup_header">
                    <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                    <h4 class="modal-title">List of CHA Name</h4>
                </div>
                <div class="modal-body popup_body">
                    <input placeholder="Search Me" id="CHABox" type="text" />
                    <ul class="navList" id="CHAList">
                        @{
                            if (ViewBag.CHAList != null)
                            {
                                foreach (var item in ViewBag.CHAList)
                                {
                                    <li id="@item.Value">@item.Text</li>
                                }
                            }
                        }
                    </ul>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-md-offset-6 col-md-6">
                            <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>*@

<div class="modal fade" id="CHAModal" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" onclick="CloseCHA()"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of CHA Name</h4>
            </div>
            <div class="modal-body popup_body" style="position:relative;">
                <input placeholder="Search By CHA Name Or Party Code" id="Chabox" type="text" tabindex="400" />
                <span class="search" style="top: 18px;"><i class="fa fa-search" aria-hidden="true" onclick="SearchChaByPartyCode()"></i></span>
                <table class="table table-striped table-bordered dataTable tblhd" style="width:100%; margin:0 !important; border-bottom:0; padding:0;">
                    <thead>
                        <tr>
                            <th colspan="8" width="80%">CHA Name</th>
                            <th colspan="4" width="20%">Party Code</th>
                        </tr>
                    </thead>
                </table>
                <div id="slim_scroll_1">
                    <table class="table dataTable table-bordered table-striped slim_tble" id="tbleCha">
                        @{
                            if (ViewBag.lstCHA != null)
                            {
                                var tabvalue = 401;
                                var tab = 0;
                                var u = "_";
                                foreach (var item in ViewBag.lstCHA)
                                {
                                    <tr tabindex="@tabvalue@u@tab" onclick="SelectCHA(@item.CHAId,'@item.CHAName')" onkeypress="SelectCHA(@item.CHAId,'@item.CHAName')">
                                        <td colspan="8" width="80%" class="txt_wrp">@item.CHAName</td>
                                        <td colspan="4" width="20%" class="txt_wrp">@item.PartyCode</td>
                                    </tr>
                                    tab++;
                                }
                            }
                        }
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-6">
                        @if (ViewBag.CHAState != null && Convert.ToBoolean(ViewBag.CHAState) == true)
                        {
                            <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreCHA()" class="btn log_Btn_sm" id="btnLoadCHA">Load More Data</button>
                        }
                        else
                        {
                            <button type="button" style="width:100%; margin-left:0;" onclick="LoadMoreCHA()" class="btn log_Btn_sm" id="btnLoadCHA" disabled>Load More Data</button>
                        }
                    </div>
                    <div class="col-md-6">
                        <button type="button" class="btn log_Btn_sm" onclick="CloseCHA()">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="IssuePartyModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of issued by</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="Issuebox" type="text" tabindex="400" />
                <ul class="navList" id="lstIssue">
                    @*@{
                        foreach (var item in Model.lstGodownList)
                        {
                        <li id="@item.GodownId">@item.GodownName</li>
                        }
                        }*@
                </ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="CargoPartyModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content popup_modal">
            <div class="modal-header popup_header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i></button>
                <h4 class="modal-title">List of cargo delivered to</h4>
            </div>
            <div class="modal-body popup_body">
                <input placeholder="Search Me" id="Cargobox" type="text" tabindex="400" />
                <ul class="navList" id="lstCargo"></ul>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-offset-6 col-md-6">
                        <button type="button" class="btn log_Btn_sm" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    var ArrayLst = [];
    var ArrayOfDeliveryOrd = [];
    $(function () {
        //debugger;
        TimeInSeconds = 5000;
        ArrayLst=@Html.Raw(Json.Encode(Model.lstDtl));
        GenerateDestuffingEntryTable();
        ArrayOblLst=@Html.Raw(Json.Encode(Model.lstOblDtl));
        if (ArrayOblLst.length != 0) {
            $.each(ArrayOblLst, function (i, item) {
                OBLlistHtml += '<li id="' + item.TallySheetDtlId + '" " onclick="SelectOBLDetails('+ item.DestuffingEntryDtlId +','+ item.TallySheetDtlId + ',&quot;' + item.BOLNo +'&quot;,&quot;'+ item.TallySheetArea +'&quot;,&quot;'+ item.BOLDate +'&quot;,&quot;'+ item.LineNo +'&quot;,&quot;'+ item.Commodity + '&quot;,'+ item.CommodityId + ',&quot;'+ item.CargoDescription + '&quot;,'+ item.NoOfPackages + ','+ item.GrossWeight + ',&quot;'+ item.CargoType + '&quot;,&quot;'+ item.UOM + '&quot;,'+ item.RemPackages + ','+ item.RemWeight + ','+ item.ManualWT + ','+ item.MechanicalWT + ','+ item.IsHoldRelease + ',&quot;' + item.BOENo +'&quot;,&quot;' + item.BOEDate + '&quot;,&quot;'+ item.OBLWiseDestuffingDate +'&quot;,&quot;'+ item.CargoType +'&quot;'+ item.Remarks +',&quot;' + item.OBLCIFValue +',' + item.OBLGrossDuty+'&quot;)">' + item.BOLNo + '</li>';//OBLCIFValue,OBLGrossDuty
            });
        }
        $('#OBLList').html(OBLlistHtml);

        //Added by Vineet

        ArrayOfDeliveryOrd=@Html.Raw(Json.Encode(Model.LstDeliveryordDtl));
        GenerateDeliveryOrdTable();

        // End


        if(ArrayLst.len)

            //$('#LocationSearch').css("display", "none");
            @*var html='';
        var arrayLoc=@Html.Raw(Json.Encode(Model.lstLocation));
        $.each(arrayLoc,function(i,item){
            html+='<div style="float:left;"><div class="boolean-container"><input type="checkbox" id="'+item.LocationId+'g" name="'+item.LocationId+'g" onclick="SelectLocation()" /><label for="'+item.LocationId+'g"><i class="square"></i><span>'+item.LocationName+'</span></label></div></div>';
        });*@
            // $('#DivLocationDet').html(html);

            $('#DestuffingEntryDate').datepicker({
                dateFormat: "dd/mm/yy",
                showOn: "button",
                buttonImage: "/Content/images/calendar.png",
                buttonImageOnly: true,
                buttonText: "Select date",
                changeMonth: true,
                changeYear: true,
                showAnima: "fadein",
                onClose: function () {
                    $("[data-valmsg-for='DestuffingEntryDate']").html('');
                }
            });
        $("#DestuffingEntryDate").datepicker("option", "minDate", '@Model.TallySheetDate');
    });

    $('#StartDate').datepicker({
        dateFormat: "dd/mm/yy",
        showOn: "button",
        buttonImage: "/Content/images/calendar.png",
        buttonImageOnly: true,
        buttonText: "Select date",
        changeMonth: true,
        changeYear: true,
        showAnima: "fadein",
        onClose: function () {
            $("[data-valmsg-for='StartDate']").html('');
        }
    });
    $('#BOEDate').datepicker({
        dateFormat: "dd/mm/yy",
        showOn: "button",
        buttonImage: "/Content/images/calendar.png",
        buttonImageOnly: true,
        buttonText: "Select date",
        changeMonth: true,
        changeYear: true,
        showAnima: "fadein",
        onClose: function () {
            $("[data-valmsg-for='BOEDate']").html('');
            GetCIFDuty();
        }
    });
    $('#OBLWiseDestuffingDate').datepicker({
        dateFormat: "dd/mm/yy",
        showOn: "button",
        buttonImage: "/Content/images/calendar.png",
        buttonImageOnly: true,
        buttonText: "Select date",
        changeMonth: true,
        changeYear: true,
        showAnima: "fadein",
        maxDate:new Date(@DateTime.Today.Year,((@DateTime.Today.Month)-1),@DateTime.Today.Day),
        onClose: function () {
            $("[data-valmsg-for='DestuffingEntryDate']").html('');
        }
    });
    $('#ShpngLinebox').keyup(function () {
        var valThis = $(this).val().toLowerCase();
        if (valThis == "") {
            $('#ShippingLineModal .navList > li').show();
        } else {
            $('#ShippingLineModal .navList > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(valThis) >= 0) ? $(this).show() : $(this).hide();
            });
        };
    });
    $('#ShippingLineList li').on("click", function () {
        $('#ShippingLine').val($(this).text());
        $('#ShippingLineId').val($(this).attr('id'));
        $("#ShippingLineModal").modal("hide");
    });
    $('#CHAList li').on("click", function () {
        $('#CHA').val($(this).text());
        $('#CHAId').val($(this).attr('id'));
        $("#CHAModal").modal("hide");
    });
    function selectcommodity(cid,cname){
        $('#Commodity').val(cname);
        $('#CommodityId').val(cid);
        $('#CommodityModal').modal('hide');
    }
    $('#Chabox').keyup(function () {
        var valThis = $(this).val().toLowerCase();
        if (valThis == "") {
            $('#CHAModal .navList > li').show();
        } else {
            $('#CHAModal .navList > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(valThis) >= 0) ? $(this).show() : $(this).hide();
            });
        };
    });
    function SelectLocation() {
        var data = '';
        var inf = '';
        $('#DivLocationDet').find('input:checked').each(function () {
            if (data == '')
                data = $(this).prop('name');
            else
                data = data + ',' + $(this).prop('name');
            if (inf == '')
                inf = $('label[for="' + $(this).prop('id') + '"]').text();
            else
                inf = inf + ',' + $('label[for="' + $(this).prop('id') + '"]').text();
        });
        $('#GodownWiseLocationIds').val(data);
        $('#GodownWiseLocationNames').val(inf);
    }



    function ReloadDestuffingEntryPage()
    {
        $('#DivBody').load('/Import/DSR_CWCImport/CreateDestuffingEntry');
    }
    function ResetGodownDet() {
        //debugger;
        $('#GodownWiseLocationNames').val('');
        $('#GodownName').val('');
        $('#Area').val(0);
        $('#AreaCbm').val(0)
        $('#DestuffingWeight').val(0);
        $('#ReceivedPackages').val(0);
        $('#CIFValue').val(0);
        $('#GrossDuty').val(0);
        $('#GdTransId').val(0)
        //$('#DivLocationDet').find('input[type="checkbox"]:checked').each(function () {
        // $(this).prop("checked", false);
        //});
        // $( "#IsHold" ).prop( "checked", true );
    }

    function ResetDestuffingEntryDet() {
        //debugger;
        $('#DivDestuffingEntryDet').find('input:text,textarea').val('');
        $('#DivDestuffingEntryDet').find('input:hidden').val('');
        $('#DivLocationDet').find('input[type="checkbox"]:checked').each(function () {
            $(this).prop("checked", false);
        });
        $( "#IsHold" ).prop( "checked", false );
        $( "#IsRelease" ).prop( "checked", false );
        $( "#IsHold" ).prop( "disabled", true );
        $( "#IsRelease" ).prop( "disabled", true );
        DisplayReadonlyOn();
    }
    function GenerateDestuffingEntryTable() {
        $('#TblDestuffingEntryDet').hide();
        $('#TblDestuffingEntryDet>tbody').html('');
        var Html = '';
        //debugger
        if (ArrayLst.length != 0) {
            $.each(ArrayLst, function (i, item) {
                //debugger
                Html += '<tr><td width="50px" class="text-center txt_wrp">' + item.BOLNo + '</td><td width="50px" class="txt_wrp">' + item.BOLDate + '</td><td width="6%" class="txt_wrp">' + item.LineNo + '</td><td width="20%" class="txt_wrp">'+item.GodownName+'</td><td width="5%" class="txt_wrp">' + item.Area +'</td><td width="5%" class="txt_wrp">' + item.AreaCbm + '</td><td width="10%" class="txt_wrp">' + item.ReceivedPackages + '</td><td width="10%" class="txt_wrp">' + item.DestuffingWeight + '</td></td><td width="5%" class="text-center">';
                //Html += '<tr><td width="50px" class="text-center txt_wrp">' + item.BOLNo + '</td><td width="50px" class="txt_wrp">' + item.BOLDate + '</td><td width="6%" class="txt_wrp">' + item.LineNo + '</td><td width="15%" class="txt_wrp">'+item.GodownName+'</td><td width="10%" class="txt_wrp">'+item.TallySheetArea+'</td><td width="5%" class="txt_wrp">' + item.Area +'</td><td width="5%" class="txt_wrp">' + item.AreaCbm + '</td><td width="10%" class="txt_wrp">' + item.ReceivedPackages + '</td><td width="10%" class="txt_wrp">' + item.DestuffingWeight + '</td></td><td width="5%" class="text-center">';
                // if(item.IsEditable==0){
                // Html += '<a href="#" onclick="EditData(' + item.DestuffingEntryDtlId +','+ item.GdTransId +','+ item.StockDetailsId + '); return false"><i class="fa fa fa-pencil-square Edit" aria-hidden="true"></i></a>';
                Html += '<a href="#" onclick="EditData(' + item.GdTransId +',&quot;' + item.BOLNo +'&quot;); return false"><i class="fa fa fa-pencil-square Edit" aria-hidden="true"></i></a>';
                //}
                //else{
                //    Html += '<a href="#" onclick="Edit(' + item.DestuffingEntryDtlId + '); return false"><i class="fa fa fa-pencil-square Edit" aria-hidden="true"></i></a>';
                //}
                Html += '</td><td width="5%" class="text-center"><a href="#" onclick="ViewData(' + item.GdTransId + ')"><i class="fa fa-search-plus" aria-hidden="true"></i></a></td></tr>';
            });
            $('#TblDestuffingEntryDet>tbody').html(Html);
            $('#TblDestuffingEntryDet').show();
        }
    }
    function ViewData(i) {
        // debugger;
        $.each(ArrayLst,function(x,item)
        {
            if(item.GdTransId==i)

            {
                $('#BtnAddDestuffingEntry').prop("disabled", true);
                $('#TallySheetDtlId').val(item.TallySheetDtlId);
                $('#TallySheetArea').val(item.TallySheetArea);
                $('#BOLNo').val(item.BOLNo);
                $('#BOLDate').val(item.BOLDate);
                $('#LineNo').val(item.LineNo);
                $('#CommodityId').val(item.CommodityId);
                $('#Commodity').val(item.Commodity);
                $('#CargoDescription').val(item.CargoDescription);
                $('#NoOfPackages').val(item.NoOfPackages);
                $('#ReceivedPackages').val(item.ReceivedPackages);
                $('#UOM').val(item.UOM);
                $('#GrossWeight').val(item.GrossWeight);
                $('#DestuffingWeight').val(item.DestuffingWeight);
                $('#Remarks').val(item.Remarks);
                $('#GodownWiseLocationNames').val(item.GodownWiseLocationNames);
                $('#GodownWiseLocationIds').val(item.GodownWiseLocationIds);
                $('#Area').val(item.Area);
                $('#AreaCbm').val(item.AreaCbm);
                $('#CIFValue').val(item.CIFValue);
                $('#GrossDuty').val(item.GrossDuty);
                $('#BOENo').val(item.BOENo);
                $('#BOEDate').val(item.BOEDate);
                $('#OBLWiseDestuffingDate').val(item.OBLWiseDestuffingDate);
                $('#CargoType').val(item.CargoType);
                $('#IsHoldRelease').val(item.IsHoldRelease);
                $('#GodownId').val(item.GodownId);
                $('#GodownName').val(item.GodownName);
                $('#ManualWT').val(item.ManualWT);
                $('#MechanicalWT').val(item.MechanicalWT);
                $('#RemPackages').val(item.RemPackages);
                $('#RemWeight').val(item.RemWeight);
                if(item.IsHoldRelease==1)
                {
                    $( "#IsRelease" ).prop( "checked", true );
                }
                DisplayReadonlyOff();
            }
        });
    }
    function DisplayReadonlyOff(){

        $('#StartDate').parent().find('img').css('display', 'none');
        $('#DestuffingEntryDate').parent().find('img').css('display', 'none');
        $('#BOENo').prop("readonly", true);
        $('#BOEDate').prop("readonly", true);
        $('#BOEDate').parent().find('img').css('display', 'none');
        $('#OBLWiseDestuffingDate').prop("readonly", true);
        $('#OBLWiseDestuffingDate').parent().find('img').css('display', 'none');
        $('#Remarks').prop("readonly", true);
        $('#ManualWT').prop("readonly", true);
        $('#MechanicalWT').prop("readonly", true);
        $('#ReceivedPackages').prop("readonly", true);
        $('#DestuffingWeight').prop("readonly", true);
        $('#Area').prop("readonly", true);
        $('#AreaCbm').prop("readonly", true);
        $('#CIFValue').prop("readonly", true);
        $('#GrossDuty').prop("readonly", true);
        $('#GodownSearch').css("display", "none");
        $('#LocationSearch').css("display", "none");
        $('#CommoditySearch').css("display", "none");
        $('#oblsearch').css("display", "none");
        $('#ChaSearch').css("display", "none");
        $('#ShippingLineSearch').css("display", "none");
        $('#CargoType').prop("disabled", true);
        $('#RMSValue').prop("disabled", true);
        $('#ODCType').prop("disabled", true);
    }
    function DisplayReadonlyOn(){

        $('#StartDate').parent().find('img').css('display', '');
        $('#DestuffingEntryDate').parent().find('img').css('display', '');
        $('#BOENo').prop("readonly", false);
        $('#BOEDate').prop("readonly", false);
        $('#BOEDate').parent().find('img').css('display', '');
        $('#OBLWiseDestuffingDate').prop("readonly", false);
        $('#OBLWiseDestuffingDate').parent().find('img').css('display', '');
        $('#Remarks').prop("readonly", false);
        $('#ManualWT').prop("readonly", false);
        $('#MechanicalWT').prop("readonly", false);
        $('#ReceivedPackages').prop("readonly", false);
        $('#DestuffingWeight').prop("readonly", false);
        $('#Area').prop("readonly", false);
        $('#AreaCbm').prop("readonly", false);
        $('#CIFValue').prop("readonly", false);
        $('#GrossDuty').prop("readonly", false);
        $('#GodownSearch').css("display", "");
        $('#LocationSearch').css("display", "");
        $('#CommoditySearch').css("display", "");
        $('#oblsearch').css("display", "");
        $('#ChaSearch').css("display", "");
        $('#ShippingLineSearch').css("display", "");
        $('#CargoType').prop("disabled", false);
        $('#RMSValue').prop("disabled", false);
        $('#ODCType').prop("disabled", false);
    }
    /*
        function escapeRegExp(string){
            return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
        }


        function replaceAll(str, term, replacement) {
            return str.replace(new RegExp(escapeRegExp(term), 'g'), replacement);
        }*/

    function EditData(Id,Obl) {
        debugger;
        DisplayReadonlyOn();
        var earRecPkg=0;
        var earRecWt=0;
        if(ArrayLst.length>0)
        {
            for (var i = 0; i < ArrayLst.length; i++) {

                if(Obl==ArrayLst[i].BOLNo)
                {
                    earRecPkg = Number(earRecPkg)+ Number(ArrayLst[i].ReceivedPackages);
                    earRecWt =Number(earRecWt)+Number(ArrayLst[i].DestuffingWeight);
                }
            }
        }

        if ($('#BtnAddDestuffingEntry').is(":disabled") == true) {
            $.each(ArrayLst,function(x,item)
            {
                //if(item.DestuffingEntryDtlId==i)
                if(item.GdTransId==Id)
                {
                    if(item.IsEditable==1){
                        alert('Can not edit delivery application alredy done');
                        return false;
                    }
                    var CargoDescription = item.CargoDescription.replace(new RegExp('_n_', 'g'), '\n');
                    CargoDescription = CargoDescription.replace(new RegExp('_c_', 'g'), ',');
                    var Remarks = item.Remarks.replace(new RegExp('_n_', 'g'), '\n');
                    Remarks = Remarks.replace(new RegExp('_c_', 'g'), ',');
                    $('#IsHold').prop("disabled", false);
                    $('#IsRelease').prop("disabled", false);
                    //debugger;
                    $('#btnReset').prop("disabled", true);
                    $('#BtnAddDestuffingEntry').prop("disabled", false);
                    $('#LocationSearch').css("display", "block");
                    $('#oblSearch').css("display", "none");
                    $('#DivLocationDet').find('input[type="checkbox"]:checked').prop("checked", false);
                    $('#TallySheetDtlId').val(item.TallySheetDtlId);
                    $('#TallySheetArea').val(item.TallySheetArea);
                    $('#BOLNo').val(item.BOLNo);
                    $('#BOLDate').val(item.BOLDate);
                    $('#LineNo').val(item.LineNo);
                    $('#CommodityId').val(item.CommodityId);
                    $('#Commodity').val(item.Commodity);
                    $('#CargoDescription').val(CargoDescription);
                    $('#NoOfPackages').val(item.NoOfPackages);
                    $('#ReceivedPackages').val(item.ReceivedPackages);
                    $('#UOM').val(item.UOM);
                    $('#GrossWeight').val(item.GrossWeight);
                    $('#DestuffingWeight').val(item.DestuffingWeight);
                    $('#Remarks').val(Remarks);
                    $('#GodownWiseLocationNames').val(item.GodownWiseLocationNames);
                    $('#GodownWiseLocationIds').val(item.GodownWiseLocationIds);
                    $('#DestuffingEntryDtlId').val(item.DestuffingEntryDtlId);
                    $('#Area').val(item.Area);
                    $('#AreaCbm').val(item.AreaCbm);
                    $('#CIFValue').val(item.CIFValue);
                    $('#GrossDuty').val(item.GrossDuty);
                    $('#BOENo').val(item.BOENo);
                    $('#BOEDate').val(item.BOEDate);
                    $('#CargoType').val(item.CargoType);
                    $('#OBLWiseDestuffingDate').val(item.OBLWiseDestuffingDate);
                    $('#IsHoldRelease').val(item.IsHoldRelease);
                    $('#GodownId').val(item.GodownId);
                    $('#GodownName').val(item.GodownName);
                    $('#GdTransId').val(item.GdTransId);
                    $('#StockDetailsId').val(item.StockDetailsId);
                    $('#InterShifting').val(0);
                    $('#LiftOn').val(0);
                    $('#LiftOff').val(0);
                    $('#Reworking').val(0);
                    $('#Weighment').val(0);
                    $('#ManualWT').val(item.ManualWT);
                    $('#MechanicalWT').val(item.MechanicalWT);
                    $('#OBLCIFValue').val(item.OBLCIFValue);
                    $('#OBLGrossDuty').val(item.OBLGrossDuty);


                    //$('#NoOfPackages').val(item.NoOfPackages);
                    //$('#GrossWeight').val(item.GrossWeight);

                    var remPkg=(Number(item.NoOfPackages)-Number(earRecPkg))+Number(item.ReceivedPackages);
                    if(remPkg<=0){
                        $('#RemPackages').val(0);
                    }
                    else{
                        $('#RemPackages').val(remPkg);
                    }
                    var remWt=(Number(item.GrossWeight)-Number(earRecWt))+Number(item.DestuffingWeight);
                    if(remWt<=0){
                        $('#RemWeight').val(0);
                    }
                    else{
                        $('#RemWeight').val(remWt);
                    }

                    if(item.IsHoldRelease==1)
                    {
                        $( "#IsRelease" ).prop( "checked", true );
                    }
                    else{
                        $( "#IsHold" ).prop( "checked", true );
                    }
                    if (item.GodownWiseLocationIds != null && item.GodownWiseLocationIds != undefined) {
                        var split = item.GodownWiseLocationIds.split(',');
                        $(split).each(function (j, data) {
                            $('#' + data + 'g').prop('checked', true);
                        });
                    }
                    ArrayLst.splice(x, 1);
                    GenerateDestuffingEntryTable();
                    return false;
                }
            });
        }
        else {
            $('#DivDestuffingEntryTblMsg').html('Please add above record');
            setTimeout(function () { $('#DivDestuffingEntryTblMsg').html(''); }, 1000);
        }
    }
    function SaveDestuffingEntryDtl() {
        debugger;
        if(ArrayLst.length>0)
        {
            if($('#BOLNo').val()!='' && $('#GodownName').val()!= '')
            {
                var Obl=$('#BOLNo').val();
                var GodownId=$('#GodownId').val();

                for (var i = 0; i < ArrayLst.length; i++) {

                    if(Obl==ArrayLst[i].BOLNo && GodownId==ArrayLst[i].GodownId)
                    {
                        alert('This Godown already exists, please update.');
                        return false;
                    }
                }
            }
        }
        $('[data-valmsg-for="GodownName"]').html('<span></span>');
        $('[data-valmsg-for="GodownWiseLocationNames"]').html('<span></span>');
        $('[data-valmsg-for="Area"]').html('<span></span>');
        $('[data-valmsg-for="AreaCbm"]').html('<span></span>');
        $('[data-valmsg-for="ReceivedPackages"]').html('<span></span>');
        $('[data-valmsg-for="DestuffingWeight"]').html('<span></span>');

        if ($('#GodownName').val() == '') {
            $('[data-valmsg-for="GodownName"]').html('<span>Fill Out This Field</span>');
            return false;
        }
        if ($('#GodownWiseLocationNames').val() == '') {
            $('[data-valmsg-for="GodownWiseLocationNames"]').html('<span>Fill Out This Field</span>');
            return false;
        }

        if($('#Area').val() == '0')
        {
            $('[data-valmsg-for="Area"]').html('<span>Fill Out This Field</span>');
            return false;
        }
        if ($('#AreaCbm').val() == '')
        {
            $('#AreaCbm').val(0);
            //$('[data-valmsg-for="AreaCbm"]').html('<span>Fill Out This Field</span>');
            //return false;
        }
        if ($('#ReceivedPackages').val()<0) {
            $('[data-valmsg-for="ReceivedPackages"]').html('<span>Negative value can not be add </span>');
            return false;
        }
        if ($('#DestuffingWeight').val()<0) {
            $('[data-valmsg-for="DestuffingWeight"]').html('<span>Negative value can not be add</span>');
            return false;
        }

        if ($('#AreaCbm').val() <0)
        {
            $('[data-valmsg-for="AreaCbm"]').html('<span>Negative value can not be add</span>');
            return false;
        }
        if ($('#Area').val() <0)
        {
            $('[data-valmsg-for="Area"]').html('<span>Negative value can not be add</span>');
            return false;
        }

        if ($('#ReceivedPackages').val()<1) {
            $('[data-valmsg-for="ReceivedPackages"]').html('<span>Enter Received Package More Than 0 </span>');
            return false;
        }
        if ($('#DestuffingWeight').val()<1) {
            $('[data-valmsg-for="DestuffingWeight"]').html('<span>Enter Destuffing Weight More Than 0 </span>');
            return false;
        }

        debugger;
        var arRecPkg=0;
        var arRecWt=0;
        if(ArrayLst.length>0)
        {
            var Obl=$('#BOLNo').val();
            for (var i = 0; i < ArrayLst.length; i++) {

                if(Obl==ArrayLst[i].BOLNo)
                {
                    arRecPkg = Number(arRecPkg)+ Number(ArrayLst[i].ReceivedPackages);
                    arRecWt =Number(arRecWt)+Number(ArrayLst[i].DestuffingWeight);
                }
            }

            arRecPkg = Number(arRecPkg) + Number($('#ReceivedPackages').val());
            arRecWt =Number(arRecWt) + Number($('#DestuffingWeight').val());
        }
        else{
            arRecPkg = $('#ReceivedPackages').val();
            arRecWt =$('#DestuffingWeight').val();
        }
        var RemPackages=Number($('#hdnRemPackages').val())-Number(arRecPkg);
        var RemWeight=Number($('#hdnRemWeight').val())-Number(arRecWt);

        if(RemPackages<0)
        {
            RemPackages=0;
        }
        if(RemWeight<0)
        {
            RemWeight=0;
        }

        $('#RemPackages').val(RemPackages);
        $('#RemWeight').val(RemWeight);

        //var arRecPkg=0;
        //var arRecWt=0;
        //if(ArrayLst.length>0)
        //{
        //    var Obl=$('#BOLNo').val();
        //    for (var i = 0; i < ArrayLst.length; i++) {

        //        if(Obl==ArrayLst[i].BOLNo)
        //        {
        //            arRecPkg = Number(arRecPkg)+ Number(ArrayLst[i].ReceivedPackages);
        //            arRecWt =Number(arRecWt)+Number(ArrayLst[i].DestuffingWeight);
        //        }
        //    }
        //}

        ////debugger;
        //var IsHoldRelease = Number($('input[name=IsHoldRelease]:checked').val());
        //var RecivedPackage=Number($('#ReceivedPackages').val());
        //var RemPackages=Number($('#RemPackages').val());
        //var TotRecPackage=Number(RecivedPackage)+ Number(arRecPkg);


        var Manual=0;
        var Mechanical=0;
        if ($('#ManualWT').val() == "") {
            Manual=0;
        }
        else
        {
            Manual=$('#ManualWT').val();
        }
        if ($('#MechanicalWT').val() == "") {
            Mechanical=0;
        }
        else
        {
            Mechanical=$('#MechanicalWT').val();
        }
        if ($('#RMSValue').val() != '3')
        {
            if ((Number(Manual)+Number(Mechanical)) <=0)
            {
                alert('Manual or Mechanical weight will be greater than zero');
                return false;
            }
        }

        //if(ArrayLst.length>0)
        //{
        //    var GodownId=$('#GodownId').val();
        //    for (var i = 0; i < ArrayLst.length; i++) {

        //        if(GodownId==ArrayLst[i].GodownId)
        //        {
        //            alert('This Godown already exists, please update');
        //            return false;
        //        }
        //    }
        //}

        //if(Number(IsHoldRelease)==1){
        //    if(Number(RemPackages)==Number(TotRecPackage)){

        //    }
        //    else
        //    {
        //        alert('Can not release (Remaining Packages and Received Packages not equal)');
        //        return false;
        //    }
        //}

        //if(Number(RemPackages)>Number(TotRecPackage)){
        //    $('#BtnAddDestuffingEntry').prop("disabled", true);
        //    $('#btnReset').prop("disabled", false);
        //    // ResetGodownDet();
        //}
        //else if(Number(RemPackages)<Number(TotRecPackage)){
        //    alert('Remaining Packages and Received Packages not equal');
        //    return false;
        //}

        var RemWeight=Number($('#RemWeight').val());
        var DestuffingWeight=Number($('#DestuffingWeight').val());
        var TotDestufWeight=Number(DestuffingWeight)+ Number(arRecWt);

        //if(Number(RemWeight)<Number(TotDestufWeight)){
        //    alert('Remaining Weight and Destuffing Weight not equal');
        //    return false;
        //}

        if ($('#ContainerNo').val() != "") {
            var DestuffingEntryDtl = {
                "DestuffingEntryDtlId":$('#DestuffingEntryDtlId').val(),
                "TallySheetDtlId": $('#TallySheetDtlId').val(),
                "BOLNo": $('#BOLNo').val(),
                "BOLDate": $('#BOLDate').val(),
                "LineNo": $('#LineNo').val(),
                "CommodityId": $('#CommodityId').val(),
                "Commodity": $('#Commodity').val(),
                "CargoDescription": $('#CargoDescription').val(),
                "NoOfPackages": $('#NoOfPackages').val(),
                "ReceivedPackages": $('#ReceivedPackages').val() == "" ? 0 : $('#ReceivedPackages').val(),
                "UOM": $('#UOM').val(),
                "GrossWeight": $('#GrossWeight').val(),
                "DestuffingWeight": $('#DestuffingWeight').val() == "" ? 0 : $('#DestuffingWeight').val(),
                "TallySheetArea": $('#TallySheetArea').val(),
                "Area": $('#Area').val() == "" ? 0 : $('#Area').val(),
                "AreaCbm": $('#AreaCbm').val() == "" ? 0 : $('#AreaCbm').val(),
                "GodownWiseLocationIds": $('#GodownWiseLocationIds').val(),
                "GodownWiseLocationNames": $('#GodownWiseLocationNames').val(),
                "Remarks": $('#Remarks').val(),
                "CIFValue":($('#CIFValue').val()==''?0:$('#CIFValue').val()),
                "GrossDuty":($('#GrossDuty').val()==''?0:$('#GrossDuty').val()),
                "BOENo":$('#BOENo').val(),
                "BOEDate":$('#BOEDate').val(),
                "OBLWiseDestuffingDate":$('#OBLWiseDestuffingDate').val(),
                "CargoType":($('#CargoType').val()),
                "IsHoldRelease":$('input[name=IsHoldRelease]:checked').val(),
                "GodownId": $('#GodownId').val(),
                "GodownName": $('#GodownName').val(),
                "GdTransId": $('#GdTransId').val(),
                "StockDetailsId": $('#StockDetailsId').val(),
                "InterShifting": 0,
                "LiftOn": 0,
                "LiftOff": 0,
                "Reworking":0,
                "Weighment":0,
                "ManualWT":$('#ManualWT').val(),
                "MechanicalWT":$('#MechanicalWT').val(),
                "OBLCIFValue":$('#OBLCIFValue').val(),
                "OBLGrossDuty":$('#OBLGrossDuty').val()
            }
            ArrayLst.push(DestuffingEntryDtl);
            //$('#BtnAddDestuffingEntry').prop("disabled", true);
            //$('#btnReset').prop("disabled", false);
            //$('#LocationSearch').css("display", "none");
            //ResetDestuffingEntryDet();
            //GenerateDestuffingEntryTable();
            if(ArrayLst.length>0)
            {
                //debugger;
                var NoOfPag=0
                var arrayRecPkg=0;
                NoOfPackages=$('#NoOfPackages').val();
                var Obl=$('#BOLNo').val();
                for (var i = 0; i < ArrayLst.length; i++) {

                    if(Obl==ArrayLst[i].BOLNo)
                    {
                        arrayRecPkg = Number(arrayRecPkg)+ Number(ArrayLst[i].ReceivedPackages);
                    }
                }
                for (var j = 0; j < ArrayLst.length; j++) {
                    if(Obl==ArrayLst[j].BOLNo)
                    {
                        if(arrayRecPkg>=NoOfPackages)
                        {
                            ArrayLst[j].IsHoldRelease="1";
                            $( '#IsRelease' ).prop( "checked", true );
                        }
                        //else{
                        //    ArrayLst[j].IsHoldRelease="0";
                        //    $( '#IsHold' ).prop( "checked", true );
                        //}
                    }
                }
                //var Obl=$('#BOLNo').val();
                for (var i = 0; i < ArrayLst.length; i++) {

                    if(Obl==ArrayLst[i].BOLNo)
                    {
                        ArrayLst[i].IsHoldRelease=$('input[name=IsHoldRelease]:checked').val();
                        ArrayLst[i].BOENo= $('#BOENo').val();
                        ArrayLst[i].BOEDate= $('#BOEDate').val();
                        ArrayLst[i].Remarks= $('#Remarks').val();
                        ArrayLst[i].OBLWiseDestuffingDate= $('#OBLWiseDestuffingDate').val();
                        ArrayLst[i].InterShifting= 0;
                        ArrayLst[i].LiftOn= 0;
                        ArrayLst[i].LiftOff= 0;
                        ArrayLst[i].Reworking= 0;
                        ArrayLst[i].Weighment= 0;
                        ArrayLst[i].ManualWT= $('#ManualWT').val();
                        ArrayLst[i].MechanicalWT= $('#MechanicalWT').val();

                    }
                }
            }

            $('#BtnAddDestuffingEntry').prop("disabled", true);
            $('#btnReset').prop("disabled", false);
            //ResetDestuffingEntryDet();
            ResetGodownDet();
            DisplayReadonlyOn();
            GenerateDestuffingEntryTable();
        }
        else {
            $('#DivDestuffingEntryTblMsg').html('Please Select A Container / CBT No In Order To Add Details');
        }
    }


    $('#BtnSaveDestuffingEntry').on("click", function () {
        debugger;
        if(ArrayLst.length>0)
        {
            //debugger;
            var Obl=$('#BOLNo').val();
            for (var i = 0; i < ArrayLst.length; i++) {

                if(Obl==ArrayLst[i].BOLNo)
                {
                    ArrayLst[i].IsHoldRelease=$('input[name=IsHoldRelease]:checked').val();
                    ArrayLst[i].BOENo= $('#BOENo').val();
                    ArrayLst[i].BOEDate= $('#BOEDate').val();
                    ArrayLst[i].Remarks= $('#Remarks').val();
                    ArrayLst[i].OBLWiseDestuffingDate= $('#OBLWiseDestuffingDate').val();
                    ArrayLst[i].InterShifting= 0;
                    ArrayLst[i].LiftOn= 0;
                    ArrayLst[i].LiftOff= 0;
                    ArrayLst[i].Reworking= 0;
                    ArrayLst[i].Weighment= 0;
                    ArrayLst[i].ManualWT= $('#ManualWT').val();
                    ArrayLst[i].MechanicalWT= $('#MechanicalWT').val();

                }
            }

        }
        if ($('#BtnAddDestuffingEntry').prop("disabled") == false) {
            $('#DivDestuffingEntryTblMsg').html('Please Add The Above Records');
            return false;
        }
        //Added by Vineet
        debugger;
        if (ArrayOfDeliveryOrd.length != 0) {
            $('#DeliveryOrdDtlXml').val(JSON.stringify(ArrayOfDeliveryOrd));
        }
        else
        {
            $('#DivDeliveryOrdTblErrMsg').html('Please Add The Above Records');
            return false;
        }

        $('#DivDestuffingEntryTblMsg').html('');
        if ($('#TblDestuffingEntryDet >tbody').html() != "") {
            if (ArrayLst.length != 0) {
                $('#DestuffingEntryXML').val(JSON.stringify(ArrayLst));
            }
        }
        //$('#BtnSaveDestuffingEntry').prop('disabled', true);
    });
    function DestuffingEntryOnSuccess(data) {
        if (data.Status == 1) {
            $('#DivDestuffingEntryMsg').html(data.Message);
            setTimeout(ReloadDestuffingEntryPage, 5000);
        }
        else {
            $('#DivDestuffingEntryErrMsg').html(data.Message);
        }
        // $('#BtnSaveDestuffingEntry').prop('disabled', false);
    }
    function DestuffingEntryOnFailure() { }
    function GetCIFDuty() {
        if (
                $('#BOENo').val() != '' &&
                $('#BOEDate').val() != '' &&
                ($('#CIFValue').val() == '' || $('#CIFValue').val() == '0') &&
                ($('#GrossDuty').val() == '' || $('#GrossDuty').val() == '0')
            )
        {
            $.ajax({
                url: '/Import/DSR_CWCImport/GetCIFandDutyForBOE',
                type: 'GET',
                data: { "BOENo": $('#BOENo').val(), "BOEDate": $('#BOEDate').val() },
                dataType: 'JSON',
                success:function(data)
                {
                    if (data.Status == 1)
                    {
                        $('#CIFValue').val(data.Data.CIFValue);
                        $('#GrossDuty').val(data.Data.GrossDuty);
                    }
                }
            });
        }
    }

    function GetLicationByGodown(i) {
        $(GodownWiseLocationNames).val('');
        //debugger;
        $.ajax({
            url: '/Import/DSR_CWCImport/GetGodownLocationById',
            type: 'GET',
            dataType: 'JSON',
            data: {GodownId:i },
            success: function (data) {
                if (data.Status == 1) {
                    //debugger;

                    var html = "";
                    $.each(data.Data.lstdynamicloc, function (i, elem) {
                        html += '<div style="float:left;"><div class="boolean-container"><input type="checkbox" id="' + elem.LocationId + 'g" name="' + elem.LocationId + '" onclick="SelectLocation()" /><label for="' + elem.LocationId + 'g"><i class="square"></i><span>' + elem.LocationName + '</span></label></div></div>';
                    });
                    $('#DivLocationDet').html(html);
                    $('#BtnAddDestuffingEntry').prop("disabled", false);
                    $('#btnReset').prop("disabled", true);
                }
            }
        });
    }


    $('#Godownbox').keyup(function () {
        var val = $(this).val().toLowerCase();
        if (val == "")
            $('#lstGodown > li').show();
        else {
            $('#lstGodown > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(val) >= 0 ? $(this).show() : $(this).hide());
            });
        }
    });

    $('#GodownSearch').on("click", function () {
        //debugger;
        $.ajax({
            url: '@Url.Action("ListOfGodownData", "DSR_CWCImport", new { Area = "Import" })',
            dataType: 'JSON',
            type: 'GET',
            success: function (data) {
                //debugger;
                //$('#ViewContainerList').val(data);
                //ViewBLList = data;
                var html = '';
                $.each(data, function (i, item) {
                    html += '<li id="' + item.GodownId + '" " onclick="GodownHide(this)">' + item.GodownName + '</li>';
                });
                $('#lstGodown').html(html);
            }
        });

    });
    function GodownHide(elem) {
        $('#GodownName').val($(elem).text());
        $('#GodownId').val($(elem).attr('id'))

        GetLicationByGodown($(elem).attr('id'));

        var NoOfPackages=0;
        var GrossWeight=0;
        var arRecPkg=0;
        var arRecWt=0;
        NoOfPackages=$('#NoOfPackages').val();
        GrossWeight=$('#GrossWeight').val();

        if(ArrayLst.length>0)
        {
            var Obl=$('#BOLNo').val();
            for (var i = 0; i < ArrayLst.length; i++) {

                if(Obl==ArrayLst[i].BOLNo)
                {
                    arRecPkg = Number(arRecPkg)+ Number(ArrayLst[i].ReceivedPackages);
                    arRecWt =Number(arRecWt)+Number(ArrayLst[i].DestuffingWeight);
                }
            }

            $('#ReceivedPackages').val(NoOfPackages-arRecPkg);
            $('#DestuffingWeight').val(GrossWeight-arRecWt);
        }

        //debugger;

        $("#GodownModal").modal("hide");
    }

    function SelectOBLDetails(DestuffingEntryDtlId,TallySheetDtlId,BOLNo,TallySheetArea,BOLDate,LineNo,Commodity,CommodityId,CargoDescription,NoOfPackages,GrossWeight,CargoType,UOM,RemPackages,RemWeight,ManualWT,MechanicalWT,IsHoldRelease,BOENo,BOEDate,OBLWiseDestuffingDate,CargoType,Remarks,OBLCIFValue,OBLGrossDuty) {
        //debugger;
        CargoDescription = CargoDescription.replace(new RegExp('_n_', 'g'), '\n');
        CargoDescription = CargoDescription.replace(new RegExp('_c_', 'g'), ',');
        Remarks = Remarks.replace(new RegExp('_n_', 'g'), '\n');
        Remarks = Remarks.replace(new RegExp('_c_', 'g'), ',');
        $('#BtnAddDestuffingEntry').prop("disabled", true);
        $('#btnReset').prop("disabled", false);
        ResetGodownDet();
        //debugger;
        if(IsHoldRelease==1)
        {
            alert('Released of this OBL');
            return false;
        }
        //debugger;
        if ($('#BtnAddDestuffingEntry').is(":disabled") == true) {
            $('#btnReset').prop("disabled", true);
            $('#BtnAddDestuffingEntry').prop("disabled", false);
            $('#LocationSearch').css("display", "block");
            $('#DivLocationDet').find('input[type="checkbox"]:checked').prop("checked", false);
            $('#DestuffingEntryDtlId').val(DestuffingEntryDtlId);
            $('#TallySheetDtlId').val(TallySheetDtlId);
            $('#TallySheetArea').val(TallySheetArea);
            $('#BOLNo').val(BOLNo);
            $('#BOLDate').val(BOLDate);
            $('#LineNo').val(LineNo);
            $('#Commodity').val(Commodity);
            $('#CommodityId').val(CommodityId);
            $('#CargoDescription').val(CargoDescription);
            $('#NoOfPackages').val(NoOfPackages);
            $('#GrossWeight').val(GrossWeight);
            $('#CargoType').val(CargoType)
            $('#UOM').val(UOM);
            $('#Area').val(0);
            $('#AreaCbm').val(0)
            $('#DestuffingWeight').val(0);
            $('#ReceivedPackages').val(0);
            $('#CIFValue').val(0);
            $('#GrossDuty').val(0);
            $('#RemPackages').val(RemPackages);
            $('#RemWeight').val(RemWeight);
            $('#BOENo').val(BOENo);
            $('#BOEDate').val(BOEDate);
            $('#OBLWiseDestuffingDate').val(OBLWiseDestuffingDate);
            $('#CargoType').val(CargoType);
            $('#Remarks').val(Remarks);
            $('#GdTransId').val(0);
            $('#StockDetailsId').val(0);
            $('#InterShifting').val(0);
            $('#LiftOn').val(0);
            $('#LiftOff').val(0);
            $('#Reworking').val(0);
            $('#Weighment').val(0);
            $('#ManualWT').val(ManualWT);
            $('#MechanicalWT').val(MechanicalWT);
            $('#OBLCIFValue').val(OBLCIFValue);
            $('#OBLGrossDuty').val(OBLGrossDuty);
        }
        $("#OBLModal").modal("hide");
        $('#DivDestufGodownEntryTblMsg').html('');
    }
    function AllowOnlyInteger(evt) {
        var CharCode;
        if (window.event) {
            CharCode = window.event.keyCode;
        }
        else {
            CharCode = evt.which;
        }
        if ((CharCode > 47 & CharCode < 58) || CharCode == 8) {
            return true;
        }
        else {
            evt.preventDefault;
            return false;
        }
    }
    function AllowOnlyDecimal(evt) {
        var CharCode;
        if (window.event) {
            CharCode = window.event.keyCode;
        }
        else {
            CharCode = evt.which;
        }
        if ((CharCode > 47 & CharCode < 58) || (CharCode == 46) || CharCode == 8) {
            return true;
        }
        else {
            evt.preventDefault;
            return false;
        }
    }

    function PopupActivate(Id) {
        debugger;
        var CharCode;
        if (window.event) {
            CharCode = window.event.keyCode;
        }
        else
        {
            CharCode = evt.which;
        }

        if (CharCode == 32) {
            debugger;
            $('#' + Id).modal('show');

            if (Id == "ContainerModal") {
                $('#ContainerBox').focus();
            }
            if (Id == "ShippingLineModal") {
                $('#ShpngLinebox').focus();
            }
            if (Id == "CHAModal") {
                $('#Chabox').focus();
            }
            if (Id == "OBLModal") {
                $('#OBLBox').focus();
            }
            if (Id == "CommodityModal") {
                $('#Commoditybox').focus();
            }
            if (Id == "IssuePartyModal") {
                IssuePartySearch();
                $('#Issuebox').focus();
            }
            if (Id == "CargoPartyModal") {
                CargoPartySearch();
                $('#Cargobox').focus();
            }
            if (Id == "GodownModal") {
                GodownSearch();
                $('#Godownbox').focus();
            }
            if (Id == "LocationModal") {
                $('#DivLocationDet').focus();
            }

        }
    }

    $('#ContainerModal').on('shown.bs.modal', function () {
        $('#ContainerBox').focus();
    });
    $('#ShippingLineModal').on('shown.bs.modal', function () {
        $('#ShpngLinebox').focus();
    });
    $('#CHAModal').on('shown.bs.modal', function () {
        $('#Chabox').focus();
    });
    $('#OBLModal').on('shown.bs.modal', function () {
        $('#OBLBox').focus();
    });
    $('#CommodityModal').on('shown.bs.modal', function () {
        $('#Commoditybox').focus();
    });

    $('#IssuePartyModal').on('shown.bs.modal', function () {
        $('#Issuebox').focus();
    });
    $('#CargoPartyModal').on('shown.bs.modal', function () {
        $('#Cargobox').focus();
    });

    $('#GodownModal').on('shown.bs.modal', function () {
        $('#Godownbox').focus();
    });
    $('#LocationModal').on('shown.bs.modal', function () {
        $('#DivLocationDet').focus();
    });

    //Added by Vineet on 14/02/2020

    function SaveDeliveryOrdDtl() {
        debugger;
        if ($('#IssuedBy').val() == '') {
            $('[data-valmsg-for="IssuedBy"]').html('<span>Fill Out This Field</span>');
            return false;
        }

        if ($('#CargsDelivered').val() == '') {
            $('[data-valmsg-for="CargsDelivered"]').html('<span>Fill Out This Field</span>');
            return false;
        }

        if ($('#ddlValidType').val() == '') {
            $('#ErrddlValidType').html('Fill Out This Field');

            return false;
        }
        $('#DivDeliveryOrdTblErrMsg').html('');
        var dtvalue = "";
        if ($('#ddlValidType').val() == "Open")
        {
            dtvalue = "";
        }
        else
        {
            dtvalue = $('#ValidDate').val();
        }
        var DeliveryAppDtl = {
            "OrderId": 0,
            "DeliveryNo": 0,
            "IssuedBy": $('#IssuedBy').val(),
            "DeliveredTo": $('#CargsDelivered').val(),
            "ValidType": $('#ddlValidType').val(),
            "ValidDate": dtvalue
        }
        ArrayOfDeliveryOrd.push(DeliveryAppDtl);
        ResetDeliveryOrdDet();
        GenerateDeliveryOrdTable();

    }

    function GenerateDeliveryOrdTable() {
        //  debugger;
        $('#TblDeliveryAppOrd').hide();
        var Html = '';
        if (ArrayOfDeliveryOrd.length != 0) {
            $.each(ArrayOfDeliveryOrd, function (i, item) {
                //  debugger;
                Html += '<tr><td class="text-center">' + (i + 1) + '</td><td>' + item.DeliveredTo + '</td><td class="text-center"><a href="#" onclick="EditDeliveryOrdDtl(' + i + ')"><i class="fa fa fa-pencil-square Edit" aria-hidden="true"></i></a></td></tr>';
            });
            $('#TblDeliveryAppOrd>tbody').html(Html);
            $('#TblDeliveryAppOrd').show();
        }
    }

    function ResetDeliveryOrdDet() {
        //  debugger;
        $('[data-valmsg-for="IssuedBy"]').html('');
        $('[data-valmsg-for="CargsDelivered"]').html('');
        $('#ErrddlValidType').html('');
        $('#DivDeliveryOrderDetails').find('input:text,textarea').val('');
        $('#ValidDate').val('@DateTime.Now.ToString("dd/MM/yyyy")');
        $('#ValidType').val('--Select--');

    }

    function EditDeliveryOrdDtl(Index) {
        //  debugger;
        $('#DivDeliveryOrdTblErrMsg').html('');
        // if ($('#BtnAddDeliveryOrd').prop("disabled") == true) {

        $('#IssuedBy').val(ArrayOfDeliveryOrd[Index].IssuedBy);
        $('#CargsDelivered').val(ArrayOfDeliveryOrd[Index].DeliveredTo);
        $('#ddlValidType').val(ArrayOfDeliveryOrd[Index].ValidType);
        $('#ValidDate').val(ArrayOfDeliveryOrd[Index].ValidDate);
        $('#BtnAddDeliveryOrd').prop("disabled", false);
        ArrayOfDeliveryOrd.splice(Index, 1);
        GenerateDeliveryOrdTable();
        //   }
        //  else {
        //      $('#DivDeliveryOrdTblErrMsg').html('Please Add The Above Records');
        // }
    }

    $('#CargoPartySearch').on("click", function () {
        //  debugger;
        CargoPartySearch();
    });
    function CargoPartySearch() {
        $.ajax({
            url: '@Url.Action("ListOfCargoParty", "DSR_CWCImport", new { Area = "Import" })',
            dataType: 'JSON',
            type: 'GET',
            success: function (data) {
                //  debugger;
                PartyDet = data;
                var html = '';
                var tabvalue = 401;
                $.each(data, function (i, item) {
                    html += '<li tabindex=' + tabvalue + '_'+ i +' id="' + item.IssueBy + '" " onclick="GetCargo(this)" onkeypress="GetCargo(this)">' + item.IssueBy + '</li>';
                });
                $('#lstCargo').html(html);
            }
        });

    }
    function GetCargo(elem) {
        //  debugger;
        $('#CargsDelivered').val($(elem).text());
        $("#CargoPartyModal").modal("hide");
        $('#ddlValidType').focus();
    }

    $('#Cargobox').keyup(function () {
        var val = $(this).val().toLowerCase();
        if (val == "")
            $('#lstCargo > li').show();
        else {
            $('#lstCargo > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(val) >= 0 ? $(this).show() : $(this).hide());
            });
        }
    });

    var PartyDet = "";
    $('#IssuePartySearch').on("click", function () {
        //  debugger;
        IssuePartySearch();
    });

    function IssuePartySearch(){
        $.ajax({
            url: '@Url.Action("ListOfIssueParty", "DSR_CWCImport", new { Area = "Import" })',
            dataType: 'JSON',
            type: 'GET',
            success: function (data) {
                //  debugger;
                PartyDet = data;
                var html = '';
                var tabvalue = 401;
                $.each(data, function (i, item) {
                    html += '<li tabindex=' + tabvalue + '_'+ i +' id="' + item.IssueBy + '" " onclick="GetIssue(this)" onkeypress="GetIssue(this)">' + item.IssueBy + '</li>';
                });
                $('#lstIssue').html(html);
            }
        });
    }
    function GetIssue(elem) {
        //  debugger;
        $('#IssuedBy').val($(elem).text());
        $("#IssuePartyModal").modal("hide");
        $('#CargsDelivered').focus();
    }

    $('#Issuebox').keyup(function () {
        var val = $(this).val().toLowerCase();
        if (val == "")
            $('#lstIssue > li').show();
        else {
            $('#lstIssue > li').each(function () {
                var text = $(this).text().toLowerCase();
                (text.indexOf(val) >= 0 ? $(this).show() : $(this).hide());
            });
        }
    });

    function ViewDeliveryOrdDtl(Index) {
        //  debugger;
        $('#DivDeliveryOrdTblErrMsg').html('');
        //  if ($('#BtnAddDeliveryOrd').prop("disabled") == true) {
        $('#IssuedBy').val(ArrayOfDeliveryOrd[Index].IssuedBy);
        $('#CargsDelivered').val(ArrayOfDeliveryOrd[Index].DeliveredTo);
        $('#ddlValidType').val(ArrayOfDeliveryOrd[Index].ValidType);
        $('#ValidDate').val(ArrayOfDeliveryOrd[Index].ValidDate);
        $('#BtnAddDeliveryOrd').attr("disabled");
        $('#DivDeliveryOrdTblErrMsg').html('Please Add The Above Records');

    }

    function ValidDt(vtype)
    {
        //  debugger;
        if(vtype.value=="Open")
        {
            $("#ValidDate").datepicker("option", "disabled", true);
            $("#ValidDate").val("");
        }
        else
        {
            $("#ValidDate").datepicker("option", "disabled", false);
        }
    }

    function checkdat() {
        //debugger;
        if(  $('#StartDate').val()!='')
        {
            var result = moment($('#StartDate').val(), "DD/MM/YYYY", true).isValid();
            if (!result) {
                $('#DivMs').html('Incorrect Date');
                setTimeout(function () { $('#DivMs').html(''); }, 5000);
                $('#StartDate').val('').focus();
            }
        }
    }

    function chec() {
        //debugger;
        //alert(elm);
        $('#StartDate').val($('#StartDate').val().replace(/^(\d\d)(\d)$/g, '$1/$2').replace(/^(\d\d\/\d\d)(\d+)$/g, '$1/$2').replace(/[^\d\/]/g, ''));
        $('#DivMs').html('');

    }

    function checkdate() {
        //debugger;
        if(  $('#DestuffingEntryDate').val()!='')
        {
            var result = moment($('#DestuffingEntryDate').val(), "DD/MM/YYYY", true).isValid();
            if (!result) {
                $('#DivMsd').html('Incorrect Date');
                setTimeout(function () { $('#DivMsd').html(''); }, 5000);
                $('#DestuffingEntryDate').val('').focus();
            }
        }
    }

    function check() {
        //debugger;
        //alert(elm);
        $('#DestuffingEntryDate').val($('#DestuffingEntryDate').val().replace(/^(\d\d)(\d)$/g, '$1/$2').replace(/^(\d\d\/\d\d)(\d+)$/g, '$1/$2').replace(/[^\d\/]/g, ''));
        $('#DivMsd').html('');

    }

    function checkdateDel() {
        debugger;
        if(  $('#ValidDate').val()!='')
        {
            var result = moment($('#ValidDate').val(), "DD/MM/YYYY", true).isValid();
            if (!result) {
                $('#DivMsDel').html('Incorrect Date');
                setTimeout(function () { $('#DivMsDel').html(''); }, 5000);
                $('#ValidDate').val('').focus();
            }
        }
    }

    function checkDel() {
        debugger;
        //alert(elm);
        $('#ValidDate').val($('#ValidDate').val().replace(/^(\d\d)(\d)$/g, '$1/$2').replace(/^(\d\d\/\d\d)(\d+)$/g, '$1/$2').replace(/[^\d\/]/g, ''));
        $('#DivMsDel').html('');

    }

    function SearchByPartyCode() {
        if ($('#ShpngLinebox').val() != '') {
            $.ajax({
                url: '/Import/DSR_CWCImport/SearchByPartyCode',
                type: 'GET',
                data: { PartyCode: $('#ShpngLinebox').val() },
                success: function (data) {
                    if (data.Status == 1) {
                        var html = '';
                        var tabvalue = 401;
                        $.each(data.Data.lstShippingLine, function (item, elem) {
                            html += '<tr tabindex=' + tabvalue + '_'+ item +' onclick="SelectShippingLine(' + elem.ShippingLineId + ',&quot;' + elem.ShippingLineName + '&quot;)" onkeypress="SelectShippingLine(' + elem.ShippingLineId + ',&quot;' + elem.ShippingLineName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.ShippingLineName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                        });
                        $('#tbleSline tbody').html('');
                        $('#tbleSline tbody').html(html);
                        $('#btnLoadMore').prop('disabled', false);
                        Page = -1;
                    }
                    else {
                        $('#tbleSline tbody').html('');
                        Page = -1;
                        $('#btnLoadMore').prop('disabled', false);
                    }

                }
            });
        }
        else
            LoadEximTrader();
    }

    function SelectShippingLine(ShippingLineId, ShippingLineName) {
        //debugger;
        $('#ShippingLine').val(ShippingLineName);
        $('#ShippingLineId').val(ShippingLineId);
        $("#ShippingLineModal").modal("hide");
        $('#ShpngLinebox').val('');
        LoadEximTrader();
        $('#CHA').focus();
    }

    function SearchChaByPartyCode() {
        if ($('#Chabox').val() != '') {
            $.ajax({
                url: '/Import/DSR_CWCImport/CHASearchByPartyCode',
                type: 'GET',
                data: { PartyCode: $('#Chabox').val() },
                success: function (data) {
                    if (data.Status == 1) {
                        var html = '';
                        var tabvalue = 401;
                        $.each(data.Data.lstCHA, function (item, elem) {
                            html += '<tr tabindex=' + tabvalue + '_'+ item +' onclick="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)" onkeypress="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                        });
                        $('#tbleCha tbody').html('');
                        $('#tbleCha tbody').html(html);
                        $('#btnLoadCHA').prop('disabled', false);
                        Page = -1;
                    }
                    else {
                        $('#tbleCha tbody').html('');
                        Page = -1;
                        $('#btnLoadCHA').prop('disabled', false);
                    }

                }
            });
        }
        else
            LoadCHA();
    }

    function LoadMoreCHA() {
        //debugger;
        $.ajax({
            url: '/Import/DSR_CWCImport/LoadCHAList',
            type: 'GET',
            data: { PartyCode: "", Page: Page + 1 },
            success: function (data) {
                if (data.Status == 1) {
                    //debugger;
                    var html = '';
                    var tabvalue = 401;
                    $.each(data.Data.lstCHA, function (item, elem) {
                        //debugger;
                        html += '<tr tabindex=' + tabvalue + '_'+ item +' onclick="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)" onkeypress="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                    });
                    if (Page == -1)
                        $('#tbleCha tbody').html(html);
                    else
                        $('#tbleCha tbody').append(html);
                    Page++;

                    //debugger;
                    if (data.Data.State == true)
                        $('#btnLoadCHA').prop('disabled', false);
                    else $('#btnLoadCHA').prop('disabled', true);
                }
            }
        });
    }

    function LoadCHA() {
        //debugger;
        Page = 0;
        $.ajax({
            url: '/Import/DSR_CWCImport/LoadCHAList',
            type: 'GET',
            data: { PartyCode: "", Page: Page },
            success: function (data) {
                if (data.Status == 1) {
                    //debugger;
                    var html = '';
                    var tabvalue = 401;
                    $.each(data.Data.lstCHA, function (item, elem) {
                        //debugger;
                        html += '<tr tabindex=' + tabvalue + '_'+ item +' onclick="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)" onkeypress="SelectCHA(' + elem.CHAId + ',&quot;' + elem.CHAName + '&quot;)"><td colspan="8" width="80%" class="txt_wrp">' + elem.CHAName + '</td><td colspan="4" width="20%" class="txt_wrp">' + elem.PartyCode + '</td></tr>';
                    });

                    $('#tbleCha tbody').html(html);

                    if (data.Data.State == true)
                        $('#btnLoadCHA').prop('disabled', false);
                    else $('#btnLoadCHA').prop('disabled', true);
                }
            }
        });
    }

    function SelectCHA(CHAId, CHAName) {
        //debugger;
        $('#CHA').val(CHAName);
        $('#CHAId').val(CHAId);
        $("#CHAModal").modal("hide");
        $('#Chabox').val('');
        LoadCHA();
        $('#Rotation').focus();
    }

    //Obl wise destuffing Date
    function checkdatO() {
        //debugger;
        if(  $('#OBLWiseDestuffingDate').val()!='')
        {
            var result = moment($('#OBLWiseDestuffingDate').val(), "DD/MM/YYYY", true).isValid();
            if (!result) {
                $('#DivMsO').html('Incorrect Date');
                setTimeout(function () { $('#DivMsO').html(''); }, 5000);
                $('#OBLWiseDestuffingDate').val('').focus();
            }
        }
    }

    function checO() {
        //debugger;
        //alert(elm);
        $('#OBLWiseDestuffingDate').val($('#OBLWiseDestuffingDate').val().replace(/^(\d\d)(\d)$/g, '$1/$2').replace(/^(\d\d\/\d\d)(\d+)$/g, '$1/$2').replace(/[^\d\/]/g, ''));
        $('#DivMsO').html('');

    }

    //BOE Date
    function checkdatBOE() {
        //debugger;
        if(  $('#BOEDate').val()!='')
        {
            var result = moment($('#BOEDate').val(), "DD/MM/YYYY", true).isValid();
            if (!result) {
                $('#DivMsBOE').html('Incorrect Date');
                setTimeout(function () { $('#DivMsBOE').html(''); }, 5000);
                $('#BOEDate').val('').focus();
            }
        }
    }

    function checBOE() {
        //debugger;
        //alert(elm);
        $('#BOEDate').val($('#BOEDate').val().replace(/^(\d\d)(\d)$/g, '$1/$2').replace(/^(\d\d\/\d\d)(\d+)$/g, '$1/$2').replace(/[^\d\/]/g, ''));
        $('#DivMsBOE').html('');

    }

    function CalWtFob()
    {
        debugger;
        var NOP = $('#NoOfPackages').val();
        var TW = $('#GrossWeight').val();
        var CV = $('#OBLCIFValue').val();
        var DT = $('#OBLGrossDuty').val();

        var DNOP = $('#ReceivedPackages').val();

        if(NOP=="" || NOP==0)
        {
            $('#DestuffingWeight').val(0);
            $('#CIFValue').val(0);
            $('#GrossDuty').val(0);
        }

        else
        {

            if(NOP == DNOP)
            {
                $('#DestuffingWeight').val(TW);
                $('#CIFValue').val(CV);
                $('#GrossDuty').val(DT);
            }
            else
            {
                $('#DestuffingWeight').val(((TW/NOP)*DNOP).toFixed(2));
                $('#CIFValue').val(((CV/NOP)*DNOP).toFixed(2));
                $('#GrossDuty').val(((DT/NOP)*DNOP).toFixed(2));
            }
        }
    }

    function debounce(func, wait, immediate) {
        var timeout;
        return function () {
            var context = this, args = arguments;
            var later = function () {
                timeout = null;
                if (!immediate) func.apply(context, args);
            };
            var callNow = immediate && !timeout;
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
            if (callNow) func.apply(context, args);
        };
    };
    document.getElementById('ShpngLinebox').addEventListener('keyup', debounce(function () {
        SearchByPartyCode()
    }, 800));
    document.getElementById('Chabox').addEventListener('keyup', debounce(function () {
        SearchChaByPartyCode()
    }, 800));
    //document.getElementById('CommodityBox').addEventListener('keyup', debounce(function () {
    //    SearchCommodityByPartyCode()
    //}, 800));

    //END

</script>
